var UZ=Object.defineProperty;var EF=e=>{throw TypeError(e)};var PZ=(e,t,n)=>t in e?UZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ce=(e,t,n)=>PZ(e,typeof t!="symbol"?t+"":t,n),SF=(e,t,n)=>t.has(e)||EF("Cannot "+n);var AF=(e,t,n)=>(SF(e,t,"read from private field"),n?n.call(e):t.get(e)),wF=(e,t,n)=>t.has(e)?EF("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),KS=(e,t,n,i)=>(SF(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function up(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var JS={exports:{}},m0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _F;function IZ(){if(_F)return m0;_F=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,r,a){var s=null;if(a!==void 0&&(s=""+a),r.key!==void 0&&(s=""+r.key),"key"in r){a={};for(var o in r)o!=="key"&&(a[o]=r[o])}else a=r;return r=a.ref,{$$typeof:e,type:i,key:s,ref:r!==void 0?r:null,props:a}}return m0.Fragment=t,m0.jsx=n,m0.jsxs=n,m0}var CF;function qZ(){return CF||(CF=1,JS.exports=IZ()),JS.exports}var j=qZ(),eA={exports:{}},Xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $F;function HZ(){if($F)return Xe;$F=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function p(k){return k===null||typeof k!="object"?null:(k=h&&k[h]||k["@@iterator"],typeof k=="function"?k:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,b={};function E(k,V,X){this.props=k,this.context=V,this.refs=b,this.updater=X||y}E.prototype.isReactComponent={},E.prototype.setState=function(k,V){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,V,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function S(){}S.prototype=E.prototype;function w(k,V,X){this.props=k,this.context=V,this.refs=b,this.updater=X||y}var _=w.prototype=new S;_.constructor=w,v(_,E.prototype),_.isPureReactComponent=!0;var C=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},M=Object.prototype.hasOwnProperty;function T(k,V,X,ne,ye,le){return X=le.ref,{$$typeof:e,type:k,key:V,ref:X!==void 0?X:null,props:le}}function F(k,V){return T(k.type,V,void 0,void 0,void 0,k.props)}function R(k){return typeof k=="object"&&k!==null&&k.$$typeof===e}function B(k){var V={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(X){return V[X]})}var L=/\/+/g;function Y(k,V){return typeof k=="object"&&k!==null&&k.key!=null?B(""+k.key):V.toString(36)}function H(){}function U(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(H,H):(k.status="pending",k.then(function(V){k.status==="pending"&&(k.status="fulfilled",k.value=V)},function(V){k.status==="pending"&&(k.status="rejected",k.reason=V)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function z(k,V,X,ne,ye){var le=typeof k;(le==="undefined"||le==="boolean")&&(k=null);var be=!1;if(k===null)be=!0;else switch(le){case"bigint":case"string":case"number":be=!0;break;case"object":switch(k.$$typeof){case e:case t:be=!0;break;case d:return be=k._init,z(be(k._payload),V,X,ne,ye)}}if(be)return ye=ye(k),be=ne===""?"."+Y(k,0):ne,C(ye)?(X="",be!=null&&(X=be.replace(L,"$&/")+"/"),z(ye,V,X,"",function(xe){return xe})):ye!=null&&(R(ye)&&(ye=F(ye,X+(ye.key==null||k&&k.key===ye.key?"":(""+ye.key).replace(L,"$&/")+"/")+be)),V.push(ye)),1;be=0;var Ye=ne===""?".":ne+":";if(C(k))for(var it=0;it<k.length;it++)ne=k[it],le=Ye+Y(ne,it),be+=z(ne,V,X,le,ye);else if(it=p(k),typeof it=="function")for(k=it.call(k),it=0;!(ne=k.next()).done;)ne=ne.value,le=Ye+Y(ne,it++),be+=z(ne,V,X,le,ye);else if(le==="object"){if(typeof k.then=="function")return z(U(k),V,X,ne,ye);throw V=String(k),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return be}function O(k,V,X){if(k==null)return k;var ne=[],ye=0;return z(k,ne,"","",function(le){return V.call(X,le,ye++)}),ne}function I(k){if(k._status===-1){var V=k._result;V=V(),V.then(function(X){(k._status===0||k._status===-1)&&(k._status=1,k._result=X)},function(X){(k._status===0||k._status===-1)&&(k._status=2,k._result=X)}),k._status===-1&&(k._status=0,k._result=V)}if(k._status===1)return k._result.default;throw k._result}var W=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)};function K(){}return Xe.Children={map:O,forEach:function(k,V,X){O(k,function(){V.apply(this,arguments)},X)},count:function(k){var V=0;return O(k,function(){V++}),V},toArray:function(k){return O(k,function(V){return V})||[]},only:function(k){if(!R(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},Xe.Component=E,Xe.Fragment=n,Xe.Profiler=r,Xe.PureComponent=w,Xe.StrictMode=i,Xe.Suspense=l,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(k){return $.H.useMemoCache(k)}},Xe.cache=function(k){return function(){return k.apply(null,arguments)}},Xe.cloneElement=function(k,V,X){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var ne=v({},k.props),ye=k.key,le=void 0;if(V!=null)for(be in V.ref!==void 0&&(le=void 0),V.key!==void 0&&(ye=""+V.key),V)!M.call(V,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&V.ref===void 0||(ne[be]=V[be]);var be=arguments.length-2;if(be===1)ne.children=X;else if(1<be){for(var Ye=Array(be),it=0;it<be;it++)Ye[it]=arguments[it+2];ne.children=Ye}return T(k.type,ye,void 0,void 0,le,ne)},Xe.createContext=function(k){return k={$$typeof:s,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:a,_context:k},k},Xe.createElement=function(k,V,X){var ne,ye={},le=null;if(V!=null)for(ne in V.key!==void 0&&(le=""+V.key),V)M.call(V,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(ye[ne]=V[ne]);var be=arguments.length-2;if(be===1)ye.children=X;else if(1<be){for(var Ye=Array(be),it=0;it<be;it++)Ye[it]=arguments[it+2];ye.children=Ye}if(k&&k.defaultProps)for(ne in be=k.defaultProps,be)ye[ne]===void 0&&(ye[ne]=be[ne]);return T(k,le,void 0,void 0,null,ye)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(k){return{$$typeof:o,render:k}},Xe.isValidElement=R,Xe.lazy=function(k){return{$$typeof:d,_payload:{_status:-1,_result:k},_init:I}},Xe.memo=function(k,V){return{$$typeof:f,type:k,compare:V===void 0?null:V}},Xe.startTransition=function(k){var V=$.T,X={};$.T=X;try{var ne=k(),ye=$.S;ye!==null&&ye(X,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(K,W)}catch(le){W(le)}finally{$.T=V}},Xe.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},Xe.use=function(k){return $.H.use(k)},Xe.useActionState=function(k,V,X){return $.H.useActionState(k,V,X)},Xe.useCallback=function(k,V){return $.H.useCallback(k,V)},Xe.useContext=function(k){return $.H.useContext(k)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(k,V){return $.H.useDeferredValue(k,V)},Xe.useEffect=function(k,V,X){var ne=$.H;if(typeof X=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(k,V)},Xe.useId=function(){return $.H.useId()},Xe.useImperativeHandle=function(k,V,X){return $.H.useImperativeHandle(k,V,X)},Xe.useInsertionEffect=function(k,V){return $.H.useInsertionEffect(k,V)},Xe.useLayoutEffect=function(k,V){return $.H.useLayoutEffect(k,V)},Xe.useMemo=function(k,V){return $.H.useMemo(k,V)},Xe.useOptimistic=function(k,V){return $.H.useOptimistic(k,V)},Xe.useReducer=function(k,V,X){return $.H.useReducer(k,V,X)},Xe.useRef=function(k){return $.H.useRef(k)},Xe.useState=function(k){return $.H.useState(k)},Xe.useSyncExternalStore=function(k,V,X){return $.H.useSyncExternalStore(k,V,X)},Xe.useTransition=function(){return $.H.useTransition()},Xe.version="19.1.0",Xe}var DF;function t$(){return DF||(DF=1,eA.exports=HZ()),eA.exports}var _e=t$();const Yl=up(_e);var tA={exports:{}},y0={},nA={exports:{}},iA={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TF;function GZ(){return TF||(TF=1,function(e){function t(O,I){var W=O.length;O.push(I);e:for(;0<W;){var K=W-1>>>1,k=O[K];if(0<r(k,I))O[K]=I,O[W]=k,W=K;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var I=O[0],W=O.pop();if(W!==I){O[0]=W;e:for(var K=0,k=O.length,V=k>>>1;K<V;){var X=2*(K+1)-1,ne=O[X],ye=X+1,le=O[ye];if(0>r(ne,W))ye<k&&0>r(le,ne)?(O[K]=le,O[ye]=W,K=ye):(O[K]=ne,O[X]=W,K=X);else if(ye<k&&0>r(le,W))O[K]=le,O[ye]=W,K=ye;else break e}}return I}function r(O,I){var W=O.sortIndex-I.sortIndex;return W!==0?W:O.id-I.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],f=[],d=1,h=null,p=3,y=!1,v=!1,b=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function C(O){for(var I=n(f);I!==null;){if(I.callback===null)i(f);else if(I.startTime<=O)i(f),I.sortIndex=I.expirationTime,t(l,I);else break;I=n(f)}}function $(O){if(b=!1,C(O),!v)if(n(l)!==null)v=!0,M||(M=!0,Y());else{var I=n(f);I!==null&&z($,I.startTime-O)}}var M=!1,T=-1,F=5,R=-1;function B(){return E?!0:!(e.unstable_now()-R<F)}function L(){if(E=!1,M){var O=e.unstable_now();R=O;var I=!0;try{e:{v=!1,b&&(b=!1,w(T),T=-1),y=!0;var W=p;try{t:{for(C(O),h=n(l);h!==null&&!(h.expirationTime>O&&B());){var K=h.callback;if(typeof K=="function"){h.callback=null,p=h.priorityLevel;var k=K(h.expirationTime<=O);if(O=e.unstable_now(),typeof k=="function"){h.callback=k,C(O),I=!0;break t}h===n(l)&&i(l),C(O)}else i(l);h=n(l)}if(h!==null)I=!0;else{var V=n(f);V!==null&&z($,V.startTime-O),I=!1}}break e}finally{h=null,p=W,y=!1}I=void 0}}finally{I?Y():M=!1}}}var Y;if(typeof _=="function")Y=function(){_(L)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,U=H.port2;H.port1.onmessage=L,Y=function(){U.postMessage(null)}}else Y=function(){S(L,0)};function z(O,I){T=S(function(){O(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var W=p;p=I;try{return O()}finally{p=W}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(O,I){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var W=p;p=O;try{return I()}finally{p=W}},e.unstable_scheduleCallback=function(O,I,W){var K=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?K+W:K):W=K,O){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=W+k,O={id:d++,callback:I,priorityLevel:O,startTime:W,expirationTime:k,sortIndex:-1},W>K?(O.sortIndex=W,t(f,O),n(l)===null&&O===n(f)&&(b?(w(T),T=-1):b=!0,z($,W-K))):(O.sortIndex=k,t(l,O),v||y||(v=!0,M||(M=!0,Y()))),O},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(O){var I=p;return function(){var W=p;p=I;try{return O.apply(this,arguments)}finally{p=W}}}}(iA)),iA}var MF;function YZ(){return MF||(MF=1,nA.exports=GZ()),nA.exports}var rA={exports:{}},ri={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kF;function VZ(){if(kF)return ri;kF=1;var e=t$();function t(l){var f="https://react.dev/errors/"+l;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(l,f,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:h==null?null:""+h,children:l,containerInfo:f,implementation:d}}var s=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,f){if(l==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ri.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ri.createPortal=function(l,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(l,f,null,d)},ri.flushSync=function(l){var f=s.T,d=i.p;try{if(s.T=null,i.p=2,l)return l()}finally{s.T=f,i.p=d,i.d.f()}},ri.preconnect=function(l,f){typeof l=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(l,f))},ri.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},ri.preinit=function(l,f){if(typeof l=="string"&&f&&typeof f.as=="string"){var d=f.as,h=o(d,f.crossOrigin),p=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?i.d.S(l,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:h,integrity:p,fetchPriority:y}):d==="script"&&i.d.X(l,{crossOrigin:h,integrity:p,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ri.preinitModule=function(l,f){if(typeof l=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=o(f.as,f.crossOrigin);i.d.M(l,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(l)},ri.preload=function(l,f){if(typeof l=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,h=o(d,f.crossOrigin);i.d.L(l,d,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ri.preloadModule=function(l,f){if(typeof l=="string")if(f){var d=o(f.as,f.crossOrigin);i.d.m(l,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(l)},ri.requestFormReset=function(l){i.d.r(l)},ri.unstable_batchedUpdates=function(l,f){return l(f)},ri.useFormState=function(l,f,d){return s.H.useFormState(l,f,d)},ri.useFormStatus=function(){return s.H.useHostTransitionStatus()},ri.version="19.1.0",ri}var NF;function XZ(){if(NF)return rA.exports;NF=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),rA.exports=VZ(),rA.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FF;function WZ(){if(FF)return y0;FF=1;var e=YZ(),t=t$(),n=XZ();function i(u){var c="https://react.dev/errors/"+u;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)c+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+u+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function a(u){var c=u,g=u;if(u.alternate)for(;c.return;)c=c.return;else{u=c;do c=u,(c.flags&4098)!==0&&(g=c.return),u=c.return;while(u)}return c.tag===3?g:null}function s(u){if(u.tag===13){var c=u.memoizedState;if(c===null&&(u=u.alternate,u!==null&&(c=u.memoizedState)),c!==null)return c.dehydrated}return null}function o(u){if(a(u)!==u)throw Error(i(188))}function l(u){var c=u.alternate;if(!c){if(c=a(u),c===null)throw Error(i(188));return c!==u?null:u}for(var g=u,m=c;;){var x=g.return;if(x===null)break;var A=x.alternate;if(A===null){if(m=x.return,m!==null){g=m;continue}break}if(x.child===A.child){for(A=x.child;A;){if(A===g)return o(x),u;if(A===m)return o(x),c;A=A.sibling}throw Error(i(188))}if(g.return!==m.return)g=x,m=A;else{for(var D=!1,N=x.child;N;){if(N===g){D=!0,g=x,m=A;break}if(N===m){D=!0,m=x,g=A;break}N=N.sibling}if(!D){for(N=A.child;N;){if(N===g){D=!0,g=A,m=x;break}if(N===m){D=!0,m=A,g=x;break}N=N.sibling}if(!D)throw Error(i(189))}}if(g.alternate!==m)throw Error(i(190))}if(g.tag!==3)throw Error(i(188));return g.stateNode.current===g?u:c}function f(u){var c=u.tag;if(c===5||c===26||c===27||c===6)return u;for(u=u.child;u!==null;){if(c=f(u),c!==null)return c;u=u.sibling}return null}var d=Object.assign,h=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),_=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function Y(u){return u===null||typeof u!="object"?null:(u=L&&u[L]||u["@@iterator"],typeof u=="function"?u:null)}var H=Symbol.for("react.client.reference");function U(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===H?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case v:return"Fragment";case E:return"Profiler";case b:return"StrictMode";case $:return"Suspense";case M:return"SuspenseList";case R:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case y:return"Portal";case _:return(u.displayName||"Context")+".Provider";case w:return(u._context.displayName||"Context")+".Consumer";case C:var c=u.render;return u=u.displayName,u||(u=c.displayName||c.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case T:return c=u.displayName||null,c!==null?c:U(u.type)||"Memo";case F:c=u._payload,u=u._init;try{return U(u(c))}catch{}}return null}var z=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},K=[],k=-1;function V(u){return{current:u}}function X(u){0>k||(u.current=K[k],K[k]=null,k--)}function ne(u,c){k++,K[k]=u.current,u.current=c}var ye=V(null),le=V(null),be=V(null),Ye=V(null);function it(u,c){switch(ne(be,c),ne(le,u),ne(ye,null),c.nodeType){case 9:case 11:u=(u=c.documentElement)&&(u=u.namespaceURI)?WN(u):0;break;default:if(u=c.tagName,c=c.namespaceURI)c=WN(c),u=QN(c,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}X(ye),ne(ye,u)}function xe(){X(ye),X(le),X(be)}function Ie(u){u.memoizedState!==null&&ne(Ye,u);var c=ye.current,g=QN(c,u.type);c!==g&&(ne(le,u),ne(ye,g))}function Ge(u){le.current===u&&(X(ye),X(le)),Ye.current===u&&(X(Ye),f0._currentValue=W)}var he=Object.prototype.hasOwnProperty,nn=e.unstable_scheduleCallback,lt=e.unstable_cancelCallback,fn=e.unstable_shouldYield,$n=e.unstable_requestPaint,dn=e.unstable_now,lm=e.unstable_getCurrentPriorityLevel,T6=e.unstable_ImmediatePriority,M6=e.unstable_UserBlockingPriority,cm=e.unstable_NormalPriority,EW=e.unstable_LowPriority,k6=e.unstable_IdlePriority,SW=e.log,AW=e.unstable_setDisableYieldValue,bh=null,or=null;function Fo(u){if(typeof SW=="function"&&AW(u),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(bh,u)}catch{}}var ur=Math.clz32?Math.clz32:CW,wW=Math.log,_W=Math.LN2;function CW(u){return u>>>=0,u===0?32:31-(wW(u)/_W|0)|0}var fm=256,dm=4194304;function al(u){var c=u&42;if(c!==0)return c;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function hm(u,c,g){var m=u.pendingLanes;if(m===0)return 0;var x=0,A=u.suspendedLanes,D=u.pingedLanes;u=u.warmLanes;var N=m&134217727;return N!==0?(m=N&~A,m!==0?x=al(m):(D&=N,D!==0?x=al(D):g||(g=N&~u,g!==0&&(x=al(g))))):(N=m&~A,N!==0?x=al(N):D!==0?x=al(D):g||(g=m&~u,g!==0&&(x=al(g)))),x===0?0:c!==0&&c!==x&&(c&A)===0&&(A=x&-x,g=c&-c,A>=g||A===32&&(g&4194048)!==0)?c:x}function xh(u,c){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&c)===0}function $W(u,c){switch(u){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function N6(){var u=fm;return fm<<=1,(fm&4194048)===0&&(fm=256),u}function F6(){var u=dm;return dm<<=1,(dm&62914560)===0&&(dm=4194304),u}function P2(u){for(var c=[],g=0;31>g;g++)c.push(u);return c}function Eh(u,c){u.pendingLanes|=c,c!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function DW(u,c,g,m,x,A){var D=u.pendingLanes;u.pendingLanes=g,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=g,u.entangledLanes&=g,u.errorRecoveryDisabledLanes&=g,u.shellSuspendCounter=0;var N=u.entanglements,P=u.expirationTimes,Z=u.hiddenUpdates;for(g=D&~g;0<g;){var se=31-ur(g),ue=1<<se;N[se]=0,P[se]=-1;var J=Z[se];if(J!==null)for(Z[se]=null,se=0;se<J.length;se++){var ee=J[se];ee!==null&&(ee.lane&=-536870913)}g&=~ue}m!==0&&O6(u,m,0),A!==0&&x===0&&u.tag!==0&&(u.suspendedLanes|=A&~(D&~c))}function O6(u,c,g){u.pendingLanes|=c,u.suspendedLanes&=~c;var m=31-ur(c);u.entangledLanes|=c,u.entanglements[m]=u.entanglements[m]|1073741824|g&4194090}function R6(u,c){var g=u.entangledLanes|=c;for(u=u.entanglements;g;){var m=31-ur(g),x=1<<m;x&c|u[m]&c&&(u[m]|=c),g&=~x}}function I2(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function q2(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function z6(){var u=I.p;return u!==0?u:(u=window.event,u===void 0?32:pF(u.type))}function TW(u,c){var g=I.p;try{return I.p=u,c()}finally{I.p=g}}var Oo=Math.random().toString(36).slice(2),ni="__reactFiber$"+Oo,Ui="__reactProps$"+Oo,Vc="__reactContainer$"+Oo,H2="__reactEvents$"+Oo,MW="__reactListeners$"+Oo,kW="__reactHandles$"+Oo,B6="__reactResources$"+Oo,Sh="__reactMarker$"+Oo;function G2(u){delete u[ni],delete u[Ui],delete u[H2],delete u[MW],delete u[kW]}function Xc(u){var c=u[ni];if(c)return c;for(var g=u.parentNode;g;){if(c=g[Vc]||g[ni]){if(g=c.alternate,c.child!==null||g!==null&&g.child!==null)for(u=eF(u);u!==null;){if(g=u[ni])return g;u=eF(u)}return c}u=g,g=u.parentNode}return null}function Wc(u){if(u=u[ni]||u[Vc]){var c=u.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return u}return null}function Ah(u){var c=u.tag;if(c===5||c===26||c===27||c===6)return u.stateNode;throw Error(i(33))}function Qc(u){var c=u[B6];return c||(c=u[B6]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Dn(u){u[Sh]=!0}var L6=new Set,j6={};function sl(u,c){Zc(u,c),Zc(u+"Capture",c)}function Zc(u,c){for(j6[u]=c,u=0;u<c.length;u++)L6.add(c[u])}var NW=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),U6={},P6={};function FW(u){return he.call(P6,u)?!0:he.call(U6,u)?!1:NW.test(u)?P6[u]=!0:(U6[u]=!0,!1)}function gm(u,c,g){if(FW(c))if(g===null)u.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":u.removeAttribute(c);return;case"boolean":var m=c.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){u.removeAttribute(c);return}}u.setAttribute(c,""+g)}}function pm(u,c,g){if(g===null)u.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(c);return}u.setAttribute(c,""+g)}}function Ns(u,c,g,m){if(m===null)u.removeAttribute(g);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(g);return}u.setAttributeNS(c,g,""+m)}}var Y2,I6;function Kc(u){if(Y2===void 0)try{throw Error()}catch(g){var c=g.stack.trim().match(/\n( *(at )?)/);Y2=c&&c[1]||"",I6=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Y2+u+I6}var V2=!1;function X2(u,c){if(!u||V2)return"";V2=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(c){var ue=function(){throw Error()};if(Object.defineProperty(ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ue,[])}catch(ee){var J=ee}Reflect.construct(u,[],ue)}else{try{ue.call()}catch(ee){J=ee}u.call(ue.prototype)}}else{try{throw Error()}catch(ee){J=ee}(ue=u())&&typeof ue.catch=="function"&&ue.catch(function(){})}}catch(ee){if(ee&&J&&typeof ee.stack=="string")return[ee.stack,J.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=m.DetermineComponentFrameRoot(),D=A[0],N=A[1];if(D&&N){var P=D.split(`
`),Z=N.split(`
`);for(x=m=0;m<P.length&&!P[m].includes("DetermineComponentFrameRoot");)m++;for(;x<Z.length&&!Z[x].includes("DetermineComponentFrameRoot");)x++;if(m===P.length||x===Z.length)for(m=P.length-1,x=Z.length-1;1<=m&&0<=x&&P[m]!==Z[x];)x--;for(;1<=m&&0<=x;m--,x--)if(P[m]!==Z[x]){if(m!==1||x!==1)do if(m--,x--,0>x||P[m]!==Z[x]){var se=`
`+P[m].replace(" at new "," at ");return u.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",u.displayName)),se}while(1<=m&&0<=x);break}}}finally{V2=!1,Error.prepareStackTrace=g}return(g=u?u.displayName||u.name:"")?Kc(g):""}function OW(u){switch(u.tag){case 26:case 27:case 5:return Kc(u.type);case 16:return Kc("Lazy");case 13:return Kc("Suspense");case 19:return Kc("SuspenseList");case 0:case 15:return X2(u.type,!1);case 11:return X2(u.type.render,!1);case 1:return X2(u.type,!0);case 31:return Kc("Activity");default:return""}}function q6(u){try{var c="";do c+=OW(u),u=u.return;while(u);return c}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function kr(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function H6(u){var c=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function RW(u){var c=H6(u)?"checked":"value",g=Object.getOwnPropertyDescriptor(u.constructor.prototype,c),m=""+u[c];if(!u.hasOwnProperty(c)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,A=g.set;return Object.defineProperty(u,c,{configurable:!0,get:function(){return x.call(this)},set:function(D){m=""+D,A.call(this,D)}}),Object.defineProperty(u,c,{enumerable:g.enumerable}),{getValue:function(){return m},setValue:function(D){m=""+D},stopTracking:function(){u._valueTracker=null,delete u[c]}}}}function mm(u){u._valueTracker||(u._valueTracker=RW(u))}function G6(u){if(!u)return!1;var c=u._valueTracker;if(!c)return!0;var g=c.getValue(),m="";return u&&(m=H6(u)?u.checked?"true":"false":u.value),u=m,u!==g?(c.setValue(u),!0):!1}function ym(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var zW=/[\n"\\]/g;function Nr(u){return u.replace(zW,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function W2(u,c,g,m,x,A,D,N){u.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?u.type=D:u.removeAttribute("type"),c!=null?D==="number"?(c===0&&u.value===""||u.value!=c)&&(u.value=""+kr(c)):u.value!==""+kr(c)&&(u.value=""+kr(c)):D!=="submit"&&D!=="reset"||u.removeAttribute("value"),c!=null?Q2(u,D,kr(c)):g!=null?Q2(u,D,kr(g)):m!=null&&u.removeAttribute("value"),x==null&&A!=null&&(u.defaultChecked=!!A),x!=null&&(u.checked=x&&typeof x!="function"&&typeof x!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?u.name=""+kr(N):u.removeAttribute("name")}function Y6(u,c,g,m,x,A,D,N){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(u.type=A),c!=null||g!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;g=g!=null?""+kr(g):"",c=c!=null?""+kr(c):g,N||c===u.value||(u.value=c),u.defaultValue=c}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,u.checked=N?u.checked:!!m,u.defaultChecked=!!m,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(u.name=D)}function Q2(u,c,g){c==="number"&&ym(u.ownerDocument)===u||u.defaultValue===""+g||(u.defaultValue=""+g)}function Jc(u,c,g,m){if(u=u.options,c){c={};for(var x=0;x<g.length;x++)c["$"+g[x]]=!0;for(g=0;g<u.length;g++)x=c.hasOwnProperty("$"+u[g].value),u[g].selected!==x&&(u[g].selected=x),x&&m&&(u[g].defaultSelected=!0)}else{for(g=""+kr(g),c=null,x=0;x<u.length;x++){if(u[x].value===g){u[x].selected=!0,m&&(u[x].defaultSelected=!0);return}c!==null||u[x].disabled||(c=u[x])}c!==null&&(c.selected=!0)}}function V6(u,c,g){if(c!=null&&(c=""+kr(c),c!==u.value&&(u.value=c),g==null)){u.defaultValue!==c&&(u.defaultValue=c);return}u.defaultValue=g!=null?""+kr(g):""}function X6(u,c,g,m){if(c==null){if(m!=null){if(g!=null)throw Error(i(92));if(z(m)){if(1<m.length)throw Error(i(93));m=m[0]}g=m}g==null&&(g=""),c=g}g=kr(c),u.defaultValue=g,m=u.textContent,m===g&&m!==""&&m!==null&&(u.value=m)}function ef(u,c){if(c){var g=u.firstChild;if(g&&g===u.lastChild&&g.nodeType===3){g.nodeValue=c;return}}u.textContent=c}var BW=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function W6(u,c,g){var m=c.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?m?u.setProperty(c,""):c==="float"?u.cssFloat="":u[c]="":m?u.setProperty(c,g):typeof g!="number"||g===0||BW.has(c)?c==="float"?u.cssFloat=g:u[c]=(""+g).trim():u[c]=g+"px"}function Q6(u,c,g){if(c!=null&&typeof c!="object")throw Error(i(62));if(u=u.style,g!=null){for(var m in g)!g.hasOwnProperty(m)||c!=null&&c.hasOwnProperty(m)||(m.indexOf("--")===0?u.setProperty(m,""):m==="float"?u.cssFloat="":u[m]="");for(var x in c)m=c[x],c.hasOwnProperty(x)&&g[x]!==m&&W6(u,x,m)}else for(var A in c)c.hasOwnProperty(A)&&W6(u,A,c[A])}function Z2(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var LW=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jW=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vm(u){return jW.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var K2=null;function J2(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var tf=null,nf=null;function Z6(u){var c=Wc(u);if(c&&(u=c.stateNode)){var g=u[Ui]||null;e:switch(u=c.stateNode,c.type){case"input":if(W2(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),c=g.name,g.type==="radio"&&c!=null){for(g=u;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Nr(""+c)+'"][type="radio"]'),c=0;c<g.length;c++){var m=g[c];if(m!==u&&m.form===u.form){var x=m[Ui]||null;if(!x)throw Error(i(90));W2(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(c=0;c<g.length;c++)m=g[c],m.form===u.form&&G6(m)}break e;case"textarea":V6(u,g.value,g.defaultValue);break e;case"select":c=g.value,c!=null&&Jc(u,!!g.multiple,c,!1)}}}var eE=!1;function K6(u,c,g){if(eE)return u(c,g);eE=!0;try{var m=u(c);return m}finally{if(eE=!1,(tf!==null||nf!==null)&&(i1(),tf&&(c=tf,u=nf,nf=tf=null,Z6(c),u)))for(c=0;c<u.length;c++)Z6(u[c])}}function wh(u,c){var g=u.stateNode;if(g===null)return null;var m=g[Ui]||null;if(m===null)return null;g=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(u=u.type,m=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!m;break e;default:u=!1}if(u)return null;if(g&&typeof g!="function")throw Error(i(231,c,typeof g));return g}var Fs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tE=!1;if(Fs)try{var _h={};Object.defineProperty(_h,"passive",{get:function(){tE=!0}}),window.addEventListener("test",_h,_h),window.removeEventListener("test",_h,_h)}catch{tE=!1}var Ro=null,nE=null,bm=null;function J6(){if(bm)return bm;var u,c=nE,g=c.length,m,x="value"in Ro?Ro.value:Ro.textContent,A=x.length;for(u=0;u<g&&c[u]===x[u];u++);var D=g-u;for(m=1;m<=D&&c[g-m]===x[A-m];m++);return bm=x.slice(u,1<m?1-m:void 0)}function xm(u){var c=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&c===13&&(u=13)):u=c,u===10&&(u=13),32<=u||u===13?u:0}function Em(){return!0}function e4(){return!1}function Pi(u){function c(g,m,x,A,D){this._reactName=g,this._targetInst=x,this.type=m,this.nativeEvent=A,this.target=D,this.currentTarget=null;for(var N in u)u.hasOwnProperty(N)&&(g=u[N],this[N]=g?g(A):A[N]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Em:e4,this.isPropagationStopped=e4,this}return d(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Em)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Em)},persist:function(){},isPersistent:Em}),c}var ol={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sm=Pi(ol),Ch=d({},ol,{view:0,detail:0}),UW=Pi(Ch),iE,rE,$h,Am=d({},Ch,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sE,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==$h&&($h&&u.type==="mousemove"?(iE=u.screenX-$h.screenX,rE=u.screenY-$h.screenY):rE=iE=0,$h=u),iE)},movementY:function(u){return"movementY"in u?u.movementY:rE}}),t4=Pi(Am),PW=d({},Am,{dataTransfer:0}),IW=Pi(PW),qW=d({},Ch,{relatedTarget:0}),aE=Pi(qW),HW=d({},ol,{animationName:0,elapsedTime:0,pseudoElement:0}),GW=Pi(HW),YW=d({},ol,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),VW=Pi(YW),XW=d({},ol,{data:0}),n4=Pi(XW),WW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KW(u){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(u):(u=ZW[u])?!!c[u]:!1}function sE(){return KW}var JW=d({},Ch,{key:function(u){if(u.key){var c=WW[u.key]||u.key;if(c!=="Unidentified")return c}return u.type==="keypress"?(u=xm(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?QW[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sE,charCode:function(u){return u.type==="keypress"?xm(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?xm(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),eQ=Pi(JW),tQ=d({},Am,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i4=Pi(tQ),nQ=d({},Ch,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sE}),iQ=Pi(nQ),rQ=d({},ol,{propertyName:0,elapsedTime:0,pseudoElement:0}),aQ=Pi(rQ),sQ=d({},Am,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),oQ=Pi(sQ),uQ=d({},ol,{newState:0,oldState:0}),lQ=Pi(uQ),cQ=[9,13,27,32],oE=Fs&&"CompositionEvent"in window,Dh=null;Fs&&"documentMode"in document&&(Dh=document.documentMode);var fQ=Fs&&"TextEvent"in window&&!Dh,r4=Fs&&(!oE||Dh&&8<Dh&&11>=Dh),a4=" ",s4=!1;function o4(u,c){switch(u){case"keyup":return cQ.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u4(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var rf=!1;function dQ(u,c){switch(u){case"compositionend":return u4(c);case"keypress":return c.which!==32?null:(s4=!0,a4);case"textInput":return u=c.data,u===a4&&s4?null:u;default:return null}}function hQ(u,c){if(rf)return u==="compositionend"||!oE&&o4(u,c)?(u=J6(),bm=nE=Ro=null,rf=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return r4&&c.locale!=="ko"?null:c.data;default:return null}}var gQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function l4(u){var c=u&&u.nodeName&&u.nodeName.toLowerCase();return c==="input"?!!gQ[u.type]:c==="textarea"}function c4(u,c,g,m){tf?nf?nf.push(m):nf=[m]:tf=m,c=l1(c,"onChange"),0<c.length&&(g=new Sm("onChange","change",null,g,m),u.push({event:g,listeners:c}))}var Th=null,Mh=null;function pQ(u){HN(u,0)}function wm(u){var c=Ah(u);if(G6(c))return u}function f4(u,c){if(u==="change")return c}var d4=!1;if(Fs){var uE;if(Fs){var lE="oninput"in document;if(!lE){var h4=document.createElement("div");h4.setAttribute("oninput","return;"),lE=typeof h4.oninput=="function"}uE=lE}else uE=!1;d4=uE&&(!document.documentMode||9<document.documentMode)}function g4(){Th&&(Th.detachEvent("onpropertychange",p4),Mh=Th=null)}function p4(u){if(u.propertyName==="value"&&wm(Mh)){var c=[];c4(c,Mh,u,J2(u)),K6(pQ,c)}}function mQ(u,c,g){u==="focusin"?(g4(),Th=c,Mh=g,Th.attachEvent("onpropertychange",p4)):u==="focusout"&&g4()}function yQ(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return wm(Mh)}function vQ(u,c){if(u==="click")return wm(c)}function bQ(u,c){if(u==="input"||u==="change")return wm(c)}function xQ(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var lr=typeof Object.is=="function"?Object.is:xQ;function kh(u,c){if(lr(u,c))return!0;if(typeof u!="object"||u===null||typeof c!="object"||c===null)return!1;var g=Object.keys(u),m=Object.keys(c);if(g.length!==m.length)return!1;for(m=0;m<g.length;m++){var x=g[m];if(!he.call(c,x)||!lr(u[x],c[x]))return!1}return!0}function m4(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function y4(u,c){var g=m4(u);u=0;for(var m;g;){if(g.nodeType===3){if(m=u+g.textContent.length,u<=c&&m>=c)return{node:g,offset:c-u};u=m}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=m4(g)}}function v4(u,c){return u&&c?u===c?!0:u&&u.nodeType===3?!1:c&&c.nodeType===3?v4(u,c.parentNode):"contains"in u?u.contains(c):u.compareDocumentPosition?!!(u.compareDocumentPosition(c)&16):!1:!1}function b4(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var c=ym(u.document);c instanceof u.HTMLIFrameElement;){try{var g=typeof c.contentWindow.location.href=="string"}catch{g=!1}if(g)u=c.contentWindow;else break;c=ym(u.document)}return c}function cE(u){var c=u&&u.nodeName&&u.nodeName.toLowerCase();return c&&(c==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||c==="textarea"||u.contentEditable==="true")}var EQ=Fs&&"documentMode"in document&&11>=document.documentMode,af=null,fE=null,Nh=null,dE=!1;function x4(u,c,g){var m=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;dE||af==null||af!==ym(m)||(m=af,"selectionStart"in m&&cE(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Nh&&kh(Nh,m)||(Nh=m,m=l1(fE,"onSelect"),0<m.length&&(c=new Sm("onSelect","select",null,c,g),u.push({event:c,listeners:m}),c.target=af)))}function ul(u,c){var g={};return g[u.toLowerCase()]=c.toLowerCase(),g["Webkit"+u]="webkit"+c,g["Moz"+u]="moz"+c,g}var sf={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionrun:ul("Transition","TransitionRun"),transitionstart:ul("Transition","TransitionStart"),transitioncancel:ul("Transition","TransitionCancel"),transitionend:ul("Transition","TransitionEnd")},hE={},E4={};Fs&&(E4=document.createElement("div").style,"AnimationEvent"in window||(delete sf.animationend.animation,delete sf.animationiteration.animation,delete sf.animationstart.animation),"TransitionEvent"in window||delete sf.transitionend.transition);function ll(u){if(hE[u])return hE[u];if(!sf[u])return u;var c=sf[u],g;for(g in c)if(c.hasOwnProperty(g)&&g in E4)return hE[u]=c[g];return u}var S4=ll("animationend"),A4=ll("animationiteration"),w4=ll("animationstart"),SQ=ll("transitionrun"),AQ=ll("transitionstart"),wQ=ll("transitioncancel"),_4=ll("transitionend"),C4=new Map,gE="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gE.push("scrollEnd");function sa(u,c){C4.set(u,c),sl(c,[u])}var $4=new WeakMap;function Fr(u,c){if(typeof u=="object"&&u!==null){var g=$4.get(u);return g!==void 0?g:(c={value:u,source:c,stack:q6(c)},$4.set(u,c),c)}return{value:u,source:c,stack:q6(c)}}var Or=[],of=0,pE=0;function _m(){for(var u=of,c=pE=of=0;c<u;){var g=Or[c];Or[c++]=null;var m=Or[c];Or[c++]=null;var x=Or[c];Or[c++]=null;var A=Or[c];if(Or[c++]=null,m!==null&&x!==null){var D=m.pending;D===null?x.next=x:(x.next=D.next,D.next=x),m.pending=x}A!==0&&D4(g,x,A)}}function Cm(u,c,g,m){Or[of++]=u,Or[of++]=c,Or[of++]=g,Or[of++]=m,pE|=m,u.lanes|=m,u=u.alternate,u!==null&&(u.lanes|=m)}function mE(u,c,g,m){return Cm(u,c,g,m),$m(u)}function uf(u,c){return Cm(u,null,null,c),$m(u)}function D4(u,c,g){u.lanes|=g;var m=u.alternate;m!==null&&(m.lanes|=g);for(var x=!1,A=u.return;A!==null;)A.childLanes|=g,m=A.alternate,m!==null&&(m.childLanes|=g),A.tag===22&&(u=A.stateNode,u===null||u._visibility&1||(x=!0)),u=A,A=A.return;return u.tag===3?(A=u.stateNode,x&&c!==null&&(x=31-ur(g),u=A.hiddenUpdates,m=u[x],m===null?u[x]=[c]:m.push(c),c.lane=g|536870912),A):null}function $m(u){if(50<i0)throw i0=0,SS=null,Error(i(185));for(var c=u.return;c!==null;)u=c,c=u.return;return u.tag===3?u.stateNode:null}var lf={};function _Q(u,c,g,m){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(u,c,g,m){return new _Q(u,c,g,m)}function yE(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Os(u,c){var g=u.alternate;return g===null?(g=cr(u.tag,c,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=c,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&65011712,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,c=u.dependencies,g.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g.refCleanup=u.refCleanup,g}function T4(u,c){u.flags&=65011714;var g=u.alternate;return g===null?(u.childLanes=0,u.lanes=c,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=g.childLanes,u.lanes=g.lanes,u.child=g.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=g.memoizedProps,u.memoizedState=g.memoizedState,u.updateQueue=g.updateQueue,u.type=g.type,c=g.dependencies,u.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),u}function Dm(u,c,g,m,x,A){var D=0;if(m=u,typeof u=="function")yE(u)&&(D=1);else if(typeof u=="string")D=$Z(u,g,ye.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case R:return u=cr(31,g,c,x),u.elementType=R,u.lanes=A,u;case v:return cl(g.children,x,A,c);case b:D=8,x|=24;break;case E:return u=cr(12,g,c,x|2),u.elementType=E,u.lanes=A,u;case $:return u=cr(13,g,c,x),u.elementType=$,u.lanes=A,u;case M:return u=cr(19,g,c,x),u.elementType=M,u.lanes=A,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case S:case _:D=10;break e;case w:D=9;break e;case C:D=11;break e;case T:D=14;break e;case F:D=16,m=null;break e}D=29,g=Error(i(130,u===null?"null":typeof u,"")),m=null}return c=cr(D,g,c,x),c.elementType=u,c.type=m,c.lanes=A,c}function cl(u,c,g,m){return u=cr(7,u,m,c),u.lanes=g,u}function vE(u,c,g){return u=cr(6,u,null,c),u.lanes=g,u}function bE(u,c,g){return c=cr(4,u.children!==null?u.children:[],u.key,c),c.lanes=g,c.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},c}var cf=[],ff=0,Tm=null,Mm=0,Rr=[],zr=0,fl=null,Rs=1,zs="";function dl(u,c){cf[ff++]=Mm,cf[ff++]=Tm,Tm=u,Mm=c}function M4(u,c,g){Rr[zr++]=Rs,Rr[zr++]=zs,Rr[zr++]=fl,fl=u;var m=Rs;u=zs;var x=32-ur(m)-1;m&=~(1<<x),g+=1;var A=32-ur(c)+x;if(30<A){var D=x-x%5;A=(m&(1<<D)-1).toString(32),m>>=D,x-=D,Rs=1<<32-ur(c)+x|g<<x|m,zs=A+u}else Rs=1<<A|g<<x|m,zs=u}function xE(u){u.return!==null&&(dl(u,1),M4(u,1,0))}function EE(u){for(;u===Tm;)Tm=cf[--ff],cf[ff]=null,Mm=cf[--ff],cf[ff]=null;for(;u===fl;)fl=Rr[--zr],Rr[zr]=null,zs=Rr[--zr],Rr[zr]=null,Rs=Rr[--zr],Rr[zr]=null}var xi=null,Qt=null,vt=!1,hl=null,Ia=!1,SE=Error(i(519));function gl(u){var c=Error(i(418,""));throw Rh(Fr(c,u)),SE}function k4(u){var c=u.stateNode,g=u.type,m=u.memoizedProps;switch(c[ni]=u,c[Ui]=m,g){case"dialog":nt("cancel",c),nt("close",c);break;case"iframe":case"object":case"embed":nt("load",c);break;case"video":case"audio":for(g=0;g<a0.length;g++)nt(a0[g],c);break;case"source":nt("error",c);break;case"img":case"image":case"link":nt("error",c),nt("load",c);break;case"details":nt("toggle",c);break;case"input":nt("invalid",c),Y6(c,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),mm(c);break;case"select":nt("invalid",c);break;case"textarea":nt("invalid",c),X6(c,m.value,m.defaultValue,m.children),mm(c)}g=m.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||c.textContent===""+g||m.suppressHydrationWarning===!0||XN(c.textContent,g)?(m.popover!=null&&(nt("beforetoggle",c),nt("toggle",c)),m.onScroll!=null&&nt("scroll",c),m.onScrollEnd!=null&&nt("scrollend",c),m.onClick!=null&&(c.onclick=c1),c=!0):c=!1,c||gl(u)}function N4(u){for(xi=u.return;xi;)switch(xi.tag){case 5:case 13:Ia=!1;return;case 27:case 3:Ia=!0;return;default:xi=xi.return}}function Fh(u){if(u!==xi)return!1;if(!vt)return N4(u),vt=!0,!1;var c=u.tag,g;if((g=c!==3&&c!==27)&&((g=c===5)&&(g=u.type,g=!(g!=="form"&&g!=="button")||LS(u.type,u.memoizedProps)),g=!g),g&&Qt&&gl(u),N4(u),c===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(i(317));e:{for(u=u.nextSibling,c=0;u;){if(u.nodeType===8)if(g=u.data,g==="/$"){if(c===0){Qt=ua(u.nextSibling);break e}c--}else g!=="$"&&g!=="$!"&&g!=="$?"||c++;u=u.nextSibling}Qt=null}}else c===27?(c=Qt,Zo(u.type)?(u=IS,IS=null,Qt=u):Qt=c):Qt=xi?ua(u.stateNode.nextSibling):null;return!0}function Oh(){Qt=xi=null,vt=!1}function F4(){var u=hl;return u!==null&&(Hi===null?Hi=u:Hi.push.apply(Hi,u),hl=null),u}function Rh(u){hl===null?hl=[u]:hl.push(u)}var AE=V(null),pl=null,Bs=null;function zo(u,c,g){ne(AE,c._currentValue),c._currentValue=g}function Ls(u){u._currentValue=AE.current,X(AE)}function wE(u,c,g){for(;u!==null;){var m=u.alternate;if((u.childLanes&c)!==c?(u.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),u===g)break;u=u.return}}function _E(u,c,g,m){var x=u.child;for(x!==null&&(x.return=u);x!==null;){var A=x.dependencies;if(A!==null){var D=x.child;A=A.firstContext;e:for(;A!==null;){var N=A;A=x;for(var P=0;P<c.length;P++)if(N.context===c[P]){A.lanes|=g,N=A.alternate,N!==null&&(N.lanes|=g),wE(A.return,g,u),m||(D=null);break e}A=N.next}}else if(x.tag===18){if(D=x.return,D===null)throw Error(i(341));D.lanes|=g,A=D.alternate,A!==null&&(A.lanes|=g),wE(D,g,u),D=null}else D=x.child;if(D!==null)D.return=x;else for(D=x;D!==null;){if(D===u){D=null;break}if(x=D.sibling,x!==null){x.return=D.return,D=x;break}D=D.return}x=D}}function zh(u,c,g,m){u=null;for(var x=c,A=!1;x!==null;){if(!A){if((x.flags&524288)!==0)A=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var D=x.alternate;if(D===null)throw Error(i(387));if(D=D.memoizedProps,D!==null){var N=x.type;lr(x.pendingProps.value,D.value)||(u!==null?u.push(N):u=[N])}}else if(x===Ye.current){if(D=x.alternate,D===null)throw Error(i(387));D.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(u!==null?u.push(f0):u=[f0])}x=x.return}u!==null&&_E(c,u,g,m),c.flags|=262144}function km(u){for(u=u.firstContext;u!==null;){if(!lr(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function ml(u){pl=u,Bs=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function ii(u){return O4(pl,u)}function Nm(u,c){return pl===null&&ml(u),O4(u,c)}function O4(u,c){var g=c._currentValue;if(c={context:c,memoizedValue:g,next:null},Bs===null){if(u===null)throw Error(i(308));Bs=c,u.dependencies={lanes:0,firstContext:c},u.flags|=524288}else Bs=Bs.next=c;return g}var CQ=typeof AbortController<"u"?AbortController:function(){var u=[],c=this.signal={aborted:!1,addEventListener:function(g,m){u.push(m)}};this.abort=function(){c.aborted=!0,u.forEach(function(g){return g()})}},$Q=e.unstable_scheduleCallback,DQ=e.unstable_NormalPriority,vn={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function CE(){return{controller:new CQ,data:new Map,refCount:0}}function Bh(u){u.refCount--,u.refCount===0&&$Q(DQ,function(){u.controller.abort()})}var Lh=null,$E=0,df=0,hf=null;function TQ(u,c){if(Lh===null){var g=Lh=[];$E=0,df=TS(),hf={status:"pending",value:void 0,then:function(m){g.push(m)}}}return $E++,c.then(R4,R4),c}function R4(){if(--$E===0&&Lh!==null){hf!==null&&(hf.status="fulfilled");var u=Lh;Lh=null,df=0,hf=null;for(var c=0;c<u.length;c++)(0,u[c])()}}function MQ(u,c){var g=[],m={status:"pending",value:null,reason:null,then:function(x){g.push(x)}};return u.then(function(){m.status="fulfilled",m.value=c;for(var x=0;x<g.length;x++)(0,g[x])(c)},function(x){for(m.status="rejected",m.reason=x,x=0;x<g.length;x++)(0,g[x])(void 0)}),m}var z4=O.S;O.S=function(u,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&TQ(u,c),z4!==null&&z4(u,c)};var yl=V(null);function DE(){var u=yl.current;return u!==null?u:zt.pooledCache}function Fm(u,c){c===null?ne(yl,yl.current):ne(yl,c.pool)}function B4(){var u=DE();return u===null?null:{parent:vn._currentValue,pool:u}}var jh=Error(i(460)),L4=Error(i(474)),Om=Error(i(542)),TE={then:function(){}};function j4(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Rm(){}function U4(u,c,g){switch(g=u[g],g===void 0?u.push(c):g!==c&&(c.then(Rm,Rm),c=g),c.status){case"fulfilled":return c.value;case"rejected":throw u=c.reason,I4(u),u;default:if(typeof c.status=="string")c.then(Rm,Rm);else{if(u=zt,u!==null&&100<u.shellSuspendCounter)throw Error(i(482));u=c,u.status="pending",u.then(function(m){if(c.status==="pending"){var x=c;x.status="fulfilled",x.value=m}},function(m){if(c.status==="pending"){var x=c;x.status="rejected",x.reason=m}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw u=c.reason,I4(u),u}throw Uh=c,jh}}var Uh=null;function P4(){if(Uh===null)throw Error(i(459));var u=Uh;return Uh=null,u}function I4(u){if(u===jh||u===Om)throw Error(i(483))}var Bo=!1;function ME(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kE(u,c){u=u.updateQueue,c.updateQueue===u&&(c.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Lo(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function jo(u,c,g){var m=u.updateQueue;if(m===null)return null;if(m=m.shared,(St&2)!==0){var x=m.pending;return x===null?c.next=c:(c.next=x.next,x.next=c),m.pending=c,c=$m(u),D4(u,null,g),c}return Cm(u,m,c,g),$m(u)}function Ph(u,c,g){if(c=c.updateQueue,c!==null&&(c=c.shared,(g&4194048)!==0)){var m=c.lanes;m&=u.pendingLanes,g|=m,c.lanes=g,R6(u,g)}}function NE(u,c){var g=u.updateQueue,m=u.alternate;if(m!==null&&(m=m.updateQueue,g===m)){var x=null,A=null;if(g=g.firstBaseUpdate,g!==null){do{var D={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};A===null?x=A=D:A=A.next=D,g=g.next}while(g!==null);A===null?x=A=c:A=A.next=c}else x=A=c;g={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:A,shared:m.shared,callbacks:m.callbacks},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=c:u.next=c,g.lastBaseUpdate=c}var FE=!1;function Ih(){if(FE){var u=hf;if(u!==null)throw u}}function qh(u,c,g,m){FE=!1;var x=u.updateQueue;Bo=!1;var A=x.firstBaseUpdate,D=x.lastBaseUpdate,N=x.shared.pending;if(N!==null){x.shared.pending=null;var P=N,Z=P.next;P.next=null,D===null?A=Z:D.next=Z,D=P;var se=u.alternate;se!==null&&(se=se.updateQueue,N=se.lastBaseUpdate,N!==D&&(N===null?se.firstBaseUpdate=Z:N.next=Z,se.lastBaseUpdate=P))}if(A!==null){var ue=x.baseState;D=0,se=Z=P=null,N=A;do{var J=N.lane&-536870913,ee=J!==N.lane;if(ee?(ot&J)===J:(m&J)===J){J!==0&&J===df&&(FE=!0),se!==null&&(se=se.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var je=u,Be=N;J=c;var Mt=g;switch(Be.tag){case 1:if(je=Be.payload,typeof je=="function"){ue=je.call(Mt,ue,J);break e}ue=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Be.payload,J=typeof je=="function"?je.call(Mt,ue,J):je,J==null)break e;ue=d({},ue,J);break e;case 2:Bo=!0}}J=N.callback,J!==null&&(u.flags|=64,ee&&(u.flags|=8192),ee=x.callbacks,ee===null?x.callbacks=[J]:ee.push(J))}else ee={lane:J,tag:N.tag,payload:N.payload,callback:N.callback,next:null},se===null?(Z=se=ee,P=ue):se=se.next=ee,D|=J;if(N=N.next,N===null){if(N=x.shared.pending,N===null)break;ee=N,N=ee.next,ee.next=null,x.lastBaseUpdate=ee,x.shared.pending=null}}while(!0);se===null&&(P=ue),x.baseState=P,x.firstBaseUpdate=Z,x.lastBaseUpdate=se,A===null&&(x.shared.lanes=0),Vo|=D,u.lanes=D,u.memoizedState=ue}}function q4(u,c){if(typeof u!="function")throw Error(i(191,u));u.call(c)}function H4(u,c){var g=u.callbacks;if(g!==null)for(u.callbacks=null,u=0;u<g.length;u++)q4(g[u],c)}var gf=V(null),zm=V(0);function G4(u,c){u=Gs,ne(zm,u),ne(gf,c),Gs=u|c.baseLanes}function OE(){ne(zm,Gs),ne(gf,gf.current)}function RE(){Gs=zm.current,X(gf),X(zm)}var Uo=0,Qe=null,Dt=null,hn=null,Bm=!1,pf=!1,vl=!1,Lm=0,Hh=0,mf=null,kQ=0;function rn(){throw Error(i(321))}function zE(u,c){if(c===null)return!1;for(var g=0;g<c.length&&g<u.length;g++)if(!lr(u[g],c[g]))return!1;return!0}function BE(u,c,g,m,x,A){return Uo=A,Qe=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,O.H=u===null||u.memoizedState===null?D5:T5,vl=!1,A=g(m,x),vl=!1,pf&&(A=V4(c,g,m,x)),Y4(u),A}function Y4(u){O.H=Hm;var c=Dt!==null&&Dt.next!==null;if(Uo=0,hn=Dt=Qe=null,Bm=!1,Hh=0,mf=null,c)throw Error(i(300));u===null||Tn||(u=u.dependencies,u!==null&&km(u)&&(Tn=!0))}function V4(u,c,g,m){Qe=u;var x=0;do{if(pf&&(mf=null),Hh=0,pf=!1,25<=x)throw Error(i(301));if(x+=1,hn=Dt=null,u.updateQueue!=null){var A=u.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}O.H=LQ,A=c(g,m)}while(pf);return A}function NQ(){var u=O.H,c=u.useState()[0];return c=typeof c.then=="function"?Gh(c):c,u=u.useState()[0],(Dt!==null?Dt.memoizedState:null)!==u&&(Qe.flags|=1024),c}function LE(){var u=Lm!==0;return Lm=0,u}function jE(u,c,g){c.updateQueue=u.updateQueue,c.flags&=-2053,u.lanes&=~g}function UE(u){if(Bm){for(u=u.memoizedState;u!==null;){var c=u.queue;c!==null&&(c.pending=null),u=u.next}Bm=!1}Uo=0,hn=Dt=Qe=null,pf=!1,Hh=Lm=0,mf=null}function Ii(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Qe.memoizedState=hn=u:hn=hn.next=u,hn}function gn(){if(Dt===null){var u=Qe.alternate;u=u!==null?u.memoizedState:null}else u=Dt.next;var c=hn===null?Qe.memoizedState:hn.next;if(c!==null)hn=c,Dt=u;else{if(u===null)throw Qe.alternate===null?Error(i(467)):Error(i(310));Dt=u,u={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},hn===null?Qe.memoizedState=hn=u:hn=hn.next=u}return hn}function PE(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gh(u){var c=Hh;return Hh+=1,mf===null&&(mf=[]),u=U4(mf,u,c),c=Qe,(hn===null?c.memoizedState:hn.next)===null&&(c=c.alternate,O.H=c===null||c.memoizedState===null?D5:T5),u}function jm(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Gh(u);if(u.$$typeof===_)return ii(u)}throw Error(i(438,String(u)))}function IE(u){var c=null,g=Qe.updateQueue;if(g!==null&&(c=g.memoCache),c==null){var m=Qe.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(c={data:m.data.map(function(x){return x.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),g===null&&(g=PE(),Qe.updateQueue=g),g.memoCache=c,g=c.data[c.index],g===void 0)for(g=c.data[c.index]=Array(u),m=0;m<u;m++)g[m]=B;return c.index++,g}function js(u,c){return typeof c=="function"?c(u):c}function Um(u){var c=gn();return qE(c,Dt,u)}function qE(u,c,g){var m=u.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=g;var x=u.baseQueue,A=m.pending;if(A!==null){if(x!==null){var D=x.next;x.next=A.next,A.next=D}c.baseQueue=x=A,m.pending=null}if(A=u.baseState,x===null)u.memoizedState=A;else{c=x.next;var N=D=null,P=null,Z=c,se=!1;do{var ue=Z.lane&-536870913;if(ue!==Z.lane?(ot&ue)===ue:(Uo&ue)===ue){var J=Z.revertLane;if(J===0)P!==null&&(P=P.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),ue===df&&(se=!0);else if((Uo&J)===J){Z=Z.next,J===df&&(se=!0);continue}else ue={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},P===null?(N=P=ue,D=A):P=P.next=ue,Qe.lanes|=J,Vo|=J;ue=Z.action,vl&&g(A,ue),A=Z.hasEagerState?Z.eagerState:g(A,ue)}else J={lane:ue,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},P===null?(N=P=J,D=A):P=P.next=J,Qe.lanes|=ue,Vo|=ue;Z=Z.next}while(Z!==null&&Z!==c);if(P===null?D=A:P.next=N,!lr(A,u.memoizedState)&&(Tn=!0,se&&(g=hf,g!==null)))throw g;u.memoizedState=A,u.baseState=D,u.baseQueue=P,m.lastRenderedState=A}return x===null&&(m.lanes=0),[u.memoizedState,m.dispatch]}function HE(u){var c=gn(),g=c.queue;if(g===null)throw Error(i(311));g.lastRenderedReducer=u;var m=g.dispatch,x=g.pending,A=c.memoizedState;if(x!==null){g.pending=null;var D=x=x.next;do A=u(A,D.action),D=D.next;while(D!==x);lr(A,c.memoizedState)||(Tn=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),g.lastRenderedState=A}return[A,m]}function X4(u,c,g){var m=Qe,x=gn(),A=vt;if(A){if(g===void 0)throw Error(i(407));g=g()}else g=c();var D=!lr((Dt||x).memoizedState,g);D&&(x.memoizedState=g,Tn=!0),x=x.queue;var N=Z4.bind(null,m,x,u);if(Yh(2048,8,N,[u]),x.getSnapshot!==c||D||hn!==null&&hn.memoizedState.tag&1){if(m.flags|=2048,yf(9,Pm(),Q4.bind(null,m,x,g,c),null),zt===null)throw Error(i(349));A||(Uo&124)!==0||W4(m,c,g)}return g}function W4(u,c,g){u.flags|=16384,u={getSnapshot:c,value:g},c=Qe.updateQueue,c===null?(c=PE(),Qe.updateQueue=c,c.stores=[u]):(g=c.stores,g===null?c.stores=[u]:g.push(u))}function Q4(u,c,g,m){c.value=g,c.getSnapshot=m,K4(c)&&J4(u)}function Z4(u,c,g){return g(function(){K4(c)&&J4(u)})}function K4(u){var c=u.getSnapshot;u=u.value;try{var g=c();return!lr(u,g)}catch{return!0}}function J4(u){var c=uf(u,2);c!==null&&pr(c,u,2)}function GE(u){var c=Ii();if(typeof u=="function"){var g=u;if(u=g(),vl){Fo(!0);try{g()}finally{Fo(!1)}}}return c.memoizedState=c.baseState=u,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:u},c}function e5(u,c,g,m){return u.baseState=g,qE(u,Dt,typeof m=="function"?m:js)}function FQ(u,c,g,m,x){if(qm(u))throw Error(i(485));if(u=c.action,u!==null){var A={payload:x,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){A.listeners.push(D)}};O.T!==null?g(!0):A.isTransition=!1,m(A),g=c.pending,g===null?(A.next=c.pending=A,t5(c,A)):(A.next=g.next,c.pending=g.next=A)}}function t5(u,c){var g=c.action,m=c.payload,x=u.state;if(c.isTransition){var A=O.T,D={};O.T=D;try{var N=g(x,m),P=O.S;P!==null&&P(D,N),n5(u,c,N)}catch(Z){YE(u,c,Z)}finally{O.T=A}}else try{A=g(x,m),n5(u,c,A)}catch(Z){YE(u,c,Z)}}function n5(u,c,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(m){i5(u,c,m)},function(m){return YE(u,c,m)}):i5(u,c,g)}function i5(u,c,g){c.status="fulfilled",c.value=g,r5(c),u.state=g,c=u.pending,c!==null&&(g=c.next,g===c?u.pending=null:(g=g.next,c.next=g,t5(u,g)))}function YE(u,c,g){var m=u.pending;if(u.pending=null,m!==null){m=m.next;do c.status="rejected",c.reason=g,r5(c),c=c.next;while(c!==m)}u.action=null}function r5(u){u=u.listeners;for(var c=0;c<u.length;c++)(0,u[c])()}function a5(u,c){return c}function s5(u,c){if(vt){var g=zt.formState;if(g!==null){e:{var m=Qe;if(vt){if(Qt){t:{for(var x=Qt,A=Ia;x.nodeType!==8;){if(!A){x=null;break t}if(x=ua(x.nextSibling),x===null){x=null;break t}}A=x.data,x=A==="F!"||A==="F"?x:null}if(x){Qt=ua(x.nextSibling),m=x.data==="F!";break e}}gl(m)}m=!1}m&&(c=g[0])}}return g=Ii(),g.memoizedState=g.baseState=c,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a5,lastRenderedState:c},g.queue=m,g=_5.bind(null,Qe,m),m.dispatch=g,m=GE(!1),A=ZE.bind(null,Qe,!1,m.queue),m=Ii(),x={state:c,dispatch:null,action:u,pending:null},m.queue=x,g=FQ.bind(null,Qe,x,A,g),x.dispatch=g,m.memoizedState=u,[c,g,!1]}function o5(u){var c=gn();return u5(c,Dt,u)}function u5(u,c,g){if(c=qE(u,c,a5)[0],u=Um(js)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var m=Gh(c)}catch(D){throw D===jh?Om:D}else m=c;c=gn();var x=c.queue,A=x.dispatch;return g!==c.memoizedState&&(Qe.flags|=2048,yf(9,Pm(),OQ.bind(null,x,g),null)),[m,A,u]}function OQ(u,c){u.action=c}function l5(u){var c=gn(),g=Dt;if(g!==null)return u5(c,g,u);gn(),c=c.memoizedState,g=gn();var m=g.queue.dispatch;return g.memoizedState=u,[c,m,!1]}function yf(u,c,g,m){return u={tag:u,create:g,deps:m,inst:c,next:null},c=Qe.updateQueue,c===null&&(c=PE(),Qe.updateQueue=c),g=c.lastEffect,g===null?c.lastEffect=u.next=u:(m=g.next,g.next=u,u.next=m,c.lastEffect=u),u}function Pm(){return{destroy:void 0,resource:void 0}}function c5(){return gn().memoizedState}function Im(u,c,g,m){var x=Ii();m=m===void 0?null:m,Qe.flags|=u,x.memoizedState=yf(1|c,Pm(),g,m)}function Yh(u,c,g,m){var x=gn();m=m===void 0?null:m;var A=x.memoizedState.inst;Dt!==null&&m!==null&&zE(m,Dt.memoizedState.deps)?x.memoizedState=yf(c,A,g,m):(Qe.flags|=u,x.memoizedState=yf(1|c,A,g,m))}function f5(u,c){Im(8390656,8,u,c)}function d5(u,c){Yh(2048,8,u,c)}function h5(u,c){return Yh(4,2,u,c)}function g5(u,c){return Yh(4,4,u,c)}function p5(u,c){if(typeof c=="function"){u=u();var g=c(u);return function(){typeof g=="function"?g():c(null)}}if(c!=null)return u=u(),c.current=u,function(){c.current=null}}function m5(u,c,g){g=g!=null?g.concat([u]):null,Yh(4,4,p5.bind(null,c,u),g)}function VE(){}function y5(u,c){var g=gn();c=c===void 0?null:c;var m=g.memoizedState;return c!==null&&zE(c,m[1])?m[0]:(g.memoizedState=[u,c],u)}function v5(u,c){var g=gn();c=c===void 0?null:c;var m=g.memoizedState;if(c!==null&&zE(c,m[1]))return m[0];if(m=u(),vl){Fo(!0);try{u()}finally{Fo(!1)}}return g.memoizedState=[m,c],m}function XE(u,c,g){return g===void 0||(Uo&1073741824)!==0?u.memoizedState=c:(u.memoizedState=g,u=EN(),Qe.lanes|=u,Vo|=u,g)}function b5(u,c,g,m){return lr(g,c)?g:gf.current!==null?(u=XE(u,g,m),lr(u,c)||(Tn=!0),u):(Uo&42)===0?(Tn=!0,u.memoizedState=g):(u=EN(),Qe.lanes|=u,Vo|=u,c)}function x5(u,c,g,m,x){var A=I.p;I.p=A!==0&&8>A?A:8;var D=O.T,N={};O.T=N,ZE(u,!1,c,g);try{var P=x(),Z=O.S;if(Z!==null&&Z(N,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var se=MQ(P,m);Vh(u,c,se,gr(u))}else Vh(u,c,m,gr(u))}catch(ue){Vh(u,c,{then:function(){},status:"rejected",reason:ue},gr())}finally{I.p=A,O.T=D}}function RQ(){}function WE(u,c,g,m){if(u.tag!==5)throw Error(i(476));var x=E5(u).queue;x5(u,x,c,W,g===null?RQ:function(){return S5(u),g(m)})}function E5(u){var c=u.memoizedState;if(c!==null)return c;c={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:W},next:null};var g={};return c.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:g},next:null},u.memoizedState=c,u=u.alternate,u!==null&&(u.memoizedState=c),c}function S5(u){var c=E5(u).next.queue;Vh(u,c,{},gr())}function QE(){return ii(f0)}function A5(){return gn().memoizedState}function w5(){return gn().memoizedState}function zQ(u){for(var c=u.return;c!==null;){switch(c.tag){case 24:case 3:var g=gr();u=Lo(g);var m=jo(c,u,g);m!==null&&(pr(m,c,g),Ph(m,c,g)),c={cache:CE()},u.payload=c;return}c=c.return}}function BQ(u,c,g){var m=gr();g={lane:m,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},qm(u)?C5(c,g):(g=mE(u,c,g,m),g!==null&&(pr(g,u,m),$5(g,c,m)))}function _5(u,c,g){var m=gr();Vh(u,c,g,m)}function Vh(u,c,g,m){var x={lane:m,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(qm(u))C5(c,x);else{var A=u.alternate;if(u.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var D=c.lastRenderedState,N=A(D,g);if(x.hasEagerState=!0,x.eagerState=N,lr(N,D))return Cm(u,c,x,0),zt===null&&_m(),!1}catch{}finally{}if(g=mE(u,c,x,m),g!==null)return pr(g,u,m),$5(g,c,m),!0}return!1}function ZE(u,c,g,m){if(m={lane:2,revertLane:TS(),action:m,hasEagerState:!1,eagerState:null,next:null},qm(u)){if(c)throw Error(i(479))}else c=mE(u,g,m,2),c!==null&&pr(c,u,2)}function qm(u){var c=u.alternate;return u===Qe||c!==null&&c===Qe}function C5(u,c){pf=Bm=!0;var g=u.pending;g===null?c.next=c:(c.next=g.next,g.next=c),u.pending=c}function $5(u,c,g){if((g&4194048)!==0){var m=c.lanes;m&=u.pendingLanes,g|=m,c.lanes=g,R6(u,g)}}var Hm={readContext:ii,use:jm,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useLayoutEffect:rn,useInsertionEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useSyncExternalStore:rn,useId:rn,useHostTransitionStatus:rn,useFormState:rn,useActionState:rn,useOptimistic:rn,useMemoCache:rn,useCacheRefresh:rn},D5={readContext:ii,use:jm,useCallback:function(u,c){return Ii().memoizedState=[u,c===void 0?null:c],u},useContext:ii,useEffect:f5,useImperativeHandle:function(u,c,g){g=g!=null?g.concat([u]):null,Im(4194308,4,p5.bind(null,c,u),g)},useLayoutEffect:function(u,c){return Im(4194308,4,u,c)},useInsertionEffect:function(u,c){Im(4,2,u,c)},useMemo:function(u,c){var g=Ii();c=c===void 0?null:c;var m=u();if(vl){Fo(!0);try{u()}finally{Fo(!1)}}return g.memoizedState=[m,c],m},useReducer:function(u,c,g){var m=Ii();if(g!==void 0){var x=g(c);if(vl){Fo(!0);try{g(c)}finally{Fo(!1)}}}else x=c;return m.memoizedState=m.baseState=x,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:x},m.queue=u,u=u.dispatch=BQ.bind(null,Qe,u),[m.memoizedState,u]},useRef:function(u){var c=Ii();return u={current:u},c.memoizedState=u},useState:function(u){u=GE(u);var c=u.queue,g=_5.bind(null,Qe,c);return c.dispatch=g,[u.memoizedState,g]},useDebugValue:VE,useDeferredValue:function(u,c){var g=Ii();return XE(g,u,c)},useTransition:function(){var u=GE(!1);return u=x5.bind(null,Qe,u.queue,!0,!1),Ii().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,c,g){var m=Qe,x=Ii();if(vt){if(g===void 0)throw Error(i(407));g=g()}else{if(g=c(),zt===null)throw Error(i(349));(ot&124)!==0||W4(m,c,g)}x.memoizedState=g;var A={value:g,getSnapshot:c};return x.queue=A,f5(Z4.bind(null,m,A,u),[u]),m.flags|=2048,yf(9,Pm(),Q4.bind(null,m,A,g,c),null),g},useId:function(){var u=Ii(),c=zt.identifierPrefix;if(vt){var g=zs,m=Rs;g=(m&~(1<<32-ur(m)-1)).toString(32)+g,c=""+c+"R"+g,g=Lm++,0<g&&(c+="H"+g.toString(32)),c+=""}else g=kQ++,c=""+c+"r"+g.toString(32)+"";return u.memoizedState=c},useHostTransitionStatus:QE,useFormState:s5,useActionState:s5,useOptimistic:function(u){var c=Ii();c.memoizedState=c.baseState=u;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=g,c=ZE.bind(null,Qe,!0,g),g.dispatch=c,[u,c]},useMemoCache:IE,useCacheRefresh:function(){return Ii().memoizedState=zQ.bind(null,Qe)}},T5={readContext:ii,use:jm,useCallback:y5,useContext:ii,useEffect:d5,useImperativeHandle:m5,useInsertionEffect:h5,useLayoutEffect:g5,useMemo:v5,useReducer:Um,useRef:c5,useState:function(){return Um(js)},useDebugValue:VE,useDeferredValue:function(u,c){var g=gn();return b5(g,Dt.memoizedState,u,c)},useTransition:function(){var u=Um(js)[0],c=gn().memoizedState;return[typeof u=="boolean"?u:Gh(u),c]},useSyncExternalStore:X4,useId:A5,useHostTransitionStatus:QE,useFormState:o5,useActionState:o5,useOptimistic:function(u,c){var g=gn();return e5(g,Dt,u,c)},useMemoCache:IE,useCacheRefresh:w5},LQ={readContext:ii,use:jm,useCallback:y5,useContext:ii,useEffect:d5,useImperativeHandle:m5,useInsertionEffect:h5,useLayoutEffect:g5,useMemo:v5,useReducer:HE,useRef:c5,useState:function(){return HE(js)},useDebugValue:VE,useDeferredValue:function(u,c){var g=gn();return Dt===null?XE(g,u,c):b5(g,Dt.memoizedState,u,c)},useTransition:function(){var u=HE(js)[0],c=gn().memoizedState;return[typeof u=="boolean"?u:Gh(u),c]},useSyncExternalStore:X4,useId:A5,useHostTransitionStatus:QE,useFormState:l5,useActionState:l5,useOptimistic:function(u,c){var g=gn();return Dt!==null?e5(g,Dt,u,c):(g.baseState=u,[u,g.queue.dispatch])},useMemoCache:IE,useCacheRefresh:w5},vf=null,Xh=0;function Gm(u){var c=Xh;return Xh+=1,vf===null&&(vf=[]),U4(vf,u,c)}function Wh(u,c){c=c.props.ref,u.ref=c!==void 0?c:null}function Ym(u,c){throw c.$$typeof===h?Error(i(525)):(u=Object.prototype.toString.call(c),Error(i(31,u==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":u)))}function M5(u){var c=u._init;return c(u._payload)}function k5(u){function c(G,q){if(u){var Q=G.deletions;Q===null?(G.deletions=[q],G.flags|=16):Q.push(q)}}function g(G,q){if(!u)return null;for(;q!==null;)c(G,q),q=q.sibling;return null}function m(G){for(var q=new Map;G!==null;)G.key!==null?q.set(G.key,G):q.set(G.index,G),G=G.sibling;return q}function x(G,q){return G=Os(G,q),G.index=0,G.sibling=null,G}function A(G,q,Q){return G.index=Q,u?(Q=G.alternate,Q!==null?(Q=Q.index,Q<q?(G.flags|=67108866,q):Q):(G.flags|=67108866,q)):(G.flags|=1048576,q)}function D(G){return u&&G.alternate===null&&(G.flags|=67108866),G}function N(G,q,Q,oe){return q===null||q.tag!==6?(q=vE(Q,G.mode,oe),q.return=G,q):(q=x(q,Q),q.return=G,q)}function P(G,q,Q,oe){var Ee=Q.type;return Ee===v?se(G,q,Q.props.children,oe,Q.key):q!==null&&(q.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===F&&M5(Ee)===q.type)?(q=x(q,Q.props),Wh(q,Q),q.return=G,q):(q=Dm(Q.type,Q.key,Q.props,null,G.mode,oe),Wh(q,Q),q.return=G,q)}function Z(G,q,Q,oe){return q===null||q.tag!==4||q.stateNode.containerInfo!==Q.containerInfo||q.stateNode.implementation!==Q.implementation?(q=bE(Q,G.mode,oe),q.return=G,q):(q=x(q,Q.children||[]),q.return=G,q)}function se(G,q,Q,oe,Ee){return q===null||q.tag!==7?(q=cl(Q,G.mode,oe,Ee),q.return=G,q):(q=x(q,Q),q.return=G,q)}function ue(G,q,Q){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=vE(""+q,G.mode,Q),q.return=G,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case p:return Q=Dm(q.type,q.key,q.props,null,G.mode,Q),Wh(Q,q),Q.return=G,Q;case y:return q=bE(q,G.mode,Q),q.return=G,q;case F:var oe=q._init;return q=oe(q._payload),ue(G,q,Q)}if(z(q)||Y(q))return q=cl(q,G.mode,Q,null),q.return=G,q;if(typeof q.then=="function")return ue(G,Gm(q),Q);if(q.$$typeof===_)return ue(G,Nm(G,q),Q);Ym(G,q)}return null}function J(G,q,Q,oe){var Ee=q!==null?q.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Ee!==null?null:N(G,q,""+Q,oe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case p:return Q.key===Ee?P(G,q,Q,oe):null;case y:return Q.key===Ee?Z(G,q,Q,oe):null;case F:return Ee=Q._init,Q=Ee(Q._payload),J(G,q,Q,oe)}if(z(Q)||Y(Q))return Ee!==null?null:se(G,q,Q,oe,null);if(typeof Q.then=="function")return J(G,q,Gm(Q),oe);if(Q.$$typeof===_)return J(G,q,Nm(G,Q),oe);Ym(G,Q)}return null}function ee(G,q,Q,oe,Ee){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return G=G.get(Q)||null,N(q,G,""+oe,Ee);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case p:return G=G.get(oe.key===null?Q:oe.key)||null,P(q,G,oe,Ee);case y:return G=G.get(oe.key===null?Q:oe.key)||null,Z(q,G,oe,Ee);case F:var Ke=oe._init;return oe=Ke(oe._payload),ee(G,q,Q,oe,Ee)}if(z(oe)||Y(oe))return G=G.get(Q)||null,se(q,G,oe,Ee,null);if(typeof oe.then=="function")return ee(G,q,Q,Gm(oe),Ee);if(oe.$$typeof===_)return ee(G,q,Q,Nm(q,oe),Ee);Ym(q,oe)}return null}function je(G,q,Q,oe){for(var Ee=null,Ke=null,Te=q,Le=q=0,kn=null;Te!==null&&Le<Q.length;Le++){Te.index>Le?(kn=Te,Te=null):kn=Te.sibling;var ht=J(G,Te,Q[Le],oe);if(ht===null){Te===null&&(Te=kn);break}u&&Te&&ht.alternate===null&&c(G,Te),q=A(ht,q,Le),Ke===null?Ee=ht:Ke.sibling=ht,Ke=ht,Te=kn}if(Le===Q.length)return g(G,Te),vt&&dl(G,Le),Ee;if(Te===null){for(;Le<Q.length;Le++)Te=ue(G,Q[Le],oe),Te!==null&&(q=A(Te,q,Le),Ke===null?Ee=Te:Ke.sibling=Te,Ke=Te);return vt&&dl(G,Le),Ee}for(Te=m(Te);Le<Q.length;Le++)kn=ee(Te,G,Le,Q[Le],oe),kn!==null&&(u&&kn.alternate!==null&&Te.delete(kn.key===null?Le:kn.key),q=A(kn,q,Le),Ke===null?Ee=kn:Ke.sibling=kn,Ke=kn);return u&&Te.forEach(function(nu){return c(G,nu)}),vt&&dl(G,Le),Ee}function Be(G,q,Q,oe){if(Q==null)throw Error(i(151));for(var Ee=null,Ke=null,Te=q,Le=q=0,kn=null,ht=Q.next();Te!==null&&!ht.done;Le++,ht=Q.next()){Te.index>Le?(kn=Te,Te=null):kn=Te.sibling;var nu=J(G,Te,ht.value,oe);if(nu===null){Te===null&&(Te=kn);break}u&&Te&&nu.alternate===null&&c(G,Te),q=A(nu,q,Le),Ke===null?Ee=nu:Ke.sibling=nu,Ke=nu,Te=kn}if(ht.done)return g(G,Te),vt&&dl(G,Le),Ee;if(Te===null){for(;!ht.done;Le++,ht=Q.next())ht=ue(G,ht.value,oe),ht!==null&&(q=A(ht,q,Le),Ke===null?Ee=ht:Ke.sibling=ht,Ke=ht);return vt&&dl(G,Le),Ee}for(Te=m(Te);!ht.done;Le++,ht=Q.next())ht=ee(Te,G,Le,ht.value,oe),ht!==null&&(u&&ht.alternate!==null&&Te.delete(ht.key===null?Le:ht.key),q=A(ht,q,Le),Ke===null?Ee=ht:Ke.sibling=ht,Ke=ht);return u&&Te.forEach(function(jZ){return c(G,jZ)}),vt&&dl(G,Le),Ee}function Mt(G,q,Q,oe){if(typeof Q=="object"&&Q!==null&&Q.type===v&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case p:e:{for(var Ee=Q.key;q!==null;){if(q.key===Ee){if(Ee=Q.type,Ee===v){if(q.tag===7){g(G,q.sibling),oe=x(q,Q.props.children),oe.return=G,G=oe;break e}}else if(q.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===F&&M5(Ee)===q.type){g(G,q.sibling),oe=x(q,Q.props),Wh(oe,Q),oe.return=G,G=oe;break e}g(G,q);break}else c(G,q);q=q.sibling}Q.type===v?(oe=cl(Q.props.children,G.mode,oe,Q.key),oe.return=G,G=oe):(oe=Dm(Q.type,Q.key,Q.props,null,G.mode,oe),Wh(oe,Q),oe.return=G,G=oe)}return D(G);case y:e:{for(Ee=Q.key;q!==null;){if(q.key===Ee)if(q.tag===4&&q.stateNode.containerInfo===Q.containerInfo&&q.stateNode.implementation===Q.implementation){g(G,q.sibling),oe=x(q,Q.children||[]),oe.return=G,G=oe;break e}else{g(G,q);break}else c(G,q);q=q.sibling}oe=bE(Q,G.mode,oe),oe.return=G,G=oe}return D(G);case F:return Ee=Q._init,Q=Ee(Q._payload),Mt(G,q,Q,oe)}if(z(Q))return je(G,q,Q,oe);if(Y(Q)){if(Ee=Y(Q),typeof Ee!="function")throw Error(i(150));return Q=Ee.call(Q),Be(G,q,Q,oe)}if(typeof Q.then=="function")return Mt(G,q,Gm(Q),oe);if(Q.$$typeof===_)return Mt(G,q,Nm(G,Q),oe);Ym(G,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,q!==null&&q.tag===6?(g(G,q.sibling),oe=x(q,Q),oe.return=G,G=oe):(g(G,q),oe=vE(Q,G.mode,oe),oe.return=G,G=oe),D(G)):g(G,q)}return function(G,q,Q,oe){try{Xh=0;var Ee=Mt(G,q,Q,oe);return vf=null,Ee}catch(Te){if(Te===jh||Te===Om)throw Te;var Ke=cr(29,Te,null,G.mode);return Ke.lanes=oe,Ke.return=G,Ke}finally{}}}var bf=k5(!0),N5=k5(!1),Br=V(null),qa=null;function Po(u){var c=u.alternate;ne(bn,bn.current&1),ne(Br,u),qa===null&&(c===null||gf.current!==null||c.memoizedState!==null)&&(qa=u)}function F5(u){if(u.tag===22){if(ne(bn,bn.current),ne(Br,u),qa===null){var c=u.alternate;c!==null&&c.memoizedState!==null&&(qa=u)}}else Io()}function Io(){ne(bn,bn.current),ne(Br,Br.current)}function Us(u){X(Br),qa===u&&(qa=null),X(bn)}var bn=V(0);function Vm(u){for(var c=u;c!==null;){if(c.tag===13){var g=c.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||PS(g)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===u)break;for(;c.sibling===null;){if(c.return===null||c.return===u)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function KE(u,c,g,m){c=u.memoizedState,g=g(m,c),g=g==null?c:d({},c,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var JE={enqueueSetState:function(u,c,g){u=u._reactInternals;var m=gr(),x=Lo(m);x.payload=c,g!=null&&(x.callback=g),c=jo(u,x,m),c!==null&&(pr(c,u,m),Ph(c,u,m))},enqueueReplaceState:function(u,c,g){u=u._reactInternals;var m=gr(),x=Lo(m);x.tag=1,x.payload=c,g!=null&&(x.callback=g),c=jo(u,x,m),c!==null&&(pr(c,u,m),Ph(c,u,m))},enqueueForceUpdate:function(u,c){u=u._reactInternals;var g=gr(),m=Lo(g);m.tag=2,c!=null&&(m.callback=c),c=jo(u,m,g),c!==null&&(pr(c,u,g),Ph(c,u,g))}};function O5(u,c,g,m,x,A,D){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(m,A,D):c.prototype&&c.prototype.isPureReactComponent?!kh(g,m)||!kh(x,A):!0}function R5(u,c,g,m){u=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(g,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(g,m),c.state!==u&&JE.enqueueReplaceState(c,c.state,null)}function bl(u,c){var g=c;if("ref"in c){g={};for(var m in c)m!=="ref"&&(g[m]=c[m])}if(u=u.defaultProps){g===c&&(g=d({},g));for(var x in u)g[x]===void 0&&(g[x]=u[x])}return g}var Xm=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function z5(u){Xm(u)}function B5(u){console.error(u)}function L5(u){Xm(u)}function Wm(u,c){try{var g=u.onUncaughtError;g(c.value,{componentStack:c.stack})}catch(m){setTimeout(function(){throw m})}}function j5(u,c,g){try{var m=u.onCaughtError;m(g.value,{componentStack:g.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function eS(u,c,g){return g=Lo(g),g.tag=3,g.payload={element:null},g.callback=function(){Wm(u,c)},g}function U5(u){return u=Lo(u),u.tag=3,u}function P5(u,c,g,m){var x=g.type.getDerivedStateFromError;if(typeof x=="function"){var A=m.value;u.payload=function(){return x(A)},u.callback=function(){j5(c,g,m)}}var D=g.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(u.callback=function(){j5(c,g,m),typeof x!="function"&&(Xo===null?Xo=new Set([this]):Xo.add(this));var N=m.stack;this.componentDidCatch(m.value,{componentStack:N!==null?N:""})})}function jQ(u,c,g,m,x){if(g.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(c=g.alternate,c!==null&&zh(c,g,x,!0),g=Br.current,g!==null){switch(g.tag){case 13:return qa===null?wS():g.alternate===null&&Zt===0&&(Zt=3),g.flags&=-257,g.flags|=65536,g.lanes=x,m===TE?g.flags|=16384:(c=g.updateQueue,c===null?g.updateQueue=new Set([m]):c.add(m),CS(u,m,x)),!1;case 22:return g.flags|=65536,m===TE?g.flags|=16384:(c=g.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([m])},g.updateQueue=c):(g=c.retryQueue,g===null?c.retryQueue=new Set([m]):g.add(m)),CS(u,m,x)),!1}throw Error(i(435,g.tag))}return CS(u,m,x),wS(),!1}if(vt)return c=Br.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=x,m!==SE&&(u=Error(i(422),{cause:m}),Rh(Fr(u,g)))):(m!==SE&&(c=Error(i(423),{cause:m}),Rh(Fr(c,g))),u=u.current.alternate,u.flags|=65536,x&=-x,u.lanes|=x,m=Fr(m,g),x=eS(u.stateNode,m,x),NE(u,x),Zt!==4&&(Zt=2)),!1;var A=Error(i(520),{cause:m});if(A=Fr(A,g),n0===null?n0=[A]:n0.push(A),Zt!==4&&(Zt=2),c===null)return!0;m=Fr(m,g),g=c;do{switch(g.tag){case 3:return g.flags|=65536,u=x&-x,g.lanes|=u,u=eS(g.stateNode,m,u),NE(g,u),!1;case 1:if(c=g.type,A=g.stateNode,(g.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Xo===null||!Xo.has(A))))return g.flags|=65536,x&=-x,g.lanes|=x,x=U5(x),P5(x,u,g,m),NE(g,x),!1}g=g.return}while(g!==null);return!1}var I5=Error(i(461)),Tn=!1;function qn(u,c,g,m){c.child=u===null?N5(c,null,g,m):bf(c,u.child,g,m)}function q5(u,c,g,m,x){g=g.render;var A=c.ref;if("ref"in m){var D={};for(var N in m)N!=="ref"&&(D[N]=m[N])}else D=m;return ml(c),m=BE(u,c,g,D,A,x),N=LE(),u!==null&&!Tn?(jE(u,c,x),Ps(u,c,x)):(vt&&N&&xE(c),c.flags|=1,qn(u,c,m,x),c.child)}function H5(u,c,g,m,x){if(u===null){var A=g.type;return typeof A=="function"&&!yE(A)&&A.defaultProps===void 0&&g.compare===null?(c.tag=15,c.type=A,G5(u,c,A,m,x)):(u=Dm(g.type,null,m,c,c.mode,x),u.ref=c.ref,u.return=c,c.child=u)}if(A=u.child,!uS(u,x)){var D=A.memoizedProps;if(g=g.compare,g=g!==null?g:kh,g(D,m)&&u.ref===c.ref)return Ps(u,c,x)}return c.flags|=1,u=Os(A,m),u.ref=c.ref,u.return=c,c.child=u}function G5(u,c,g,m,x){if(u!==null){var A=u.memoizedProps;if(kh(A,m)&&u.ref===c.ref)if(Tn=!1,c.pendingProps=m=A,uS(u,x))(u.flags&131072)!==0&&(Tn=!0);else return c.lanes=u.lanes,Ps(u,c,x)}return tS(u,c,g,m,x)}function Y5(u,c,g){var m=c.pendingProps,x=m.children,A=u!==null?u.memoizedState:null;if(m.mode==="hidden"){if((c.flags&128)!==0){if(m=A!==null?A.baseLanes|g:g,u!==null){for(x=c.child=u.child,A=0;x!==null;)A=A|x.lanes|x.childLanes,x=x.sibling;c.childLanes=A&~m}else c.childLanes=0,c.child=null;return V5(u,c,m,g)}if((g&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},u!==null&&Fm(c,A!==null?A.cachePool:null),A!==null?G4(c,A):OE(),F5(c);else return c.lanes=c.childLanes=536870912,V5(u,c,A!==null?A.baseLanes|g:g,g)}else A!==null?(Fm(c,A.cachePool),G4(c,A),Io(),c.memoizedState=null):(u!==null&&Fm(c,null),OE(),Io());return qn(u,c,x,g),c.child}function V5(u,c,g,m){var x=DE();return x=x===null?null:{parent:vn._currentValue,pool:x},c.memoizedState={baseLanes:g,cachePool:x},u!==null&&Fm(c,null),OE(),F5(c),u!==null&&zh(u,c,m,!0),null}function Qm(u,c){var g=c.ref;if(g===null)u!==null&&u.ref!==null&&(c.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(i(284));(u===null||u.ref!==g)&&(c.flags|=4194816)}}function tS(u,c,g,m,x){return ml(c),g=BE(u,c,g,m,void 0,x),m=LE(),u!==null&&!Tn?(jE(u,c,x),Ps(u,c,x)):(vt&&m&&xE(c),c.flags|=1,qn(u,c,g,x),c.child)}function X5(u,c,g,m,x,A){return ml(c),c.updateQueue=null,g=V4(c,m,g,x),Y4(u),m=LE(),u!==null&&!Tn?(jE(u,c,A),Ps(u,c,A)):(vt&&m&&xE(c),c.flags|=1,qn(u,c,g,A),c.child)}function W5(u,c,g,m,x){if(ml(c),c.stateNode===null){var A=lf,D=g.contextType;typeof D=="object"&&D!==null&&(A=ii(D)),A=new g(m,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=JE,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=m,A.state=c.memoizedState,A.refs={},ME(c),D=g.contextType,A.context=typeof D=="object"&&D!==null?ii(D):lf,A.state=c.memoizedState,D=g.getDerivedStateFromProps,typeof D=="function"&&(KE(c,g,D,m),A.state=c.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(D=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),D!==A.state&&JE.enqueueReplaceState(A,A.state,null),qh(c,m,A,x),Ih(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!0}else if(u===null){A=c.stateNode;var N=c.memoizedProps,P=bl(g,N);A.props=P;var Z=A.context,se=g.contextType;D=lf,typeof se=="object"&&se!==null&&(D=ii(se));var ue=g.getDerivedStateFromProps;se=typeof ue=="function"||typeof A.getSnapshotBeforeUpdate=="function",N=c.pendingProps!==N,se||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(N||Z!==D)&&R5(c,A,m,D),Bo=!1;var J=c.memoizedState;A.state=J,qh(c,m,A,x),Ih(),Z=c.memoizedState,N||J!==Z||Bo?(typeof ue=="function"&&(KE(c,g,ue,m),Z=c.memoizedState),(P=Bo||O5(c,g,P,m,J,Z,D))?(se||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=Z),A.props=m,A.state=Z,A.context=D,m=P):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{A=c.stateNode,kE(u,c),D=c.memoizedProps,se=bl(g,D),A.props=se,ue=c.pendingProps,J=A.context,Z=g.contextType,P=lf,typeof Z=="object"&&Z!==null&&(P=ii(Z)),N=g.getDerivedStateFromProps,(Z=typeof N=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(D!==ue||J!==P)&&R5(c,A,m,P),Bo=!1,J=c.memoizedState,A.state=J,qh(c,m,A,x),Ih();var ee=c.memoizedState;D!==ue||J!==ee||Bo||u!==null&&u.dependencies!==null&&km(u.dependencies)?(typeof N=="function"&&(KE(c,g,N,m),ee=c.memoizedState),(se=Bo||O5(c,g,se,m,J,ee,P)||u!==null&&u.dependencies!==null&&km(u.dependencies))?(Z||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,ee,P),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,ee,P)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||D===u.memoizedProps&&J===u.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||D===u.memoizedProps&&J===u.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ee),A.props=m,A.state=ee,A.context=P,m=se):(typeof A.componentDidUpdate!="function"||D===u.memoizedProps&&J===u.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||D===u.memoizedProps&&J===u.memoizedState||(c.flags|=1024),m=!1)}return A=m,Qm(u,c),m=(c.flags&128)!==0,A||m?(A=c.stateNode,g=m&&typeof g.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,u!==null&&m?(c.child=bf(c,u.child,null,x),c.child=bf(c,null,g,x)):qn(u,c,g,x),c.memoizedState=A.state,u=c.child):u=Ps(u,c,x),u}function Q5(u,c,g,m){return Oh(),c.flags|=256,qn(u,c,g,m),c.child}var nS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function iS(u){return{baseLanes:u,cachePool:B4()}}function rS(u,c,g){return u=u!==null?u.childLanes&~g:0,c&&(u|=Lr),u}function Z5(u,c,g){var m=c.pendingProps,x=!1,A=(c.flags&128)!==0,D;if((D=A)||(D=u!==null&&u.memoizedState===null?!1:(bn.current&2)!==0),D&&(x=!0,c.flags&=-129),D=(c.flags&32)!==0,c.flags&=-33,u===null){if(vt){if(x?Po(c):Io(),vt){var N=Qt,P;if(P=N){e:{for(P=N,N=Ia;P.nodeType!==8;){if(!N){N=null;break e}if(P=ua(P.nextSibling),P===null){N=null;break e}}N=P}N!==null?(c.memoizedState={dehydrated:N,treeContext:fl!==null?{id:Rs,overflow:zs}:null,retryLane:536870912,hydrationErrors:null},P=cr(18,null,null,0),P.stateNode=N,P.return=c,c.child=P,xi=c,Qt=null,P=!0):P=!1}P||gl(c)}if(N=c.memoizedState,N!==null&&(N=N.dehydrated,N!==null))return PS(N)?c.lanes=32:c.lanes=536870912,null;Us(c)}return N=m.children,m=m.fallback,x?(Io(),x=c.mode,N=Zm({mode:"hidden",children:N},x),m=cl(m,x,g,null),N.return=c,m.return=c,N.sibling=m,c.child=N,x=c.child,x.memoizedState=iS(g),x.childLanes=rS(u,D,g),c.memoizedState=nS,m):(Po(c),aS(c,N))}if(P=u.memoizedState,P!==null&&(N=P.dehydrated,N!==null)){if(A)c.flags&256?(Po(c),c.flags&=-257,c=sS(u,c,g)):c.memoizedState!==null?(Io(),c.child=u.child,c.flags|=128,c=null):(Io(),x=m.fallback,N=c.mode,m=Zm({mode:"visible",children:m.children},N),x=cl(x,N,g,null),x.flags|=2,m.return=c,x.return=c,m.sibling=x,c.child=m,bf(c,u.child,null,g),m=c.child,m.memoizedState=iS(g),m.childLanes=rS(u,D,g),c.memoizedState=nS,c=x);else if(Po(c),PS(N)){if(D=N.nextSibling&&N.nextSibling.dataset,D)var Z=D.dgst;D=Z,m=Error(i(419)),m.stack="",m.digest=D,Rh({value:m,source:null,stack:null}),c=sS(u,c,g)}else if(Tn||zh(u,c,g,!1),D=(g&u.childLanes)!==0,Tn||D){if(D=zt,D!==null&&(m=g&-g,m=(m&42)!==0?1:I2(m),m=(m&(D.suspendedLanes|g))!==0?0:m,m!==0&&m!==P.retryLane))throw P.retryLane=m,uf(u,m),pr(D,u,m),I5;N.data==="$?"||wS(),c=sS(u,c,g)}else N.data==="$?"?(c.flags|=192,c.child=u.child,c=null):(u=P.treeContext,Qt=ua(N.nextSibling),xi=c,vt=!0,hl=null,Ia=!1,u!==null&&(Rr[zr++]=Rs,Rr[zr++]=zs,Rr[zr++]=fl,Rs=u.id,zs=u.overflow,fl=c),c=aS(c,m.children),c.flags|=4096);return c}return x?(Io(),x=m.fallback,N=c.mode,P=u.child,Z=P.sibling,m=Os(P,{mode:"hidden",children:m.children}),m.subtreeFlags=P.subtreeFlags&65011712,Z!==null?x=Os(Z,x):(x=cl(x,N,g,null),x.flags|=2),x.return=c,m.return=c,m.sibling=x,c.child=m,m=x,x=c.child,N=u.child.memoizedState,N===null?N=iS(g):(P=N.cachePool,P!==null?(Z=vn._currentValue,P=P.parent!==Z?{parent:Z,pool:Z}:P):P=B4(),N={baseLanes:N.baseLanes|g,cachePool:P}),x.memoizedState=N,x.childLanes=rS(u,D,g),c.memoizedState=nS,m):(Po(c),g=u.child,u=g.sibling,g=Os(g,{mode:"visible",children:m.children}),g.return=c,g.sibling=null,u!==null&&(D=c.deletions,D===null?(c.deletions=[u],c.flags|=16):D.push(u)),c.child=g,c.memoizedState=null,g)}function aS(u,c){return c=Zm({mode:"visible",children:c},u.mode),c.return=u,u.child=c}function Zm(u,c){return u=cr(22,u,null,c),u.lanes=0,u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},u}function sS(u,c,g){return bf(c,u.child,null,g),u=aS(c,c.pendingProps.children),u.flags|=2,c.memoizedState=null,u}function K5(u,c,g){u.lanes|=c;var m=u.alternate;m!==null&&(m.lanes|=c),wE(u.return,c,g)}function oS(u,c,g,m,x){var A=u.memoizedState;A===null?u.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:g,tailMode:x}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=m,A.tail=g,A.tailMode=x)}function J5(u,c,g){var m=c.pendingProps,x=m.revealOrder,A=m.tail;if(qn(u,c,m.children,g),m=bn.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=c.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&K5(u,g,c);else if(u.tag===19)K5(u,g,c);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===c)break e;for(;u.sibling===null;){if(u.return===null||u.return===c)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}m&=1}switch(ne(bn,m),x){case"forwards":for(g=c.child,x=null;g!==null;)u=g.alternate,u!==null&&Vm(u)===null&&(x=g),g=g.sibling;g=x,g===null?(x=c.child,c.child=null):(x=g.sibling,g.sibling=null),oS(c,!1,x,g,A);break;case"backwards":for(g=null,x=c.child,c.child=null;x!==null;){if(u=x.alternate,u!==null&&Vm(u)===null){c.child=x;break}u=x.sibling,x.sibling=g,g=x,x=u}oS(c,!0,g,null,A);break;case"together":oS(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ps(u,c,g){if(u!==null&&(c.dependencies=u.dependencies),Vo|=c.lanes,(g&c.childLanes)===0)if(u!==null){if(zh(u,c,g,!1),(g&c.childLanes)===0)return null}else return null;if(u!==null&&c.child!==u.child)throw Error(i(153));if(c.child!==null){for(u=c.child,g=Os(u,u.pendingProps),c.child=g,g.return=c;u.sibling!==null;)u=u.sibling,g=g.sibling=Os(u,u.pendingProps),g.return=c;g.sibling=null}return c.child}function uS(u,c){return(u.lanes&c)!==0?!0:(u=u.dependencies,!!(u!==null&&km(u)))}function UQ(u,c,g){switch(c.tag){case 3:it(c,c.stateNode.containerInfo),zo(c,vn,u.memoizedState.cache),Oh();break;case 27:case 5:Ie(c);break;case 4:it(c,c.stateNode.containerInfo);break;case 10:zo(c,c.type,c.memoizedProps.value);break;case 13:var m=c.memoizedState;if(m!==null)return m.dehydrated!==null?(Po(c),c.flags|=128,null):(g&c.child.childLanes)!==0?Z5(u,c,g):(Po(c),u=Ps(u,c,g),u!==null?u.sibling:null);Po(c);break;case 19:var x=(u.flags&128)!==0;if(m=(g&c.childLanes)!==0,m||(zh(u,c,g,!1),m=(g&c.childLanes)!==0),x){if(m)return J5(u,c,g);c.flags|=128}if(x=c.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ne(bn,bn.current),m)break;return null;case 22:case 23:return c.lanes=0,Y5(u,c,g);case 24:zo(c,vn,u.memoizedState.cache)}return Ps(u,c,g)}function eN(u,c,g){if(u!==null)if(u.memoizedProps!==c.pendingProps)Tn=!0;else{if(!uS(u,g)&&(c.flags&128)===0)return Tn=!1,UQ(u,c,g);Tn=(u.flags&131072)!==0}else Tn=!1,vt&&(c.flags&1048576)!==0&&M4(c,Mm,c.index);switch(c.lanes=0,c.tag){case 16:e:{u=c.pendingProps;var m=c.elementType,x=m._init;if(m=x(m._payload),c.type=m,typeof m=="function")yE(m)?(u=bl(m,u),c.tag=1,c=W5(null,c,m,u,g)):(c.tag=0,c=tS(null,c,m,u,g));else{if(m!=null){if(x=m.$$typeof,x===C){c.tag=11,c=q5(null,c,m,u,g);break e}else if(x===T){c.tag=14,c=H5(null,c,m,u,g);break e}}throw c=U(m)||m,Error(i(306,c,""))}}return c;case 0:return tS(u,c,c.type,c.pendingProps,g);case 1:return m=c.type,x=bl(m,c.pendingProps),W5(u,c,m,x,g);case 3:e:{if(it(c,c.stateNode.containerInfo),u===null)throw Error(i(387));m=c.pendingProps;var A=c.memoizedState;x=A.element,kE(u,c),qh(c,m,null,g);var D=c.memoizedState;if(m=D.cache,zo(c,vn,m),m!==A.cache&&_E(c,[vn],g,!0),Ih(),m=D.element,A.isDehydrated)if(A={element:m,isDehydrated:!1,cache:D.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=Q5(u,c,m,g);break e}else if(m!==x){x=Fr(Error(i(424)),c),Rh(x),c=Q5(u,c,m,g);break e}else{switch(u=c.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(Qt=ua(u.firstChild),xi=c,vt=!0,hl=null,Ia=!0,g=N5(c,null,m,g),c.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(Oh(),m===x){c=Ps(u,c,g);break e}qn(u,c,m,g)}c=c.child}return c;case 26:return Qm(u,c),u===null?(g=rF(c.type,null,c.pendingProps,null))?c.memoizedState=g:vt||(g=c.type,u=c.pendingProps,m=f1(be.current).createElement(g),m[ni]=c,m[Ui]=u,Gn(m,g,u),Dn(m),c.stateNode=m):c.memoizedState=rF(c.type,u.memoizedProps,c.pendingProps,u.memoizedState),null;case 27:return Ie(c),u===null&&vt&&(m=c.stateNode=tF(c.type,c.pendingProps,be.current),xi=c,Ia=!0,x=Qt,Zo(c.type)?(IS=x,Qt=ua(m.firstChild)):Qt=x),qn(u,c,c.pendingProps.children,g),Qm(u,c),u===null&&(c.flags|=4194304),c.child;case 5:return u===null&&vt&&((x=m=Qt)&&(m=gZ(m,c.type,c.pendingProps,Ia),m!==null?(c.stateNode=m,xi=c,Qt=ua(m.firstChild),Ia=!1,x=!0):x=!1),x||gl(c)),Ie(c),x=c.type,A=c.pendingProps,D=u!==null?u.memoizedProps:null,m=A.children,LS(x,A)?m=null:D!==null&&LS(x,D)&&(c.flags|=32),c.memoizedState!==null&&(x=BE(u,c,NQ,null,null,g),f0._currentValue=x),Qm(u,c),qn(u,c,m,g),c.child;case 6:return u===null&&vt&&((u=g=Qt)&&(g=pZ(g,c.pendingProps,Ia),g!==null?(c.stateNode=g,xi=c,Qt=null,u=!0):u=!1),u||gl(c)),null;case 13:return Z5(u,c,g);case 4:return it(c,c.stateNode.containerInfo),m=c.pendingProps,u===null?c.child=bf(c,null,m,g):qn(u,c,m,g),c.child;case 11:return q5(u,c,c.type,c.pendingProps,g);case 7:return qn(u,c,c.pendingProps,g),c.child;case 8:return qn(u,c,c.pendingProps.children,g),c.child;case 12:return qn(u,c,c.pendingProps.children,g),c.child;case 10:return m=c.pendingProps,zo(c,c.type,m.value),qn(u,c,m.children,g),c.child;case 9:return x=c.type._context,m=c.pendingProps.children,ml(c),x=ii(x),m=m(x),c.flags|=1,qn(u,c,m,g),c.child;case 14:return H5(u,c,c.type,c.pendingProps,g);case 15:return G5(u,c,c.type,c.pendingProps,g);case 19:return J5(u,c,g);case 31:return m=c.pendingProps,g=c.mode,m={mode:m.mode,children:m.children},u===null?(g=Zm(m,g),g.ref=c.ref,c.child=g,g.return=c,c=g):(g=Os(u.child,m),g.ref=c.ref,c.child=g,g.return=c,c=g),c;case 22:return Y5(u,c,g);case 24:return ml(c),m=ii(vn),u===null?(x=DE(),x===null&&(x=zt,A=CE(),x.pooledCache=A,A.refCount++,A!==null&&(x.pooledCacheLanes|=g),x=A),c.memoizedState={parent:m,cache:x},ME(c),zo(c,vn,x)):((u.lanes&g)!==0&&(kE(u,c),qh(c,null,null,g),Ih()),x=u.memoizedState,A=c.memoizedState,x.parent!==m?(x={parent:m,cache:m},c.memoizedState=x,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=x),zo(c,vn,m)):(m=A.cache,zo(c,vn,m),m!==x.cache&&_E(c,[vn],g,!0))),qn(u,c,c.pendingProps.children,g),c.child;case 29:throw c.pendingProps}throw Error(i(156,c.tag))}function Is(u){u.flags|=4}function tN(u,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!lF(c)){if(c=Br.current,c!==null&&((ot&4194048)===ot?qa!==null:(ot&62914560)!==ot&&(ot&536870912)===0||c!==qa))throw Uh=TE,L4;u.flags|=8192}}function Km(u,c){c!==null&&(u.flags|=4),u.flags&16384&&(c=u.tag!==22?F6():536870912,u.lanes|=c,Af|=c)}function Qh(u,c){if(!vt)switch(u.tailMode){case"hidden":c=u.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var m=null;g!==null;)g.alternate!==null&&(m=g),g=g.sibling;m===null?c||u.tail===null?u.tail=null:u.tail.sibling=null:m.sibling=null}}function Yt(u){var c=u.alternate!==null&&u.alternate.child===u.child,g=0,m=0;if(c)for(var x=u.child;x!==null;)g|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=u,x=x.sibling;else for(x=u.child;x!==null;)g|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=u,x=x.sibling;return u.subtreeFlags|=m,u.childLanes=g,c}function PQ(u,c,g){var m=c.pendingProps;switch(EE(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(c),null;case 1:return Yt(c),null;case 3:return g=c.stateNode,m=null,u!==null&&(m=u.memoizedState.cache),c.memoizedState.cache!==m&&(c.flags|=2048),Ls(vn),xe(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(u===null||u.child===null)&&(Fh(c)?Is(c):u===null||u.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,F4())),Yt(c),null;case 26:return g=c.memoizedState,u===null?(Is(c),g!==null?(Yt(c),tN(c,g)):(Yt(c),c.flags&=-16777217)):g?g!==u.memoizedState?(Is(c),Yt(c),tN(c,g)):(Yt(c),c.flags&=-16777217):(u.memoizedProps!==m&&Is(c),Yt(c),c.flags&=-16777217),null;case 27:Ge(c),g=be.current;var x=c.type;if(u!==null&&c.stateNode!=null)u.memoizedProps!==m&&Is(c);else{if(!m){if(c.stateNode===null)throw Error(i(166));return Yt(c),null}u=ye.current,Fh(c)?k4(c):(u=tF(x,m,g),c.stateNode=u,Is(c))}return Yt(c),null;case 5:if(Ge(c),g=c.type,u!==null&&c.stateNode!=null)u.memoizedProps!==m&&Is(c);else{if(!m){if(c.stateNode===null)throw Error(i(166));return Yt(c),null}if(u=ye.current,Fh(c))k4(c);else{switch(x=f1(be.current),u){case 1:u=x.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:u=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":u=x.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":u=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":u=x.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof m.is=="string"?x.createElement("select",{is:m.is}):x.createElement("select"),m.multiple?u.multiple=!0:m.size&&(u.size=m.size);break;default:u=typeof m.is=="string"?x.createElement(g,{is:m.is}):x.createElement(g)}}u[ni]=c,u[Ui]=m;e:for(x=c.child;x!==null;){if(x.tag===5||x.tag===6)u.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===c)break e;for(;x.sibling===null;){if(x.return===null||x.return===c)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}c.stateNode=u;e:switch(Gn(u,g,m),g){case"button":case"input":case"select":case"textarea":u=!!m.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Is(c)}}return Yt(c),c.flags&=-16777217,null;case 6:if(u&&c.stateNode!=null)u.memoizedProps!==m&&Is(c);else{if(typeof m!="string"&&c.stateNode===null)throw Error(i(166));if(u=be.current,Fh(c)){if(u=c.stateNode,g=c.memoizedProps,m=null,x=xi,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}u[ni]=c,u=!!(u.nodeValue===g||m!==null&&m.suppressHydrationWarning===!0||XN(u.nodeValue,g)),u||gl(c)}else u=f1(u).createTextNode(m),u[ni]=c,c.stateNode=u}return Yt(c),null;case 13:if(m=c.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(x=Fh(c),m!==null&&m.dehydrated!==null){if(u===null){if(!x)throw Error(i(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[ni]=c}else Oh(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Yt(c),x=!1}else x=F4(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=x),x=!0;if(!x)return c.flags&256?(Us(c),c):(Us(c),null)}if(Us(c),(c.flags&128)!==0)return c.lanes=g,c;if(g=m!==null,u=u!==null&&u.memoizedState!==null,g){m=c.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool);var A=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(A=m.memoizedState.cachePool.pool),A!==x&&(m.flags|=2048)}return g!==u&&g&&(c.child.flags|=8192),Km(c,c.updateQueue),Yt(c),null;case 4:return xe(),u===null&&FS(c.stateNode.containerInfo),Yt(c),null;case 10:return Ls(c.type),Yt(c),null;case 19:if(X(bn),x=c.memoizedState,x===null)return Yt(c),null;if(m=(c.flags&128)!==0,A=x.rendering,A===null)if(m)Qh(x,!1);else{if(Zt!==0||u!==null&&(u.flags&128)!==0)for(u=c.child;u!==null;){if(A=Vm(u),A!==null){for(c.flags|=128,Qh(x,!1),u=A.updateQueue,c.updateQueue=u,Km(c,u),c.subtreeFlags=0,u=g,g=c.child;g!==null;)T4(g,u),g=g.sibling;return ne(bn,bn.current&1|2),c.child}u=u.sibling}x.tail!==null&&dn()>t1&&(c.flags|=128,m=!0,Qh(x,!1),c.lanes=4194304)}else{if(!m)if(u=Vm(A),u!==null){if(c.flags|=128,m=!0,u=u.updateQueue,c.updateQueue=u,Km(c,u),Qh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!A.alternate&&!vt)return Yt(c),null}else 2*dn()-x.renderingStartTime>t1&&g!==536870912&&(c.flags|=128,m=!0,Qh(x,!1),c.lanes=4194304);x.isBackwards?(A.sibling=c.child,c.child=A):(u=x.last,u!==null?u.sibling=A:c.child=A,x.last=A)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=dn(),c.sibling=null,u=bn.current,ne(bn,m?u&1|2:u&1),c):(Yt(c),null);case 22:case 23:return Us(c),RE(),m=c.memoizedState!==null,u!==null?u.memoizedState!==null!==m&&(c.flags|=8192):m&&(c.flags|=8192),m?(g&536870912)!==0&&(c.flags&128)===0&&(Yt(c),c.subtreeFlags&6&&(c.flags|=8192)):Yt(c),g=c.updateQueue,g!==null&&Km(c,g.retryQueue),g=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==g&&(c.flags|=2048),u!==null&&X(yl),null;case 24:return g=null,u!==null&&(g=u.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),Ls(vn),Yt(c),null;case 25:return null;case 30:return null}throw Error(i(156,c.tag))}function IQ(u,c){switch(EE(c),c.tag){case 1:return u=c.flags,u&65536?(c.flags=u&-65537|128,c):null;case 3:return Ls(vn),xe(),u=c.flags,(u&65536)!==0&&(u&128)===0?(c.flags=u&-65537|128,c):null;case 26:case 27:case 5:return Ge(c),null;case 13:if(Us(c),u=c.memoizedState,u!==null&&u.dehydrated!==null){if(c.alternate===null)throw Error(i(340));Oh()}return u=c.flags,u&65536?(c.flags=u&-65537|128,c):null;case 19:return X(bn),null;case 4:return xe(),null;case 10:return Ls(c.type),null;case 22:case 23:return Us(c),RE(),u!==null&&X(yl),u=c.flags,u&65536?(c.flags=u&-65537|128,c):null;case 24:return Ls(vn),null;case 25:return null;default:return null}}function nN(u,c){switch(EE(c),c.tag){case 3:Ls(vn),xe();break;case 26:case 27:case 5:Ge(c);break;case 4:xe();break;case 13:Us(c);break;case 19:X(bn);break;case 10:Ls(c.type);break;case 22:case 23:Us(c),RE(),u!==null&&X(yl);break;case 24:Ls(vn)}}function Zh(u,c){try{var g=c.updateQueue,m=g!==null?g.lastEffect:null;if(m!==null){var x=m.next;g=x;do{if((g.tag&u)===u){m=void 0;var A=g.create,D=g.inst;m=A(),D.destroy=m}g=g.next}while(g!==x)}}catch(N){Ft(c,c.return,N)}}function qo(u,c,g){try{var m=c.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var A=x.next;m=A;do{if((m.tag&u)===u){var D=m.inst,N=D.destroy;if(N!==void 0){D.destroy=void 0,x=c;var P=g,Z=N;try{Z()}catch(se){Ft(x,P,se)}}}m=m.next}while(m!==A)}}catch(se){Ft(c,c.return,se)}}function iN(u){var c=u.updateQueue;if(c!==null){var g=u.stateNode;try{H4(c,g)}catch(m){Ft(u,u.return,m)}}}function rN(u,c,g){g.props=bl(u.type,u.memoizedProps),g.state=u.memoizedState;try{g.componentWillUnmount()}catch(m){Ft(u,c,m)}}function Kh(u,c){try{var g=u.ref;if(g!==null){switch(u.tag){case 26:case 27:case 5:var m=u.stateNode;break;case 30:m=u.stateNode;break;default:m=u.stateNode}typeof g=="function"?u.refCleanup=g(m):g.current=m}}catch(x){Ft(u,c,x)}}function Ha(u,c){var g=u.ref,m=u.refCleanup;if(g!==null)if(typeof m=="function")try{m()}catch(x){Ft(u,c,x)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(x){Ft(u,c,x)}else g.current=null}function aN(u){var c=u.type,g=u.memoizedProps,m=u.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":g.autoFocus&&m.focus();break e;case"img":g.src?m.src=g.src:g.srcSet&&(m.srcset=g.srcSet)}}catch(x){Ft(u,u.return,x)}}function lS(u,c,g){try{var m=u.stateNode;lZ(m,u.type,g,c),m[Ui]=c}catch(x){Ft(u,u.return,x)}}function sN(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Zo(u.type)||u.tag===4}function cS(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||sN(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Zo(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function fS(u,c,g){var m=u.tag;if(m===5||m===6)u=u.stateNode,c?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(u,c):(c=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,c.appendChild(u),g=g._reactRootContainer,g!=null||c.onclick!==null||(c.onclick=c1));else if(m!==4&&(m===27&&Zo(u.type)&&(g=u.stateNode,c=null),u=u.child,u!==null))for(fS(u,c,g),u=u.sibling;u!==null;)fS(u,c,g),u=u.sibling}function Jm(u,c,g){var m=u.tag;if(m===5||m===6)u=u.stateNode,c?g.insertBefore(u,c):g.appendChild(u);else if(m!==4&&(m===27&&Zo(u.type)&&(g=u.stateNode),u=u.child,u!==null))for(Jm(u,c,g),u=u.sibling;u!==null;)Jm(u,c,g),u=u.sibling}function oN(u){var c=u.stateNode,g=u.memoizedProps;try{for(var m=u.type,x=c.attributes;x.length;)c.removeAttributeNode(x[0]);Gn(c,m,g),c[ni]=u,c[Ui]=g}catch(A){Ft(u,u.return,A)}}var qs=!1,an=!1,dS=!1,uN=typeof WeakSet=="function"?WeakSet:Set,Mn=null;function qQ(u,c){if(u=u.containerInfo,zS=y1,u=b4(u),cE(u)){if("selectionStart"in u)var g={start:u.selectionStart,end:u.selectionEnd};else e:{g=(g=u.ownerDocument)&&g.defaultView||window;var m=g.getSelection&&g.getSelection();if(m&&m.rangeCount!==0){g=m.anchorNode;var x=m.anchorOffset,A=m.focusNode;m=m.focusOffset;try{g.nodeType,A.nodeType}catch{g=null;break e}var D=0,N=-1,P=-1,Z=0,se=0,ue=u,J=null;t:for(;;){for(var ee;ue!==g||x!==0&&ue.nodeType!==3||(N=D+x),ue!==A||m!==0&&ue.nodeType!==3||(P=D+m),ue.nodeType===3&&(D+=ue.nodeValue.length),(ee=ue.firstChild)!==null;)J=ue,ue=ee;for(;;){if(ue===u)break t;if(J===g&&++Z===x&&(N=D),J===A&&++se===m&&(P=D),(ee=ue.nextSibling)!==null)break;ue=J,J=ue.parentNode}ue=ee}g=N===-1||P===-1?null:{start:N,end:P}}else g=null}g=g||{start:0,end:0}}else g=null;for(BS={focusedElem:u,selectionRange:g},y1=!1,Mn=c;Mn!==null;)if(c=Mn,u=c.child,(c.subtreeFlags&1024)!==0&&u!==null)u.return=c,Mn=u;else for(;Mn!==null;){switch(c=Mn,A=c.alternate,u=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&A!==null){u=void 0,g=c,x=A.memoizedProps,A=A.memoizedState,m=g.stateNode;try{var je=bl(g.type,x,g.elementType===g.type);u=m.getSnapshotBeforeUpdate(je,A),m.__reactInternalSnapshotBeforeUpdate=u}catch(Be){Ft(g,g.return,Be)}}break;case 3:if((u&1024)!==0){if(u=c.stateNode.containerInfo,g=u.nodeType,g===9)US(u);else if(g===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":US(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(i(163))}if(u=c.sibling,u!==null){u.return=c.return,Mn=u;break}Mn=c.return}}function lN(u,c,g){var m=g.flags;switch(g.tag){case 0:case 11:case 15:Ho(u,g),m&4&&Zh(5,g);break;case 1:if(Ho(u,g),m&4)if(u=g.stateNode,c===null)try{u.componentDidMount()}catch(D){Ft(g,g.return,D)}else{var x=bl(g.type,c.memoizedProps);c=c.memoizedState;try{u.componentDidUpdate(x,c,u.__reactInternalSnapshotBeforeUpdate)}catch(D){Ft(g,g.return,D)}}m&64&&iN(g),m&512&&Kh(g,g.return);break;case 3:if(Ho(u,g),m&64&&(u=g.updateQueue,u!==null)){if(c=null,g.child!==null)switch(g.child.tag){case 27:case 5:c=g.child.stateNode;break;case 1:c=g.child.stateNode}try{H4(u,c)}catch(D){Ft(g,g.return,D)}}break;case 27:c===null&&m&4&&oN(g);case 26:case 5:Ho(u,g),c===null&&m&4&&aN(g),m&512&&Kh(g,g.return);break;case 12:Ho(u,g);break;case 13:Ho(u,g),m&4&&dN(u,g),m&64&&(u=g.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(g=KQ.bind(null,g),mZ(u,g))));break;case 22:if(m=g.memoizedState!==null||qs,!m){c=c!==null&&c.memoizedState!==null||an,x=qs;var A=an;qs=m,(an=c)&&!A?Go(u,g,(g.subtreeFlags&8772)!==0):Ho(u,g),qs=x,an=A}break;case 30:break;default:Ho(u,g)}}function cN(u){var c=u.alternate;c!==null&&(u.alternate=null,cN(c)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(c=u.stateNode,c!==null&&G2(c)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Pt=null,qi=!1;function Hs(u,c,g){for(g=g.child;g!==null;)fN(u,c,g),g=g.sibling}function fN(u,c,g){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(bh,g)}catch{}switch(g.tag){case 26:an||Ha(g,c),Hs(u,c,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:an||Ha(g,c);var m=Pt,x=qi;Zo(g.type)&&(Pt=g.stateNode,qi=!1),Hs(u,c,g),o0(g.stateNode),Pt=m,qi=x;break;case 5:an||Ha(g,c);case 6:if(m=Pt,x=qi,Pt=null,Hs(u,c,g),Pt=m,qi=x,Pt!==null)if(qi)try{(Pt.nodeType===9?Pt.body:Pt.nodeName==="HTML"?Pt.ownerDocument.body:Pt).removeChild(g.stateNode)}catch(A){Ft(g,c,A)}else try{Pt.removeChild(g.stateNode)}catch(A){Ft(g,c,A)}break;case 18:Pt!==null&&(qi?(u=Pt,JN(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,g.stateNode),p0(u)):JN(Pt,g.stateNode));break;case 4:m=Pt,x=qi,Pt=g.stateNode.containerInfo,qi=!0,Hs(u,c,g),Pt=m,qi=x;break;case 0:case 11:case 14:case 15:an||qo(2,g,c),an||qo(4,g,c),Hs(u,c,g);break;case 1:an||(Ha(g,c),m=g.stateNode,typeof m.componentWillUnmount=="function"&&rN(g,c,m)),Hs(u,c,g);break;case 21:Hs(u,c,g);break;case 22:an=(m=an)||g.memoizedState!==null,Hs(u,c,g),an=m;break;default:Hs(u,c,g)}}function dN(u,c){if(c.memoizedState===null&&(u=c.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{p0(u)}catch(g){Ft(c,c.return,g)}}function HQ(u){switch(u.tag){case 13:case 19:var c=u.stateNode;return c===null&&(c=u.stateNode=new uN),c;case 22:return u=u.stateNode,c=u._retryCache,c===null&&(c=u._retryCache=new uN),c;default:throw Error(i(435,u.tag))}}function hS(u,c){var g=HQ(u);c.forEach(function(m){var x=JQ.bind(null,u,m);g.has(m)||(g.add(m),m.then(x,x))})}function fr(u,c){var g=c.deletions;if(g!==null)for(var m=0;m<g.length;m++){var x=g[m],A=u,D=c,N=D;e:for(;N!==null;){switch(N.tag){case 27:if(Zo(N.type)){Pt=N.stateNode,qi=!1;break e}break;case 5:Pt=N.stateNode,qi=!1;break e;case 3:case 4:Pt=N.stateNode.containerInfo,qi=!0;break e}N=N.return}if(Pt===null)throw Error(i(160));fN(A,D,x),Pt=null,qi=!1,A=x.alternate,A!==null&&(A.return=null),x.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)hN(c,u),c=c.sibling}var oa=null;function hN(u,c){var g=u.alternate,m=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:fr(c,u),dr(u),m&4&&(qo(3,u,u.return),Zh(3,u),qo(5,u,u.return));break;case 1:fr(c,u),dr(u),m&512&&(an||g===null||Ha(g,g.return)),m&64&&qs&&(u=u.updateQueue,u!==null&&(m=u.callbacks,m!==null&&(g=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=g===null?m:g.concat(m))));break;case 26:var x=oa;if(fr(c,u),dr(u),m&512&&(an||g===null||Ha(g,g.return)),m&4){var A=g!==null?g.memoizedState:null;if(m=u.memoizedState,g===null)if(m===null)if(u.stateNode===null){e:{m=u.type,g=u.memoizedProps,x=x.ownerDocument||x;t:switch(m){case"title":A=x.getElementsByTagName("title")[0],(!A||A[Sh]||A[ni]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=x.createElement(m),x.head.insertBefore(A,x.querySelector("head > title"))),Gn(A,m,g),A[ni]=u,Dn(A),m=A;break e;case"link":var D=oF("link","href",x).get(m+(g.href||""));if(D){for(var N=0;N<D.length;N++)if(A=D[N],A.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&A.getAttribute("rel")===(g.rel==null?null:g.rel)&&A.getAttribute("title")===(g.title==null?null:g.title)&&A.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){D.splice(N,1);break t}}A=x.createElement(m),Gn(A,m,g),x.head.appendChild(A);break;case"meta":if(D=oF("meta","content",x).get(m+(g.content||""))){for(N=0;N<D.length;N++)if(A=D[N],A.getAttribute("content")===(g.content==null?null:""+g.content)&&A.getAttribute("name")===(g.name==null?null:g.name)&&A.getAttribute("property")===(g.property==null?null:g.property)&&A.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&A.getAttribute("charset")===(g.charSet==null?null:g.charSet)){D.splice(N,1);break t}}A=x.createElement(m),Gn(A,m,g),x.head.appendChild(A);break;default:throw Error(i(468,m))}A[ni]=u,Dn(A),m=A}u.stateNode=m}else uF(x,u.type,u.stateNode);else u.stateNode=sF(x,m,u.memoizedProps);else A!==m?(A===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):A.count--,m===null?uF(x,u.type,u.stateNode):sF(x,m,u.memoizedProps)):m===null&&u.stateNode!==null&&lS(u,u.memoizedProps,g.memoizedProps)}break;case 27:fr(c,u),dr(u),m&512&&(an||g===null||Ha(g,g.return)),g!==null&&m&4&&lS(u,u.memoizedProps,g.memoizedProps);break;case 5:if(fr(c,u),dr(u),m&512&&(an||g===null||Ha(g,g.return)),u.flags&32){x=u.stateNode;try{ef(x,"")}catch(ee){Ft(u,u.return,ee)}}m&4&&u.stateNode!=null&&(x=u.memoizedProps,lS(u,x,g!==null?g.memoizedProps:x)),m&1024&&(dS=!0);break;case 6:if(fr(c,u),dr(u),m&4){if(u.stateNode===null)throw Error(i(162));m=u.memoizedProps,g=u.stateNode;try{g.nodeValue=m}catch(ee){Ft(u,u.return,ee)}}break;case 3:if(g1=null,x=oa,oa=d1(c.containerInfo),fr(c,u),oa=x,dr(u),m&4&&g!==null&&g.memoizedState.isDehydrated)try{p0(c.containerInfo)}catch(ee){Ft(u,u.return,ee)}dS&&(dS=!1,gN(u));break;case 4:m=oa,oa=d1(u.stateNode.containerInfo),fr(c,u),dr(u),oa=m;break;case 12:fr(c,u),dr(u);break;case 13:fr(c,u),dr(u),u.child.flags&8192&&u.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(bS=dn()),m&4&&(m=u.updateQueue,m!==null&&(u.updateQueue=null,hS(u,m)));break;case 22:x=u.memoizedState!==null;var P=g!==null&&g.memoizedState!==null,Z=qs,se=an;if(qs=Z||x,an=se||P,fr(c,u),an=se,qs=Z,dr(u),m&8192)e:for(c=u.stateNode,c._visibility=x?c._visibility&-2:c._visibility|1,x&&(g===null||P||qs||an||xl(u)),g=null,c=u;;){if(c.tag===5||c.tag===26){if(g===null){P=g=c;try{if(A=P.stateNode,x)D=A.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{N=P.stateNode;var ue=P.memoizedProps.style,J=ue!=null&&ue.hasOwnProperty("display")?ue.display:null;N.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(ee){Ft(P,P.return,ee)}}}else if(c.tag===6){if(g===null){P=c;try{P.stateNode.nodeValue=x?"":P.memoizedProps}catch(ee){Ft(P,P.return,ee)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===u)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===u)break e;for(;c.sibling===null;){if(c.return===null||c.return===u)break e;g===c&&(g=null),c=c.return}g===c&&(g=null),c.sibling.return=c.return,c=c.sibling}m&4&&(m=u.updateQueue,m!==null&&(g=m.retryQueue,g!==null&&(m.retryQueue=null,hS(u,g))));break;case 19:fr(c,u),dr(u),m&4&&(m=u.updateQueue,m!==null&&(u.updateQueue=null,hS(u,m)));break;case 30:break;case 21:break;default:fr(c,u),dr(u)}}function dr(u){var c=u.flags;if(c&2){try{for(var g,m=u.return;m!==null;){if(sN(m)){g=m;break}m=m.return}if(g==null)throw Error(i(160));switch(g.tag){case 27:var x=g.stateNode,A=cS(u);Jm(u,A,x);break;case 5:var D=g.stateNode;g.flags&32&&(ef(D,""),g.flags&=-33);var N=cS(u);Jm(u,N,D);break;case 3:case 4:var P=g.stateNode.containerInfo,Z=cS(u);fS(u,Z,P);break;default:throw Error(i(161))}}catch(se){Ft(u,u.return,se)}u.flags&=-3}c&4096&&(u.flags&=-4097)}function gN(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var c=u;gN(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),u=u.sibling}}function Ho(u,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)lN(u,c.alternate,c),c=c.sibling}function xl(u){for(u=u.child;u!==null;){var c=u;switch(c.tag){case 0:case 11:case 14:case 15:qo(4,c,c.return),xl(c);break;case 1:Ha(c,c.return);var g=c.stateNode;typeof g.componentWillUnmount=="function"&&rN(c,c.return,g),xl(c);break;case 27:o0(c.stateNode);case 26:case 5:Ha(c,c.return),xl(c);break;case 22:c.memoizedState===null&&xl(c);break;case 30:xl(c);break;default:xl(c)}u=u.sibling}}function Go(u,c,g){for(g=g&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var m=c.alternate,x=u,A=c,D=A.flags;switch(A.tag){case 0:case 11:case 15:Go(x,A,g),Zh(4,A);break;case 1:if(Go(x,A,g),m=A,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Z){Ft(m,m.return,Z)}if(m=A,x=m.updateQueue,x!==null){var N=m.stateNode;try{var P=x.shared.hiddenCallbacks;if(P!==null)for(x.shared.hiddenCallbacks=null,x=0;x<P.length;x++)q4(P[x],N)}catch(Z){Ft(m,m.return,Z)}}g&&D&64&&iN(A),Kh(A,A.return);break;case 27:oN(A);case 26:case 5:Go(x,A,g),g&&m===null&&D&4&&aN(A),Kh(A,A.return);break;case 12:Go(x,A,g);break;case 13:Go(x,A,g),g&&D&4&&dN(x,A);break;case 22:A.memoizedState===null&&Go(x,A,g),Kh(A,A.return);break;case 30:break;default:Go(x,A,g)}c=c.sibling}}function gS(u,c){var g=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),u=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(u=c.memoizedState.cachePool.pool),u!==g&&(u!=null&&u.refCount++,g!=null&&Bh(g))}function pS(u,c){u=null,c.alternate!==null&&(u=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==u&&(c.refCount++,u!=null&&Bh(u))}function Ga(u,c,g,m){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)pN(u,c,g,m),c=c.sibling}function pN(u,c,g,m){var x=c.flags;switch(c.tag){case 0:case 11:case 15:Ga(u,c,g,m),x&2048&&Zh(9,c);break;case 1:Ga(u,c,g,m);break;case 3:Ga(u,c,g,m),x&2048&&(u=null,c.alternate!==null&&(u=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==u&&(c.refCount++,u!=null&&Bh(u)));break;case 12:if(x&2048){Ga(u,c,g,m),u=c.stateNode;try{var A=c.memoizedProps,D=A.id,N=A.onPostCommit;typeof N=="function"&&N(D,c.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(P){Ft(c,c.return,P)}}else Ga(u,c,g,m);break;case 13:Ga(u,c,g,m);break;case 23:break;case 22:A=c.stateNode,D=c.alternate,c.memoizedState!==null?A._visibility&2?Ga(u,c,g,m):Jh(u,c):A._visibility&2?Ga(u,c,g,m):(A._visibility|=2,xf(u,c,g,m,(c.subtreeFlags&10256)!==0)),x&2048&&gS(D,c);break;case 24:Ga(u,c,g,m),x&2048&&pS(c.alternate,c);break;default:Ga(u,c,g,m)}}function xf(u,c,g,m,x){for(x=x&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=u,D=c,N=g,P=m,Z=D.flags;switch(D.tag){case 0:case 11:case 15:xf(A,D,N,P,x),Zh(8,D);break;case 23:break;case 22:var se=D.stateNode;D.memoizedState!==null?se._visibility&2?xf(A,D,N,P,x):Jh(A,D):(se._visibility|=2,xf(A,D,N,P,x)),x&&Z&2048&&gS(D.alternate,D);break;case 24:xf(A,D,N,P,x),x&&Z&2048&&pS(D.alternate,D);break;default:xf(A,D,N,P,x)}c=c.sibling}}function Jh(u,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var g=u,m=c,x=m.flags;switch(m.tag){case 22:Jh(g,m),x&2048&&gS(m.alternate,m);break;case 24:Jh(g,m),x&2048&&pS(m.alternate,m);break;default:Jh(g,m)}c=c.sibling}}var e0=8192;function Ef(u){if(u.subtreeFlags&e0)for(u=u.child;u!==null;)mN(u),u=u.sibling}function mN(u){switch(u.tag){case 26:Ef(u),u.flags&e0&&u.memoizedState!==null&&TZ(oa,u.memoizedState,u.memoizedProps);break;case 5:Ef(u);break;case 3:case 4:var c=oa;oa=d1(u.stateNode.containerInfo),Ef(u),oa=c;break;case 22:u.memoizedState===null&&(c=u.alternate,c!==null&&c.memoizedState!==null?(c=e0,e0=16777216,Ef(u),e0=c):Ef(u));break;default:Ef(u)}}function yN(u){var c=u.alternate;if(c!==null&&(u=c.child,u!==null)){c.child=null;do c=u.sibling,u.sibling=null,u=c;while(u!==null)}}function t0(u){var c=u.deletions;if((u.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var m=c[g];Mn=m,bN(m,u)}yN(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)vN(u),u=u.sibling}function vN(u){switch(u.tag){case 0:case 11:case 15:t0(u),u.flags&2048&&qo(9,u,u.return);break;case 3:t0(u);break;case 12:t0(u);break;case 22:var c=u.stateNode;u.memoizedState!==null&&c._visibility&2&&(u.return===null||u.return.tag!==13)?(c._visibility&=-3,e1(u)):t0(u);break;default:t0(u)}}function e1(u){var c=u.deletions;if((u.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var m=c[g];Mn=m,bN(m,u)}yN(u)}for(u=u.child;u!==null;){switch(c=u,c.tag){case 0:case 11:case 15:qo(8,c,c.return),e1(c);break;case 22:g=c.stateNode,g._visibility&2&&(g._visibility&=-3,e1(c));break;default:e1(c)}u=u.sibling}}function bN(u,c){for(;Mn!==null;){var g=Mn;switch(g.tag){case 0:case 11:case 15:qo(8,g,c);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var m=g.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Bh(g.memoizedState.cache)}if(m=g.child,m!==null)m.return=g,Mn=m;else e:for(g=u;Mn!==null;){m=Mn;var x=m.sibling,A=m.return;if(cN(m),m===g){Mn=null;break e}if(x!==null){x.return=A,Mn=x;break e}Mn=A}}}var GQ={getCacheForType:function(u){var c=ii(vn),g=c.data.get(u);return g===void 0&&(g=u(),c.data.set(u,g)),g}},YQ=typeof WeakMap=="function"?WeakMap:Map,St=0,zt=null,tt=null,ot=0,At=0,hr=null,Yo=!1,Sf=!1,mS=!1,Gs=0,Zt=0,Vo=0,El=0,yS=0,Lr=0,Af=0,n0=null,Hi=null,vS=!1,bS=0,t1=1/0,n1=null,Xo=null,Hn=0,Wo=null,wf=null,_f=0,xS=0,ES=null,xN=null,i0=0,SS=null;function gr(){if((St&2)!==0&&ot!==0)return ot&-ot;if(O.T!==null){var u=df;return u!==0?u:TS()}return z6()}function EN(){Lr===0&&(Lr=(ot&536870912)===0||vt?N6():536870912);var u=Br.current;return u!==null&&(u.flags|=32),Lr}function pr(u,c,g){(u===zt&&(At===2||At===9)||u.cancelPendingCommit!==null)&&(Cf(u,0),Qo(u,ot,Lr,!1)),Eh(u,g),((St&2)===0||u!==zt)&&(u===zt&&((St&2)===0&&(El|=g),Zt===4&&Qo(u,ot,Lr,!1)),Ya(u))}function SN(u,c,g){if((St&6)!==0)throw Error(i(327));var m=!g&&(c&124)===0&&(c&u.expiredLanes)===0||xh(u,c),x=m?WQ(u,c):_S(u,c,!0),A=m;do{if(x===0){Sf&&!m&&Qo(u,c,0,!1);break}else{if(g=u.current.alternate,A&&!VQ(g)){x=_S(u,c,!1),A=!1;continue}if(x===2){if(A=c,u.errorRecoveryDisabledLanes&A)var D=0;else D=u.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){c=D;e:{var N=u;x=n0;var P=N.current.memoizedState.isDehydrated;if(P&&(Cf(N,D).flags|=256),D=_S(N,D,!1),D!==2){if(mS&&!P){N.errorRecoveryDisabledLanes|=A,El|=A,x=4;break e}A=Hi,Hi=x,A!==null&&(Hi===null?Hi=A:Hi.push.apply(Hi,A))}x=D}if(A=!1,x!==2)continue}}if(x===1){Cf(u,0),Qo(u,c,0,!0);break}e:{switch(m=u,A=x,A){case 0:case 1:throw Error(i(345));case 4:if((c&4194048)!==c)break;case 6:Qo(m,c,Lr,!Yo);break e;case 2:Hi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((c&62914560)===c&&(x=bS+300-dn(),10<x)){if(Qo(m,c,Lr,!Yo),hm(m,0,!0)!==0)break e;m.timeoutHandle=ZN(AN.bind(null,m,g,Hi,n1,vS,c,Lr,El,Af,Yo,A,2,-0,0),x);break e}AN(m,g,Hi,n1,vS,c,Lr,El,Af,Yo,A,0,-0,0)}}break}while(!0);Ya(u)}function AN(u,c,g,m,x,A,D,N,P,Z,se,ue,J,ee){if(u.timeoutHandle=-1,ue=c.subtreeFlags,(ue&8192||(ue&16785408)===16785408)&&(c0={stylesheets:null,count:0,unsuspend:DZ},mN(c),ue=MZ(),ue!==null)){u.cancelPendingCommit=ue(MN.bind(null,u,c,A,g,m,x,D,N,P,se,1,J,ee)),Qo(u,A,D,!Z);return}MN(u,c,A,g,m,x,D,N,P)}function VQ(u){for(var c=u;;){var g=c.tag;if((g===0||g===11||g===15)&&c.flags&16384&&(g=c.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var m=0;m<g.length;m++){var x=g[m],A=x.getSnapshot;x=x.value;try{if(!lr(A(),x))return!1}catch{return!1}}if(g=c.child,c.subtreeFlags&16384&&g!==null)g.return=c,c=g;else{if(c===u)break;for(;c.sibling===null;){if(c.return===null||c.return===u)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Qo(u,c,g,m){c&=~yS,c&=~El,u.suspendedLanes|=c,u.pingedLanes&=~c,m&&(u.warmLanes|=c),m=u.expirationTimes;for(var x=c;0<x;){var A=31-ur(x),D=1<<A;m[A]=-1,x&=~D}g!==0&&O6(u,g,c)}function i1(){return(St&6)===0?(r0(0),!1):!0}function AS(){if(tt!==null){if(At===0)var u=tt.return;else u=tt,Bs=pl=null,UE(u),vf=null,Xh=0,u=tt;for(;u!==null;)nN(u.alternate,u),u=u.return;tt=null}}function Cf(u,c){var g=u.timeoutHandle;g!==-1&&(u.timeoutHandle=-1,fZ(g)),g=u.cancelPendingCommit,g!==null&&(u.cancelPendingCommit=null,g()),AS(),zt=u,tt=g=Os(u.current,null),ot=c,At=0,hr=null,Yo=!1,Sf=xh(u,c),mS=!1,Af=Lr=yS=El=Vo=Zt=0,Hi=n0=null,vS=!1,(c&8)!==0&&(c|=c&32);var m=u.entangledLanes;if(m!==0)for(u=u.entanglements,m&=c;0<m;){var x=31-ur(m),A=1<<x;c|=u[x],m&=~A}return Gs=c,_m(),g}function wN(u,c){Qe=null,O.H=Hm,c===jh||c===Om?(c=P4(),At=3):c===L4?(c=P4(),At=4):At=c===I5?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,hr=c,tt===null&&(Zt=1,Wm(u,Fr(c,u.current)))}function _N(){var u=O.H;return O.H=Hm,u===null?Hm:u}function CN(){var u=O.A;return O.A=GQ,u}function wS(){Zt=4,Yo||(ot&4194048)!==ot&&Br.current!==null||(Sf=!0),(Vo&134217727)===0&&(El&134217727)===0||zt===null||Qo(zt,ot,Lr,!1)}function _S(u,c,g){var m=St;St|=2;var x=_N(),A=CN();(zt!==u||ot!==c)&&(n1=null,Cf(u,c)),c=!1;var D=Zt;e:do try{if(At!==0&&tt!==null){var N=tt,P=hr;switch(At){case 8:AS(),D=6;break e;case 3:case 2:case 9:case 6:Br.current===null&&(c=!0);var Z=At;if(At=0,hr=null,$f(u,N,P,Z),g&&Sf){D=0;break e}break;default:Z=At,At=0,hr=null,$f(u,N,P,Z)}}XQ(),D=Zt;break}catch(se){wN(u,se)}while(!0);return c&&u.shellSuspendCounter++,Bs=pl=null,St=m,O.H=x,O.A=A,tt===null&&(zt=null,ot=0,_m()),D}function XQ(){for(;tt!==null;)$N(tt)}function WQ(u,c){var g=St;St|=2;var m=_N(),x=CN();zt!==u||ot!==c?(n1=null,t1=dn()+500,Cf(u,c)):Sf=xh(u,c);e:do try{if(At!==0&&tt!==null){c=tt;var A=hr;t:switch(At){case 1:At=0,hr=null,$f(u,c,A,1);break;case 2:case 9:if(j4(A)){At=0,hr=null,DN(c);break}c=function(){At!==2&&At!==9||zt!==u||(At=7),Ya(u)},A.then(c,c);break e;case 3:At=7;break e;case 4:At=5;break e;case 7:j4(A)?(At=0,hr=null,DN(c)):(At=0,hr=null,$f(u,c,A,7));break;case 5:var D=null;switch(tt.tag){case 26:D=tt.memoizedState;case 5:case 27:var N=tt;if(!D||lF(D)){At=0,hr=null;var P=N.sibling;if(P!==null)tt=P;else{var Z=N.return;Z!==null?(tt=Z,r1(Z)):tt=null}break t}}At=0,hr=null,$f(u,c,A,5);break;case 6:At=0,hr=null,$f(u,c,A,6);break;case 8:AS(),Zt=6;break e;default:throw Error(i(462))}}QQ();break}catch(se){wN(u,se)}while(!0);return Bs=pl=null,O.H=m,O.A=x,St=g,tt!==null?0:(zt=null,ot=0,_m(),Zt)}function QQ(){for(;tt!==null&&!fn();)$N(tt)}function $N(u){var c=eN(u.alternate,u,Gs);u.memoizedProps=u.pendingProps,c===null?r1(u):tt=c}function DN(u){var c=u,g=c.alternate;switch(c.tag){case 15:case 0:c=X5(g,c,c.pendingProps,c.type,void 0,ot);break;case 11:c=X5(g,c,c.pendingProps,c.type.render,c.ref,ot);break;case 5:UE(c);default:nN(g,c),c=tt=T4(c,Gs),c=eN(g,c,Gs)}u.memoizedProps=u.pendingProps,c===null?r1(u):tt=c}function $f(u,c,g,m){Bs=pl=null,UE(c),vf=null,Xh=0;var x=c.return;try{if(jQ(u,x,c,g,ot)){Zt=1,Wm(u,Fr(g,u.current)),tt=null;return}}catch(A){if(x!==null)throw tt=x,A;Zt=1,Wm(u,Fr(g,u.current)),tt=null;return}c.flags&32768?(vt||m===1?u=!0:Sf||(ot&536870912)!==0?u=!1:(Yo=u=!0,(m===2||m===9||m===3||m===6)&&(m=Br.current,m!==null&&m.tag===13&&(m.flags|=16384))),TN(c,u)):r1(c)}function r1(u){var c=u;do{if((c.flags&32768)!==0){TN(c,Yo);return}u=c.return;var g=PQ(c.alternate,c,Gs);if(g!==null){tt=g;return}if(c=c.sibling,c!==null){tt=c;return}tt=c=u}while(c!==null);Zt===0&&(Zt=5)}function TN(u,c){do{var g=IQ(u.alternate,u);if(g!==null){g.flags&=32767,tt=g;return}if(g=u.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!c&&(u=u.sibling,u!==null)){tt=u;return}tt=u=g}while(u!==null);Zt=6,tt=null}function MN(u,c,g,m,x,A,D,N,P){u.cancelPendingCommit=null;do a1();while(Hn!==0);if((St&6)!==0)throw Error(i(327));if(c!==null){if(c===u.current)throw Error(i(177));if(A=c.lanes|c.childLanes,A|=pE,DW(u,g,A,D,N,P),u===zt&&(tt=zt=null,ot=0),wf=c,Wo=u,_f=g,xS=A,ES=x,xN=m,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,eZ(cm,function(){return RN(),null})):(u.callbackNode=null,u.callbackPriority=0),m=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||m){m=O.T,O.T=null,x=I.p,I.p=2,D=St,St|=4;try{qQ(u,c,g)}finally{St=D,I.p=x,O.T=m}}Hn=1,kN(),NN(),FN()}}function kN(){if(Hn===1){Hn=0;var u=Wo,c=wf,g=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||g){g=O.T,O.T=null;var m=I.p;I.p=2;var x=St;St|=4;try{hN(c,u);var A=BS,D=b4(u.containerInfo),N=A.focusedElem,P=A.selectionRange;if(D!==N&&N&&N.ownerDocument&&v4(N.ownerDocument.documentElement,N)){if(P!==null&&cE(N)){var Z=P.start,se=P.end;if(se===void 0&&(se=Z),"selectionStart"in N)N.selectionStart=Z,N.selectionEnd=Math.min(se,N.value.length);else{var ue=N.ownerDocument||document,J=ue&&ue.defaultView||window;if(J.getSelection){var ee=J.getSelection(),je=N.textContent.length,Be=Math.min(P.start,je),Mt=P.end===void 0?Be:Math.min(P.end,je);!ee.extend&&Be>Mt&&(D=Mt,Mt=Be,Be=D);var G=y4(N,Be),q=y4(N,Mt);if(G&&q&&(ee.rangeCount!==1||ee.anchorNode!==G.node||ee.anchorOffset!==G.offset||ee.focusNode!==q.node||ee.focusOffset!==q.offset)){var Q=ue.createRange();Q.setStart(G.node,G.offset),ee.removeAllRanges(),Be>Mt?(ee.addRange(Q),ee.extend(q.node,q.offset)):(Q.setEnd(q.node,q.offset),ee.addRange(Q))}}}}for(ue=[],ee=N;ee=ee.parentNode;)ee.nodeType===1&&ue.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<ue.length;N++){var oe=ue[N];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}y1=!!zS,BS=zS=null}finally{St=x,I.p=m,O.T=g}}u.current=c,Hn=2}}function NN(){if(Hn===2){Hn=0;var u=Wo,c=wf,g=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||g){g=O.T,O.T=null;var m=I.p;I.p=2;var x=St;St|=4;try{lN(u,c.alternate,c)}finally{St=x,I.p=m,O.T=g}}Hn=3}}function FN(){if(Hn===4||Hn===3){Hn=0,$n();var u=Wo,c=wf,g=_f,m=xN;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Hn=5:(Hn=0,wf=Wo=null,ON(u,u.pendingLanes));var x=u.pendingLanes;if(x===0&&(Xo=null),q2(g),c=c.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(bh,c,void 0,(c.current.flags&128)===128)}catch{}if(m!==null){c=O.T,x=I.p,I.p=2,O.T=null;try{for(var A=u.onRecoverableError,D=0;D<m.length;D++){var N=m[D];A(N.value,{componentStack:N.stack})}}finally{O.T=c,I.p=x}}(_f&3)!==0&&a1(),Ya(u),x=u.pendingLanes,(g&4194090)!==0&&(x&42)!==0?u===SS?i0++:(i0=0,SS=u):i0=0,r0(0)}}function ON(u,c){(u.pooledCacheLanes&=c)===0&&(c=u.pooledCache,c!=null&&(u.pooledCache=null,Bh(c)))}function a1(u){return kN(),NN(),FN(),RN()}function RN(){if(Hn!==5)return!1;var u=Wo,c=xS;xS=0;var g=q2(_f),m=O.T,x=I.p;try{I.p=32>g?32:g,O.T=null,g=ES,ES=null;var A=Wo,D=_f;if(Hn=0,wf=Wo=null,_f=0,(St&6)!==0)throw Error(i(331));var N=St;if(St|=4,vN(A.current),pN(A,A.current,D,g),St=N,r0(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(bh,A)}catch{}return!0}finally{I.p=x,O.T=m,ON(u,c)}}function zN(u,c,g){c=Fr(g,c),c=eS(u.stateNode,c,2),u=jo(u,c,2),u!==null&&(Eh(u,2),Ya(u))}function Ft(u,c,g){if(u.tag===3)zN(u,u,g);else for(;c!==null;){if(c.tag===3){zN(c,u,g);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Xo===null||!Xo.has(m))){u=Fr(g,u),g=U5(2),m=jo(c,g,2),m!==null&&(P5(g,m,c,u),Eh(m,2),Ya(m));break}}c=c.return}}function CS(u,c,g){var m=u.pingCache;if(m===null){m=u.pingCache=new YQ;var x=new Set;m.set(c,x)}else x=m.get(c),x===void 0&&(x=new Set,m.set(c,x));x.has(g)||(mS=!0,x.add(g),u=ZQ.bind(null,u,c,g),c.then(u,u))}function ZQ(u,c,g){var m=u.pingCache;m!==null&&m.delete(c),u.pingedLanes|=u.suspendedLanes&g,u.warmLanes&=~g,zt===u&&(ot&g)===g&&(Zt===4||Zt===3&&(ot&62914560)===ot&&300>dn()-bS?(St&2)===0&&Cf(u,0):yS|=g,Af===ot&&(Af=0)),Ya(u)}function BN(u,c){c===0&&(c=F6()),u=uf(u,c),u!==null&&(Eh(u,c),Ya(u))}function KQ(u){var c=u.memoizedState,g=0;c!==null&&(g=c.retryLane),BN(u,g)}function JQ(u,c){var g=0;switch(u.tag){case 13:var m=u.stateNode,x=u.memoizedState;x!==null&&(g=x.retryLane);break;case 19:m=u.stateNode;break;case 22:m=u.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(c),BN(u,g)}function eZ(u,c){return nn(u,c)}var s1=null,Df=null,$S=!1,o1=!1,DS=!1,Sl=0;function Ya(u){u!==Df&&u.next===null&&(Df===null?s1=Df=u:Df=Df.next=u),o1=!0,$S||($S=!0,nZ())}function r0(u,c){if(!DS&&o1){DS=!0;do for(var g=!1,m=s1;m!==null;){if(u!==0){var x=m.pendingLanes;if(x===0)var A=0;else{var D=m.suspendedLanes,N=m.pingedLanes;A=(1<<31-ur(42|u)+1)-1,A&=x&~(D&~N),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(g=!0,PN(m,A))}else A=ot,A=hm(m,m===zt?A:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(A&3)===0||xh(m,A)||(g=!0,PN(m,A));m=m.next}while(g);DS=!1}}function tZ(){LN()}function LN(){o1=$S=!1;var u=0;Sl!==0&&(cZ()&&(u=Sl),Sl=0);for(var c=dn(),g=null,m=s1;m!==null;){var x=m.next,A=jN(m,c);A===0?(m.next=null,g===null?s1=x:g.next=x,x===null&&(Df=g)):(g=m,(u!==0||(A&3)!==0)&&(o1=!0)),m=x}r0(u)}function jN(u,c){for(var g=u.suspendedLanes,m=u.pingedLanes,x=u.expirationTimes,A=u.pendingLanes&-62914561;0<A;){var D=31-ur(A),N=1<<D,P=x[D];P===-1?((N&g)===0||(N&m)!==0)&&(x[D]=$W(N,c)):P<=c&&(u.expiredLanes|=N),A&=~N}if(c=zt,g=ot,g=hm(u,u===c?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),m=u.callbackNode,g===0||u===c&&(At===2||At===9)||u.cancelPendingCommit!==null)return m!==null&&m!==null&&lt(m),u.callbackNode=null,u.callbackPriority=0;if((g&3)===0||xh(u,g)){if(c=g&-g,c===u.callbackPriority)return c;switch(m!==null&&lt(m),q2(g)){case 2:case 8:g=M6;break;case 32:g=cm;break;case 268435456:g=k6;break;default:g=cm}return m=UN.bind(null,u),g=nn(g,m),u.callbackPriority=c,u.callbackNode=g,c}return m!==null&&m!==null&&lt(m),u.callbackPriority=2,u.callbackNode=null,2}function UN(u,c){if(Hn!==0&&Hn!==5)return u.callbackNode=null,u.callbackPriority=0,null;var g=u.callbackNode;if(a1()&&u.callbackNode!==g)return null;var m=ot;return m=hm(u,u===zt?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),m===0?null:(SN(u,m,c),jN(u,dn()),u.callbackNode!=null&&u.callbackNode===g?UN.bind(null,u):null)}function PN(u,c){if(a1())return null;SN(u,c,!0)}function nZ(){dZ(function(){(St&6)!==0?nn(T6,tZ):LN()})}function TS(){return Sl===0&&(Sl=N6()),Sl}function IN(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:vm(""+u)}function qN(u,c){var g=c.ownerDocument.createElement("input");return g.name=c.name,g.value=c.value,u.id&&g.setAttribute("form",u.id),c.parentNode.insertBefore(g,c),u=new FormData(u),g.parentNode.removeChild(g),u}function iZ(u,c,g,m,x){if(c==="submit"&&g&&g.stateNode===x){var A=IN((x[Ui]||null).action),D=m.submitter;D&&(c=(c=D[Ui]||null)?IN(c.formAction):D.getAttribute("formAction"),c!==null&&(A=c,D=null));var N=new Sm("action","action",null,m,x);u.push({event:N,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Sl!==0){var P=D?qN(x,D):new FormData(x);WE(g,{pending:!0,data:P,method:x.method,action:A},null,P)}}else typeof A=="function"&&(N.preventDefault(),P=D?qN(x,D):new FormData(x),WE(g,{pending:!0,data:P,method:x.method,action:A},A,P))},currentTarget:x}]})}}for(var MS=0;MS<gE.length;MS++){var kS=gE[MS],rZ=kS.toLowerCase(),aZ=kS[0].toUpperCase()+kS.slice(1);sa(rZ,"on"+aZ)}sa(S4,"onAnimationEnd"),sa(A4,"onAnimationIteration"),sa(w4,"onAnimationStart"),sa("dblclick","onDoubleClick"),sa("focusin","onFocus"),sa("focusout","onBlur"),sa(SQ,"onTransitionRun"),sa(AQ,"onTransitionStart"),sa(wQ,"onTransitionCancel"),sa(_4,"onTransitionEnd"),Zc("onMouseEnter",["mouseout","mouseover"]),Zc("onMouseLeave",["mouseout","mouseover"]),Zc("onPointerEnter",["pointerout","pointerover"]),Zc("onPointerLeave",["pointerout","pointerover"]),sl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),sl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),sl("onBeforeInput",["compositionend","keypress","textInput","paste"]),sl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),sl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),sl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var a0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sZ=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(a0));function HN(u,c){c=(c&4)!==0;for(var g=0;g<u.length;g++){var m=u[g],x=m.event;m=m.listeners;e:{var A=void 0;if(c)for(var D=m.length-1;0<=D;D--){var N=m[D],P=N.instance,Z=N.currentTarget;if(N=N.listener,P!==A&&x.isPropagationStopped())break e;A=N,x.currentTarget=Z;try{A(x)}catch(se){Xm(se)}x.currentTarget=null,A=P}else for(D=0;D<m.length;D++){if(N=m[D],P=N.instance,Z=N.currentTarget,N=N.listener,P!==A&&x.isPropagationStopped())break e;A=N,x.currentTarget=Z;try{A(x)}catch(se){Xm(se)}x.currentTarget=null,A=P}}}}function nt(u,c){var g=c[H2];g===void 0&&(g=c[H2]=new Set);var m=u+"__bubble";g.has(m)||(GN(c,u,2,!1),g.add(m))}function NS(u,c,g){var m=0;c&&(m|=4),GN(g,u,m,c)}var u1="_reactListening"+Math.random().toString(36).slice(2);function FS(u){if(!u[u1]){u[u1]=!0,L6.forEach(function(g){g!=="selectionchange"&&(sZ.has(g)||NS(g,!1,u),NS(g,!0,u))});var c=u.nodeType===9?u:u.ownerDocument;c===null||c[u1]||(c[u1]=!0,NS("selectionchange",!1,c))}}function GN(u,c,g,m){switch(pF(c)){case 2:var x=FZ;break;case 8:x=OZ;break;default:x=VS}g=x.bind(null,c,g,u),x=void 0,!tE||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(x=!0),m?x!==void 0?u.addEventListener(c,g,{capture:!0,passive:x}):u.addEventListener(c,g,!0):x!==void 0?u.addEventListener(c,g,{passive:x}):u.addEventListener(c,g,!1)}function OS(u,c,g,m,x){var A=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var D=m.tag;if(D===3||D===4){var N=m.stateNode.containerInfo;if(N===x)break;if(D===4)for(D=m.return;D!==null;){var P=D.tag;if((P===3||P===4)&&D.stateNode.containerInfo===x)return;D=D.return}for(;N!==null;){if(D=Xc(N),D===null)return;if(P=D.tag,P===5||P===6||P===26||P===27){m=A=D;continue e}N=N.parentNode}}m=m.return}K6(function(){var Z=A,se=J2(g),ue=[];e:{var J=C4.get(u);if(J!==void 0){var ee=Sm,je=u;switch(u){case"keypress":if(xm(g)===0)break e;case"keydown":case"keyup":ee=eQ;break;case"focusin":je="focus",ee=aE;break;case"focusout":je="blur",ee=aE;break;case"beforeblur":case"afterblur":ee=aE;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=t4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=IW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=iQ;break;case S4:case A4:case w4:ee=GW;break;case _4:ee=aQ;break;case"scroll":case"scrollend":ee=UW;break;case"wheel":ee=oQ;break;case"copy":case"cut":case"paste":ee=VW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=i4;break;case"toggle":case"beforetoggle":ee=lQ}var Be=(c&4)!==0,Mt=!Be&&(u==="scroll"||u==="scrollend"),G=Be?J!==null?J+"Capture":null:J;Be=[];for(var q=Z,Q;q!==null;){var oe=q;if(Q=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||Q===null||G===null||(oe=wh(q,G),oe!=null&&Be.push(s0(q,oe,Q))),Mt)break;q=q.return}0<Be.length&&(J=new ee(J,je,null,g,se),ue.push({event:J,listeners:Be}))}}if((c&7)===0){e:{if(J=u==="mouseover"||u==="pointerover",ee=u==="mouseout"||u==="pointerout",J&&g!==K2&&(je=g.relatedTarget||g.fromElement)&&(Xc(je)||je[Vc]))break e;if((ee||J)&&(J=se.window===se?se:(J=se.ownerDocument)?J.defaultView||J.parentWindow:window,ee?(je=g.relatedTarget||g.toElement,ee=Z,je=je?Xc(je):null,je!==null&&(Mt=a(je),Be=je.tag,je!==Mt||Be!==5&&Be!==27&&Be!==6)&&(je=null)):(ee=null,je=Z),ee!==je)){if(Be=t4,oe="onMouseLeave",G="onMouseEnter",q="mouse",(u==="pointerout"||u==="pointerover")&&(Be=i4,oe="onPointerLeave",G="onPointerEnter",q="pointer"),Mt=ee==null?J:Ah(ee),Q=je==null?J:Ah(je),J=new Be(oe,q+"leave",ee,g,se),J.target=Mt,J.relatedTarget=Q,oe=null,Xc(se)===Z&&(Be=new Be(G,q+"enter",je,g,se),Be.target=Q,Be.relatedTarget=Mt,oe=Be),Mt=oe,ee&&je)t:{for(Be=ee,G=je,q=0,Q=Be;Q;Q=Tf(Q))q++;for(Q=0,oe=G;oe;oe=Tf(oe))Q++;for(;0<q-Q;)Be=Tf(Be),q--;for(;0<Q-q;)G=Tf(G),Q--;for(;q--;){if(Be===G||G!==null&&Be===G.alternate)break t;Be=Tf(Be),G=Tf(G)}Be=null}else Be=null;ee!==null&&YN(ue,J,ee,Be,!1),je!==null&&Mt!==null&&YN(ue,Mt,je,Be,!0)}}e:{if(J=Z?Ah(Z):window,ee=J.nodeName&&J.nodeName.toLowerCase(),ee==="select"||ee==="input"&&J.type==="file")var Ee=f4;else if(l4(J))if(d4)Ee=bQ;else{Ee=yQ;var Ke=mQ}else ee=J.nodeName,!ee||ee.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?Z&&Z2(Z.elementType)&&(Ee=f4):Ee=vQ;if(Ee&&(Ee=Ee(u,Z))){c4(ue,Ee,g,se);break e}Ke&&Ke(u,J,Z),u==="focusout"&&Z&&J.type==="number"&&Z.memoizedProps.value!=null&&Q2(J,"number",J.value)}switch(Ke=Z?Ah(Z):window,u){case"focusin":(l4(Ke)||Ke.contentEditable==="true")&&(af=Ke,fE=Z,Nh=null);break;case"focusout":Nh=fE=af=null;break;case"mousedown":dE=!0;break;case"contextmenu":case"mouseup":case"dragend":dE=!1,x4(ue,g,se);break;case"selectionchange":if(EQ)break;case"keydown":case"keyup":x4(ue,g,se)}var Te;if(oE)e:{switch(u){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else rf?o4(u,g)&&(Le="onCompositionEnd"):u==="keydown"&&g.keyCode===229&&(Le="onCompositionStart");Le&&(r4&&g.locale!=="ko"&&(rf||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&rf&&(Te=J6()):(Ro=se,nE="value"in Ro?Ro.value:Ro.textContent,rf=!0)),Ke=l1(Z,Le),0<Ke.length&&(Le=new n4(Le,u,null,g,se),ue.push({event:Le,listeners:Ke}),Te?Le.data=Te:(Te=u4(g),Te!==null&&(Le.data=Te)))),(Te=fQ?dQ(u,g):hQ(u,g))&&(Le=l1(Z,"onBeforeInput"),0<Le.length&&(Ke=new n4("onBeforeInput","beforeinput",null,g,se),ue.push({event:Ke,listeners:Le}),Ke.data=Te)),iZ(ue,u,Z,g,se)}HN(ue,c)})}function s0(u,c,g){return{instance:u,listener:c,currentTarget:g}}function l1(u,c){for(var g=c+"Capture",m=[];u!==null;){var x=u,A=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||A===null||(x=wh(u,g),x!=null&&m.unshift(s0(u,x,A)),x=wh(u,c),x!=null&&m.push(s0(u,x,A))),u.tag===3)return m;u=u.return}return[]}function Tf(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function YN(u,c,g,m,x){for(var A=c._reactName,D=[];g!==null&&g!==m;){var N=g,P=N.alternate,Z=N.stateNode;if(N=N.tag,P!==null&&P===m)break;N!==5&&N!==26&&N!==27||Z===null||(P=Z,x?(Z=wh(g,A),Z!=null&&D.unshift(s0(g,Z,P))):x||(Z=wh(g,A),Z!=null&&D.push(s0(g,Z,P)))),g=g.return}D.length!==0&&u.push({event:c,listeners:D})}var oZ=/\r\n?/g,uZ=/\u0000|\uFFFD/g;function VN(u){return(typeof u=="string"?u:""+u).replace(oZ,`
`).replace(uZ,"")}function XN(u,c){return c=VN(c),VN(u)===c}function c1(){}function Tt(u,c,g,m,x,A){switch(g){case"children":typeof m=="string"?c==="body"||c==="textarea"&&m===""||ef(u,m):(typeof m=="number"||typeof m=="bigint")&&c!=="body"&&ef(u,""+m);break;case"className":pm(u,"class",m);break;case"tabIndex":pm(u,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":pm(u,g,m);break;case"style":Q6(u,m,A);break;case"data":if(c!=="object"){pm(u,"data",m);break}case"src":case"href":if(m===""&&(c!=="a"||g!=="href")){u.removeAttribute(g);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){u.removeAttribute(g);break}m=vm(""+m),u.setAttribute(g,m);break;case"action":case"formAction":if(typeof m=="function"){u.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(g==="formAction"?(c!=="input"&&Tt(u,c,"name",x.name,x,null),Tt(u,c,"formEncType",x.formEncType,x,null),Tt(u,c,"formMethod",x.formMethod,x,null),Tt(u,c,"formTarget",x.formTarget,x,null)):(Tt(u,c,"encType",x.encType,x,null),Tt(u,c,"method",x.method,x,null),Tt(u,c,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){u.removeAttribute(g);break}m=vm(""+m),u.setAttribute(g,m);break;case"onClick":m!=null&&(u.onclick=c1);break;case"onScroll":m!=null&&nt("scroll",u);break;case"onScrollEnd":m!=null&&nt("scrollend",u);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(g=m.__html,g!=null){if(x.children!=null)throw Error(i(60));u.innerHTML=g}}break;case"multiple":u.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":u.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){u.removeAttribute("xlink:href");break}g=vm(""+m),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?u.setAttribute(g,""+m):u.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?u.setAttribute(g,""):u.removeAttribute(g);break;case"capture":case"download":m===!0?u.setAttribute(g,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?u.setAttribute(g,m):u.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?u.setAttribute(g,m):u.removeAttribute(g);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?u.removeAttribute(g):u.setAttribute(g,m);break;case"popover":nt("beforetoggle",u),nt("toggle",u),gm(u,"popover",m);break;case"xlinkActuate":Ns(u,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Ns(u,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Ns(u,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Ns(u,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Ns(u,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Ns(u,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Ns(u,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Ns(u,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Ns(u,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":gm(u,"is",m);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=LW.get(g)||g,gm(u,g,m))}}function RS(u,c,g,m,x,A){switch(g){case"style":Q6(u,m,A);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(g=m.__html,g!=null){if(x.children!=null)throw Error(i(60));u.innerHTML=g}}break;case"children":typeof m=="string"?ef(u,m):(typeof m=="number"||typeof m=="bigint")&&ef(u,""+m);break;case"onScroll":m!=null&&nt("scroll",u);break;case"onScrollEnd":m!=null&&nt("scrollend",u);break;case"onClick":m!=null&&(u.onclick=c1);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!j6.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(x=g.endsWith("Capture"),c=g.slice(2,x?g.length-7:void 0),A=u[Ui]||null,A=A!=null?A[g]:null,typeof A=="function"&&u.removeEventListener(c,A,x),typeof m=="function")){typeof A!="function"&&A!==null&&(g in u?u[g]=null:u.hasAttribute(g)&&u.removeAttribute(g)),u.addEventListener(c,m,x);break e}g in u?u[g]=m:m===!0?u.setAttribute(g,""):gm(u,g,m)}}}function Gn(u,c,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nt("error",u),nt("load",u);var m=!1,x=!1,A;for(A in g)if(g.hasOwnProperty(A)){var D=g[A];if(D!=null)switch(A){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:Tt(u,c,A,D,g,null)}}x&&Tt(u,c,"srcSet",g.srcSet,g,null),m&&Tt(u,c,"src",g.src,g,null);return;case"input":nt("invalid",u);var N=A=D=x=null,P=null,Z=null;for(m in g)if(g.hasOwnProperty(m)){var se=g[m];if(se!=null)switch(m){case"name":x=se;break;case"type":D=se;break;case"checked":P=se;break;case"defaultChecked":Z=se;break;case"value":A=se;break;case"defaultValue":N=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,c));break;default:Tt(u,c,m,se,g,null)}}Y6(u,A,N,P,Z,D,x,!1),mm(u);return;case"select":nt("invalid",u),m=D=A=null;for(x in g)if(g.hasOwnProperty(x)&&(N=g[x],N!=null))switch(x){case"value":A=N;break;case"defaultValue":D=N;break;case"multiple":m=N;default:Tt(u,c,x,N,g,null)}c=A,g=D,u.multiple=!!m,c!=null?Jc(u,!!m,c,!1):g!=null&&Jc(u,!!m,g,!0);return;case"textarea":nt("invalid",u),A=x=m=null;for(D in g)if(g.hasOwnProperty(D)&&(N=g[D],N!=null))switch(D){case"value":m=N;break;case"defaultValue":x=N;break;case"children":A=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Tt(u,c,D,N,g,null)}X6(u,m,x,A),mm(u);return;case"option":for(P in g)if(g.hasOwnProperty(P)&&(m=g[P],m!=null))switch(P){case"selected":u.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Tt(u,c,P,m,g,null)}return;case"dialog":nt("beforetoggle",u),nt("toggle",u),nt("cancel",u),nt("close",u);break;case"iframe":case"object":nt("load",u);break;case"video":case"audio":for(m=0;m<a0.length;m++)nt(a0[m],u);break;case"image":nt("error",u),nt("load",u);break;case"details":nt("toggle",u);break;case"embed":case"source":case"link":nt("error",u),nt("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in g)if(g.hasOwnProperty(Z)&&(m=g[Z],m!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:Tt(u,c,Z,m,g,null)}return;default:if(Z2(c)){for(se in g)g.hasOwnProperty(se)&&(m=g[se],m!==void 0&&RS(u,c,se,m,g,void 0));return}}for(N in g)g.hasOwnProperty(N)&&(m=g[N],m!=null&&Tt(u,c,N,m,g,null))}function lZ(u,c,g,m){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,A=null,D=null,N=null,P=null,Z=null,se=null;for(ee in g){var ue=g[ee];if(g.hasOwnProperty(ee)&&ue!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":P=ue;default:m.hasOwnProperty(ee)||Tt(u,c,ee,null,m,ue)}}for(var J in m){var ee=m[J];if(ue=g[J],m.hasOwnProperty(J)&&(ee!=null||ue!=null))switch(J){case"type":A=ee;break;case"name":x=ee;break;case"checked":Z=ee;break;case"defaultChecked":se=ee;break;case"value":D=ee;break;case"defaultValue":N=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,c));break;default:ee!==ue&&Tt(u,c,J,ee,m,ue)}}W2(u,D,N,P,Z,se,A,x);return;case"select":ee=D=N=J=null;for(A in g)if(P=g[A],g.hasOwnProperty(A)&&P!=null)switch(A){case"value":break;case"multiple":ee=P;default:m.hasOwnProperty(A)||Tt(u,c,A,null,m,P)}for(x in m)if(A=m[x],P=g[x],m.hasOwnProperty(x)&&(A!=null||P!=null))switch(x){case"value":J=A;break;case"defaultValue":N=A;break;case"multiple":D=A;default:A!==P&&Tt(u,c,x,A,m,P)}c=N,g=D,m=ee,J!=null?Jc(u,!!g,J,!1):!!m!=!!g&&(c!=null?Jc(u,!!g,c,!0):Jc(u,!!g,g?[]:"",!1));return;case"textarea":ee=J=null;for(N in g)if(x=g[N],g.hasOwnProperty(N)&&x!=null&&!m.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Tt(u,c,N,null,m,x)}for(D in m)if(x=m[D],A=g[D],m.hasOwnProperty(D)&&(x!=null||A!=null))switch(D){case"value":J=x;break;case"defaultValue":ee=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==A&&Tt(u,c,D,x,m,A)}V6(u,J,ee);return;case"option":for(var je in g)if(J=g[je],g.hasOwnProperty(je)&&J!=null&&!m.hasOwnProperty(je))switch(je){case"selected":u.selected=!1;break;default:Tt(u,c,je,null,m,J)}for(P in m)if(J=m[P],ee=g[P],m.hasOwnProperty(P)&&J!==ee&&(J!=null||ee!=null))switch(P){case"selected":u.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:Tt(u,c,P,J,m,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in g)J=g[Be],g.hasOwnProperty(Be)&&J!=null&&!m.hasOwnProperty(Be)&&Tt(u,c,Be,null,m,J);for(Z in m)if(J=m[Z],ee=g[Z],m.hasOwnProperty(Z)&&J!==ee&&(J!=null||ee!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,c));break;default:Tt(u,c,Z,J,m,ee)}return;default:if(Z2(c)){for(var Mt in g)J=g[Mt],g.hasOwnProperty(Mt)&&J!==void 0&&!m.hasOwnProperty(Mt)&&RS(u,c,Mt,void 0,m,J);for(se in m)J=m[se],ee=g[se],!m.hasOwnProperty(se)||J===ee||J===void 0&&ee===void 0||RS(u,c,se,J,m,ee);return}}for(var G in g)J=g[G],g.hasOwnProperty(G)&&J!=null&&!m.hasOwnProperty(G)&&Tt(u,c,G,null,m,J);for(ue in m)J=m[ue],ee=g[ue],!m.hasOwnProperty(ue)||J===ee||J==null&&ee==null||Tt(u,c,ue,J,m,ee)}var zS=null,BS=null;function f1(u){return u.nodeType===9?u:u.ownerDocument}function WN(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QN(u,c){if(u===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&c==="foreignObject"?0:u}function LS(u,c){return u==="textarea"||u==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var jS=null;function cZ(){var u=window.event;return u&&u.type==="popstate"?u===jS?!1:(jS=u,!0):(jS=null,!1)}var ZN=typeof setTimeout=="function"?setTimeout:void 0,fZ=typeof clearTimeout=="function"?clearTimeout:void 0,KN=typeof Promise=="function"?Promise:void 0,dZ=typeof queueMicrotask=="function"?queueMicrotask:typeof KN<"u"?function(u){return KN.resolve(null).then(u).catch(hZ)}:ZN;function hZ(u){setTimeout(function(){throw u})}function Zo(u){return u==="head"}function JN(u,c){var g=c,m=0,x=0;do{var A=g.nextSibling;if(u.removeChild(g),A&&A.nodeType===8)if(g=A.data,g==="/$"){if(0<m&&8>m){g=m;var D=u.ownerDocument;if(g&1&&o0(D.documentElement),g&2&&o0(D.body),g&4)for(g=D.head,o0(g),D=g.firstChild;D;){var N=D.nextSibling,P=D.nodeName;D[Sh]||P==="SCRIPT"||P==="STYLE"||P==="LINK"&&D.rel.toLowerCase()==="stylesheet"||g.removeChild(D),D=N}}if(x===0){u.removeChild(A),p0(c);return}x--}else g==="$"||g==="$?"||g==="$!"?x++:m=g.charCodeAt(0)-48;else m=0;g=A}while(g);p0(c)}function US(u){var c=u.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var g=c;switch(c=c.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":US(g),G2(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}u.removeChild(g)}}function gZ(u,c,g,m){for(;u.nodeType===1;){var x=g;if(u.nodeName.toLowerCase()!==c.toLowerCase()){if(!m&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(m){if(!u[Sh])switch(c){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(A=u.getAttribute("rel"),A==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(A!==x.rel||u.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||u.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||u.getAttribute("title")!==(x.title==null?null:x.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(A=u.getAttribute("src"),(A!==(x.src==null?null:x.src)||u.getAttribute("type")!==(x.type==null?null:x.type)||u.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&A&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(c==="input"&&u.type==="hidden"){var A=x.name==null?null:""+x.name;if(x.type==="hidden"&&u.getAttribute("name")===A)return u}else return u;if(u=ua(u.nextSibling),u===null)break}return null}function pZ(u,c,g){if(c==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!g||(u=ua(u.nextSibling),u===null))return null;return u}function PS(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState==="complete"}function mZ(u,c){var g=u.ownerDocument;if(u.data!=="$?"||g.readyState==="complete")c();else{var m=function(){c(),g.removeEventListener("DOMContentLoaded",m)};g.addEventListener("DOMContentLoaded",m),u._reactRetry=m}}function ua(u){for(;u!=null;u=u.nextSibling){var c=u.nodeType;if(c===1||c===3)break;if(c===8){if(c=u.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return u}var IS=null;function eF(u){u=u.previousSibling;for(var c=0;u;){if(u.nodeType===8){var g=u.data;if(g==="$"||g==="$!"||g==="$?"){if(c===0)return u;c--}else g==="/$"&&c++}u=u.previousSibling}return null}function tF(u,c,g){switch(c=f1(g),u){case"html":if(u=c.documentElement,!u)throw Error(i(452));return u;case"head":if(u=c.head,!u)throw Error(i(453));return u;case"body":if(u=c.body,!u)throw Error(i(454));return u;default:throw Error(i(451))}}function o0(u){for(var c=u.attributes;c.length;)u.removeAttributeNode(c[0]);G2(u)}var jr=new Map,nF=new Set;function d1(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var Ys=I.d;I.d={f:yZ,r:vZ,D:bZ,C:xZ,L:EZ,m:SZ,X:wZ,S:AZ,M:_Z};function yZ(){var u=Ys.f(),c=i1();return u||c}function vZ(u){var c=Wc(u);c!==null&&c.tag===5&&c.type==="form"?S5(c):Ys.r(u)}var Mf=typeof document>"u"?null:document;function iF(u,c,g){var m=Mf;if(m&&typeof c=="string"&&c){var x=Nr(c);x='link[rel="'+u+'"][href="'+x+'"]',typeof g=="string"&&(x+='[crossorigin="'+g+'"]'),nF.has(x)||(nF.add(x),u={rel:u,crossOrigin:g,href:c},m.querySelector(x)===null&&(c=m.createElement("link"),Gn(c,"link",u),Dn(c),m.head.appendChild(c)))}}function bZ(u){Ys.D(u),iF("dns-prefetch",u,null)}function xZ(u,c){Ys.C(u,c),iF("preconnect",u,c)}function EZ(u,c,g){Ys.L(u,c,g);var m=Mf;if(m&&u&&c){var x='link[rel="preload"][as="'+Nr(c)+'"]';c==="image"&&g&&g.imageSrcSet?(x+='[imagesrcset="'+Nr(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(x+='[imagesizes="'+Nr(g.imageSizes)+'"]')):x+='[href="'+Nr(u)+'"]';var A=x;switch(c){case"style":A=kf(u);break;case"script":A=Nf(u)}jr.has(A)||(u=d({rel:"preload",href:c==="image"&&g&&g.imageSrcSet?void 0:u,as:c},g),jr.set(A,u),m.querySelector(x)!==null||c==="style"&&m.querySelector(u0(A))||c==="script"&&m.querySelector(l0(A))||(c=m.createElement("link"),Gn(c,"link",u),Dn(c),m.head.appendChild(c)))}}function SZ(u,c){Ys.m(u,c);var g=Mf;if(g&&u){var m=c&&typeof c.as=="string"?c.as:"script",x='link[rel="modulepreload"][as="'+Nr(m)+'"][href="'+Nr(u)+'"]',A=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Nf(u)}if(!jr.has(A)&&(u=d({rel:"modulepreload",href:u},c),jr.set(A,u),g.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(l0(A)))return}m=g.createElement("link"),Gn(m,"link",u),Dn(m),g.head.appendChild(m)}}}function AZ(u,c,g){Ys.S(u,c,g);var m=Mf;if(m&&u){var x=Qc(m).hoistableStyles,A=kf(u);c=c||"default";var D=x.get(A);if(!D){var N={loading:0,preload:null};if(D=m.querySelector(u0(A)))N.loading=5;else{u=d({rel:"stylesheet",href:u,"data-precedence":c},g),(g=jr.get(A))&&qS(u,g);var P=D=m.createElement("link");Dn(P),Gn(P,"link",u),P._p=new Promise(function(Z,se){P.onload=Z,P.onerror=se}),P.addEventListener("load",function(){N.loading|=1}),P.addEventListener("error",function(){N.loading|=2}),N.loading|=4,h1(D,c,m)}D={type:"stylesheet",instance:D,count:1,state:N},x.set(A,D)}}}function wZ(u,c){Ys.X(u,c);var g=Mf;if(g&&u){var m=Qc(g).hoistableScripts,x=Nf(u),A=m.get(x);A||(A=g.querySelector(l0(x)),A||(u=d({src:u,async:!0},c),(c=jr.get(x))&&HS(u,c),A=g.createElement("script"),Dn(A),Gn(A,"link",u),g.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},m.set(x,A))}}function _Z(u,c){Ys.M(u,c);var g=Mf;if(g&&u){var m=Qc(g).hoistableScripts,x=Nf(u),A=m.get(x);A||(A=g.querySelector(l0(x)),A||(u=d({src:u,async:!0,type:"module"},c),(c=jr.get(x))&&HS(u,c),A=g.createElement("script"),Dn(A),Gn(A,"link",u),g.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},m.set(x,A))}}function rF(u,c,g,m){var x=(x=be.current)?d1(x):null;if(!x)throw Error(i(446));switch(u){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(c=kf(g.href),g=Qc(x).hoistableStyles,m=g.get(c),m||(m={type:"style",instance:null,count:0,state:null},g.set(c,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){u=kf(g.href);var A=Qc(x).hoistableStyles,D=A.get(u);if(D||(x=x.ownerDocument||x,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(u,D),(A=x.querySelector(u0(u)))&&!A._p&&(D.instance=A,D.state.loading=5),jr.has(u)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},jr.set(u,g),A||CZ(x,u,g,D.state))),c&&m===null)throw Error(i(528,""));return D}if(c&&m!==null)throw Error(i(529,""));return null;case"script":return c=g.async,g=g.src,typeof g=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Nf(g),g=Qc(x).hoistableScripts,m=g.get(c),m||(m={type:"script",instance:null,count:0,state:null},g.set(c,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,u))}}function kf(u){return'href="'+Nr(u)+'"'}function u0(u){return'link[rel="stylesheet"]['+u+"]"}function aF(u){return d({},u,{"data-precedence":u.precedence,precedence:null})}function CZ(u,c,g,m){u.querySelector('link[rel="preload"][as="style"]['+c+"]")?m.loading=1:(c=u.createElement("link"),m.preload=c,c.addEventListener("load",function(){return m.loading|=1}),c.addEventListener("error",function(){return m.loading|=2}),Gn(c,"link",g),Dn(c),u.head.appendChild(c))}function Nf(u){return'[src="'+Nr(u)+'"]'}function l0(u){return"script[async]"+u}function sF(u,c,g){if(c.count++,c.instance===null)switch(c.type){case"style":var m=u.querySelector('style[data-href~="'+Nr(g.href)+'"]');if(m)return c.instance=m,Dn(m),m;var x=d({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return m=(u.ownerDocument||u).createElement("style"),Dn(m),Gn(m,"style",x),h1(m,g.precedence,u),c.instance=m;case"stylesheet":x=kf(g.href);var A=u.querySelector(u0(x));if(A)return c.state.loading|=4,c.instance=A,Dn(A),A;m=aF(g),(x=jr.get(x))&&qS(m,x),A=(u.ownerDocument||u).createElement("link"),Dn(A);var D=A;return D._p=new Promise(function(N,P){D.onload=N,D.onerror=P}),Gn(A,"link",m),c.state.loading|=4,h1(A,g.precedence,u),c.instance=A;case"script":return A=Nf(g.src),(x=u.querySelector(l0(A)))?(c.instance=x,Dn(x),x):(m=g,(x=jr.get(A))&&(m=d({},g),HS(m,x)),u=u.ownerDocument||u,x=u.createElement("script"),Dn(x),Gn(x,"link",m),u.head.appendChild(x),c.instance=x);case"void":return null;default:throw Error(i(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(m=c.instance,c.state.loading|=4,h1(m,g.precedence,u));return c.instance}function h1(u,c,g){for(var m=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,A=x,D=0;D<m.length;D++){var N=m[D];if(N.dataset.precedence===c)A=N;else if(A!==x)break}A?A.parentNode.insertBefore(u,A.nextSibling):(c=g.nodeType===9?g.head:g,c.insertBefore(u,c.firstChild))}function qS(u,c){u.crossOrigin==null&&(u.crossOrigin=c.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=c.referrerPolicy),u.title==null&&(u.title=c.title)}function HS(u,c){u.crossOrigin==null&&(u.crossOrigin=c.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=c.referrerPolicy),u.integrity==null&&(u.integrity=c.integrity)}var g1=null;function oF(u,c,g){if(g1===null){var m=new Map,x=g1=new Map;x.set(g,m)}else x=g1,m=x.get(g),m||(m=new Map,x.set(g,m));if(m.has(u))return m;for(m.set(u,null),g=g.getElementsByTagName(u),x=0;x<g.length;x++){var A=g[x];if(!(A[Sh]||A[ni]||u==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var D=A.getAttribute(c)||"";D=u+D;var N=m.get(D);N?N.push(A):m.set(D,[A])}}return m}function uF(u,c,g){u=u.ownerDocument||u,u.head.insertBefore(g,c==="title"?u.querySelector("head > title"):null)}function $Z(u,c,g){if(g===1||c.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return u=c.disabled,typeof c.precedence=="string"&&u==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function lF(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var c0=null;function DZ(){}function TZ(u,c,g){if(c0===null)throw Error(i(475));var m=c0;if(c.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=kf(g.href),A=u.querySelector(u0(x));if(A){u=A._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(m.count++,m=p1.bind(m),u.then(m,m)),c.state.loading|=4,c.instance=A,Dn(A);return}A=u.ownerDocument||u,g=aF(g),(x=jr.get(x))&&qS(g,x),A=A.createElement("link"),Dn(A);var D=A;D._p=new Promise(function(N,P){D.onload=N,D.onerror=P}),Gn(A,"link",g),c.instance=A}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(c,u),(u=c.state.preload)&&(c.state.loading&3)===0&&(m.count++,c=p1.bind(m),u.addEventListener("load",c),u.addEventListener("error",c))}}function MZ(){if(c0===null)throw Error(i(475));var u=c0;return u.stylesheets&&u.count===0&&GS(u,u.stylesheets),0<u.count?function(c){var g=setTimeout(function(){if(u.stylesheets&&GS(u,u.stylesheets),u.unsuspend){var m=u.unsuspend;u.unsuspend=null,m()}},6e4);return u.unsuspend=c,function(){u.unsuspend=null,clearTimeout(g)}}:null}function p1(){if(this.count--,this.count===0){if(this.stylesheets)GS(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var m1=null;function GS(u,c){u.stylesheets=null,u.unsuspend!==null&&(u.count++,m1=new Map,c.forEach(kZ,u),m1=null,p1.call(u))}function kZ(u,c){if(!(c.state.loading&4)){var g=m1.get(u);if(g)var m=g.get(null);else{g=new Map,m1.set(u,g);for(var x=u.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<x.length;A++){var D=x[A];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(g.set(D.dataset.precedence,D),m=D)}m&&g.set(null,m)}x=c.instance,D=x.getAttribute("data-precedence"),A=g.get(D)||m,A===m&&g.set(null,x),g.set(D,x),this.count++,m=p1.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),A?A.parentNode.insertBefore(x,A.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(x,u.firstChild)),c.state.loading|=4}}var f0={$$typeof:_,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function NZ(u,c,g,m,x,A,D,N){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=P2(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P2(0),this.hiddenUpdates=P2(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=A,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function cF(u,c,g,m,x,A,D,N,P,Z,se,ue){return u=new NZ(u,c,g,D,N,P,Z,ue),c=1,A===!0&&(c|=24),A=cr(3,null,null,c),u.current=A,A.stateNode=u,c=CE(),c.refCount++,u.pooledCache=c,c.refCount++,A.memoizedState={element:m,isDehydrated:g,cache:c},ME(A),u}function fF(u){return u?(u=lf,u):lf}function dF(u,c,g,m,x,A){x=fF(x),m.context===null?m.context=x:m.pendingContext=x,m=Lo(c),m.payload={element:g},A=A===void 0?null:A,A!==null&&(m.callback=A),g=jo(u,m,c),g!==null&&(pr(g,u,c),Ph(g,u,c))}function hF(u,c){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<c?g:c}}function YS(u,c){hF(u,c),(u=u.alternate)&&hF(u,c)}function gF(u){if(u.tag===13){var c=uf(u,67108864);c!==null&&pr(c,u,67108864),YS(u,67108864)}}var y1=!0;function FZ(u,c,g,m){var x=O.T;O.T=null;var A=I.p;try{I.p=2,VS(u,c,g,m)}finally{I.p=A,O.T=x}}function OZ(u,c,g,m){var x=O.T;O.T=null;var A=I.p;try{I.p=8,VS(u,c,g,m)}finally{I.p=A,O.T=x}}function VS(u,c,g,m){if(y1){var x=XS(m);if(x===null)OS(u,c,m,v1,g),mF(u,m);else if(zZ(x,u,c,g,m))m.stopPropagation();else if(mF(u,m),c&4&&-1<RZ.indexOf(u)){for(;x!==null;){var A=Wc(x);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var D=al(A.pendingLanes);if(D!==0){var N=A;for(N.pendingLanes|=2,N.entangledLanes|=2;D;){var P=1<<31-ur(D);N.entanglements[1]|=P,D&=~P}Ya(A),(St&6)===0&&(t1=dn()+500,r0(0))}}break;case 13:N=uf(A,2),N!==null&&pr(N,A,2),i1(),YS(A,2)}if(A=XS(m),A===null&&OS(u,c,m,v1,g),A===x)break;x=A}x!==null&&m.stopPropagation()}else OS(u,c,m,null,g)}}function XS(u){return u=J2(u),WS(u)}var v1=null;function WS(u){if(v1=null,u=Xc(u),u!==null){var c=a(u);if(c===null)u=null;else{var g=c.tag;if(g===13){if(u=s(c),u!==null)return u;u=null}else if(g===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;u=null}else c!==u&&(u=null)}}return v1=u,null}function pF(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lm()){case T6:return 2;case M6:return 8;case cm:case EW:return 32;case k6:return 268435456;default:return 32}default:return 32}}var QS=!1,Ko=null,Jo=null,eu=null,d0=new Map,h0=new Map,tu=[],RZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mF(u,c){switch(u){case"focusin":case"focusout":Ko=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":eu=null;break;case"pointerover":case"pointerout":d0.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":h0.delete(c.pointerId)}}function g0(u,c,g,m,x,A){return u===null||u.nativeEvent!==A?(u={blockedOn:c,domEventName:g,eventSystemFlags:m,nativeEvent:A,targetContainers:[x]},c!==null&&(c=Wc(c),c!==null&&gF(c)),u):(u.eventSystemFlags|=m,c=u.targetContainers,x!==null&&c.indexOf(x)===-1&&c.push(x),u)}function zZ(u,c,g,m,x){switch(c){case"focusin":return Ko=g0(Ko,u,c,g,m,x),!0;case"dragenter":return Jo=g0(Jo,u,c,g,m,x),!0;case"mouseover":return eu=g0(eu,u,c,g,m,x),!0;case"pointerover":var A=x.pointerId;return d0.set(A,g0(d0.get(A)||null,u,c,g,m,x)),!0;case"gotpointercapture":return A=x.pointerId,h0.set(A,g0(h0.get(A)||null,u,c,g,m,x)),!0}return!1}function yF(u){var c=Xc(u.target);if(c!==null){var g=a(c);if(g!==null){if(c=g.tag,c===13){if(c=s(g),c!==null){u.blockedOn=c,TW(u.priority,function(){if(g.tag===13){var m=gr();m=I2(m);var x=uf(g,m);x!==null&&pr(x,g,m),YS(g,m)}});return}}else if(c===3&&g.stateNode.current.memoizedState.isDehydrated){u.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}u.blockedOn=null}function b1(u){if(u.blockedOn!==null)return!1;for(var c=u.targetContainers;0<c.length;){var g=XS(u.nativeEvent);if(g===null){g=u.nativeEvent;var m=new g.constructor(g.type,g);K2=m,g.target.dispatchEvent(m),K2=null}else return c=Wc(g),c!==null&&gF(c),u.blockedOn=g,!1;c.shift()}return!0}function vF(u,c,g){b1(u)&&g.delete(c)}function BZ(){QS=!1,Ko!==null&&b1(Ko)&&(Ko=null),Jo!==null&&b1(Jo)&&(Jo=null),eu!==null&&b1(eu)&&(eu=null),d0.forEach(vF),h0.forEach(vF)}function x1(u,c){u.blockedOn===c&&(u.blockedOn=null,QS||(QS=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,BZ)))}var E1=null;function bF(u){E1!==u&&(E1=u,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){E1===u&&(E1=null);for(var c=0;c<u.length;c+=3){var g=u[c],m=u[c+1],x=u[c+2];if(typeof m!="function"){if(WS(m||g)===null)continue;break}var A=Wc(g);A!==null&&(u.splice(c,3),c-=3,WE(A,{pending:!0,data:x,method:g.method,action:m},m,x))}}))}function p0(u){function c(P){return x1(P,u)}Ko!==null&&x1(Ko,u),Jo!==null&&x1(Jo,u),eu!==null&&x1(eu,u),d0.forEach(c),h0.forEach(c);for(var g=0;g<tu.length;g++){var m=tu[g];m.blockedOn===u&&(m.blockedOn=null)}for(;0<tu.length&&(g=tu[0],g.blockedOn===null);)yF(g),g.blockedOn===null&&tu.shift();if(g=(u.ownerDocument||u).$$reactFormReplay,g!=null)for(m=0;m<g.length;m+=3){var x=g[m],A=g[m+1],D=x[Ui]||null;if(typeof A=="function")D||bF(g);else if(D){var N=null;if(A&&A.hasAttribute("formAction")){if(x=A,D=A[Ui]||null)N=D.formAction;else if(WS(x)!==null)continue}else N=D.action;typeof N=="function"?g[m+1]=N:(g.splice(m,3),m-=3),bF(g)}}}function ZS(u){this._internalRoot=u}S1.prototype.render=ZS.prototype.render=function(u){var c=this._internalRoot;if(c===null)throw Error(i(409));var g=c.current,m=gr();dF(g,m,u,c,null,null)},S1.prototype.unmount=ZS.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var c=u.containerInfo;dF(u.current,2,null,u,null,null),i1(),c[Vc]=null}};function S1(u){this._internalRoot=u}S1.prototype.unstable_scheduleHydration=function(u){if(u){var c=z6();u={blockedOn:null,target:u,priority:c};for(var g=0;g<tu.length&&c!==0&&c<tu[g].priority;g++);tu.splice(g,0,u),g===0&&yF(u)}};var xF=t.version;if(xF!=="19.1.0")throw Error(i(527,xF,"19.1.0"));I.findDOMNode=function(u){var c=u._reactInternals;if(c===void 0)throw typeof u.render=="function"?Error(i(188)):(u=Object.keys(u).join(","),Error(i(268,u)));return u=l(c),u=u!==null?f(u):null,u=u===null?null:u.stateNode,u};var LZ={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var A1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!A1.isDisabled&&A1.supportsFiber)try{bh=A1.inject(LZ),or=A1}catch{}}return y0.createRoot=function(u,c){if(!r(u))throw Error(i(299));var g=!1,m="",x=z5,A=B5,D=L5,N=null;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(N=c.unstable_transitionCallbacks)),c=cF(u,1,!1,null,null,g,m,x,A,D,N,null),u[Vc]=c.current,FS(u),new ZS(c)},y0.hydrateRoot=function(u,c,g){if(!r(u))throw Error(i(299));var m=!1,x="",A=z5,D=B5,N=L5,P=null,Z=null;return g!=null&&(g.unstable_strictMode===!0&&(m=!0),g.identifierPrefix!==void 0&&(x=g.identifierPrefix),g.onUncaughtError!==void 0&&(A=g.onUncaughtError),g.onCaughtError!==void 0&&(D=g.onCaughtError),g.onRecoverableError!==void 0&&(N=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(P=g.unstable_transitionCallbacks),g.formState!==void 0&&(Z=g.formState)),c=cF(u,1,!0,c,g??null,m,x,A,D,N,P,Z),c.context=fF(null),g=c.current,m=gr(),m=I2(m),x=Lo(m),x.callback=null,jo(g,x,m),g=m,c.current.lanes=g,Eh(c,g),Ya(c),u[Vc]=c.current,FS(u),new S1(c)},y0.version="19.1.0",y0}var OF;function QZ(){if(OF)return tA.exports;OF=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),tA.exports=WZ(),tA.exports}var ZZ=QZ();/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KZ=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JZ=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),RF=e=>{const t=JZ(e);return t.charAt(0).toUpperCase()+t.slice(1)},sB=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),eK=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nK=_e.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:a,iconNode:s,...o},l)=>_e.createElement("svg",{ref:l,...tK,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:sB("lucide",r),...!a&&!eK(o)&&{"aria-hidden":"true"},...o},[...s.map(([f,d])=>_e.createElement(f,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=(e,t)=>{const n=_e.forwardRef(({className:i,...r},a)=>_e.createElement(nK,{ref:a,iconNode:t,className:sB(`lucide-${KZ(RF(e))}`,`lucide-${e}`,i),...r}));return n.displayName=RF(e),n};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iK=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],aA=Sb("chart-column",iK);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],aK=Sb("globe",rK);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sK=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],oB=Sb("package",sK);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],n$=Sb("search",oK),uK=({sidebarCollapsed:e,setSidebarCollapsed:t,queries:n,activeQueryId:i,handleNewQuery:r,handleLoadQuery:a,handleDeleteQuery:s,getQueryDisplayName:o,selectedProducts:l})=>j.jsxs("div",{className:`${e?"w-16":"w-72"} bg-gray-800 border-r border-gray-700 transition-all duration-300 flex flex-col flex-shrink-0`,children:[j.jsxs("div",{className:"p-4",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[!e&&j.jsxs("h1",{className:"text-lg font-bold text-white flex items-center",children:[j.jsx(aA,{className:"w-5 h-5 mr-2 text-blue-400"}),"TradeLens",j.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-medium bg-orange-600 text-white rounded-full",children:"Beta"})]}),e&&j.jsx("div",{className:"flex justify-center w-full",children:j.jsx(aA,{className:"w-6 h-6 text-blue-400"})}),e?j.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-white p-1 rounded hover:bg-gray-700 transition-colors",children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}):j.jsx("button",{onClick:()=>t(!0),className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-gray-700 transition-colors flex-shrink-0",children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})})]}),j.jsxs("button",{onClick:r,disabled:l.length===0,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2 px-4 py-3",title:e?"New Query":"",children:[j.jsx(n$,{className:"w-4 h-4 flex-shrink-0"}),!e&&j.jsx("span",{className:"text-sm",children:"New Query"})]})]}),j.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-6",children:[!e&&j.jsxs("h3",{className:"text-xs font-medium text-gray-400 uppercase tracking-wide mb-4",children:["Saved Queries (",n.length,")"]}),n.length===0?!e&&j.jsxs("div",{className:"text-center py-8",children:[j.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-3",children:j.jsx(aA,{className:"w-6 h-6 text-gray-500"})}),j.jsx("p",{className:"text-gray-500 text-sm",children:"No queries yet"}),j.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Create your first query to get started"})]}):j.jsx("div",{className:"space-y-2",children:n.map(f=>j.jsx("div",{className:`p-3 rounded-lg border transition-colors cursor-pointer group relative ${i===f.id?"bg-blue-600 border-blue-500 text-white":"bg-gray-700 border-gray-600 text-gray-300 hover:bg-gray-600"}`,onClick:()=>a(f),title:e?o(f):"",children:e?j.jsx("div",{className:"flex items-center justify-center",children:j.jsx("div",{className:`w-3 h-3 rounded-full ${i===f.id?"bg-white":"bg-gray-400"}`})}):j.jsxs("div",{className:"flex items-start justify-between",children:[j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsx("div",{className:"font-medium text-sm truncate",children:f.name}),j.jsx("div",{className:"text-xs opacity-75 mt-1 line-clamp-2 leading-tight",children:o(f)}),j.jsx("div",{className:"text-xs opacity-60 mt-2",children:f.createdAt.toLocaleDateString()})]}),j.jsx("button",{onClick:d=>{d.stopPropagation(),s(f.id)},className:"text-gray-400 hover:text-red-400 ml-2 p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})},f.id))})]})]}),lK=({availableDatasets:e,selectedDataset:t,onDatasetChange:n})=>{const i={baci:{id:"baci",name:"BACI",title:"Trade flows",yearRange:"2017-2022",description:"Annual trade flows for HS6 products.",speed:"Fast",speedIcon:"",borderColor:"blue"},prodcom:{id:"prodcom",name:"PRODCOM",title:"Manufacturers' Sales",yearRange:"2014-2024",description:"Annual sales for UK manufacturers by CN8 product.",speed:"Manufacturing",speedIcon:"",borderColor:"purple"}};return j.jsx("div",{className:"mb-8 flex gap-6 flex-wrap",children:e.map(r=>{const a=i[r];return a?j.jsxs("button",{className:`rounded-lg border-2 border-gray-700 bg-gray-800 px-8 py-6 flex flex-col items-start min-w-[220px] shadow-lg transition-all ${t===r?`border-${a.borderColor}-500 ring-2 ring-${a.borderColor}-500`:`hover:border-${a.borderColor}-400`}`,onClick:()=>n(r),children:[j.jsx("div",{className:"flex items-center gap-2 mb-2",children:j.jsx("span",{className:"text-base font-bold",children:a.name})}),j.jsx("div",{className:"text-lg font-semibold mb-1",children:a.title}),j.jsx("div",{className:"text-sm text-gray-300 mb-1",children:a.yearRange}),j.jsx("div",{className:"text-sm text-gray-400 mb-4",children:a.description}),j.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-2 border-t border-gray-700 w-full",children:[j.jsx("span",{className:`text-lg text-${a.borderColor}-400`,children:a.speedIcon}),j.jsx("span",{className:`text-xs text-${a.borderColor}-400`,children:a.speed})]})]},r):null})})},cK=({config:e,selectedProducts:t,productSearch:n,onProductSearch:i,showProductSuggestions:r,productSuggestions:a,onSelectProduct:s,onRemoveProduct:o,tradeType:l,onTradeTypeChange:f,fromCountries:d,fromCountrySearch:h,onFromCountrySearch:p,showFromCountrySuggestions:y,countrySuggestions:v,onSelectFromCountry:b,onRemoveFromCountry:E,toCountries:S,toCountrySearch:w,onToCountrySearch:_,showToCountrySuggestions:C,onSelectToCountry:$,onRemoveToCountry:M,onShowFromCountrySuggestions:T,onShowToCountrySuggestions:F,startYear:R,onStartYearChange:B,endYear:L,onEndYearChange:Y,onExecuteQuery:H,disabled:U=!1})=>{var W,K;if(!e)return null;const z=k=>{var le,be,Ye,it;const V=k[e.product.codeField]||"",X=k[e.product.nameField]||k.description||"",ne=((le=e.ui)==null?void 0:le.productNameTruncate)||12;return((it=(Ye=(be=e.ui)==null?void 0:be.productPillFormat)==null?void 0:Ye.replace("{code}",V))==null?void 0:it.replace("{name}",X.length>ne?X.slice(0,ne)+"...":X))||`${V}:${X.length>ne?X.slice(0,ne)+"...":X}`},O=k=>k[e.product.codeField],I=k=>k[e.country.nameField]||k;return j.jsxs("div",{className:"space-y-8",children:[j.jsx("div",{children:j.jsxs("div",{className:"relative",children:[j.jsx(oB,{className:"absolute left-0 top-1/2 transform -translate-y-1/2 text-gray-400 w-6 h-6 z-10"}),j.jsxs("div",{className:"pl-8 pr-4 py-4 min-h-[60px] flex flex-wrap gap-3 items-center border-b-2 border-gray-600 focus-within:border-blue-500 transition-colors bg-transparent",children:[t.map(k=>j.jsxs("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-full flex items-center gap-2 text-sm font-medium",children:[j.jsx("span",{children:z(k)}),j.jsx("button",{onClick:()=>o(O(k)),className:"text-blue-200 hover:text-white text-lg leading-none",children:""})]},O(k))),j.jsx("input",{type:"text",value:n,onChange:k=>i(k.target.value),placeholder:"Search by products, services, commodity codes, and e.t.c",className:"flex-1 bg-transparent text-white text-xl placeholder-gray-400 focus:outline-none min-w-64 border-none",disabled:U})]}),r&&a.length>0&&j.jsx("div",{className:"absolute top-full left-0 right-0 bg-gray-700 border border-gray-600 rounded-lg mt-2 shadow-xl z-20 max-h-64 overflow-y-auto",children:a.slice(0,e.product.defaultLimit).map((k,V)=>j.jsxs("button",{onClick:()=>s(k),className:"w-full text-left px-6 py-4 hover:bg-gray-600 text-white border-b border-gray-600 last:border-b-0 transition-colors flex flex-col items-start",children:[j.jsx("span",{className:"text-sm text-gray-400 truncate",children:k[e.product.codeField]||k.product_code}),j.jsx("span",{className:"font-medium text-lg",children:k[e.product.nameField]||k.description})]},V))})]})}),e.query.tradeTypeOptions&&e.query.tradeTypeOptions.length>0&&j.jsxs("div",{children:[j.jsx("h4",{className:"text-xl text-gray-400 mb-4",children:"Looking for..."}),j.jsx("div",{className:"flex gap-4",children:e.query.tradeTypeOptions.map(k=>j.jsx("button",{onClick:()=>f(k),disabled:U,className:`px-6 py-3 rounded-full font-medium text-base transition-colors ${l===k?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"} ${U?"opacity-50 cursor-not-allowed":""}`,children:k.replace("Trade: ","")},k))})]}),j.jsxs("div",{children:[j.jsx("h4",{className:"text-xl text-gray-400 mb-4",children:"Location..."}),j.jsxs("div",{className:"flex items-end gap-6",children:[j.jsxs("div",{className:"relative flex-1",children:[j.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:d.map(k=>j.jsxs("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-full flex items-center gap-2 text-sm font-medium",children:[j.jsx("span",{children:k}),j.jsx("button",{onClick:()=>E(k),className:"text-blue-200 hover:text-white text-lg leading-none",children:""})]},k))}),j.jsxs("div",{className:"relative",children:[j.jsx("input",{type:"text",value:h,onChange:k=>p(k.target.value),onFocus:()=>T(!0),onBlur:()=>T(!1),className:"w-full bg-transparent text-white text-lg placeholder-gray-400 focus:outline-none border-b-2 border-gray-600 focus:border-blue-500 transition-colors py-3",placeholder:"Add exporter country...",disabled:U}),y&&j.jsx("div",{className:"absolute top-full left-0 right-0 bg-gray-700 border border-gray-600 rounded-lg mt-2 shadow-xl z-20 max-h-48 overflow-y-auto",children:v.slice(0,e.country.defaultLimit).map((k,V)=>j.jsx("button",{onMouseDown:X=>{X.preventDefault(),b(I(k))},className:"w-full text-left px-4 py-3 hover:bg-gray-600 text-white border-b border-gray-600 last:border-b-0",children:I(k)},V))})]})]}),j.jsx("div",{className:"text-gray-400 text-lg pb-3",children:"to"}),j.jsxs("div",{className:"relative flex-1",children:[j.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:S.map(k=>j.jsxs("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-full flex items-center gap-2 text-sm font-medium",children:[j.jsx("span",{children:k}),j.jsx("button",{onClick:()=>M(k),className:"text-blue-200 hover:text-white text-lg leading-none",children:""})]},k))}),j.jsxs("div",{className:"relative",children:[j.jsx("input",{type:"text",value:w,onChange:k=>_(k.target.value),onFocus:()=>F(!0),onBlur:()=>F(!1),className:"w-full bg-transparent text-white text-lg placeholder-gray-400 focus:outline-none border-b-2 border-gray-600 focus:border-blue-500 transition-colors py-3",placeholder:"Add importer country...",disabled:U}),C&&j.jsxs("div",{className:"absolute top-full left-0 right-0 bg-gray-700 border border-gray-600 rounded-lg mt-2 shadow-xl z-20 max-h-48 overflow-y-auto",children:[!w&&((W=e.ui)==null?void 0:W.showEverywhereOption)&&j.jsxs(j.Fragment,{children:[j.jsxs("button",{onMouseDown:k=>{k.preventDefault(),$("Everywhere")},className:"w-full text-left px-4 py-3 hover:bg-gray-600 text-white border-b border-gray-600 font-medium",children:[j.jsx("div",{className:"font-medium",children:"Everywhere"}),j.jsx("div",{className:"text-xs text-gray-400",children:"Individual country records"})]}),((K=e.ui)==null?void 0:K.showWorldOption)&&j.jsxs("button",{onMouseDown:k=>{k.preventDefault(),$("World")},className:"w-full text-left px-4 py-3 hover:bg-gray-600 text-white border-b border-gray-600 font-medium",children:[j.jsx("div",{className:"font-medium",children:"World"}),j.jsx("div",{className:"text-xs text-gray-400",children:"Aggregated global data"})]})]}),v.map((k,V)=>j.jsx("button",{onMouseDown:X=>{X.preventDefault(),$(I(k))},className:"w-full text-left px-4 py-3 hover:bg-gray-600 text-white border-b border-gray-600 last:border-b-0",children:I(k)},V))]})]})]})]})]}),j.jsxs("div",{children:[j.jsx("h4",{className:"text-xl text-gray-400 mb-4",children:"Between..."}),j.jsxs("div",{className:"flex items-end gap-6 max-w-md",children:[j.jsx("div",{className:"flex-1",children:j.jsx("select",{value:R,onChange:k=>B(k.target.value),className:"w-full bg-transparent text-white text-lg focus:outline-none border-b-2 border-gray-600 focus:border-blue-500 transition-colors py-3 appearance-none",disabled:U,children:(()=>{var V;const k=(V=e.query)==null?void 0:V.yearRange;return k?Array.from({length:k.max-k.min+1},(X,ne)=>k.max-ne).map(X=>j.jsx("option",{value:X,className:"bg-gray-700",children:X},X)):Array.from({length:15},(X,ne)=>2024-ne).map(X=>j.jsx("option",{value:X,className:"bg-gray-700",children:X},X))})()})}),j.jsx("div",{className:"text-gray-400 text-lg pb-3",children:"and"}),j.jsx("div",{className:"flex-1",children:j.jsx("select",{value:L,onChange:k=>Y(k.target.value),className:"w-full bg-transparent text-white text-lg focus:outline-none border-b-2 border-gray-600 focus:border-blue-500 transition-colors py-3 appearance-none",disabled:U,children:(()=>{var V;const k=(V=e.query)==null?void 0:V.yearRange;return k?Array.from({length:k.max-k.min+1},(X,ne)=>k.max-ne).map(X=>j.jsx("option",{value:X,className:"bg-gray-700",children:X},X)):Array.from({length:15},(X,ne)=>2024-ne).map(X=>j.jsx("option",{value:X,className:"bg-gray-700",children:X},X))})()})})]})]}),j.jsx("div",{children:j.jsxs("button",{onClick:H,disabled:U||t.length===0,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-8 py-3 rounded-lg font-medium text-lg transition-colors flex items-center gap-3",children:[j.jsx(n$,{className:"w-5 h-5"}),"Search"]})})]})},fK="baci",dK="BACI Trade Database",hK="International trade data by product and country, based on BACI HS17 taxonomy.",gK={products:"/api/products",countries:"/api/countries",tradeQuery:"/api/trade-query"},pK={searchParam:"search",productTypeParam:"product_type",productType:"hs6_products",codeField:"code",nameField:"name",limitParam:"limit",defaultLimit:8},mK={searchParam:"search",codeField:"code",nameField:"country_name",limitParam:"limit",defaultLimit:10},yK={tradeTypeOptions:[],defaultTradeType:"exports",defaultStartYear:"2020",defaultEndYear:"2022",yearRange:{min:2017,max:2022},defaultRowsPerPage:10,params:{trade_type:"trade_type",product_codes:"product_codes",from_country:"from_country",to_country:"to_country",year_from:"year_from",year_to:"year_to",page:"page",page_size:"page_size"}},vK={showEverywhereOption:!0,showWorldOption:!1,productPillFormat:"{code}:{name}",productNameTruncate:12},bK={id:fK,name:dK,description:hK,endpoints:gK,product:pK,country:mK,query:yK,ui:vK},xK="prodcom",EK="PRODCOM Manufacturing Database",SK="EU manufacturer sales data by CN8 product classification.",AK={products:"/api/products",countries:"/api/countries",tradeQuery:"/api/prodcom-query"},wK={searchParam:"search",productTypeParam:"product_type",productType:"cn8_products",codeField:"code",nameField:"description",limitParam:"limit",defaultLimit:8},_K={searchParam:"search",codeField:"code",nameField:"country_name",limitParam:"limit",defaultLimit:10},CK={tradeTypeOptions:["Value","Volume","Other"],defaultTradeType:"Value",defaultStartYear:"2020",defaultEndYear:"2024",defaultRowsPerPage:10,params:{measure:"measure",product_codes:"product_codes",year_from:"year_from",year_to:"year_to",page:"page",page_size:"page_size"}},$K={showEverywhereOption:!1,showWorldOption:!1,productPillFormat:"{code}:{name}",productNameTruncate:12},DK={id:xK,name:EK,description:SK,endpoints:AK,product:wK,country:_K,query:CK,ui:$K},TK="https://api.tradelens.uk",MK={apiBase:TK},lp=e=>{const[t,n]=_e.useState(null),[i,r]=_e.useState(!0),[a,s]=_e.useState(null);return _e.useEffect(()=>{(async()=>{try{r(!0);let l;switch(e){case"baci":l=bK;break;case"prodcom":l=DK;break;default:throw new Error(`Unknown dataset: ${e}`)}const f={...l,apiBase:MK.apiBase};n(f),s(null)}catch(l){s(l.message),n(null)}finally{r(!1)}})()},[e]),{config:t,loading:i,error:a}},cp=e=>{const[t,n]=_e.useState([]),[i,r]=_e.useState([]),[a,s]=_e.useState(!1),[o,l]=_e.useState(!1),[f,d]=_e.useState({});_e.useEffect(()=>{if(!e)return;(async()=>{try{const w=await(await fetch(`${e.apiBase}${e.endpoints.countries}?limit=1000`)).json(),_={};w.forEach(C=>{C[e.country.nameField]&&C[e.country.codeField]&&(_[C[e.country.nameField]]=C[e.country.codeField])}),d(_)}catch(S){console.error("Failed to load country code map:",S)}})()},[e]);const h=_e.useCallback(async(E,S=null)=>{if(!e||!E){n([]);return}s(!0);try{const w=new URLSearchParams({[e.product.searchParam]:E,[e.product.limitParam]:e.product.defaultLimit});e.product.productTypeParam&&e.product.productType&&w.append(e.product.productTypeParam,e.product.productType),S&&w.append("type",S);const C=await(await fetch(`${e.apiBase}${e.endpoints.products}?${w}`)).json();n(C)}catch(w){console.error("Failed to search products:",w),n([])}finally{s(!1)}},[e]),p=_e.useCallback(async E=>{if(!e){r([]);return}l(!0);try{const S=new URLSearchParams({[e.country.searchParam]:E||"",[e.country.limitParam]:e.country.defaultLimit}),_=await(await fetch(`${e.apiBase}${e.endpoints.countries}?${S}`)).json();r(_)}catch(S){console.error("Failed to search countries:",S),r([])}finally{l(!1)}},[e]),y=_e.useCallback(async(E,S=1,w=10)=>{if(!e)return{data:[],total_records:0,total_pages:1,apiUrl:""};try{const _=new URLSearchParams({[e.query.params.trade_type]:E.tradeType,[e.query.params.product_codes]:E.productCodes,[e.query.params.from_country]:E.fromCountry,[e.query.params.to_country]:E.toCountry,[e.query.params.year_from]:E.yearFrom,[e.query.params.year_to]:E.yearTo,[e.query.params.page]:S,[e.query.params.page_size]:w}),C=`${e.apiBase}${e.endpoints.tradeQuery}?${_}`;return{...await(await fetch(C)).json(),apiUrl:C}}catch(_){return console.error("Failed to execute trade query:",_),{data:[],total_records:0,total_pages:1,apiUrl:""}}},[e]),v=_e.useCallback(async(E,S=1,w=10)=>{if(!e)return{data:[],total_records:0,total_pages:1};try{const _=new URLSearchParams({[e.query.params.product_codes]:E.productCodes,[e.query.params.year_from]:E.yearFrom,[e.query.params.year_to]:E.yearTo,[e.query.params.measure]:E.measure,[e.query.params.page]:S,[e.query.params.page_size]:w});return await(await fetch(`${e.apiBase}${e.endpoints.tradeQuery}?${_}`)).json()}catch(_){return console.error("Failed to execute PRODCOM query:",_),{data:[],total_records:0,total_pages:1}}},[e]),b=_e.useCallback(E=>E?f[E]||E:"",[f]);return{productSuggestions:t,countrySuggestions:i,productLoading:a,countryLoading:o,searchProducts:h,searchCountries:p,executeTradeQuery:y,executeProdcomQuery:v,getCountryCodeByName:b}},kK=({onQueryCreated:e,disabled:t=!1,initialState:n={}})=>{const{config:i,loading:r,error:a}=lp("baci"),s=cp(i),[o,l]=_e.useState(n.selectedProducts||[]),[f,d]=_e.useState(""),[h,p]=_e.useState(!1),[y,v]=_e.useState(n.fromCountries||[]),[b,E]=_e.useState(""),[S,w]=_e.useState(!1),[_,C]=_e.useState(n.toCountries||[]),[$,M]=_e.useState(""),[T,F]=_e.useState(!1),[R,B]=_e.useState(n.tradeType||"exports"),[L,Y]=_e.useState(n.startYear||"2020"),[H,U]=_e.useState(n.endYear||"2022");_e.useEffect(()=>{f&&i?(s.searchProducts(f),p(!0)):p(!1)},[f,i,s.searchProducts]),_e.useEffect(()=>{if(i&&(b||$||S||T)){const le=b||$||"";s.searchCountries(le)}},[b,$,S,T,i,s.searchCountries]);const z=le=>{d(le)},O=le=>{const be=le[i==null?void 0:i.product.codeField];o.find(Ye=>Ye[i==null?void 0:i.product.codeField]===be)||l([...o,le]),d(""),p(!1)},I=le=>{l(o.filter(be=>be[i==null?void 0:i.product.codeField]!==le))},W=le=>{E(le)},K=le=>{const be=typeof le=="string"?le:le.country_name;y.find(Ye=>(typeof Ye=="string"?Ye:Ye.country_name)===be)||v([...y,le]),E(""),w(!1)},k=le=>{const be=typeof le=="string"?le:le.country_name;v(y.filter(Ye=>(typeof Ye=="string"?Ye:Ye.country_name)!==be))},V=le=>{M(le)},X=le=>{const be=typeof le=="string"?le:le.country_name;_.find(Ye=>(typeof Ye=="string"?Ye:Ye.country_name)===be)||C([..._,le]),M(""),F(!1)},ne=le=>{const be=typeof le=="string"?le:le.country_name;C(_.filter(Ye=>(typeof Ye=="string"?Ye:Ye.country_name)!==be))},ye=()=>{if(o.length===0)return;const le={id:Date.now(),dataset:"baci",name:`BACI Query ${Date.now()}`,tradeType:R,products:o,fromCountries:y,toCountries:_,startYear:L,endYear:H,createdAt:new Date};e==null||e(le)};return r?j.jsx("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:j.jsx("div",{className:"text-center",children:"Loading BACI configuration..."})}):a?j.jsx("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:j.jsxs("div",{className:"text-center text-red-400",children:["Error loading BACI configuration: ",a]})}):j.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:[j.jsx("div",{className:"mb-6 p-4 bg-gray-700 rounded-lg border border-gray-600",children:j.jsxs("p",{className:"text-sm text-gray-300 leading-relaxed",children:["Search CEPII BACI data (based on UN Comtrade), available at"," ",j.jsx("a",{href:"https://www.cepii.fr/CEPII/en/bdd_modele/bdd_modele_item.asp?id=37",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"CEPII.fr"}),". The data in the Beta version ranges from 2017-2022 and is based on HS17 product classifications. Note that data may be missing where data values have been suppressed."]})}),j.jsx(cK,{config:i,selectedProducts:o,productSearch:f,onProductSearch:z,showProductSuggestions:h,productSuggestions:s.productSuggestions,onSelectProduct:O,onRemoveProduct:I,tradeType:R,onTradeTypeChange:B,fromCountries:y,fromCountrySearch:b,onFromCountrySearch:W,showFromCountrySuggestions:S,countrySuggestions:s.countrySuggestions,onSelectFromCountry:K,onRemoveFromCountry:k,toCountries:_,toCountrySearch:$,onToCountrySearch:V,showToCountrySuggestions:T,onSelectToCountry:X,onRemoveToCountry:ne,onShowFromCountrySuggestions:w,onShowToCountrySuggestions:F,startYear:L,onStartYearChange:Y,endYear:H,onEndYearChange:U,onExecuteQuery:ye,disabled:t})]})},NK=({onQueryCreated:e,disabled:t=!1,initialState:n={}})=>{const{config:i,loading:r,error:a}=lp("prodcom"),s=cp(i),[o,l]=_e.useState(n.selectedProducts||[]),[f,d]=_e.useState(""),[h,p]=_e.useState(!1),[y,v]=_e.useState(n.productTypeFilter||"Product"),[b,E]=_e.useState(n.measureType||"Value"),[S,w]=_e.useState(n.startYear||"2020"),[_,C]=_e.useState(n.endYear||"2024");_e.useEffect(()=>{f&&i?(s.searchProducts(f,y),p(!0)):p(!1)},[f,y,i,s.searchProducts]);const $=B=>{d(B)},M=B=>{const L=B[i==null?void 0:i.product.codeField];o.find(Y=>Y[i==null?void 0:i.product.codeField]===L)||l([...o,B]),d(""),p(!1)},T=B=>{l(o.filter(L=>L[i==null?void 0:i.product.codeField]!==B))},F=B=>{v(B),f&&s.searchProducts(f,B)},R=()=>{if(o.length===0)return;const B={id:Date.now(),dataset:"prodcom",name:`PRODCOM Query ${Date.now()}`,measureType:b,products:o,productTypeFilter:y,startYear:S,endYear:_,createdAt:new Date};e==null||e(B)};return r?j.jsx("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:j.jsx("div",{className:"text-center",children:"Loading PRODCOM configuration..."})}):a?j.jsx("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:j.jsxs("div",{className:"text-center text-red-400",children:["Error loading PRODCOM configuration: ",a]})}):j.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:[j.jsx("div",{className:"mb-6 p-4 bg-gray-700 rounded-lg border border-gray-600",children:j.jsxs("p",{className:"text-sm text-gray-300 leading-relaxed",children:["Search ONS UK manufacturers' sales by product data, available at"," ",j.jsx("a",{href:"https://www.ons.gov.uk/businessindustryandtrade/manufacturingandproductionindustry/datasets/ukmanufacturerssalesbyproductprodcom",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"ONS.gov.uk"}),". Data in the Beta version ranges from 2014-2024. Note that data may be missing where data values have been suppressed or were not collected."]})}),j.jsxs("div",{className:"space-y-8",children:[j.jsxs("div",{children:[j.jsx("h3",{className:"text-3xl font-medium text-gray-300 mb-6",children:"What are you looking for?"}),j.jsx("div",{className:"mb-6",children:j.jsx("div",{className:"flex gap-2",children:["Division","Industry","Product"].map(B=>j.jsx("button",{onClick:()=>F(B),className:`px-4 py-2 text-base rounded-md border transition-colors ${y===B?"bg-purple-600 border-purple-500 text-white":"bg-gray-700 border-gray-600 text-gray-300 hover:bg-gray-600"}`,disabled:t,children:B},B))})}),j.jsxs("div",{className:"relative",children:[j.jsx(oB,{className:"absolute left-0 top-1/2 transform -translate-y-1/2 text-gray-400 w-6 h-6 z-10"}),j.jsxs("div",{className:"pl-8 pr-4 py-4 min-h-[60px] flex flex-wrap gap-3 items-center border-b-2 border-gray-600 focus-within:border-purple-500 transition-colors bg-transparent",children:[o.map(B=>{var L;return j.jsxs("div",{className:"bg-purple-600 text-white px-3 py-1 rounded-full flex items-center gap-2 text-sm font-medium",children:[j.jsxs("span",{children:[B[i==null?void 0:i.product.codeField],":",(L=B[i==null?void 0:i.product.nameField])==null?void 0:L.substring(0,20),"..."]}),j.jsx("button",{onClick:()=>T(B[i==null?void 0:i.product.codeField]),className:"text-purple-200 hover:text-white text-lg leading-none",disabled:t,children:""})]},B[i==null?void 0:i.product.codeField])}),j.jsx("input",{type:"text",value:f,onChange:B=>$(B.target.value),placeholder:`Search ${y.toLowerCase()==="industry"?"industries":y.toLowerCase()+"s"} by code, name, keywords...`,className:"flex-1 bg-transparent text-white text-xl placeholder-gray-400 focus:outline-none min-w-64 border-none",disabled:t})]}),h&&s.productSuggestions.length>0&&j.jsx("div",{className:"absolute top-full left-0 right-0 bg-gray-700 border border-gray-600 rounded-lg mt-2 shadow-xl z-20 max-h-64 overflow-y-auto",children:s.productSuggestions.slice(0,(i==null?void 0:i.product.defaultLimit)||8).map((B,L)=>j.jsxs("button",{onClick:()=>M(B),className:"w-full text-left px-6 py-4 hover:bg-gray-600 text-white border-b border-gray-600 last:border-b-0 transition-colors flex flex-col items-start",disabled:t,children:[j.jsx("span",{className:"text-sm text-gray-400 truncate",children:B[i==null?void 0:i.product.codeField]}),j.jsx("span",{className:"font-medium text-lg",children:B[i==null?void 0:i.product.nameField]}),j.jsxs("span",{className:"text-gray-400 text-xs",children:["(",B.type,")"]})]},L))})]})]}),j.jsxs("div",{children:[j.jsx("h4",{className:"text-xl text-gray-400 mb-4",children:"I want to see..."}),j.jsx("div",{className:"flex gap-2",children:["Value","Volume","Average price/Other"].map(B=>j.jsx("button",{onClick:()=>E(B),className:`px-4 py-2 text-base rounded-md border transition-colors ${b===B?"bg-purple-600 border-purple-500 text-white":"bg-gray-700 border-gray-600 text-gray-300 hover:bg-gray-600"}`,disabled:t,children:B},B))})]}),j.jsxs("div",{children:[j.jsx("h4",{className:"text-xl text-gray-400 mb-4",children:"Between..."}),j.jsxs("div",{className:"flex items-end gap-6 max-w-md",children:[j.jsx("div",{className:"flex-1",children:j.jsx("select",{value:S,onChange:B=>w(B.target.value),className:"w-full bg-transparent text-white text-lg focus:outline-none border-b-2 border-gray-600 focus:border-purple-500 transition-colors py-3 appearance-none",disabled:t,children:Array.from({length:11},(B,L)=>2014+L).map(B=>j.jsx("option",{value:B.toString(),className:"bg-gray-700",children:B},B))})}),j.jsx("div",{className:"text-gray-400 text-lg pb-3",children:"and"}),j.jsx("div",{className:"flex-1",children:j.jsx("select",{value:_,onChange:B=>C(B.target.value),className:"w-full bg-transparent text-white text-lg focus:outline-none border-b-2 border-gray-600 focus:border-purple-500 transition-colors py-3 appearance-none",disabled:t,children:Array.from({length:11},(B,L)=>2014+L).map(B=>j.jsx("option",{value:B.toString(),className:"bg-gray-700",children:B},B))})})]})]}),j.jsx("button",{onClick:R,disabled:t||o.length===0,className:"w-full px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o.length===0?"Select products to query":"Execute Query"})]})]})},FK=({selectedDataset:e,onQueryCreated:t,disabled:n=!1,initialState:i={}})=>{switch(e){case"baci":return j.jsx(kK,{onQueryCreated:t,disabled:n,initialState:i});case"prodcom":return j.jsx(NK,{onQueryCreated:t,disabled:n,initialState:i});default:return j.jsx("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-8",children:j.jsxs("div",{className:"text-center text-gray-400",children:['Dataset "',e,'" not supported yet.']})})}},OK=({query:e,getQueryDisplayName:t,downloadCSV:n,tradeData:i})=>j.jsx("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{children:[j.jsxs("h3",{className:"text-xl font-semibold mb-2",children:["Analysis Results: ",e==null?void 0:e.name]}),j.jsxs("p",{className:"text-gray-400",children:[t(e)," (",e==null?void 0:e.startYear," - ",e==null?void 0:e.endYear,")"]})]}),j.jsxs("button",{onClick:n,disabled:i.length===0,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2",children:[j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download CSV"]})]})}),RK=({tradeData:e,tradeDataLoading:t,tradeDataTotal:n,startIndex:i,endIndex:r,totalPages:a,currentPage:s,goToPage:o,rowsPerPage:l,dataset:f="baci"})=>{const d=f==="prodcom",p=(()=>{if(d)return[{label:"Code",align:"left"},{label:"Description",align:"left"},{label:"Type",align:"left"},{label:"Year",align:"left"},{label:"Measure",align:"left"},{label:"Value",align:"right"},{label:"Unit",align:"left"},{label:"Flag",align:"left"}];if(f==="baci"&&e.length>0){const b=e[0];return Object.keys(b).map(S=>{const w=S.split("_").map(C=>C.charAt(0).toUpperCase()+C.slice(1)).join(" "),_=["value","quantity","product_code","exporter_id","importer_id","year"].includes(S);return{label:w,key:S,align:_?"right":"left"}})}else return[{label:"Code",align:"left"},{label:"Product",align:"left"},{label:"Year",align:"left"},{label:"Partner",align:"left"},{label:"Flow",align:"left"},{label:"Value (USD)",align:"right"},{label:"Quantity",align:"right"}]})(),y=p.length,v=d?"PRODCOM Data":"Trade Data";return j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[j.jsxs("h4",{className:"text-lg font-semibold mb-4",children:[v," (",n," records)"]}),j.jsx("div",{className:"overflow-x-auto",children:j.jsxs("table",{className:"w-full text-sm",children:[j.jsx("thead",{children:j.jsx("tr",{className:"border-b border-gray-600",children:p.map((b,E)=>j.jsx("th",{className:`py-2 px-3 font-medium text-gray-300 ${b.align==="right"?"text-right":"text-left"}`,children:b.label},E))})}),j.jsx("tbody",{children:t?j.jsx("tr",{children:j.jsx("td",{colSpan:y,className:"py-8 text-center text-gray-400",children:"Loading..."})}):e.length===0?j.jsx("tr",{children:j.jsx("td",{colSpan:y,className:"py-8 text-center text-gray-400",children:"No data found"})}):e.map((b,E)=>{var S;return j.jsx("tr",{className:"border-b border-gray-700 hover:bg-gray-750",children:d?j.jsxs(j.Fragment,{children:[j.jsx("td",{className:"py-2 px-3 text-purple-400 font-mono text-xs",children:b.code}),j.jsx("td",{className:"py-2 px-3 text-white max-w-xs truncate text-sm",title:b.description,children:b.description}),j.jsx("td",{className:"py-2 px-3 text-gray-300 text-xs",children:b.type||"N/A"}),j.jsx("td",{className:"py-2 px-3 text-gray-300",children:b.year}),j.jsx("td",{className:"py-2 px-3 text-gray-300 text-xs",children:b.measure}),j.jsx("td",{className:"py-2 px-3 text-right text-green-400 font-mono text-sm",children:b.measure==="Value"?`${(b.value/1e3).toFixed(0)}k`:b.measure==="Volume"?`${(b.value/1e3).toFixed(0)}k`:`${b.value.toFixed(2)}`}),j.jsx("td",{className:"py-2 px-3 text-gray-300 text-xs",children:((S=b.unit)==null?void 0:S.replace(/k$/,""))||""}),j.jsx("td",{className:"py-2 px-3 text-gray-400 text-xs",children:b.flag||""})]}):p.map((w,_)=>{const C=w.key||w.label.toLowerCase().replace(/ /g,"_"),$=b[C],M=(F,R)=>F==null?"":R==="value"?`$${(F/1e3).toFixed(0)}k`:R==="quantity"?F.toFixed(0):R==="product_code"?F:String(F),T=F=>F==="product_code"?"text-blue-400 font-mono text-xs":F==="value"?"text-green-400 font-mono text-sm":F==="quantity"?"text-gray-300 font-mono text-xs":F==="product"?"text-white max-w-xs truncate text-sm":F.includes("name")?"text-white text-sm":"text-gray-300";return j.jsx("td",{className:`py-2 px-3 ${T(C)} ${w.align==="right"?"text-right":"text-left"}`,title:C==="product"?$:void 0,children:M($,C)},_)})},b.id||E)})})]})}),a>1&&j.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-700",children:[j.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",i+1,"-",r," of ",n," records"]}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("button",{onClick:()=>o(s-1),disabled:s===1,className:"px-3 py-1 rounded bg-gray-700 text-gray-300 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),j.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,a)},(b,E)=>{let S;return a<=5||s<=3?S=E+1:s>=a-2?S=a-4+E:S=s-2+E,j.jsx("button",{onClick:()=>o(S),className:`px-3 py-1 rounded text-sm transition-colors ${s===S?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:S},S)})}),j.jsx("button",{onClick:()=>o(s+1),disabled:s===a,className:"px-3 py-1 rounded bg-gray-700 text-gray-300 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})]})};var sA={exports:{}},oA,zF;function zK(){if(zF)return oA;zF=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return oA=e,oA}var uA,BF;function BK(){if(BF)return uA;BF=1;var e=zK();function t(){}function n(){}return n.resetWarningCache=t,uA=function(){function i(s,o,l,f,d,h){if(h!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}i.isRequired=i;function r(){return i}var a={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:r,element:i,elementType:i,instanceOf:r,node:i,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:n,resetWarningCache:t};return a.PropTypes=a,a},uA}var LF;function LK(){return LF||(LF=1,sA.exports=BK()()),sA.exports}var jK=LK();const jF=up(jK),UF={};function O_(e,t){e===void 0&&(e=UF),t===void 0&&(t=UF);const n=Object.keys(e),i=Object.keys(t);return e===t||n.length===i.length&&n.every(r=>e[r]===t[r])}function jy(e,t,n,i){function r(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function o(d){try{f(i.next(d))}catch(h){s(h)}}function l(d){try{f(i.throw(d))}catch(h){s(h)}}function f(d){d.done?a(d.value):r(d.value).then(o,l)}f((i=i.apply(e,t||[])).next())})}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var UK=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),PK=Object.prototype.hasOwnProperty;function R_(e,t){return PK.call(e,t)}function z_(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)R_(e,r)&&i.push(r);return i}function xr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function B_(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function Fl(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function uB(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function L_(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(L_(e[t]))return!0}else if(typeof e=="object"){for(var i=z_(e),r=i.length,a=0;a<r;a++)if(L_(e[i[a]]))return!0}}return!1}function PF(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var lB=function(e){UK(t,e);function t(n,i,r,a,s){var o=this.constructor,l=e.call(this,PF(n,{name:i,index:r,operation:a,tree:s}))||this;return l.name=i,l.index=r,l.operation=a,l.tree=s,Object.setPrototypeOf(l,o.prototype),l.message=PF(n,{name:i,index:r,operation:a,tree:s}),l}return t}(Error),Jt=lB,IK=xr,Xf={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Uy(n,this.path);i&&(i=xr(i));var r=Vl(n,{op:"remove",path:this.from}).removed;return Vl(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Uy(n,this.from);return Vl(n,{op:"add",path:this.path,value:xr(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Tg(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},qK={add:function(e,t,n){return B_(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:Xf.move,copy:Xf.copy,test:Xf.test,_get:Xf._get};function Uy(e,t){if(t=="")return e;var n={op:"_get",path:t};return Vl(e,n),n.value}function Vl(e,t,n,i,r,a){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):Py(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=Uy(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=Tg(e,t.value),s.test===!1)throw new Jt("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new Jt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return s}}else{i||(e=xr(e));var o=t.path||"",l=o.split("/"),f=e,d=1,h=l.length,p=void 0,y=void 0,v=void 0;for(typeof n=="function"?v=n:v=Py;;){if(y=l[d],y&&y.indexOf("~")!=-1&&(y=uB(y)),r&&(y=="__proto__"||y=="prototype"&&d>0&&l[d-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&p===void 0&&(f[y]===void 0?p=l.slice(0,d).join("/"):d==h-1&&(p=t.path),p!==void 0&&v(t,0,e,p)),d++,Array.isArray(f)){if(y==="-")y=f.length;else{if(n&&!B_(y))throw new Jt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);B_(y)&&(y=~~y)}if(d>=h){if(n&&t.op==="add"&&y>f.length)throw new Jt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var s=qK[t.op].call(t,f,y,e);if(s.test===!1)throw new Jt("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return s}}else if(d>=h){var s=Xf[t.op].call(t,f,y,e);if(s.test===!1)throw new Jt("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return s}if(f=f[y],n&&d<h&&(!f||typeof f!="object"))throw new Jt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function Ab(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new Jt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=xr(e));for(var a=new Array(t.length),s=0,o=t.length;s<o;s++)a[s]=Vl(e,t[s],n,!0,r,s),e=a[s].newDocument;return a.newDocument=e,a}function HK(e,t,n){var i=Vl(e,t);if(i.test===!1)throw new Jt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function Py(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new Jt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Xf[e.op]){if(typeof e.path!="string")throw new Jt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Jt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Jt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Jt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&L_(e.value))throw new Jt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,a=i.split("/").length;if(r!==a+1&&r!==a)throw new Jt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new Jt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},o=cB([s],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Jt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Jt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function cB(e,t,n){try{if(!Array.isArray(e))throw new Jt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Ab(xr(t),xr(e),n||!0);else{n=n||Py;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof Jt)return r;throw r}}function Tg(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,a,s;if(n&&i){if(a=e.length,a!=t.length)return!1;for(r=a;r--!==0;)if(!Tg(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var o=Object.keys(e);if(a=o.length,a!==Object.keys(t).length)return!1;for(r=a;r--!==0;)if(!t.hasOwnProperty(o[r]))return!1;for(r=a;r--!==0;)if(s=o[r],!Tg(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}const GK=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Jt,_areEquals:Tg,applyOperation:Vl,applyPatch:Ab,applyReducer:HK,deepClone:IK,getValueByPointer:Uy,validate:cB,validator:Py},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var i$=new WeakMap,YK=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),VK=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function XK(e){return i$.get(e)}function WK(e,t){return e.observers.get(t)}function QK(e,t){e.observers.delete(t.callback)}function ZK(e,t){t.unobserve()}function KK(e,t){var n=[],i,r=XK(e);if(!r)r=new YK(e),i$.set(e,r);else{var a=WK(r,t);i=a&&a.observer}if(i)return i;if(i={},r.value=xr(e),t){i.callback=t,i.next=null;var s=function(){j_(i)},o=function(){clearTimeout(i.next),i.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return i.patches=n,i.object=e,i.unobserve=function(){j_(i),clearTimeout(i.next),QK(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(t,new VK(t,i)),i}function j_(e,t){t===void 0&&(t=!1);var n=i$.get(e.object);r$(n.value,e.object,e.patches,"",t),e.patches.length&&Ab(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function r$(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=z_(t),s=z_(e),o=!1,l=s.length-1;l>=0;l--){var f=s[l],d=e[f];if(R_(t,f)&&!(t[f]===void 0&&d!==void 0&&Array.isArray(t)===!1)){var h=t[f];typeof d=="object"&&d!=null&&typeof h=="object"&&h!=null&&Array.isArray(d)===Array.isArray(h)?r$(d,h,n,i+"/"+Fl(f),r):d!==h&&(r&&n.push({op:"test",path:i+"/"+Fl(f),value:xr(d)}),n.push({op:"replace",path:i+"/"+Fl(f),value:xr(h)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Fl(f),value:xr(d)}),n.push({op:"remove",path:i+"/"+Fl(f)}),o=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!o&&a.length==s.length))for(var l=0;l<a.length;l++){var f=a[l];!R_(e,f)&&t[f]!==void 0&&n.push({op:"add",path:i+"/"+Fl(f),value:xr(t[f])})}}}function JK(e,t,n){n===void 0&&(n=!1);var i=[];return r$(e,t,i,"",n),i}const eJ=Object.freeze(Object.defineProperty({__proto__:null,compare:JK,generate:j_,observe:KK,unobserve:ZK},Symbol.toStringTag,{value:"Module"}));Object.assign({},GK,eJ,{JsonPatchError:lB,deepClone:xr,escapePathComponent:Fl,unescapePathComponent:uB});var lA,IF;function tJ(){if(IF)return lA;IF=1;var e=/("(?:[^\\"]|\\.)*")|[:,]/g;return lA=function(n,i){var r,a,s;return i=i||{},r=JSON.stringify([1],void 0,i.indent===void 0?2:i.indent).slice(2,-3),a=r===""?1/0:i.maxLength===void 0?80:i.maxLength,s=i.replacer,function o(l,f,d){var h,p,y,v,b,E,S,w,_,C,$,M;if(l&&typeof l.toJSON=="function"&&(l=l.toJSON()),$=JSON.stringify(l,s),$===void 0)return $;if(S=a-f.length-d,$.length<=S&&(_=$.replace(e,function(T,F){return F||T+" "}),_.length<=S))return _;if(s!=null&&(l=JSON.parse($),s=void 0),typeof l=="object"&&l!==null){if(w=f+r,y=[],p=0,Array.isArray(l))for(C="[",h="]",S=l.length;p<S;p++)y.push(o(l[p],w,p===S-1?0:1)||"null");else for(C="{",h="}",E=Object.keys(l),S=E.length;p<S;p++)v=E[p],b=JSON.stringify(v)+": ",M=o(l[v],w,b.length+(p===S-1?0:1)),M!==void 0&&y.push(b+M);if(y.length>0)return[C,r+y.join(`,
`+w),h].join(`
`+f)}return $}(n,"",0)},lA}var nJ=tJ();const cA=up(nJ);var w1={exports:{}},fA,qF;function wb(){if(qF)return fA;qF=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=t-6;return fA={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},fA}var dA,HF;function _b(){if(HF)return dA;HF=1;var e={};return dA=typeof process=="object"&&e&&e.NODE_DEBUG&&/\bsemver\b/i.test(e.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},dA}var GF;function fp(){return GF||(GF=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=wb(),a=_b();t=e.exports={};const s=t.re=[],o=t.safeRe=[],l=t.src=[],f=t.safeSrc=[],d=t.t={};let h=0;const p="[a-zA-Z0-9-]",y=[["\\s",1],["\\d",r],[p,i]],v=E=>{for(const[S,w]of y)E=E.split(`${S}*`).join(`${S}{0,${w}}`).split(`${S}+`).join(`${S}{1,${w}}`);return E},b=(E,S,w)=>{const _=v(S),C=h++;a(E,C,S),d[E]=C,l[C]=S,f[C]=_,s[C]=new RegExp(S,w?"g":void 0),o[C]=new RegExp(_,w?"g":void 0)};b("NUMERICIDENTIFIER","0|[1-9]\\d*"),b("NUMERICIDENTIFIERLOOSE","\\d+"),b("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),b("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),b("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASEIDENTIFIER",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIER]})`),b("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),b("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),b("BUILDIDENTIFIER",`${p}+`),b("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),b("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),b("FULL",`^${l[d.FULLPLAIN]}$`),b("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),b("LOOSE",`^${l[d.LOOSEPLAIN]}$`),b("GTLT","((?:<|>)?=?)"),b("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),b("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),b("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),b("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),b("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),b("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),b("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),b("COERCE",`${l[d.COERCEPLAIN]}(?:$|[^\\d])`),b("COERCEFULL",l[d.COERCEPLAIN]+`(?:${l[d.PRERELEASE]})?(?:${l[d.BUILD]})?(?:$|[^\\d])`),b("COERCERTL",l[d.COERCE],!0),b("COERCERTLFULL",l[d.COERCEFULL],!0),b("LONETILDE","(?:~>?)"),b("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",b("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),b("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),b("LONECARET","(?:\\^)"),b("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",b("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),b("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),b("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),b("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),b("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",b("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),b("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),b("STAR","(<|>)?=?\\s*\\*"),b("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),b("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(w1,w1.exports)),w1.exports}var hA,YF;function a$(){if(YF)return hA;YF=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return hA=i=>i?typeof i!="object"?e:i:t,hA}var gA,VF;function fB(){if(VF)return gA;VF=1;const e=/^[0-9]+$/,t=(i,r)=>{const a=e.test(i),s=e.test(r);return a&&s&&(i=+i,r=+r),i===r?0:a&&!s?-1:s&&!a?1:i<r?-1:1};return gA={compareIdentifiers:t,rcompareIdentifiers:(i,r)=>t(r,i)},gA}var pA,XF;function Bi(){if(XF)return pA;XF=1;const e=_b(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=wb(),{safeRe:i,t:r}=fp(),a=a$(),{compareIdentifiers:s}=fB();class o{constructor(f,d){if(d=a(d),f instanceof o){if(f.loose===!!d.loose&&f.includePrerelease===!!d.includePrerelease)return f;f=f.version}else if(typeof f!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof f}".`);if(f.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",f,d),this.options=d,this.loose=!!d.loose,this.includePrerelease=!!d.includePrerelease;const h=f.trim().match(d.loose?i[r.LOOSE]:i[r.FULL]);if(!h)throw new TypeError(`Invalid Version: ${f}`);if(this.raw=f,this.major=+h[1],this.minor=+h[2],this.patch=+h[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");h[4]?this.prerelease=h[4].split(".").map(p=>{if(/^[0-9]+$/.test(p)){const y=+p;if(y>=0&&y<n)return y}return p}):this.prerelease=[],this.build=h[5]?h[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(f){if(e("SemVer.compare",this.version,this.options,f),!(f instanceof o)){if(typeof f=="string"&&f===this.version)return 0;f=new o(f,this.options)}return f.version===this.version?0:this.compareMain(f)||this.comparePre(f)}compareMain(f){return f instanceof o||(f=new o(f,this.options)),s(this.major,f.major)||s(this.minor,f.minor)||s(this.patch,f.patch)}comparePre(f){if(f instanceof o||(f=new o(f,this.options)),this.prerelease.length&&!f.prerelease.length)return-1;if(!this.prerelease.length&&f.prerelease.length)return 1;if(!this.prerelease.length&&!f.prerelease.length)return 0;let d=0;do{const h=this.prerelease[d],p=f.prerelease[d];if(e("prerelease compare",d,h,p),h===void 0&&p===void 0)return 0;if(p===void 0)return 1;if(h===void 0)return-1;if(h===p)continue;return s(h,p)}while(++d)}compareBuild(f){f instanceof o||(f=new o(f,this.options));let d=0;do{const h=this.build[d],p=f.build[d];if(e("build compare",d,h,p),h===void 0&&p===void 0)return 0;if(p===void 0)return 1;if(h===void 0)return-1;if(h===p)continue;return s(h,p)}while(++d)}inc(f,d,h){if(f.startsWith("pre")){if(!d&&h===!1)throw new Error("invalid increment argument: identifier is empty");if(d){const p=`-${d}`.match(this.options.loose?i[r.PRERELEASELOOSE]:i[r.PRERELEASE]);if(!p||p[1]!==d)throw new Error(`invalid identifier: ${d}`)}}switch(f){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",d,h);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",d,h);break;case"prepatch":this.prerelease.length=0,this.inc("patch",d,h),this.inc("pre",d,h);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",d,h),this.inc("pre",d,h);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const p=Number(h)?1:0;if(this.prerelease.length===0)this.prerelease=[p];else{let y=this.prerelease.length;for(;--y>=0;)typeof this.prerelease[y]=="number"&&(this.prerelease[y]++,y=-2);if(y===-1){if(d===this.prerelease.join(".")&&h===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(p)}}if(d){let y=[d,p];h===!1&&(y=[d]),s(this.prerelease[0],d)===0?isNaN(this.prerelease[1])&&(this.prerelease=y):this.prerelease=y}break}default:throw new Error(`invalid increment argument: ${f}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return pA=o,pA}var mA,WF;function Vd(){if(WF)return mA;WF=1;const e=Bi();return mA=(n,i,r=!1)=>{if(n instanceof e)return n;try{return new e(n,i)}catch(a){if(!r)return null;throw a}},mA}var yA,QF;function iJ(){if(QF)return yA;QF=1;const e=Vd();return yA=(n,i)=>{const r=e(n,i);return r?r.version:null},yA}var vA,ZF;function rJ(){if(ZF)return vA;ZF=1;const e=Vd();return vA=(n,i)=>{const r=e(n.trim().replace(/^[=v]+/,""),i);return r?r.version:null},vA}var bA,KF;function aJ(){if(KF)return bA;KF=1;const e=Bi();return bA=(n,i,r,a,s)=>{typeof r=="string"&&(s=a,a=r,r=void 0);try{return new e(n instanceof e?n.version:n,r).inc(i,a,s).version}catch{return null}},bA}var xA,JF;function sJ(){if(JF)return xA;JF=1;const e=Vd();return xA=(n,i)=>{const r=e(n,null,!0),a=e(i,null,!0),s=r.compare(a);if(s===0)return null;const o=s>0,l=o?r:a,f=o?a:r,d=!!l.prerelease.length;if(!!f.prerelease.length&&!d){if(!f.patch&&!f.minor)return"major";if(f.compareMain(l)===0)return f.minor&&!f.patch?"minor":"patch"}const p=d?"pre":"";return r.major!==a.major?p+"major":r.minor!==a.minor?p+"minor":r.patch!==a.patch?p+"patch":"prerelease"},xA}var EA,eO;function oJ(){if(eO)return EA;eO=1;const e=Bi();return EA=(n,i)=>new e(n,i).major,EA}var SA,tO;function uJ(){if(tO)return SA;tO=1;const e=Bi();return SA=(n,i)=>new e(n,i).minor,SA}var AA,nO;function lJ(){if(nO)return AA;nO=1;const e=Bi();return AA=(n,i)=>new e(n,i).patch,AA}var wA,iO;function cJ(){if(iO)return wA;iO=1;const e=Vd();return wA=(n,i)=>{const r=e(n,i);return r&&r.prerelease.length?r.prerelease:null},wA}var _A,rO;function ka(){if(rO)return _A;rO=1;const e=Bi();return _A=(n,i,r)=>new e(n,r).compare(new e(i,r)),_A}var CA,aO;function fJ(){if(aO)return CA;aO=1;const e=ka();return CA=(n,i,r)=>e(i,n,r),CA}var $A,sO;function dJ(){if(sO)return $A;sO=1;const e=ka();return $A=(n,i)=>e(n,i,!0),$A}var DA,oO;function s$(){if(oO)return DA;oO=1;const e=Bi();return DA=(n,i,r)=>{const a=new e(n,r),s=new e(i,r);return a.compare(s)||a.compareBuild(s)},DA}var TA,uO;function hJ(){if(uO)return TA;uO=1;const e=s$();return TA=(n,i)=>n.sort((r,a)=>e(r,a,i)),TA}var MA,lO;function gJ(){if(lO)return MA;lO=1;const e=s$();return MA=(n,i)=>n.sort((r,a)=>e(a,r,i)),MA}var kA,cO;function Cb(){if(cO)return kA;cO=1;const e=ka();return kA=(n,i,r)=>e(n,i,r)>0,kA}var NA,fO;function o$(){if(fO)return NA;fO=1;const e=ka();return NA=(n,i,r)=>e(n,i,r)<0,NA}var FA,dO;function dB(){if(dO)return FA;dO=1;const e=ka();return FA=(n,i,r)=>e(n,i,r)===0,FA}var OA,hO;function hB(){if(hO)return OA;hO=1;const e=ka();return OA=(n,i,r)=>e(n,i,r)!==0,OA}var RA,gO;function u$(){if(gO)return RA;gO=1;const e=ka();return RA=(n,i,r)=>e(n,i,r)>=0,RA}var zA,pO;function l$(){if(pO)return zA;pO=1;const e=ka();return zA=(n,i,r)=>e(n,i,r)<=0,zA}var BA,mO;function gB(){if(mO)return BA;mO=1;const e=dB(),t=hB(),n=Cb(),i=u$(),r=o$(),a=l$();return BA=(o,l,f,d)=>{switch(l){case"===":return typeof o=="object"&&(o=o.version),typeof f=="object"&&(f=f.version),o===f;case"!==":return typeof o=="object"&&(o=o.version),typeof f=="object"&&(f=f.version),o!==f;case"":case"=":case"==":return e(o,f,d);case"!=":return t(o,f,d);case">":return n(o,f,d);case">=":return i(o,f,d);case"<":return r(o,f,d);case"<=":return a(o,f,d);default:throw new TypeError(`Invalid operator: ${l}`)}},BA}var LA,yO;function pJ(){if(yO)return LA;yO=1;const e=Bi(),t=Vd(),{safeRe:n,t:i}=fp();return LA=(a,s)=>{if(a instanceof e)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;s=s||{};let o=null;if(!s.rtl)o=a.match(s.includePrerelease?n[i.COERCEFULL]:n[i.COERCE]);else{const y=s.includePrerelease?n[i.COERCERTLFULL]:n[i.COERCERTL];let v;for(;(v=y.exec(a))&&(!o||o.index+o[0].length!==a.length);)(!o||v.index+v[0].length!==o.index+o[0].length)&&(o=v),y.lastIndex=v.index+v[1].length+v[2].length;y.lastIndex=-1}if(o===null)return null;const l=o[2],f=o[3]||"0",d=o[4]||"0",h=s.includePrerelease&&o[5]?`-${o[5]}`:"",p=s.includePrerelease&&o[6]?`+${o[6]}`:"";return t(`${l}.${f}.${d}${h}${p}`,s)},LA}var jA,vO;function mJ(){if(vO)return jA;vO=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const i=this.map.get(n);if(i!==void 0)return this.map.delete(n),this.map.set(n,i),i}delete(n){return this.map.delete(n)}set(n,i){if(!this.delete(n)&&i!==void 0){if(this.map.size>=this.max){const a=this.map.keys().next().value;this.delete(a)}this.map.set(n,i)}return this}}return jA=e,jA}var UA,bO;function Na(){if(bO)return UA;bO=1;const e=/\s+/g;class t{constructor(z,O){if(O=r(O),z instanceof t)return z.loose===!!O.loose&&z.includePrerelease===!!O.includePrerelease?z:new t(z.raw,O);if(z instanceof a)return this.raw=z.value,this.set=[[z]],this.formatted=void 0,this;if(this.options=O,this.loose=!!O.loose,this.includePrerelease=!!O.includePrerelease,this.raw=z.trim().replace(e," "),this.set=this.raw.split("||").map(I=>this.parseRange(I.trim())).filter(I=>I.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const I=this.set[0];if(this.set=this.set.filter(W=>!b(W[0])),this.set.length===0)this.set=[I];else if(this.set.length>1){for(const W of this.set)if(W.length===1&&E(W[0])){this.set=[W];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let z=0;z<this.set.length;z++){z>0&&(this.formatted+="||");const O=this.set[z];for(let I=0;I<O.length;I++)I>0&&(this.formatted+=" "),this.formatted+=O[I].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(z){const I=((this.options.includePrerelease&&y)|(this.options.loose&&v))+":"+z,W=i.get(I);if(W)return W;const K=this.options.loose,k=K?l[f.HYPHENRANGELOOSE]:l[f.HYPHENRANGE];z=z.replace(k,Y(this.options.includePrerelease)),s("hyphen replace",z),z=z.replace(l[f.COMPARATORTRIM],d),s("comparator trim",z),z=z.replace(l[f.TILDETRIM],h),s("tilde trim",z),z=z.replace(l[f.CARETTRIM],p),s("caret trim",z);let V=z.split(" ").map(le=>w(le,this.options)).join(" ").split(/\s+/).map(le=>L(le,this.options));K&&(V=V.filter(le=>(s("loose invalid filter",le,this.options),!!le.match(l[f.COMPARATORLOOSE])))),s("range list",V);const X=new Map,ne=V.map(le=>new a(le,this.options));for(const le of ne){if(b(le))return[le];X.set(le.value,le)}X.size>1&&X.has("")&&X.delete("");const ye=[...X.values()];return i.set(I,ye),ye}intersects(z,O){if(!(z instanceof t))throw new TypeError("a Range is required");return this.set.some(I=>S(I,O)&&z.set.some(W=>S(W,O)&&I.every(K=>W.every(k=>K.intersects(k,O)))))}test(z){if(!z)return!1;if(typeof z=="string")try{z=new o(z,this.options)}catch{return!1}for(let O=0;O<this.set.length;O++)if(H(this.set[O],z,this.options))return!0;return!1}}UA=t;const n=mJ(),i=new n,r=a$(),a=$b(),s=_b(),o=Bi(),{safeRe:l,t:f,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:p}=fp(),{FLAG_INCLUDE_PRERELEASE:y,FLAG_LOOSE:v}=wb(),b=U=>U.value==="<0.0.0-0",E=U=>U.value==="",S=(U,z)=>{let O=!0;const I=U.slice();let W=I.pop();for(;O&&I.length;)O=I.every(K=>W.intersects(K,z)),W=I.pop();return O},w=(U,z)=>(s("comp",U,z),U=M(U,z),s("caret",U),U=C(U,z),s("tildes",U),U=F(U,z),s("xrange",U),U=B(U,z),s("stars",U),U),_=U=>!U||U.toLowerCase()==="x"||U==="*",C=(U,z)=>U.trim().split(/\s+/).map(O=>$(O,z)).join(" "),$=(U,z)=>{const O=z.loose?l[f.TILDELOOSE]:l[f.TILDE];return U.replace(O,(I,W,K,k,V)=>{s("tilde",U,I,W,K,k,V);let X;return _(W)?X="":_(K)?X=`>=${W}.0.0 <${+W+1}.0.0-0`:_(k)?X=`>=${W}.${K}.0 <${W}.${+K+1}.0-0`:V?(s("replaceTilde pr",V),X=`>=${W}.${K}.${k}-${V} <${W}.${+K+1}.0-0`):X=`>=${W}.${K}.${k} <${W}.${+K+1}.0-0`,s("tilde return",X),X})},M=(U,z)=>U.trim().split(/\s+/).map(O=>T(O,z)).join(" "),T=(U,z)=>{s("caret",U,z);const O=z.loose?l[f.CARETLOOSE]:l[f.CARET],I=z.includePrerelease?"-0":"";return U.replace(O,(W,K,k,V,X)=>{s("caret",U,W,K,k,V,X);let ne;return _(K)?ne="":_(k)?ne=`>=${K}.0.0${I} <${+K+1}.0.0-0`:_(V)?K==="0"?ne=`>=${K}.${k}.0${I} <${K}.${+k+1}.0-0`:ne=`>=${K}.${k}.0${I} <${+K+1}.0.0-0`:X?(s("replaceCaret pr",X),K==="0"?k==="0"?ne=`>=${K}.${k}.${V}-${X} <${K}.${k}.${+V+1}-0`:ne=`>=${K}.${k}.${V}-${X} <${K}.${+k+1}.0-0`:ne=`>=${K}.${k}.${V}-${X} <${+K+1}.0.0-0`):(s("no pr"),K==="0"?k==="0"?ne=`>=${K}.${k}.${V}${I} <${K}.${k}.${+V+1}-0`:ne=`>=${K}.${k}.${V}${I} <${K}.${+k+1}.0-0`:ne=`>=${K}.${k}.${V} <${+K+1}.0.0-0`),s("caret return",ne),ne})},F=(U,z)=>(s("replaceXRanges",U,z),U.split(/\s+/).map(O=>R(O,z)).join(" ")),R=(U,z)=>{U=U.trim();const O=z.loose?l[f.XRANGELOOSE]:l[f.XRANGE];return U.replace(O,(I,W,K,k,V,X)=>{s("xRange",U,I,W,K,k,V,X);const ne=_(K),ye=ne||_(k),le=ye||_(V),be=le;return W==="="&&be&&(W=""),X=z.includePrerelease?"-0":"",ne?W===">"||W==="<"?I="<0.0.0-0":I="*":W&&be?(ye&&(k=0),V=0,W===">"?(W=">=",ye?(K=+K+1,k=0,V=0):(k=+k+1,V=0)):W==="<="&&(W="<",ye?K=+K+1:k=+k+1),W==="<"&&(X="-0"),I=`${W+K}.${k}.${V}${X}`):ye?I=`>=${K}.0.0${X} <${+K+1}.0.0-0`:le&&(I=`>=${K}.${k}.0${X} <${K}.${+k+1}.0-0`),s("xRange return",I),I})},B=(U,z)=>(s("replaceStars",U,z),U.trim().replace(l[f.STAR],"")),L=(U,z)=>(s("replaceGTE0",U,z),U.trim().replace(l[z.includePrerelease?f.GTE0PRE:f.GTE0],"")),Y=U=>(z,O,I,W,K,k,V,X,ne,ye,le,be)=>(_(I)?O="":_(W)?O=`>=${I}.0.0${U?"-0":""}`:_(K)?O=`>=${I}.${W}.0${U?"-0":""}`:k?O=`>=${O}`:O=`>=${O}${U?"-0":""}`,_(ne)?X="":_(ye)?X=`<${+ne+1}.0.0-0`:_(le)?X=`<${ne}.${+ye+1}.0-0`:be?X=`<=${ne}.${ye}.${le}-${be}`:U?X=`<${ne}.${ye}.${+le+1}-0`:X=`<=${X}`,`${O} ${X}`.trim()),H=(U,z,O)=>{for(let I=0;I<U.length;I++)if(!U[I].test(z))return!1;if(z.prerelease.length&&!O.includePrerelease){for(let I=0;I<U.length;I++)if(s(U[I].semver),U[I].semver!==a.ANY&&U[I].semver.prerelease.length>0){const W=U[I].semver;if(W.major===z.major&&W.minor===z.minor&&W.patch===z.patch)return!0}return!1}return!0};return UA}var PA,xO;function $b(){if(xO)return PA;xO=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(d,h){if(h=n(h),d instanceof t){if(d.loose===!!h.loose)return d;d=d.value}d=d.trim().split(/\s+/).join(" "),s("comparator",d,h),this.options=h,this.loose=!!h.loose,this.parse(d),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(d){const h=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],p=d.match(h);if(!p)throw new TypeError(`Invalid comparator: ${d}`);this.operator=p[1]!==void 0?p[1]:"",this.operator==="="&&(this.operator=""),p[2]?this.semver=new o(p[2],this.options.loose):this.semver=e}toString(){return this.value}test(d){if(s("Comparator.test",d,this.options.loose),this.semver===e||d===e)return!0;if(typeof d=="string")try{d=new o(d,this.options)}catch{return!1}return a(d,this.operator,this.semver,this.options)}intersects(d,h){if(!(d instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(d.value,h).test(this.value):d.operator===""?d.value===""?!0:new l(this.value,h).test(d.semver):(h=n(h),h.includePrerelease&&(this.value==="<0.0.0-0"||d.value==="<0.0.0-0")||!h.includePrerelease&&(this.value.startsWith("<0.0.0")||d.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&d.operator.startsWith(">")||this.operator.startsWith("<")&&d.operator.startsWith("<")||this.semver.version===d.semver.version&&this.operator.includes("=")&&d.operator.includes("=")||a(this.semver,"<",d.semver,h)&&this.operator.startsWith(">")&&d.operator.startsWith("<")||a(this.semver,">",d.semver,h)&&this.operator.startsWith("<")&&d.operator.startsWith(">")))}}PA=t;const n=a$(),{safeRe:i,t:r}=fp(),a=gB(),s=_b(),o=Bi(),l=Na();return PA}var IA,EO;function Db(){if(EO)return IA;EO=1;const e=Na();return IA=(n,i,r)=>{try{i=new e(i,r)}catch{return!1}return i.test(n)},IA}var qA,SO;function yJ(){if(SO)return qA;SO=1;const e=Na();return qA=(n,i)=>new e(n,i).set.map(r=>r.map(a=>a.value).join(" ").trim().split(" ")),qA}var HA,AO;function vJ(){if(AO)return HA;AO=1;const e=Bi(),t=Na();return HA=(i,r,a)=>{let s=null,o=null,l=null;try{l=new t(r,a)}catch{return null}return i.forEach(f=>{l.test(f)&&(!s||o.compare(f)===-1)&&(s=f,o=new e(s,a))}),s},HA}var GA,wO;function bJ(){if(wO)return GA;wO=1;const e=Bi(),t=Na();return GA=(i,r,a)=>{let s=null,o=null,l=null;try{l=new t(r,a)}catch{return null}return i.forEach(f=>{l.test(f)&&(!s||o.compare(f)===1)&&(s=f,o=new e(s,a))}),s},GA}var YA,_O;function xJ(){if(_O)return YA;_O=1;const e=Bi(),t=Na(),n=Cb();return YA=(r,a)=>{r=new t(r,a);let s=new e("0.0.0");if(r.test(s)||(s=new e("0.0.0-0"),r.test(s)))return s;s=null;for(let o=0;o<r.set.length;++o){const l=r.set[o];let f=null;l.forEach(d=>{const h=new e(d.semver.version);switch(d.operator){case">":h.prerelease.length===0?h.patch++:h.prerelease.push(0),h.raw=h.format();case"":case">=":(!f||n(h,f))&&(f=h);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${d.operator}`)}}),f&&(!s||n(s,f))&&(s=f)}return s&&r.test(s)?s:null},YA}var VA,CO;function EJ(){if(CO)return VA;CO=1;const e=Na();return VA=(n,i)=>{try{return new e(n,i).range||"*"}catch{return null}},VA}var XA,$O;function c$(){if($O)return XA;$O=1;const e=Bi(),t=$b(),{ANY:n}=t,i=Na(),r=Db(),a=Cb(),s=o$(),o=l$(),l=u$();return XA=(d,h,p,y)=>{d=new e(d,y),h=new i(h,y);let v,b,E,S,w;switch(p){case">":v=a,b=o,E=s,S=">",w=">=";break;case"<":v=s,b=l,E=a,S="<",w="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(r(d,h,y))return!1;for(let _=0;_<h.set.length;++_){const C=h.set[_];let $=null,M=null;if(C.forEach(T=>{T.semver===n&&(T=new t(">=0.0.0")),$=$||T,M=M||T,v(T.semver,$.semver,y)?$=T:E(T.semver,M.semver,y)&&(M=T)}),$.operator===S||$.operator===w||(!M.operator||M.operator===S)&&b(d,M.semver))return!1;if(M.operator===w&&E(d,M.semver))return!1}return!0},XA}var WA,DO;function SJ(){if(DO)return WA;DO=1;const e=c$();return WA=(n,i,r)=>e(n,i,">",r),WA}var QA,TO;function AJ(){if(TO)return QA;TO=1;const e=c$();return QA=(n,i,r)=>e(n,i,"<",r),QA}var ZA,MO;function wJ(){if(MO)return ZA;MO=1;const e=Na();return ZA=(n,i,r)=>(n=new e(n,r),i=new e(i,r),n.intersects(i,r)),ZA}var KA,kO;function _J(){if(kO)return KA;kO=1;const e=Db(),t=ka();return KA=(n,i,r)=>{const a=[];let s=null,o=null;const l=n.sort((p,y)=>t(p,y,r));for(const p of l)e(p,i,r)?(o=p,s||(s=p)):(o&&a.push([s,o]),o=null,s=null);s&&a.push([s,null]);const f=[];for(const[p,y]of a)p===y?f.push(p):!y&&p===l[0]?f.push("*"):y?p===l[0]?f.push(`<=${y}`):f.push(`${p} - ${y}`):f.push(`>=${p}`);const d=f.join(" || "),h=typeof i.raw=="string"?i.raw:String(i);return d.length<h.length?d:i},KA}var JA,NO;function CJ(){if(NO)return JA;NO=1;const e=Na(),t=$b(),{ANY:n}=t,i=Db(),r=ka(),a=(h,p,y={})=>{if(h===p)return!0;h=new e(h,y),p=new e(p,y);let v=!1;e:for(const b of h.set){for(const E of p.set){const S=l(b,E,y);if(v=v||S!==null,S)continue e}if(v)return!1}return!0},s=[new t(">=0.0.0-0")],o=[new t(">=0.0.0")],l=(h,p,y)=>{if(h===p)return!0;if(h.length===1&&h[0].semver===n){if(p.length===1&&p[0].semver===n)return!0;y.includePrerelease?h=s:h=o}if(p.length===1&&p[0].semver===n){if(y.includePrerelease)return!0;p=o}const v=new Set;let b,E;for(const F of h)F.operator===">"||F.operator===">="?b=f(b,F,y):F.operator==="<"||F.operator==="<="?E=d(E,F,y):v.add(F.semver);if(v.size>1)return null;let S;if(b&&E){if(S=r(b.semver,E.semver,y),S>0)return null;if(S===0&&(b.operator!==">="||E.operator!=="<="))return null}for(const F of v){if(b&&!i(F,String(b),y)||E&&!i(F,String(E),y))return null;for(const R of p)if(!i(F,String(R),y))return!1;return!0}let w,_,C,$,M=E&&!y.includePrerelease&&E.semver.prerelease.length?E.semver:!1,T=b&&!y.includePrerelease&&b.semver.prerelease.length?b.semver:!1;M&&M.prerelease.length===1&&E.operator==="<"&&M.prerelease[0]===0&&(M=!1);for(const F of p){if($=$||F.operator===">"||F.operator===">=",C=C||F.operator==="<"||F.operator==="<=",b){if(T&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===T.major&&F.semver.minor===T.minor&&F.semver.patch===T.patch&&(T=!1),F.operator===">"||F.operator===">="){if(w=f(b,F,y),w===F&&w!==b)return!1}else if(b.operator===">="&&!i(b.semver,String(F),y))return!1}if(E){if(M&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===M.major&&F.semver.minor===M.minor&&F.semver.patch===M.patch&&(M=!1),F.operator==="<"||F.operator==="<="){if(_=d(E,F,y),_===F&&_!==E)return!1}else if(E.operator==="<="&&!i(E.semver,String(F),y))return!1}if(!F.operator&&(E||b)&&S!==0)return!1}return!(b&&C&&!E&&S!==0||E&&$&&!b&&S!==0||T||M)},f=(h,p,y)=>{if(!h)return p;const v=r(h.semver,p.semver,y);return v>0?h:v<0||p.operator===">"&&h.operator===">="?p:h},d=(h,p,y)=>{if(!h)return p;const v=r(h.semver,p.semver,y);return v<0?h:v>0||p.operator==="<"&&h.operator==="<="?p:h};return JA=a,JA}var ew,FO;function $J(){if(FO)return ew;FO=1;const e=fp(),t=wb(),n=Bi(),i=fB(),r=Vd(),a=iJ(),s=rJ(),o=aJ(),l=sJ(),f=oJ(),d=uJ(),h=lJ(),p=cJ(),y=ka(),v=fJ(),b=dJ(),E=s$(),S=hJ(),w=gJ(),_=Cb(),C=o$(),$=dB(),M=hB(),T=u$(),F=l$(),R=gB(),B=pJ(),L=$b(),Y=Na(),H=Db(),U=yJ(),z=vJ(),O=bJ(),I=xJ(),W=EJ(),K=c$(),k=SJ(),V=AJ(),X=wJ(),ne=_J(),ye=CJ();return ew={parse:r,valid:a,clean:s,inc:o,diff:l,major:f,minor:d,patch:h,prerelease:p,compare:y,rcompare:v,compareLoose:b,compareBuild:E,sort:S,rsort:w,gt:_,lt:C,eq:$,neq:M,gte:T,lte:F,cmp:R,coerce:B,Comparator:L,Range:Y,satisfies:H,toComparators:U,maxSatisfying:z,minSatisfying:O,minVersion:I,validRange:W,outside:K,gtr:k,ltr:V,intersects:X,simplifyRange:ne,subset:ye,SemVer:n,re:e.re,src:e.src,tokens:e.t,SEMVER_SPEC_VERSION:t.SEMVER_SPEC_VERSION,RELEASE_TYPES:t.RELEASE_TYPES,compareIdentifiers:i.compareIdentifiers,rcompareIdentifiers:i.rcompareIdentifiers},ew}var pB=$J();function ar(e,t,n){return e.fields=t||[],e.fname=n,e}function tn(e){return e==null?null:e.fname}function hi(e){return e==null?null:e.fields}function mB(e){return e.length===1?DJ(e[0]):TJ(e)}const DJ=e=>function(t){return t[e]},TJ=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function ae(e){throw Error(e)}function Tb(e){const t=[],n=e.length;let i=null,r=0,a="",s,o,l;e=e+"";function f(){t.push(a+e.substring(s,o)),a="",s=o+1}for(s=o=0;o<n;++o)if(l=e[o],l==="\\")a+=e.substring(s,o++),s=o;else if(l===i)f(),i=null,r=-1;else{if(i)continue;s===r&&l==='"'||s===r&&l==="'"?(s=o+1,i=l):l==="."&&!r?o>s?f():s=o+1:l==="["?(o>s&&f(),r=s=o+1):l==="]"&&(r||ae("Access path missing open bracket: "+e),r>0&&f(),r=0,s=o+1)}return r&&ae("Access path missing closing bracket: "+e),i&&ae("Access path missing closing quote: "+e),o>s&&(o++,f()),t}function Qr(e,t,n){const i=Tb(e);return e=i.length===1?i[0]:e,ar((n&&n.get||mB)(i),[e],t||e)}const dp=Qr("id"),Fi=ar(e=>e,[],"identity"),du=ar(()=>0,[],"zero"),Xd=ar(()=>1,[],"one"),Zr=ar(()=>!0,[],"true"),ru=ar(()=>!1,[],"false");function MJ(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const yB=0,f$=1,vB=2,bB=3,xB=4;function EB(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:MJ,i=e||yB;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=f$&&n(t||"error","ERROR",arguments),this},warn(){return i>=vB&&n(t||"warn","WARN",arguments),this},info(){return i>=bB&&n(t||"log","INFO",arguments),this},debug(){return i>=xB&&n(t||"log","DEBUG",arguments),this}}}var De=Array.isArray;function Pe(e){return e===Object(e)}const OO=e=>e!=="__proto__";function Mb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const a in r)if(a==="signals")i.signals=kJ(i.signals,r.signals);else{const s=a==="legend"?{layout:1}:a==="style"?!0:null;kb(i,a,r[a],s)}return i},{})}function kb(e,t,n,i){if(!OO(t))return;let r,a;if(Pe(n)&&!De(n)){a=Pe(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?kb(a,r,n[r]):OO(r)&&(a[r]=n[r])}else e[t]=n}function kJ(e,t){if(e==null)return t;const n={},i=[];function r(a){n[a.name]||(n[a.name]=1,i.push(a))}return t.forEach(r),e.forEach(r),i}function st(e){return e[e.length-1]}function fi(e){return e==null||e===""?null:+e}const SB=e=>t=>e*Math.exp(t),AB=e=>t=>Math.log(e*t),wB=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),_B=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Iy=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Nb(e,t,n,i){const r=n(e[0]),a=n(st(e)),s=(a-r)*t;return[i(r-s),i(a-s)]}function CB(e,t){return Nb(e,t,fi,Fi)}function $B(e,t){var n=Math.sign(e[0]);return Nb(e,t,AB(n),SB(n))}function DB(e,t,n){return Nb(e,t,Iy(n),Iy(1/n))}function TB(e,t,n){return Nb(e,t,wB(n),_B(n))}function Fb(e,t,n,i,r){const a=i(e[0]),s=i(st(e)),o=t!=null?i(t):(a+s)/2;return[r(o+(a-o)*n),r(o+(s-o)*n)]}function d$(e,t,n){return Fb(e,t,n,fi,Fi)}function h$(e,t,n){const i=Math.sign(e[0]);return Fb(e,t,n,AB(i),SB(i))}function qy(e,t,n,i){return Fb(e,t,n,Iy(i),Iy(1/i))}function g$(e,t,n,i){return Fb(e,t,n,wB(i),_B(i))}function MB(e){return 1+~~(new Date(e).getMonth()/3)}function kB(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Fe(e){return e!=null?De(e)?e:[e]:[]}function NB(e,t,n){let i=e[0],r=e[1],a;return r<i&&(a=r,r=i,i=a),a=r-i,a>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-a),i+a]}function We(e){return typeof e=="function"}const NJ="descending";function p$(e,t,n){n=n||{},t=Fe(t)||[];const i=[],r=[],a={},s=n.comparator||FJ;return Fe(e).forEach((o,l)=>{o!=null&&(i.push(t[l]===NJ?-1:1),r.push(o=We(o)?o:Qr(o,null,n)),(hi(o)||[]).forEach(f=>a[f]=1))}),r.length===0?null:ar(s(r,i),Object.keys(a))}const hp=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),FJ=(e,t)=>e.length===1?OJ(e[0],t[0]):RJ(e,t,e.length),OJ=(e,t)=>function(n,i){return hp(e(n),e(i))*t},RJ=(e,t,n)=>(t.push(0),function(i,r){let a,s=0,o=-1;for(;s===0&&++o<n;)a=e[o],s=hp(a(i),a(r));return s*t[o]});function bi(e){return We(e)?e:()=>e}function m$(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Ve(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function cs(e,t){let n=0,i,r,a,s;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(a=s=r;n<i;++n)r=e[n],r!=null&&(r<a&&(a=r),r>s&&(s=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(a=s=r;n<i;++n)r=t(e[n]),r!=null&&(r<a&&(a=r),r>s&&(s=r))}return[a,s]}function FB(e,t){const n=e.length;let i=-1,r,a,s,o,l;if(t==null){for(;++i<n;)if(a=e[i],a!=null&&a>=a){r=s=a;break}if(i===n)return[-1,-1];for(o=l=i;++i<n;)a=e[i],a!=null&&(r>a&&(r=a,o=i),s<a&&(s=a,l=i))}else{for(;++i<n;)if(a=t(e[i],i,e),a!=null&&a>=a){r=s=a;break}if(i===n)return[-1,-1];for(o=l=i;++i<n;)a=t(e[i],i,e),a!=null&&(r>a&&(r=a,o=i),s<a&&(s=a,l=i))}return[o,l]}function ze(e,t){return Object.hasOwn(e,t)}const _1={};function Wd(e){let t={},n;function i(a){return ze(t,a)&&t[a]!==_1}const r={size:0,empty:0,object:t,has:i,get(a){return i(a)?t[a]:void 0},set(a,s){return i(a)||(++r.size,t[a]===_1&&--r.empty),t[a]=s,this},delete(a){return i(a)&&(--r.size,++r.empty,t[a]=_1),this},clear(){r.size=r.empty=0,r.object=t={}},test(a){return arguments.length?(n=a,r):n},clean(){const a={};let s=0;for(const o in t){const l=t[o];l!==_1&&(!n||!n(l))&&(a[o]=l,++s)}r.size=s,r.empty=0,r.object=t=a}};return e&&Object.keys(e).forEach(a=>{r.set(a,e[a])}),r}function OB(e,t,n,i,r,a){if(!n&&n!==0)return a;const s=+n;let o=e[0],l=st(e),f;l<o&&(f=o,o=l,l=f),f=Math.abs(t-o);const d=Math.abs(l-t);return f<d&&f<=s?i:d<=s?r:a}function me(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ve(i,n)}function Wf(e,t,n,i){let r=t[0],a=t[t.length-1],s;return r>a&&(s=r,r=a,a=s),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=a:e<a)}function y$(e){return typeof e=="boolean"}function Au(e){return Object.prototype.toString.call(e)==="[object Date]"}function RB(e){return e&&We(e[Symbol.iterator])}function Tu(e){return typeof e=="number"}function v$(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ft(e){return typeof e=="string"}function b$(e,t,n){e&&(e=t?Fe(e).map(o=>o.replace(/\\(.)/g,"$1")):Fe(e));const i=e&&e.length,r=n&&n.get||mB,a=o=>r(t?[o]:Tb(o));let s;if(!i)s=function(){return""};else if(i===1){const o=a(e[0]);s=function(l){return""+o(l)}}else{const o=e.map(a);s=function(l){let f=""+o[0](l),d=0;for(;++d<i;)f+="|"+o[d](l);return f}}return ar(s,e,"key")}function zB(e,t){const n=e[0],i=st(e),r=+t;return r?r===1?i:n+r*(i-n):n}const zJ=1e4;function BB(e){e=+e||zJ;let t,n,i;const r=()=>{t={},n={},i=0},a=(s,o)=>(++i>e&&(n=t,t={},i=1),t[s]=o);return r(),{clear:r,has:s=>ze(t,s)||ze(n,s),get:s=>ze(t,s)?t[s]:ze(n,s)?a(s,n[s]):void 0,set:(s,o)=>ze(t,s)?t[s]=o:a(s,o)}}function LB(e,t,n,i){const r=t.length,a=n.length;if(!a)return t;if(!r)return n;const s=i||new t.constructor(r+a);let o=0,l=0,f=0;for(;o<r&&l<a;++f)s[f]=e(t[o],n[l])>0?n[l++]:t[o++];for(;o<r;++o,++f)s[f]=t[o];for(;l<a;++l,++f)s[f]=n[l];return s}function I0(e,t){let n="";for(;--t>=0;)n+=e;return n}function jB(e,t,n,i){const r=n||" ",a=e+"",s=t-a.length;return s<=0?a:i==="left"?I0(r,s)+a:i==="center"?I0(r,~~(s/2))+a+I0(r,Math.ceil(s/2)):a+I0(r,s)}function gp(e){return e&&st(e)-e[0]||0}function $e(e){return De(e)?"["+e.map($e)+"]":Pe(e)||ft(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function x$(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const BJ=e=>Tu(e)||Au(e)?e:Date.parse(e);function E$(e,t){return t=t||BJ,e==null||e===""?null:t(e)}function S$(e){return e==null||e===""?null:e+""}function wa(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function UB(e,t,n,i){const r=i??"",a=e+"",s=a.length,o=Math.max(0,t-r.length);return s<=t?a:n==="left"?r+a.slice(s-o):n==="center"?a.slice(0,Math.ceil(o/2))+r+a.slice(s-~~(o/2)):a.slice(0,o)+r}function ou(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const a=t(e[r]);a&&n(a,r,e)}}else e.forEach(n)}var RO={},tw={},nw=34,v0=10,iw=13;function PB(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function LJ(e,t){var n=PB(e);return function(i,r){return t(n(i),r,e)}}function zO(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Gi(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function jJ(e){return e<0?"-"+Gi(-e,6):e>9999?"+"+Gi(e,6):Gi(e,4)}function UJ(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":jJ(e.getUTCFullYear())+"-"+Gi(e.getUTCMonth()+1,2)+"-"+Gi(e.getUTCDate(),2)+(r?"T"+Gi(t,2)+":"+Gi(n,2)+":"+Gi(i,2)+"."+Gi(r,3)+"Z":i?"T"+Gi(t,2)+":"+Gi(n,2)+":"+Gi(i,2)+"Z":n||t?"T"+Gi(t,2)+":"+Gi(n,2)+"Z":"")}function PJ(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(h,p){var y,v,b=r(h,function(E,S){if(y)return y(E,S-1);v=E,y=p?LJ(E,p):PB(E)});return b.columns=v||[],b}function r(h,p){var y=[],v=h.length,b=0,E=0,S,w=v<=0,_=!1;h.charCodeAt(v-1)===v0&&--v,h.charCodeAt(v-1)===iw&&--v;function C(){if(w)return tw;if(_)return _=!1,RO;var M,T=b,F;if(h.charCodeAt(T)===nw){for(;b++<v&&h.charCodeAt(b)!==nw||h.charCodeAt(++b)===nw;);return(M=b)>=v?w=!0:(F=h.charCodeAt(b++))===v0?_=!0:F===iw&&(_=!0,h.charCodeAt(b)===v0&&++b),h.slice(T+1,M-1).replace(/""/g,'"')}for(;b<v;){if((F=h.charCodeAt(M=b++))===v0)_=!0;else if(F===iw)_=!0,h.charCodeAt(b)===v0&&++b;else if(F!==n)continue;return h.slice(T,M)}return w=!0,h.slice(T,v)}for(;(S=C())!==tw;){for(var $=[];S!==RO&&S!==tw;)$.push(S),S=C();p&&($=p($,E++))==null||y.push($)}return y}function a(h,p){return h.map(function(y){return p.map(function(v){return d(y[v])}).join(e)})}function s(h,p){return p==null&&(p=zO(h)),[p.map(d).join(e)].concat(a(h,p)).join(`
`)}function o(h,p){return p==null&&(p=zO(h)),a(h,p).join(`
`)}function l(h){return h.map(f).join(`
`)}function f(h){return h.map(d).join(e)}function d(h){return h==null?"":h instanceof Date?UJ(h):t.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:i,parseRows:r,format:s,formatBody:o,formatRows:l,formatRow:f,formatValue:d}}function IJ(e){return e}function qJ(e){if(e==null)return IJ;var t,n,i=e.scale[0],r=e.scale[1],a=e.translate[0],s=e.translate[1];return function(o,l){l||(t=n=0);var f=2,d=o.length,h=new Array(d);for(h[0]=(t+=o[0])*i+a,h[1]=(n+=o[1])*r+s;f<d;)h[f]=o[f],++f;return h}}function HJ(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function GJ(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return BO(e,n)})}:BO(e,t)}function BO(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,a=IB(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:a}:i==null?{type:"Feature",id:n,properties:r,geometry:a}:{type:"Feature",id:n,bbox:i,properties:r,geometry:a}}function IB(e,t){var n=qJ(e.transform),i=e.arcs;function r(d,h){h.length&&h.pop();for(var p=i[d<0?~d:d],y=0,v=p.length;y<v;++y)h.push(n(p[y],y));d<0&&HJ(h,v)}function a(d){return n(d)}function s(d){for(var h=[],p=0,y=d.length;p<y;++p)r(d[p],h);return h.length<2&&h.push(h[0]),h}function o(d){for(var h=s(d);h.length<4;)h.push(h[0]);return h}function l(d){return d.map(o)}function f(d){var h=d.type,p;switch(h){case"GeometryCollection":return{type:h,geometries:d.geometries.map(f)};case"Point":p=a(d.coordinates);break;case"MultiPoint":p=d.coordinates.map(a);break;case"LineString":p=s(d.arcs);break;case"MultiLineString":p=d.arcs.map(s);break;case"Polygon":p=l(d.arcs);break;case"MultiPolygon":p=d.arcs.map(l);break;default:return null}return{type:h,coordinates:p}}return f(t)}function YJ(e,t){var n={},i={},r={},a=[],s=-1;t.forEach(function(f,d){var h=e.arcs[f<0?~f:f],p;h.length<3&&!h[1][0]&&!h[1][1]&&(p=t[++s],t[s]=f,t[d]=p)}),t.forEach(function(f){var d=o(f),h=d[0],p=d[1],y,v;if(y=r[h])if(delete r[y.end],y.push(f),y.end=p,v=i[p]){delete i[v.start];var b=v===y?y:y.concat(v);i[b.start=y.start]=r[b.end=v.end]=b}else i[y.start]=r[y.end]=y;else if(y=i[p])if(delete i[y.start],y.unshift(f),y.start=h,v=r[h]){delete r[v.end];var E=v===y?y:v.concat(y);i[E.start=v.start]=r[E.end=y.end]=E}else i[y.start]=r[y.end]=y;else y=[f],i[y.start=h]=r[y.end=p]=y});function o(f){var d=e.arcs[f<0?~f:f],h=d[0],p;return e.transform?(p=[0,0],d.forEach(function(y){p[0]+=y[0],p[1]+=y[1]})):p=d[d.length-1],f<0?[p,h]:[h,p]}function l(f,d){for(var h in f){var p=f[h];delete d[p.start],delete p.start,delete p.end,p.forEach(function(y){n[y<0?~y:y]=1}),a.push(p)}}return l(r,i),l(i,r),t.forEach(function(f){n[f<0?~f:f]||a.push([f])}),a}function VJ(e){return IB(e,XJ.apply(this,arguments))}function XJ(e,t,n){var i,r,a;if(arguments.length>1)i=WJ(e,t,n);else for(r=0,i=new Array(a=e.arcs.length);r<a;++r)i[r]=r;return{type:"MultiLineString",arcs:YJ(e,i)}}function WJ(e,t,n){var i=[],r=[],a;function s(h){var p=h<0?~h:h;(r[p]||(r[p]=[])).push({i:h,g:a})}function o(h){h.forEach(s)}function l(h){h.forEach(o)}function f(h){h.forEach(l)}function d(h){switch(a=h,h.type){case"GeometryCollection":h.geometries.forEach(d);break;case"LineString":o(h.arcs);break;case"MultiLineString":case"Polygon":l(h.arcs);break;case"MultiPolygon":f(h.arcs);break}}return d(t),r.forEach(n==null?function(h){i.push(h[0].i)}:function(h){n(h[0].g,h[h.length-1].g)&&i.push(h[0].i)}),i}function lo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function QJ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Qd(e){let t,n,i;e.length!==2?(t=lo,n=(o,l)=>lo(e(o),l),i=(o,l)=>e(o)-l):(t=e===lo||e===QJ?e:ZJ,n=e,i=e);function r(o,l,f=0,d=o.length){if(f<d){if(t(l,l)!==0)return d;do{const h=f+d>>>1;n(o[h],l)<0?f=h+1:d=h}while(f<d)}return f}function a(o,l,f=0,d=o.length){if(f<d){if(t(l,l)!==0)return d;do{const h=f+d>>>1;n(o[h],l)<=0?f=h+1:d=h}while(f<d)}return f}function s(o,l,f=0,d=o.length){const h=r(o,l,f,d-1);return h>f&&i(o[h-1],l)>-i(o[h],l)?h-1:h}return{left:r,center:s,right:a}}function ZJ(){return 0}function qB(e){return e===null?NaN:+e}function*KJ(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const HB=Qd(lo),Mu=HB.right,JJ=HB.left;Qd(qB).center;function eee(e,t){let n=0,i,r=0,a=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(i=s-r,r+=i/++n,a+=i*(s-r));else{let s=-1;for(let o of e)(o=t(o,++s,e))!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,a+=i*(o-r))}if(n>1)return a/(n-1)}function tee(e,t){const n=eee(e,t);return n&&Math.sqrt(n)}class ki{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const a=n[r],s=t+a,o=Math.abs(t)<Math.abs(a)?t-(s-a):a-(s-t);o&&(n[i++]=o),t=s}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,a,s=0;if(n>0){for(s=t[--n];n>0&&(i=s,r=t[--n],s=i+r,a=r-(s-i),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(r=a*2,i=s+r,r==i-s&&(s=i))}return s}}class LO extends Map{constructor(t,n=VB){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(U_(this,t))}has(t){return super.has(U_(this,t))}set(t,n){return super.set(GB(this,t),n)}delete(t){return super.delete(YB(this,t))}}class Hy extends Set{constructor(t,n=VB){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(U_(this,t))}add(t){return super.add(GB(this,t))}delete(t){return super.delete(YB(this,t))}}function U_({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function GB({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function YB({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function VB(e){return e!==null&&typeof e=="object"?e.valueOf():e}function nee(e,t){return Array.from(t,n=>e[n])}function iee(e=lo){if(e===lo)return XB;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function XB(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const ree=Math.sqrt(50),aee=Math.sqrt(10),see=Math.sqrt(2);function Gy(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),a=i/Math.pow(10,r),s=a>=ree?10:a>=aee?5:a>=see?2:1;let o,l,f;return r<0?(f=Math.pow(10,-r)/s,o=Math.round(e*f),l=Math.round(t*f),o/f<e&&++o,l/f>t&&--l,f=-f):(f=Math.pow(10,r)*s,o=Math.round(e/f),l=Math.round(t/f),o*f<e&&++o,l*f>t&&--l),l<o&&.5<=n&&n<2?Gy(e,t,n*2):[o,l,f]}function P_(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,a,s]=i?Gy(t,e,n):Gy(e,t,n);if(!(a>=r))return[];const o=a-r+1,l=new Array(o);if(i)if(s<0)for(let f=0;f<o;++f)l[f]=(a-f)/-s;else for(let f=0;f<o;++f)l[f]=(a-f)*s;else if(s<0)for(let f=0;f<o;++f)l[f]=(r+f)/-s;else for(let f=0;f<o;++f)l[f]=(r+f)*s;return l}function I_(e,t,n){return t=+t,e=+e,n=+n,Gy(e,t,n)[2]}function ku(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?I_(t,e,n):I_(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function Xl(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function q_(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function WB(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?XB:iee(r);i>n;){if(i-n>600){const l=i-n+1,f=t-n+1,d=Math.log(l),h=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*h*(l-h)/l)*(f-l/2<0?-1:1),y=Math.max(n,Math.floor(t-f*h/l+p)),v=Math.min(i,Math.floor(t+(l-f)*h/l+p));WB(e,t,y,v,r)}const a=e[t];let s=n,o=i;for(b0(e,n,t),r(e[i],a)>0&&b0(e,n,i);s<o;){for(b0(e,s,o),++s,--o;r(e[s],a)<0;)++s;for(;r(e[o],a)>0;)--o}r(e[n],a)===0?b0(e,n,o):(++o,b0(e,o,i)),o<=t&&(n=o+1),t<=o&&(i=o-1)}return e}function b0(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function H_(e,t,n){if(e=Float64Array.from(KJ(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return q_(e);if(t>=1)return Xl(e);var i,r=(i-1)*t,a=Math.floor(r),s=Xl(WB(e,a).subarray(0,a+1)),o=q_(e.subarray(a+1));return s+(o-s)*(r-a)}}function QB(e,t,n=qB){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,a=Math.floor(r),s=+n(e[a],a,e),o=+n(e[a+1],a+1,e);return s+(o-s)*(r-a)}}function oee(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let a of e)(a=t(a,++r,e))!=null&&(a=+a)>=a&&(++n,i+=a)}if(n)return i/n}function ZB(e,t){return H_(e,.5,t)}function*uee(e){for(const t of e)yield*t}function KB(e){return Array.from(uee(e))}function Er(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(r);++i<r;)a[i]=e+i*n;return a}function JB(e,t){let n=0;for(let i of e)(i=+i)&&(n+=i);return n}function lee(e,...t){e=new Hy(e),t=t.map(cee);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function cee(e){return e instanceof Hy?e:new Hy(e)}function fee(...e){const t=new Hy;for(const n of e)for(const i of n)t.add(i);return t}function dee(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Yy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function dd(e){return e=Yy(Math.abs(e)),e?e[1]:NaN}function hee(e,t){return function(n,i){for(var r=n.length,a=[],s=0,o=e[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),a.push(n.substring(r-=o,r+o)),!((l+=o+1)>i));)o=e[s=(s+1)%e.length];return a.reverse().join(t)}}function gee(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var pee=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ic(e){if(!(t=pee.exec(e)))throw new Error("invalid format: "+e);var t;return new A$({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ic.prototype=A$.prototype;function A$(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}A$.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function mee(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var eL;function yee(e,t){var n=Yy(e,t);if(!n)return e+"";var i=n[0],r=n[1],a=r-(eL=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return a===s?i:a>s?i+new Array(a-s+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+Yy(e,Math.max(0,t+a-1))[0]}function jO(e,t){var n=Yy(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const UO={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:dee,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>jO(e*100,t),r:jO,s:yee,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function PO(e){return e}var IO=Array.prototype.map,qO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function tL(e){var t=e.grouping===void 0||e.thousands===void 0?PO:hee(IO.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?PO:gee(IO.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function f(h){h=ic(h);var p=h.fill,y=h.align,v=h.sign,b=h.symbol,E=h.zero,S=h.width,w=h.comma,_=h.precision,C=h.trim,$=h.type;$==="n"?(w=!0,$="g"):UO[$]||(_===void 0&&(_=12),C=!0,$="g"),(E||p==="0"&&y==="=")&&(E=!0,p="0",y="=");var M=b==="$"?n:b==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",T=b==="$"?i:/[%p]/.test($)?s:"",F=UO[$],R=/[defgprs%]/.test($);_=_===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function B(L){var Y=M,H=T,U,z,O;if($==="c")H=F(L)+H,L="";else{L=+L;var I=L<0||1/L<0;if(L=isNaN(L)?l:F(Math.abs(L),_),C&&(L=mee(L)),I&&+L==0&&v!=="+"&&(I=!1),Y=(I?v==="("?v:o:v==="-"||v==="("?"":v)+Y,H=($==="s"?qO[8+eL/3]:"")+H+(I&&v==="("?")":""),R){for(U=-1,z=L.length;++U<z;)if(O=L.charCodeAt(U),48>O||O>57){H=(O===46?r+L.slice(U+1):L.slice(U))+H,L=L.slice(0,U);break}}}w&&!E&&(L=t(L,1/0));var W=Y.length+L.length+H.length,K=W<S?new Array(S-W+1).join(p):"";switch(w&&E&&(L=t(K+L,K.length?S-H.length:1/0),K=""),y){case"<":L=Y+L+H+K;break;case"=":L=Y+K+L+H;break;case"^":L=K.slice(0,W=K.length>>1)+Y+L+H+K.slice(W);break;default:L=K+Y+L+H;break}return a(L)}return B.toString=function(){return h+""},B}function d(h,p){var y=f((h=ic(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(dd(p)/3)))*3,b=Math.pow(10,-v),E=qO[8+v/3];return function(S){return y(b*S)+E}}return{format:f,formatPrefix:d}}var C1,Ob,w$;vee({thousands:",",grouping:[3],currency:["$",""]});function vee(e){return C1=tL(e),Ob=C1.format,w$=C1.formatPrefix,C1}function nL(e){return Math.max(0,-dd(Math.abs(e)))}function iL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(dd(t)/3)))*3-dd(Math.abs(e)))}function rL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,dd(t)-dd(e))+1}const rw=new Date,aw=new Date;function _n(e,t,n,i){function r(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return r.floor=a=>(e(a=new Date(+a)),a),r.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),r.round=a=>{const s=r(a),o=r.ceil(a);return a-s<o-a?s:o},r.offset=(a,s)=>(t(a=new Date(+a),s==null?1:Math.floor(s)),a),r.range=(a,s,o)=>{const l=[];if(a=r.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return l;let f;do l.push(f=new Date(+a)),t(a,o),e(a);while(f<a&&a<s);return l},r.filter=a=>_n(s=>{if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!a(s););else for(;--o>=0;)for(;t(s,1),!a(s););}),n&&(r.count=(a,s)=>(rw.setTime(+a),aw.setTime(+s),e(rw),e(aw),Math.floor(n(rw,aw))),r.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?r.filter(i?s=>i(s)%a===0:s=>r.count(0,s)%a===0):r)),r}const hd=_n(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);hd.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?_n(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):hd);hd.range;const io=1e3,Hr=io*60,ro=Hr*60,vo=ro*24,_$=vo*7,HO=vo*30,sw=vo*365,ao=_n(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*io)},(e,t)=>(t-e)/io,e=>e.getUTCSeconds());ao.range;const Rb=_n(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*io)},(e,t)=>{e.setTime(+e+t*Hr)},(e,t)=>(t-e)/Hr,e=>e.getMinutes());Rb.range;const zb=_n(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Hr)},(e,t)=>(t-e)/Hr,e=>e.getUTCMinutes());zb.range;const Bb=_n(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*io-e.getMinutes()*Hr)},(e,t)=>{e.setTime(+e+t*ro)},(e,t)=>(t-e)/ro,e=>e.getHours());Bb.range;const Lb=_n(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ro)},(e,t)=>(t-e)/ro,e=>e.getUTCHours());Lb.range;const co=_n(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Hr)/vo,e=>e.getDate()-1);co.range;const wu=_n(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/vo,e=>e.getUTCDate()-1);wu.range;const aL=_n(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/vo,e=>Math.floor(e/vo));aL.range;function $c(e){return _n(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Hr)/_$)}const Zd=$c(0),Vy=$c(1),bee=$c(2),xee=$c(3),gd=$c(4),Eee=$c(5),See=$c(6);Zd.range;Vy.range;bee.range;xee.range;gd.range;Eee.range;See.range;function Dc(e){return _n(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/_$)}const Kd=Dc(0),Xy=Dc(1),Aee=Dc(2),wee=Dc(3),pd=Dc(4),_ee=Dc(5),Cee=Dc(6);Kd.range;Xy.range;Aee.range;wee.range;pd.range;_ee.range;Cee.range;const Mg=_n(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Mg.range;const kg=_n(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());kg.range;const fs=_n(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_n(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});fs.range;const ds=_n(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ds.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_n(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});ds.range;function sL(e,t,n,i,r,a){const s=[[ao,1,io],[ao,5,5*io],[ao,15,15*io],[ao,30,30*io],[a,1,Hr],[a,5,5*Hr],[a,15,15*Hr],[a,30,30*Hr],[r,1,ro],[r,3,3*ro],[r,6,6*ro],[r,12,12*ro],[i,1,vo],[i,2,2*vo],[n,1,_$],[t,1,HO],[t,3,3*HO],[e,1,sw]];function o(f,d,h){const p=d<f;p&&([f,d]=[d,f]);const y=h&&typeof h.range=="function"?h:l(f,d,h),v=y?y.range(f,+d+1):[];return p?v.reverse():v}function l(f,d,h){const p=Math.abs(d-f)/h,y=Qd(([,,E])=>E).right(s,p);if(y===s.length)return e.every(ku(f/sw,d/sw,h));if(y===0)return hd.every(Math.max(ku(f,d,h),1));const[v,b]=s[p/s[y-1][2]<s[y][2]/p?y-1:y];return v.every(b)}return[o,l]}const[$ee,Dee]=sL(ds,kg,Kd,aL,Lb,zb),[Tee,Mee]=sL(fs,Mg,Zd,co,Bb,Rb),Jn="year",Ji="quarter",gi="month",Sn="week",er="date",ci="day",hs="dayofyear",$r="hours",Dr="minutes",Kr="seconds",_a="milliseconds",C$=[Jn,Ji,gi,Sn,er,ci,hs,$r,Dr,Kr,_a],ow=C$.reduce((e,t,n)=>(e[t]=1+n,e),{});function $$(e){const t=Fe(e).slice(),n={};return t.length||ae("Missing time unit."),t.forEach(r=>{ze(ow,r)?n[r]=1:ae(`Invalid time unit: ${r}.`)}),(n[Sn]||n[ci]?1:0)+(n[Ji]||n[gi]||n[er]?1:0)+(n[hs]?1:0)>1&&ae(`Incompatible time units: ${e}`),t.sort((r,a)=>ow[r]-ow[a]),t}const kee={[Jn]:"%Y ",[Ji]:"Q%q ",[gi]:"%b ",[er]:"%d ",[Sn]:"W%U ",[ci]:"%a ",[hs]:"%j ",[$r]:"%H:00",[Dr]:"00:%M",[Kr]:":%S",[_a]:".%L",[`${Jn}-${gi}`]:"%Y-%m ",[`${Jn}-${gi}-${er}`]:"%Y-%m-%d ",[`${$r}-${Dr}`]:"%H:%M"};function oL(e,t){const n=Ve({},kee,t),i=$$(e),r=i.length;let a="",s=0,o,l;for(s=0;s<r;)for(o=i.length;o>s;--o)if(l=i.slice(s,o).join("-"),n[l]!=null){a+=n[l],s=o;break}return a.trim()}const zl=new Date;function D$(e){return zl.setFullYear(e),zl.setMonth(0),zl.setDate(1),zl.setHours(0,0,0,0),zl}function uL(e){return cL(new Date(e))}function lL(e){return G_(new Date(e))}function cL(e){return co.count(D$(e.getFullYear())-1,e)}function G_(e){return Zd.count(D$(e.getFullYear())-1,e)}function Y_(e){return D$(e).getDay()}function Nee(e,t,n,i,r,a,s){if(0<=e&&e<100){const o=new Date(-1,t,n,i,r,a,s);return o.setFullYear(e),o}return new Date(e,t,n,i,r,a,s)}function fL(e){return hL(new Date(e))}function dL(e){return V_(new Date(e))}function hL(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return wu.count(t-1,e)}function V_(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Kd.count(t-1,e)}function X_(e){return zl.setTime(Date.UTC(e,0,1)),zl.getUTCDay()}function Fee(e,t,n,i,r,a,s){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,i,r,a,s));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,i,r,a,s))}function gL(e,t,n,i,r){const a=t||1,s=st(e),o=(S,w,_)=>(_=_||S,Oee(n[_],i[_],S===s&&a,w)),l=new Date,f=wa(e),d=f[Jn]?o(Jn):bi(2012),h=f[gi]?o(gi):f[Ji]?o(Ji):du,p=f[Sn]&&f[ci]?o(ci,1,Sn+ci):f[Sn]?o(Sn,1):f[ci]?o(ci,1):f[er]?o(er,1):f[hs]?o(hs,1):Xd,y=f[$r]?o($r):du,v=f[Dr]?o(Dr):du,b=f[Kr]?o(Kr):du,E=f[_a]?o(_a):du;return function(S){l.setTime(+S);const w=d(l);return r(w,h(l),p(l,w),y(l),v(l),b(l),E(l))}}function Oee(e,t,n,i){const r=n<=1?e:i?(a,s)=>i+n*Math.floor((e(a,s)-i)/n):(a,s)=>n*Math.floor(e(a,s)/n);return t?(a,s)=>t(r(a,s),s):r}function md(e,t,n){return t+e*7-(n+6)%7}const Ree={[Jn]:e=>e.getFullYear(),[Ji]:e=>Math.floor(e.getMonth()/3),[gi]:e=>e.getMonth(),[er]:e=>e.getDate(),[$r]:e=>e.getHours(),[Dr]:e=>e.getMinutes(),[Kr]:e=>e.getSeconds(),[_a]:e=>e.getMilliseconds(),[hs]:e=>cL(e),[Sn]:e=>G_(e),[Sn+ci]:(e,t)=>md(G_(e),e.getDay(),Y_(t)),[ci]:(e,t)=>md(1,e.getDay(),Y_(t))},zee={[Ji]:e=>3*e,[Sn]:(e,t)=>md(e,0,Y_(t))};function pL(e,t){return gL(e,t||1,Ree,zee,Nee)}const Bee={[Jn]:e=>e.getUTCFullYear(),[Ji]:e=>Math.floor(e.getUTCMonth()/3),[gi]:e=>e.getUTCMonth(),[er]:e=>e.getUTCDate(),[$r]:e=>e.getUTCHours(),[Dr]:e=>e.getUTCMinutes(),[Kr]:e=>e.getUTCSeconds(),[_a]:e=>e.getUTCMilliseconds(),[hs]:e=>hL(e),[Sn]:e=>V_(e),[ci]:(e,t)=>md(1,e.getUTCDay(),X_(t)),[Sn+ci]:(e,t)=>md(V_(e),e.getUTCDay(),X_(t))},Lee={[Ji]:e=>3*e,[Sn]:(e,t)=>md(e,0,X_(t))};function mL(e,t){return gL(e,t||1,Bee,Lee,Fee)}const jee={[Jn]:fs,[Ji]:Mg.every(3),[gi]:Mg,[Sn]:Zd,[er]:co,[ci]:co,[hs]:co,[$r]:Bb,[Dr]:Rb,[Kr]:ao,[_a]:hd},Uee={[Jn]:ds,[Ji]:kg.every(3),[gi]:kg,[Sn]:Kd,[er]:wu,[ci]:wu,[hs]:wu,[$r]:Lb,[Dr]:zb,[Kr]:ao,[_a]:hd};function Jd(e){return jee[e]}function eh(e){return Uee[e]}function yL(e,t,n){return e?e.offset(t,n):void 0}function vL(e,t,n){return yL(Jd(e),t,n)}function bL(e,t,n){return yL(eh(e),t,n)}function xL(e,t,n,i){return e?e.range(t,n,i):void 0}function EL(e,t,n,i){return xL(Jd(e),t,n,i)}function SL(e,t,n,i){return xL(eh(e),t,n,i)}const q0=1e3,H0=q0*60,G0=H0*60,jb=G0*24,Pee=jb*7,GO=jb*30,W_=jb*365,AL=[Jn,gi,er,$r,Dr,Kr,_a],Y0=AL.slice(0,-1),V0=Y0.slice(0,-1),X0=V0.slice(0,-1),Iee=X0.slice(0,-1),qee=[Jn,Sn],YO=[Jn,gi],wL=[Jn],x0=[[Y0,1,q0],[Y0,5,5*q0],[Y0,15,15*q0],[Y0,30,30*q0],[V0,1,H0],[V0,5,5*H0],[V0,15,15*H0],[V0,30,30*H0],[X0,1,G0],[X0,3,3*G0],[X0,6,6*G0],[X0,12,12*G0],[Iee,1,jb],[qee,1,Pee],[YO,1,GO],[YO,3,3*GO],[wL,1,W_]];function _L(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(gp(t))/n;let r=Qd(o=>o[2]).right(x0,i),a,s;return r===x0.length?(a=wL,s=ku(t[0]/W_,t[1]/W_,n)):r?(r=x0[i/x0[r-1][2]<x0[r][2]/i?r-1:r],a=r[0],s=r[1]):(a=AL,s=Math.max(ku(t[0],t[1],n),1)),{units:a,step:s}}function uw(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function lw(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function E0(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function CL(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,a=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,f=S0(r),d=A0(r),h=S0(a),p=A0(a),y=S0(s),v=A0(s),b=S0(o),E=A0(o),S=S0(l),w=A0(l),_={a:I,A:W,b:K,B:k,c:null,d:KO,e:KO,f:dte,g:Ste,G:wte,H:lte,I:cte,j:fte,L:$L,m:hte,M:gte,p:V,q:X,Q:tR,s:nR,S:pte,u:mte,U:yte,V:vte,w:bte,W:xte,x:null,X:null,y:Ete,Y:Ate,Z:_te,"%":eR},C={a:ne,A:ye,b:le,B:be,c:null,d:JO,e:JO,f:Tte,g:jte,G:Pte,H:Cte,I:$te,j:Dte,L:TL,m:Mte,M:kte,p:Ye,q:it,Q:tR,s:nR,S:Nte,u:Fte,U:Ote,V:Rte,w:zte,W:Bte,x:null,X:null,y:Lte,Y:Ute,Z:Ite,"%":eR},$={a:B,A:L,b:Y,B:H,c:U,d:QO,e:QO,f:ate,g:WO,G:XO,H:ZO,I:ZO,j:tte,L:rte,m:ete,M:nte,p:R,q:Jee,Q:ote,s:ute,S:ite,u:Xee,U:Wee,V:Qee,w:Vee,W:Zee,x:z,X:O,y:WO,Y:XO,Z:Kee,"%":ste};_.x=M(n,_),_.X=M(i,_),_.c=M(t,_),C.x=M(n,C),C.X=M(i,C),C.c=M(t,C);function M(xe,Ie){return function(Ge){var he=[],nn=-1,lt=0,fn=xe.length,$n,dn,lm;for(Ge instanceof Date||(Ge=new Date(+Ge));++nn<fn;)xe.charCodeAt(nn)===37&&(he.push(xe.slice(lt,nn)),(dn=VO[$n=xe.charAt(++nn)])!=null?$n=xe.charAt(++nn):dn=$n==="e"?" ":"0",(lm=Ie[$n])&&($n=lm(Ge,dn)),he.push($n),lt=nn+1);return he.push(xe.slice(lt,nn)),he.join("")}}function T(xe,Ie){return function(Ge){var he=E0(1900,void 0,1),nn=F(he,xe,Ge+="",0),lt,fn;if(nn!=Ge.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(Ie&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(lt=lw(E0(he.y,0,1)),fn=lt.getUTCDay(),lt=fn>4||fn===0?Xy.ceil(lt):Xy(lt),lt=wu.offset(lt,(he.V-1)*7),he.y=lt.getUTCFullYear(),he.m=lt.getUTCMonth(),he.d=lt.getUTCDate()+(he.w+6)%7):(lt=uw(E0(he.y,0,1)),fn=lt.getDay(),lt=fn>4||fn===0?Vy.ceil(lt):Vy(lt),lt=co.offset(lt,(he.V-1)*7),he.y=lt.getFullYear(),he.m=lt.getMonth(),he.d=lt.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),fn="Z"in he?lw(E0(he.y,0,1)).getUTCDay():uw(E0(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(fn+5)%7:he.w+he.U*7-(fn+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,lw(he)):uw(he)}}function F(xe,Ie,Ge,he){for(var nn=0,lt=Ie.length,fn=Ge.length,$n,dn;nn<lt;){if(he>=fn)return-1;if($n=Ie.charCodeAt(nn++),$n===37){if($n=Ie.charAt(nn++),dn=$[$n in VO?Ie.charAt(nn++):$n],!dn||(he=dn(xe,Ge,he))<0)return-1}else if($n!=Ge.charCodeAt(he++))return-1}return he}function R(xe,Ie,Ge){var he=f.exec(Ie.slice(Ge));return he?(xe.p=d.get(he[0].toLowerCase()),Ge+he[0].length):-1}function B(xe,Ie,Ge){var he=y.exec(Ie.slice(Ge));return he?(xe.w=v.get(he[0].toLowerCase()),Ge+he[0].length):-1}function L(xe,Ie,Ge){var he=h.exec(Ie.slice(Ge));return he?(xe.w=p.get(he[0].toLowerCase()),Ge+he[0].length):-1}function Y(xe,Ie,Ge){var he=S.exec(Ie.slice(Ge));return he?(xe.m=w.get(he[0].toLowerCase()),Ge+he[0].length):-1}function H(xe,Ie,Ge){var he=b.exec(Ie.slice(Ge));return he?(xe.m=E.get(he[0].toLowerCase()),Ge+he[0].length):-1}function U(xe,Ie,Ge){return F(xe,t,Ie,Ge)}function z(xe,Ie,Ge){return F(xe,n,Ie,Ge)}function O(xe,Ie,Ge){return F(xe,i,Ie,Ge)}function I(xe){return s[xe.getDay()]}function W(xe){return a[xe.getDay()]}function K(xe){return l[xe.getMonth()]}function k(xe){return o[xe.getMonth()]}function V(xe){return r[+(xe.getHours()>=12)]}function X(xe){return 1+~~(xe.getMonth()/3)}function ne(xe){return s[xe.getUTCDay()]}function ye(xe){return a[xe.getUTCDay()]}function le(xe){return l[xe.getUTCMonth()]}function be(xe){return o[xe.getUTCMonth()]}function Ye(xe){return r[+(xe.getUTCHours()>=12)]}function it(xe){return 1+~~(xe.getUTCMonth()/3)}return{format:function(xe){var Ie=M(xe+="",_);return Ie.toString=function(){return xe},Ie},parse:function(xe){var Ie=T(xe+="",!1);return Ie.toString=function(){return xe},Ie},utcFormat:function(xe){var Ie=M(xe+="",C);return Ie.toString=function(){return xe},Ie},utcParse:function(xe){var Ie=T(xe+="",!0);return Ie.toString=function(){return xe},Ie}}}var VO={"-":"",_:" ",0:"0"},Pn=/^\s*\d+/,Hee=/^%/,Gee=/[\\^$*+?|[\]().{}]/g;function mt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(t)+r:r)}function Yee(e){return e.replace(Gee,"\\$&")}function S0(e){return new RegExp("^(?:"+e.map(Yee).join("|")+")","i")}function A0(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Vee(e,t,n){var i=Pn.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function Xee(e,t,n){var i=Pn.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function Wee(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function Qee(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function Zee(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function XO(e,t,n){var i=Pn.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function WO(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Kee(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Jee(e,t,n){var i=Pn.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function ete(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function QO(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function tte(e,t,n){var i=Pn.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function ZO(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function nte(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function ite(e,t,n){var i=Pn.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function rte(e,t,n){var i=Pn.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function ate(e,t,n){var i=Pn.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function ste(e,t,n){var i=Hee.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function ote(e,t,n){var i=Pn.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function ute(e,t,n){var i=Pn.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function KO(e,t){return mt(e.getDate(),t,2)}function lte(e,t){return mt(e.getHours(),t,2)}function cte(e,t){return mt(e.getHours()%12||12,t,2)}function fte(e,t){return mt(1+co.count(fs(e),e),t,3)}function $L(e,t){return mt(e.getMilliseconds(),t,3)}function dte(e,t){return $L(e,t)+"000"}function hte(e,t){return mt(e.getMonth()+1,t,2)}function gte(e,t){return mt(e.getMinutes(),t,2)}function pte(e,t){return mt(e.getSeconds(),t,2)}function mte(e){var t=e.getDay();return t===0?7:t}function yte(e,t){return mt(Zd.count(fs(e)-1,e),t,2)}function DL(e){var t=e.getDay();return t>=4||t===0?gd(e):gd.ceil(e)}function vte(e,t){return e=DL(e),mt(gd.count(fs(e),e)+(fs(e).getDay()===4),t,2)}function bte(e){return e.getDay()}function xte(e,t){return mt(Vy.count(fs(e)-1,e),t,2)}function Ete(e,t){return mt(e.getFullYear()%100,t,2)}function Ste(e,t){return e=DL(e),mt(e.getFullYear()%100,t,2)}function Ate(e,t){return mt(e.getFullYear()%1e4,t,4)}function wte(e,t){var n=e.getDay();return e=n>=4||n===0?gd(e):gd.ceil(e),mt(e.getFullYear()%1e4,t,4)}function _te(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+mt(t/60|0,"0",2)+mt(t%60,"0",2)}function JO(e,t){return mt(e.getUTCDate(),t,2)}function Cte(e,t){return mt(e.getUTCHours(),t,2)}function $te(e,t){return mt(e.getUTCHours()%12||12,t,2)}function Dte(e,t){return mt(1+wu.count(ds(e),e),t,3)}function TL(e,t){return mt(e.getUTCMilliseconds(),t,3)}function Tte(e,t){return TL(e,t)+"000"}function Mte(e,t){return mt(e.getUTCMonth()+1,t,2)}function kte(e,t){return mt(e.getUTCMinutes(),t,2)}function Nte(e,t){return mt(e.getUTCSeconds(),t,2)}function Fte(e){var t=e.getUTCDay();return t===0?7:t}function Ote(e,t){return mt(Kd.count(ds(e)-1,e),t,2)}function ML(e){var t=e.getUTCDay();return t>=4||t===0?pd(e):pd.ceil(e)}function Rte(e,t){return e=ML(e),mt(pd.count(ds(e),e)+(ds(e).getUTCDay()===4),t,2)}function zte(e){return e.getUTCDay()}function Bte(e,t){return mt(Xy.count(ds(e)-1,e),t,2)}function Lte(e,t){return mt(e.getUTCFullYear()%100,t,2)}function jte(e,t){return e=ML(e),mt(e.getUTCFullYear()%100,t,2)}function Ute(e,t){return mt(e.getUTCFullYear()%1e4,t,4)}function Pte(e,t){var n=e.getUTCDay();return e=n>=4||n===0?pd(e):pd.ceil(e),mt(e.getUTCFullYear()%1e4,t,4)}function Ite(){return"+0000"}function eR(){return"%"}function tR(e){return+e}function nR(e){return Math.floor(+e/1e3)}var Ff,T$,kL,M$,NL;qte({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function qte(e){return Ff=CL(e),T$=Ff.format,kL=Ff.parse,M$=Ff.utcFormat,NL=Ff.utcParse,Ff}function W0(e){const t={};return n=>t[n]||(t[n]=e(n))}function Hte(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let a=Gte(i,r);const s=a<i.length?i.slice(a):"";for(;--a>r;)if(i[a]!=="0"){++a;break}return i.slice(0,a)+s}}function Gte(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function FL(e){const t=W0(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=ic(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return Hte(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,a,s){s=ic(s??",f");const o=ku(i,r,a),l=Math.max(Math.abs(i),Math.abs(r));let f;if(s.precision==null)switch(s.type){case"s":return isNaN(f=iL(o,l))||(s.precision=f),n(s,l);case"":case"e":case"g":case"p":case"r":{isNaN(f=rL(o,l))||(s.precision=f-(s.type==="e"));break}case"f":case"%":{isNaN(f=nL(o))||(s.precision=f-(s.type==="%")*2);break}}return t(s)}}}let Q_;OL();function OL(){return Q_=FL({format:Ob,formatPrefix:w$})}function RL(e){return FL(tL(e))}function Wy(e){return arguments.length?Q_=RL(e):Q_}function iR(e,t,n){n=n||{},Pe(n)||ae(`Invalid time multi-format specifier: ${n}`);const i=t(Kr),r=t(Dr),a=t($r),s=t(er),o=t(Sn),l=t(gi),f=t(Ji),d=t(Jn),h=e(n[_a]||".%L"),p=e(n[Kr]||":%S"),y=e(n[Dr]||"%I:%M"),v=e(n[$r]||"%I %p"),b=e(n[er]||n[ci]||"%a %d"),E=e(n[Sn]||"%b %d"),S=e(n[gi]||"%B"),w=e(n[Ji]||"%B"),_=e(n[Jn]||"%Y");return C=>(i(C)<C?h:r(C)<C?p:a(C)<C?y:s(C)<C?v:l(C)<C?o(C)<C?b:E:d(C)<C?f(C)<C?S:w:_)(C)}function zL(e){const t=W0(e.format),n=W0(e.utcFormat);return{timeFormat:i=>ft(i)?t(i):iR(t,Jd,i),utcFormat:i=>ft(i)?n(i):iR(n,eh,i),timeParse:W0(e.parse),utcParse:W0(e.utcParse)}}let Z_;BL();function BL(){return Z_=zL({format:T$,parse:kL,utcFormat:M$,utcParse:NL})}function LL(e){return zL(CL(e))}function Ng(e){return arguments.length?Z_=LL(e):Z_}const K_=(e,t)=>Ve({},e,t);function jL(e,t){const n=e?RL(e):Wy(),i=t?LL(t):Ng();return K_(n,i)}function k$(e,t){const n=arguments.length;return n&&n!==2&&ae("defaultLocale expects either zero or two arguments."),n?K_(Wy(e),Ng(t)):K_(Wy(),Ng())}function Yte(){return OL(),BL(),k$()}const Vte=/^(data:|([A-Za-z]+:)?\/\/)/,Xte=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Wte=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,rR="file://";function Qte(e,t){return n=>({options:n||{},sanitize:Kte,load:Zte,fileAccess:!1,file:Jte(t),http:tne(e)})}async function Zte(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function Kte(e,t){t=Ve({},this.options,t);const n=this.fileAccess,i={href:null};let r,a,s;const o=Xte.test(e.replace(Wte,""));(e==null||typeof e!="string"||!o)&&ae("Sanitize failure, invalid URI: "+$e(e));const l=Vte.test(e);return(s=t.baseURL)&&!l&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),a=(r=e.startsWith(rR))||t.mode==="file"||t.mode!=="http"&&!l&&n,r?e=e.slice(rR.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!a}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function Jte(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,a)=>{r?i(r):n(a)})}):ene}async function ene(){ae("No file system access.")}function tne(e){return e?async function(t,n){const i=Ve({},this.options.http,n),r=n&&n.response,a=await e(t,i);return a.ok?We(a[r])?a[r]():a.text():ae(a.status+""+a.statusText)}:nne}async function nne(){ae("No HTTP fetch method available.")}const ine=e=>e!=null&&e===e,rne=e=>e==="true"||e==="false"||e===!0||e===!1,ane=e=>!Number.isNaN(Date.parse(e)),UL=e=>!Number.isNaN(+e)&&!(e instanceof Date),sne=e=>UL(e)&&Number.isInteger(+e),J_={boolean:x$,integer:fi,number:fi,date:E$,string:S$,unknown:Fi},$1=[rne,sne,UL,ane],one=["boolean","integer","number","date"];function PL(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=$1.length,r=$1.map((a,s)=>s+1);for(let a=0,s=0,o,l;a<n;++a)for(l=t?e[a][t]:e[a],o=0;o<i;++o)if(r[o]&&ine(l)&&!$1[o](l)&&(r[o]=0,++s,s===$1.length))return"string";return one[r.reduce((a,s)=>a===0?s:a,0)-1]}function IL(e,t){return t.reduce((n,i)=>(n[i]=PL(e,i),n),{})}function aR(e){const t=function(n,i){const r={delimiter:e};return N$(n,i?Ve(i,r):r)};return t.responseType="text",t}function N$(e,t){return t.header&&(e=t.header.map($e).join(t.delimiter)+`
`+e),PJ(t.delimiter).parse(e+"")}N$.responseType="text";function une(e){return typeof Buffer=="function"&&We(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function F$(e,t){const n=t&&t.property?Qr(t.property):Fi;return Pe(e)&&!une(e)?lne(n(e),t):n(JSON.parse(e))}F$.responseType="json";function lne(e,t){return!De(e)&&RB(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const cne={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function qL(e,t){let n,i,r,a;return e=F$(e,t),t&&t.feature?(n=GJ,r=t.feature):t&&t.mesh?(n=VJ,r=t.mesh,a=cne[t.filter]):ae("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,a):ae("Invalid TopoJSON object: "+r),i&&i.features||[i]}qL.responseType="json";const dy={dsv:N$,csv:aR(","),tsv:aR("	"),json:F$,topojson:qL};function O$(e,t){return arguments.length>1?(dy[e]=t,this):ze(dy,e)?dy[e]:null}function HL(e){const t=O$(e);return t&&t.responseType||"text"}function GL(e,t,n,i){t=t||{};const r=O$(t.type||"json");return r||ae("Unknown data format type: "+t.type),e=r(e,t),t.parse&&fne(e,t.parse,n,i),ze(e,"columns")&&delete e.columns,e}function fne(e,t,n,i){if(!e.length)return;const r=Ng();n=n||r.timeParse,i=i||r.utcParse;let a=e.columns||Object.keys(e[0]),s,o,l,f,d,h;t==="auto"&&(t=IL(e,a)),a=Object.keys(t);const p=a.map(y=>{const v=t[y];let b,E;if(v&&(v.startsWith("date:")||v.startsWith("utc:")))return b=v.split(/:(.+)?/,2),E=b[1],(E[0]==="'"&&E[E.length-1]==="'"||E[0]==='"'&&E[E.length-1]==='"')&&(E=E.slice(1,-1)),(b[0]==="utc"?i:n)(E);if(!J_[v])throw Error("Illegal format pattern: "+y+":"+v);return J_[v]});for(l=0,d=e.length,h=a.length;l<d;++l)for(s=e[l],f=0;f<h;++f)o=a[f],s[o]=p[f](s[o])}const Ub=Qte(typeof fetch<"u"&&fetch,null);function Pb(e){const t=e||Fi,n=[],i={};return n.add=r=>{const a=t(r);return i[a]||(i[a]=1,n.push(r)),n},n.remove=r=>{const a=t(r);if(i[a]){i[a]=0;const s=n.indexOf(r);s>=0&&n.splice(s,1)}return n},n}async function hy(e,t){try{await t(e)}catch(n){e.error(n)}}const YL=Symbol("vega_id");let dne=1;function Ib(e){return!!(e&&ke(e))}function ke(e){return e[YL]}function VL(e,t){return e[YL]=t,e}function bt(e){const t=e===Object(e)?e:{data:e};return ke(t)?t:VL(t,dne++)}function R$(e){return qb(e,bt({}))}function qb(e,t){for(const n in e)t[n]=e[n];return t}function XL(e,t){return VL(t,ke(e))}function Tc(e,t){return e?t?(n,i)=>e(n,i)||ke(t(n))-ke(t(i)):(n,i)=>e(n,i)||ke(n)-ke(i):null}function WL(e){return e&&e.constructor===Mc}function Mc(){const e=[],t=[],n=[],i=[],r=[];let a=null,s=!1;return{constructor:Mc,insert(o){const l=Fe(o),f=l.length;for(let d=0;d<f;++d)e.push(l[d]);return this},remove(o){const l=We(o)?i:t,f=Fe(o),d=f.length;for(let h=0;h<d;++h)l.push(f[h]);return this},modify(o,l,f){const d={field:l,value:bi(f)};return We(o)?(d.filter=o,r.push(d)):(d.tuple=o,n.push(d)),this},encode(o,l){return We(o)?r.push({filter:o,field:l}):n.push({tuple:o,field:l}),this},clean(o){return a=o,this},reflow(){return s=!0,this},pulse(o,l){const f={},d={};let h,p,y,v,b,E;for(h=0,p=l.length;h<p;++h)f[ke(l[h])]=1;for(h=0,p=t.length;h<p;++h)b=t[h],f[ke(b)]=-1;for(h=0,p=i.length;h<p;++h)v=i[h],l.forEach(w=>{v(w)&&(f[ke(w)]=-1)});for(h=0,p=e.length;h<p;++h)b=e[h],E=ke(b),f[E]?f[E]=1:o.add.push(bt(e[h]));for(h=0,p=l.length;h<p;++h)b=l[h],f[ke(b)]<0&&o.rem.push(b);function S(w,_,C){C?w[_]=C(w):o.encode=_,s||(d[ke(w)]=w)}for(h=0,p=n.length;h<p;++h)y=n[h],b=y.tuple,v=y.field,E=f[ke(b)],E>0&&(S(b,v,y.value),o.modifies(v));for(h=0,p=r.length;h<p;++h)y=r[h],v=y.filter,l.forEach(w=>{v(w)&&f[ke(w)]>0&&S(w,y.field,y.value)}),o.modifies(y.field);if(s)o.mod=t.length||i.length?l.filter(w=>f[ke(w)]>0):l.slice();else for(E in d)o.mod.push(d[E]);return(a||a==null&&(t.length||i.length))&&o.clean(!0),o}}}const gy="_:mod:_";function Hb(){Object.defineProperty(this,gy,{writable:!0,value:{}})}Hb.prototype={set(e,t,n,i){const r=this,a=r[e],s=r[gy];return t!=null&&t>=0?(a[t]!==n||i)&&(a[t]=n,s[t+":"+e]=-1,s[e]=-1):(a!==n||i)&&(r[e]=n,s[e]=De(n)?1+n.length:-1),r},modified(e,t){const n=this[gy];if(arguments.length){if(De(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[gy]={},this}};let hne=0;const gne="pulse",pne=new Hb,mne=1,yne=2;function Ot(e,t,n,i){this.id=++hne,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function sR(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ot.prototype={targets(){return this._targets||(this._targets=Pb(dp))},set(e){return this.value!==e?(this.value=e,1):0},skip:sR(mne),modified:sR(yne),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Hb,r=this._argops=this._argops||[],a=[];let s,o,l,f;const d=(h,p,y)=>{y instanceof Ot?(y!==this&&(t&&y.targets().add(this),a.push(y)),r.push({op:y,name:h,index:p})):i.set(h,p,y)};for(s in e)if(o=e[s],s===gne)Fe(o).forEach(h=>{h instanceof Ot?h!==this&&(h.targets().add(this),a.push(h)):ae("Pulse parameters must be operator instances.")}),this.source=o;else if(De(o))for(i.set(s,-1,Array(l=o.length)),f=0;f<l;++f)d(s,f,o[f]);else d(s,-1,o);return this.marshall().clear(),n&&(r.initonly=!0),a},marshall(e){const t=this._argval||pne,n=this._argops;let i,r,a,s;if(n){const o=n.length;for(r=0;r<o;++r)i=n[r],a=i.op,s=a.modified()&&a.stamp===e,t.set(i.name,i.index,a.value,s);if(n.initonly){for(r=0;r<o;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function vne(e,t,n,i){let r=1,a;return e instanceof Ot?a=e:e&&e.prototype instanceof Ot?a=new e:We(e)?a=new Ot(null,e):(r=0,a=new Ot(e,t)),this.rank(a),r&&(i=n,n=t),n&&this.connect(a,a.parameters(n,i)),this.touch(a),a}function bne(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let xne=0;function Gb(e,t,n){this.id=++xne,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function au(e,t,n){return new Gb(e,t,n)}Gb.prototype={_filter:Zr,_apply:Fi,targets(){return this._targets||(this._targets=Pb(dp))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=au(e);return this.targets().add(t),t},apply(e){const t=au(null,e);return this.targets().add(t),t},merge(){const e=au();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=au();return this.targets().add(au(null,null,m$(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(au(null,null,()=>n=!0)),t.targets().add(au(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Zr,this._targets=null}};function Ene(e,t,n,i){const r=this,a=au(n,i),s=function(f){f.dataflow=r;try{a.receive(f)}catch(d){r.error(d)}finally{r.run()}};let o;typeof e=="string"&&typeof document<"u"?o=document.querySelectorAll(e):o=Fe(e);const l=o.length;for(let f=0;f<l;++f)o[f].addEventListener(t,s);return a}function Sne(e,t){const n=this.locale();return GL(e,t,n.timeParse,n.utcParse)}function Ane(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function wne(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:HL(t&&t.type)});try{r=n.parse(r,t)}catch(a){i=-2,n.warn("Data ingestion failed",e,a)}}catch(a){i=-1,n.warn("Loading failed",e,a)}return{data:r,status:i}}async function _ne(e,t,n){const i=this,r=i._pending||Cne(i);r.requests+=1;const a=await i.request(t,n);return i.pulse(e,i.changeset().remove(Zr).insert(a.data||[])),r.done(),a}function Cne(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const $ne={skip:!0};function Dne(e,t,n,i,r){return(e instanceof Ot?Mne:Tne)(this,e,t,n,i,r),this}function Tne(e,t,n,i,r,a){const s=Ve({},a,$ne);let o,l;We(n)||(n=bi(n)),i===void 0?o=f=>e.touch(n(f)):We(i)?(l=new Ot(null,i,r,!1),o=f=>{l.evaluate(f);const d=n(f),h=l.value;WL(h)?e.pulse(d,h,a):e.update(d,h,s)}):o=f=>e.update(n(f),i,s),t.apply(o)}function Mne(e,t,n,i,r,a){if(i===void 0)t.targets().add(n);else{const s=a||{},o=new Ot(null,kne(n,i),r,!1);o.modified(s.force),o.rank=t.rank,t.targets().add(o),n&&(o.skip(!0),o.value=n.value,o.targets().add(n),e.connect(n,[o]))}}function kne(e,t){return t=We(t)?t:bi(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function Nne(e){e.rank=++this._rank}function Fne(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&ae("Cycle detected in dataflow graph.")}const Qy={},Qa=1,uu=2,Zs=4,One=Qa|uu,oR=Qa|Zs,Of=Qa|uu|Zs,uR=8,w0=16,lR=32,cR=64;function _u(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function cw(e,t){const n=[];return ou(e,t,i=>n.push(i)),n}function fR(e,t){const n={};return e.visit(t,i=>{n[ke(i)]=1}),i=>n[ke(i)]?null:i}function D1(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}_u.prototype={StopPropagation:Qy,ADD:Qa,REM:uu,MOD:Zs,ADD_REM:One,ADD_MOD:oR,ALL:Of,REFLOW:uR,SOURCE:w0,NO_SOURCE:lR,NO_FIELDS:cR,fork(e){return new _u(this.dataflow).init(this,e)},clone(){const e=this.fork(Of);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Of|w0)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new _u(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&cR)&&(n.fields=e.fields),t&Qa?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&uu?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Zs?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&lR?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Of;return t&Qa&&this.add.length||t&uu&&this.rem.length||t&Zs&&this.mod.length},reflow(e){if(e)return this.fork(Of).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Zs,fR(this,Qa))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return De(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?De(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Qa&&(n.addF=D1(n.addF,t)),e&uu&&(n.remF=D1(n.remF,t)),e&Zs&&(n.modF=D1(n.modF,t)),e&w0&&(n.srcF=D1(n.srcF,t)),n},materialize(e){e=e||Of;const t=this;return e&Qa&&t.addF&&(t.add=cw(t.add,t.addF),t.addF=null),e&uu&&t.remF&&(t.rem=cw(t.rem,t.remF),t.remF=null),e&Zs&&t.modF&&(t.mod=cw(t.mod,t.modF),t.modF=null),e&w0&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&w0)return ou(n.source,n.srcF,i),n;e&Qa&&ou(n.add,n.addF,i),e&uu&&ou(n.rem,n.remF,i),e&Zs&&ou(n.mod,n.modF,i);const r=n.source;if(e&uR&&r){const a=n.add.length+n.mod.length;a===r.length||(a?ou(r,fR(n,oR),i):ou(r,n.srcF,i))}return n}};function z$(e,t,n,i){const r=this;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const s of n)if(s.stamp===t){if(s.fields){const o=r.fields||(r.fields={});for(const l in s.fields)o[l]=1}s.changed(r.ADD)&&(a|=r.ADD),s.changed(r.REM)&&(a|=r.REM),s.changed(r.MOD)&&(a|=r.MOD)}this.changes=a}me(z$,_u,{fork(e){const t=new _u(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?De(e)?e.some(i=>n[i]):n[e]:0},filter(){ae("MultiPulse does not support filtering.")},materialize(){ae("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let a=0;if(e&n.SOURCE)for(;a<r;++a)i[a].visit(e,t);else for(;a<r;++a)i[a].stamp===n.stamp&&i[a].visit(e,t);return n}});async function Rne(e,t,n){const i=this,r=[];if(i._pulse)return QL(i);if(i._pending&&await i._pending,t&&await hy(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const a=++i._clock;i._pulse=new _u(i,a,e),i._touched.forEach(d=>i._enqueue(d,!0)),i._touched=Pb(dp);let s=0,o,l,f;try{for(;i._heap.size()>0;){if(o=i._heap.pop(),o.rank!==o.qrank){i._enqueue(o,!0);continue}l=o.run(i._getPulse(o,e)),l.then?l=await l:l.async&&(r.push(l.async),l=Qy),l!==Qy&&o._targets&&o._targets.forEach(d=>i._enqueue(d)),++s}}catch(d){i._heap.clear(),f=d}if(i._input={},i._pulse=null,i.debug(`Pulse ${a}: ${s} operators`),f&&(i._postrun=[],i.error(f)),i._postrun.length){const d=i._postrun.sort((h,p)=>p.priority-h.priority);i._postrun=[];for(let h=0;h<d.length;++h)await hy(i,d[h].callback)}return n&&await hy(i,n),r.length&&Promise.all(r).then(d=>i.runAsync(null,()=>{d.forEach(h=>{try{h(i)}catch(p){i.error(p)}})})),i}async function zne(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function Bne(e,t,n){return this._pulse?QL(this):(this.evaluate(e,t,n),this)}function Lne(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function QL(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function jne(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function Une(e,t){const n=e.source,i=this._clock;return n&&De(n)?new z$(this,i,n.map(r=>r.pulse),t):this._input[e.id]||Pne(this._pulse,n&&n.pulse)}function Pne(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Qy&&(e.source=t.source),e)}const B$={skip:!1,force:!1};function Ine(e,t){const n=t||B$;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function qne(e,t,n){const i=n||B$;return(e.set(t)||i.force)&&this.touch(e,i),this}function Hne(e,t,n){this.touch(e,n||B$);const i=new _u(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function Gne(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),ZL(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,Yne(t,0,e)):i=n,i}}}function ZL(e,t,n,i){let r,a;const s=e[n];for(;n>t;){if(a=n-1>>1,r=e[a],i(s,r)<0){e[n]=r,n=a;continue}break}return e[n]=s}function Yne(e,t,n){const i=t,r=e.length,a=e[t];let s=(t<<1)+1,o;for(;s<r;)o=s+1,o<r&&n(e[s],e[o])>=0&&(s=o),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=a,ZL(e,i,t,n)}function td(){this.logger(EB()),this.logLevel(f$),this._clock=0,this._rank=0,this._locale=k$();try{this._loader=Ub()}catch{}this._touched=Pb(dp),this._input={},this._pulse=null,this._heap=Gne((e,t)=>e.qrank-t.qrank),this._postrun=[]}function _0(e){return function(){return this._log[e].apply(this,arguments)}}td.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:_0("error"),warn:_0("warn"),info:_0("info"),debug:_0("debug"),logLevel:_0("level"),cleanThreshold:1e4,add:vne,connect:bne,rank:Nne,rerank:Fne,pulse:Hne,touch:Ine,update:qne,changeset:Mc,ingest:Ane,parse:Sne,preload:_ne,request:wne,events:Ene,on:Dne,evaluate:Rne,run:Bne,runAsync:zne,runAfter:Lne,_enqueue:jne,_getPulse:Une};function te(e,t){Ot.call(this,e,null,t)}me(te,Ot,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const yd={};function KL(e){const t=JL(e);return t&&t.Definition||null}function JL(e){return e=e&&e.toLowerCase(),ze(yd,e)?yd[e]:null}function*ej(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function L$(e,t,n){const i=Float64Array.from(ej(e,n));return i.sort(lo),t.map(r=>QB(i,r))}function j$(e,t){return L$(e,[.25,.5,.75],t)}function U$(e,t){const n=e.length,i=tee(e,t),r=j$(e,t),a=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,a)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function tj(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let a=e.extent[0],s=e.extent[1],o,l,f,d,h,p;const y=e.span||s-a||Math.abs(a)||1;if(e.step)o=e.step;else if(e.steps){for(d=y/t,h=0,p=e.steps.length;h<p&&e.steps[h]<d;++h);o=e.steps[Math.max(0,h-1)]}else{for(l=Math.ceil(Math.log(t)/i),f=e.minstep||0,o=Math.max(f,Math.pow(n,Math.round(Math.log(y)/i)-l));Math.ceil(y/o)>t;)o*=n;for(h=0,p=r.length;h<p;++h)d=o/r[h],d>=f&&y/d<=t&&(o=d)}d=Math.log(o);const v=d>=0?0:~~(-d/i)+1,b=Math.pow(n,-v-1);return(e.nice||e.nice===void 0)&&(d=Math.floor(a/o+b)*o,a=a<d?d-o:d,s=Math.ceil(s/o)*o),{start:a,stop:s===a?a+o:s,step:o}}var Jr=Math.random;function Vne(e){Jr=e}function nj(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(ej(e,i)),a=r.length,s=t;let o,l,f,d;for(f=0,d=Array(s);f<s;++f){for(o=0,l=0;l<a;++l)o+=r[~~(Jr()*a)];d[f]=o/a}return d.sort(lo),[H_(d,n/2),H_(d,1-n/2)]}function ij(e,t,n,i){i=i||(p=>p);const r=e.length,a=new Float64Array(r);let s=0,o=1,l=i(e[0]),f=l,d=l+t,h;for(;o<r;++o){if(h=i(e[o]),h>=d){for(f=(l+f)/2;s<o;++s)a[s]=f;d=h+t,l=h}f=h}for(f=(l+f)/2;s<o;++s)a[s]=f;return n?Xne(a,t+t/4):a}function Xne(e,t){const n=e.length;let i=0,r=1,a,s;for(;e[i]===e[r];)++r;for(;r<n;){for(a=r+1;e[r]===e[a];)++a;if(e[r]-e[r-1]<t){for(s=r+(i+a-r-r>>1);s<r;)e[s++]=e[r];for(;s>r;)e[s--]=e[i]}i=r,r=a}return e}function Wne(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function Qne(e,t){t==null&&(t=e,e=0);let n,i,r;const a={min(s){return arguments.length?(n=s||0,r=i-n,a):n},max(s){return arguments.length?(i=s||0,r=i-n,a):i},sample(){return n+Math.floor(r*Jr())},pdf(s){return s===Math.floor(s)&&s>=n&&s<i?1/r:0},cdf(s){const o=Math.floor(s);return o<n?0:o>=i?1:(o-n+1)/r},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*r):NaN}};return a.min(e).max(t)}const rj=Math.sqrt(2*Math.PI),Zne=Math.SQRT2;let C0=NaN;function Yb(e,t){e=e||0,t=t??1;let n=0,i=0,r,a;if(C0===C0)n=C0,C0=NaN;else{do n=Jr()*2-1,i=Jr()*2-1,r=n*n+i*i;while(r===0||r>1);a=Math.sqrt(-2*Math.log(r)/r),n*=a,C0=i*a}return e+n*t}function P$(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*rj)}function Vb(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let a;if(r>37)a=0;else{const s=Math.exp(-r*r/2);let o;r<7.07106781186547?(o=.0352624965998911*r+.700383064443688,o=o*r+6.37396220353165,o=o*r+33.912866078383,o=o*r+112.079291497871,o=o*r+221.213596169931,o=o*r+220.206867912376,a=s*o,o=.0883883476483184*r+1.75566716318264,o=o*r+16.064177579207,o=o*r+86.7807322029461,o=o*r+296.564248779674,o=o*r+637.333633378831,o=o*r+793.826512519948,o=o*r+440.413735824752,a=a/o):(o=r+.65,o=r+4/o,o=r+3/o,o=r+2/o,o=r+1/o,a=s/o/2.506628274631)}return i>0?1-a:a}function Xb(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*Zne*Kne(2*e-1)}function Kne(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function I$(e,t){let n,i;const r={mean(a){return arguments.length?(n=a||0,r):n},stdev(a){return arguments.length?(i=a??1,r):i},sample:()=>Yb(n,i),pdf:a=>P$(a,n,i),cdf:a=>Vb(a,n,i),icdf:a=>Xb(a,n,i)};return r.mean(e).stdev(t)}function q$(e,t){const n=I$();let i=0;const r={data(a){return arguments.length?(e=a,i=a?a.length:0,r.bandwidth(t)):e},bandwidth(a){return arguments.length?(t=a,!t&&e&&(t=U$(e)),r):t},sample(){return e[~~(Jr()*i)]+t*n.sample()},pdf(a){let s=0,o=0;for(;o<i;++o)s+=n.pdf((a-e[o])/t);return s/t/i},cdf(a){let s=0,o=0;for(;o<i;++o)s+=n.cdf((a-e[o])/t);return s/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function H$(e,t){return e=e||0,t=t??1,Math.exp(e+Yb()*t)}function G$(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*rj*e)}function Y$(e,t,n){return Vb(Math.log(e),t,n)}function V$(e,t,n){return Math.exp(Xb(e,t,n))}function aj(e,t){let n,i;const r={mean(a){return arguments.length?(n=a||0,r):n},stdev(a){return arguments.length?(i=a??1,r):i},sample:()=>H$(n,i),pdf:a=>G$(a,n,i),cdf:a=>Y$(a,n,i),icdf:a=>V$(a,n,i)};return r.mean(e).stdev(t)}function sj(e,t){let n=0,i;function r(s){const o=[];let l=0,f;for(f=0;f<n;++f)l+=o[f]=s[f]==null?1:+s[f];for(f=0;f<n;++f)o[f]/=l;return o}const a={weights(s){return arguments.length?(i=r(t=s||[]),a):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),a.weights(t)):e},sample(){const s=Jr();let o=e[n-1],l=i[0],f=0;for(;f<n-1;l+=i[++f])if(s<l){o=e[f];break}return o.sample()},pdf(s){let o=0,l=0;for(;l<n;++l)o+=i[l]*e[l].pdf(s);return o},cdf(s){let o=0,l=0;for(;l<n;++l)o+=i[l]*e[l].cdf(s);return o},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function X$(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Jr()}function W$(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function Q$(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Z$(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function oj(e,t){let n,i;const r={min(a){return arguments.length?(n=a||0,r):n},max(a){return arguments.length?(i=a??1,r):i},sample:()=>X$(n,i),pdf:a=>W$(a,n,i),cdf:a=>Q$(a,n,i),icdf:a=>Z$(a,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function K$(e,t,n){let i=0,r=0;for(const a of e){const s=n(a);t(a)==null||s==null||isNaN(s)||(i+=(s-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function pp(e,t,n,i){const r=i-e*e,a=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-a*e,a]}function Wb(e,t,n,i){e=e.filter(y=>{let v=t(y),b=n(y);return v!=null&&(v=+v)>=v&&b!=null&&(b=+b)>=b}),i&&e.sort((y,v)=>t(y)-t(v));const r=e.length,a=new Float64Array(r),s=new Float64Array(r);let o=0,l=0,f=0,d,h,p;for(p of e)a[o]=d=+t(p),s[o]=h=+n(p),++o,l+=(d-l)/o,f+=(h-f)/o;for(o=0;o<r;++o)a[o]-=l,s[o]-=f;return[a,s,l,f]}function mp(e,t,n,i){let r=-1,a,s;for(const o of e)a=t(o),s=n(o),a!=null&&(a=+a)>=a&&s!=null&&(s=+s)>=s&&i(a,s,++r)}function th(e,t,n,i,r){let a=0,s=0;return mp(e,t,n,(o,l)=>{const f=l-r(o),d=l-i;a+=f*f,s+=d*d}),1-a/s}function J$(e,t,n){let i=0,r=0,a=0,s=0,o=0;mp(e,t,n,(d,h)=>{++o,i+=(d-i)/o,r+=(h-r)/o,a+=(d*h-a)/o,s+=(d*d-s)/o});const l=pp(i,r,a,s),f=d=>l[0]+l[1]*d;return{coef:l,predict:f,rSquared:th(e,t,n,r,f)}}function uj(e,t,n){let i=0,r=0,a=0,s=0,o=0;mp(e,t,n,(d,h)=>{++o,d=Math.log(d),i+=(d-i)/o,r+=(h-r)/o,a+=(d*h-a)/o,s+=(d*d-s)/o});const l=pp(i,r,a,s),f=d=>l[0]+l[1]*Math.log(d);return{coef:l,predict:f,rSquared:th(e,t,n,r,f)}}function lj(e,t,n){const[i,r,a,s]=Wb(e,t,n);let o=0,l=0,f=0,d=0,h=0,p,y,v;mp(e,t,n,(w,_)=>{p=i[h++],y=Math.log(_),v=p*_,o+=(_*y-o)/h,l+=(v-l)/h,f+=(v*y-f)/h,d+=(p*v-d)/h});const[b,E]=pp(l/s,o/s,f/s,d/s),S=w=>Math.exp(b+E*(w-a));return{coef:[Math.exp(b-E*a),E],predict:S,rSquared:th(e,t,n,s,S)}}function cj(e,t,n){let i=0,r=0,a=0,s=0,o=0,l=0;mp(e,t,n,(h,p)=>{const y=Math.log(h),v=Math.log(p);++l,i+=(y-i)/l,r+=(v-r)/l,a+=(y*v-a)/l,s+=(y*y-s)/l,o+=(p-o)/l});const f=pp(i,r,a,s),d=h=>f[0]*Math.pow(h,f[1]);return f[0]=Math.exp(f[0]),{coef:f,predict:d,rSquared:th(e,t,n,o,d)}}function eD(e,t,n){const[i,r,a,s]=Wb(e,t,n),o=i.length;let l=0,f=0,d=0,h=0,p=0,y,v,b,E;for(y=0;y<o;)v=i[y],b=r[y++],E=v*v,l+=(E-l)/y,f+=(E*v-f)/y,d+=(E*E-d)/y,h+=(v*b-h)/y,p+=(E*b-p)/y;const S=d-l*l,w=l*S-f*f,_=(p*l-h*f)/w,C=(h*S-p*f)/w,$=-_*l,M=T=>(T=T-a,_*T*T+C*T+$+s);return{coef:[$-C*a+_*a*a+s,C-2*_*a,_],predict:M,rSquared:th(e,t,n,s,M)}}function fj(e,t,n,i){if(i===0)return K$(e,t,n);if(i===1)return J$(e,t,n);if(i===2)return eD(e,t,n);const[r,a,s,o]=Wb(e,t,n),l=r.length,f=[],d=[],h=i+1;let p,y,v,b,E;for(p=0;p<h;++p){for(v=0,b=0;v<l;++v)b+=Math.pow(r[v],p)*a[v];for(f.push(b),E=new Float64Array(h),y=0;y<h;++y){for(v=0,b=0;v<l;++v)b+=Math.pow(r[v],p+y);E[y]=b}d.push(E)}d.push(f);const S=eie(d),w=_=>{_-=s;let C=o+S[0]+S[1]*_+S[2]*_*_;for(p=3;p<h;++p)C+=S[p]*Math.pow(_,p);return C};return{coef:Jne(h,S,-s,o),predict:w,rSquared:th(e,t,n,o,w)}}function Jne(e,t,n,i){const r=Array(e);let a,s,o,l;for(a=0;a<e;++a)r[a]=0;for(a=e-1;a>=0;--a)for(o=t[a],l=1,r[a]+=o,s=1;s<=a;++s)l*=(a+1-s)/s,r[a-s]+=o*Math.pow(n,s)*l;return r[0]+=i,r}function eie(e){const t=e.length-1,n=[];let i,r,a,s,o;for(i=0;i<t;++i){for(s=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][s])&&(s=r);for(a=i;a<t+1;++a)o=e[a][i],e[a][i]=e[a][s],e[a][s]=o;for(r=i+1;r<t;++r)for(a=t;a>=i;a--)e[a][r]-=e[a][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(o=0,a=r+1;a<t;++a)o+=e[a][r]*n[a];n[r]=(e[t][r]-o)/e[r][r]}return n}const dR=2,hR=1e-12;function dj(e,t,n,i){const[r,a,s,o]=Wb(e,t,n,!0),l=r.length,f=Math.max(2,~~(i*l)),d=new Float64Array(l),h=new Float64Array(l),p=new Float64Array(l).fill(1);for(let y=-1;++y<=dR;){const v=[0,f-1];for(let E=0;E<l;++E){const S=r[E],w=v[0],_=v[1],C=S-r[w]>r[_]-S?w:_;let $=0,M=0,T=0,F=0,R=0;const B=1/Math.abs(r[C]-S||1);for(let H=w;H<=_;++H){const U=r[H],z=a[H],O=tie(Math.abs(S-U)*B)*p[H],I=U*O;$+=O,M+=I,T+=z*O,F+=z*I,R+=U*I}const[L,Y]=pp(M/$,T/$,F/$,R/$);d[E]=L+Y*S,h[E]=Math.abs(a[E]-d[E]),nie(r,E+1,v)}if(y===dR)break;const b=ZB(h);if(Math.abs(b)<hR)break;for(let E=0,S,w;E<l;++E)S=h[E]/(6*b),p[E]=S>=1?hR:(w=1-S*S)*w}return iie(r,d,s,o)}function tie(e){return(e=1-e*e*e)*e*e}function nie(e,t,n){const i=e[t];let r=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>r&&e[a]-i<=i-e[r];)n[0]=++r,n[1]=a,++a}function iie(e,t,n,i){const r=e.length,a=[];let s=0,o=0,l=[],f;for(;s<r;++s)f=e[s]+n,l[0]===f?l[1]+=(t[s]-l[1])/++o:(o=0,l[1]+=i,l=[f,t[s]],a.push(l));return l[1]+=i,a}const rie=.5*Math.PI/180;function Qb(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=b=>[b,e(b)],a=t[0],s=t[1],o=s-a,l=o/i,f=[r(a)],d=[];if(n===i){for(let b=1;b<i;++b)f.push(r(a+b/n*o));return f.push(r(s)),f}else{d.push(r(s));for(let b=n;--b>0;)d.push(r(a+b/n*o))}let h=f[0],p=d[d.length-1];const y=1/o,v=aie(h[1],d);for(;p;){const b=r((h[0]+p[0])/2);b[0]-h[0]>=l&&sie(h,b,p,y,v)>rie?d.push(b):(h=p,f.push(p),d.pop()),p=d[d.length-1]}return f}function aie(e,t){let n=e,i=e;const r=t.length;for(let a=0;a<r;++a){const s=t[a][1];s<n&&(n=s),s>i&&(i=s)}return 1/(i-n)}function sie(e,t,n,i,r){const a=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),s=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(a-s)}function oie(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function eC(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:oie(e)}function hj(e,t,n){return n||e+(t?"_"+t:"")}const fw=()=>{},uie={init:fw,add:fw,rem:fw,idx:0},Fg={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},yp=Object.keys(Fg).filter(e=>e!=="__count__");function lie(e,t){return(n,i)=>Ve({name:e,aggregate_param:i,out:n||e},uie,t)}[...yp,"__count__"].forEach(e=>{Fg[e]=lie(e,Fg[e])});function gj(e,t,n){return Fg[e](n,t)}function pj(e,t){return e.idx-t.idx}function cie(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=Fg[r]())})};return e.forEach(n),Object.values(t).sort(pj)}function fie(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function die(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function hie(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function gie(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function mj(e,t){const n=t||Fi,i=cie(e),r=e.slice().sort(pj);function a(s){this._ops=i,this._out=r,this.cell=s,this.init()}return a.prototype.init=fie,a.prototype.add=die,a.prototype.rem=hie,a.prototype.set=gie,a.prototype.get=n,a.fields=e.map(s=>s.out),a}function tD(e){this._key=e?Qr(e):ke,this.reset()}const ti=tD.prototype;ti.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};ti.add=function(e){this._add.push(e)};ti.rem=function(e){this._rem.push(e)};ti.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,a=Array(i-r),s={};let o,l,f;for(o=0;o<r;++o)s[n(t[o])]=1;for(o=0,l=0;o<i;++o)s[n(f=e[o])]?s[n(f)]=0:a[l++]=f;return this._rem=[],this._add=a};ti.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,a;for(;--i>=0;)a=e(t[i])+"",ze(n,a)||(n[a]=1,++r);return r};ti.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=FB(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};ti.argmin=function(e){return this.extent(e)[0]||{}};ti.argmax=function(e){return this.extent(e)[1]||{}};ti.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};ti.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};ti.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=j$(this.values(),e),this._get=e),this._q};ti.q1=function(e){return this.quartile(e)[0]};ti.q2=function(e){return this.quartile(e)[1]};ti.q3=function(e){return this.quartile(e)[2]};ti.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=nj(this.values(),1e3,.05,e),this._get=e),this._ci};ti.ci0=function(e){return this.ci(e)[0]};ti.ci1=function(e){return this.ci(e)[1]};function Nu(e){te.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Nu.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:yp},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};me(Nu,te,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function a(o){let l,f,d,h;for(l in o)for(d=o[l].tuple,f=0;f<r;++f)i[f][h=d[n[f]]]=h}a(e._prev),a(t);function s(o,l,f){const d=n[f],h=i[f++];for(const p in h){const y=o?o+"|"+p:p;l[d]=h[p],f<r?s(y,l,f):t[y]||e.cell(y,l)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(w){const _=Fe(hi(w)),C=_.length;let $=0,M;for(;$<C;++$)i[M=_[$]]||(i[M]=1,t.push(M))}this._dims=Fe(e.groupby),this._dnames=this._dims.map(w=>{const _=tn(w);return r(w),n.push(_),_}),this.cellkey=e.key?e.key:eC(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=e.fields||[null],s=e.ops||["count"],o=e.aggregate_params||[null],l=e.as||[],f=a.length,d={};let h,p,y,v,b,E,S;for(f!==s.length&&ae("Unmatched number of fields and aggregate ops."),S=0;S<f;++S){if(h=a[S],p=s[S],y=o[S]||null,h==null&&p!=="count"&&ae("Null aggregate field specified."),b=tn(h),E=hj(p,b,l[S]),n.push(E),p==="count"){this._counts.push(E);continue}v=d[b],v||(r(h),v=d[b]=[],v.field=h,this._measures.push(v)),p!=="count"&&(this._countOnly=!1),v.push(gj(p,y,E))}return this._measures=this._measures.map(w=>mj(w,w.field)),Object.create(null)},cellkey:eC(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let a=0;a<r;++a)n.agg[a]=new i[a](n)}return n.store&&(n.data=new tD),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,a={};for(let s=0;s<r;++s)a[n[s]]=i[s](e);return t?XL(t.tuple,a):bt(a)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,a=i.length;r<a;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,a=i.length;r<a;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,a=i.length;r<a;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,a=e.add,s=e.rem,o=e.mod;let l,f,d,h;if(i)for(f in i)l=i[f],(!r||l.num)&&s.push(l.tuple);for(d=0,h=this._alen;d<h;++d)a.push(this.celltuple(t[d])),t[d]=null;for(d=0,h=this._mlen;d<h;++d)l=n[d],(l.num===0&&r?s:o).push(this.celltuple(l)),n[d]=null;return this._alen=this._mlen=0,this._prev=null,e}});const pie=1e-14;function nD(e){te.call(this,null,e)}nD.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};me(nD,te,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,a=i.step,s=e.as||["bin0","bin1"],o=s[0],l=s[1];let f;return e.modified()?(t=t.reflow(!0),f=t.SOURCE):f=t.modified(hi(e.field))?t.ADD_MOD:t.ADD,t.visit(f,n?d=>{const h=i(d);d[o]=h,d[l]=h==null?null:r+a*(1+(h-r)/a)}:d=>d[o]=i(d)),t.modifies(n?s:o)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=tj(e),i=n.step;let r=n.start,a=r+Math.ceil((n.stop-r)/i)*i,s,o;(s=e.anchor)!=null&&(o=s-(r+i*Math.floor((s-r)/i)),r+=o,a+=o);const l=function(f){let d=fi(t(f));return d==null?null:d<r?-1/0:d>a?1/0:(d=Math.max(r,Math.min(d,a-i)),r+i*Math.floor(pie+(d-r)/i))};return l.start=r,l.stop=n.stop,l.step=i,this.value=ar(l,hi(t),e.name||"bin_"+tn(t))}});function yj(e,t,n){const i=e;let r=t||[],a=n||[],s={},o=0;return{add:l=>a.push(l),remove:l=>s[i(l)]=++o,size:()=>r.length,data:(l,f)=>(o&&(r=r.filter(d=>!s[i(d)]),s={},o=0),f&&l&&r.sort(l),a.length&&(r=l?LB(l,r,a.sort(l)):r.concat(a),a=[]),r)}}function iD(e){te.call(this,[],e)}iD.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};me(iD,te,{transform(e,t){const n=t.fork(t.ALL),i=yj(ke,this.value,n.materialize(n.ADD).add),r=e.sort,a=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(a),this.value=n.source=i.data(Tc(r),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function vj(e){Ot.call(this,null,mie,e)}me(vj,Ot);function mie(e){return this.value&&!e.modified()?this.value:p$(e.fields,e.orders)}function rD(e){te.call(this,null,e)}rD.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function yie(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}me(rD,te,{transform(e,t){const n=h=>p=>{for(var y=yie(o(p),e.case,a)||[],v,b=0,E=y.length;b<E;++b)s.test(v=y[b])||h(v)},i=this._parameterCheck(e,t),r=this._counts,a=this._match,s=this._stop,o=e.field,l=e.as||["text","count"],f=n(h=>r[h]=1+(r[h]||0)),d=n(h=>r[h]-=1);return i?t.visit(t.SOURCE,f):(t.visit(t.ADD,f),t.visit(t.REM,d)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],a=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let o,l,f;for(o in n)l=i[o],f=n[o]||0,!l&&f?(i[o]=l=bt({}),l[r]=o,l[a]=f,s.add.push(l)):f===0?(l&&s.rem.push(l),n[o]=null,i[o]=null):l[a]!==f&&(l[a]=f,s.mod.push(l));return s.modifies(t)}});function aD(e){te.call(this,null,e)}aD.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};me(aD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],a=i[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let o=this.value;return s?(o&&(n.rem=o),o=t.materialize(t.SOURCE).source,n.add=this.value=vie(o,r,a,e.filter||Zr)):n.mod=o,n.source=this.value,n.modifies(i)}});function vie(e,t,n,i){for(var r=[],a={},s=e.length,o=0,l,f;o<s;++o)for(a[t]=f=e[o],l=0;l<s;++l)a[n]=e[l],i(a)&&(r.push(bt(a)),a={},a[t]=f);return r}const gR={kde:q$,mixture:sj,normal:I$,lognormal:aj,uniform:oj},bie="distributions",pR="function",xie="field";function bj(e,t){const n=e[pR];ze(gR,n)||ae("Unknown distribution function: "+n);const i=gR[n]();for(const r in e)r===xie?i.data((e.from||t()).map(e[r])):r===bie?i[r](e[r].map(a=>bj(a,t))):typeof i[r]===pR&&i[r](e[r]);return i}function sD(e){te.call(this,null,e)}const xj=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Eie={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:xj},{name:"weights",type:"number",array:!0}]};sD.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:xj.concat(Eie)},{name:"as",type:"string",array:!0,default:["value","density"]}]};me(sD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=bj(e.distribution,Sie(t)),r=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&ae("Invalid density method: "+s),!e.extent&&!i.data&&ae("Missing density extent parameter."),s=i[s];const o=e.as||["value","density"],l=e.extent||cs(i.data()),f=Qb(s,l,r,a).map(d=>{const h={};return h[o[0]]=d[0],h[o[1]]=d[1],bt(h)});this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});function Sie(e){return()=>e.materialize(e.SOURCE).source}function Ej(e,t){return e?e.map((n,i)=>t[i]||tn(n)):null}function oD(e,t,n){const i=[],r=h=>h(l);let a,s,o,l,f,d;if(t==null)i.push(e.map(n));else for(a={},s=0,o=e.length;s<o;++s)l=e[s],f=t.map(r),d=a[f],d||(a[f]=d=[],d.dims=f,i.push(d)),d.push(n(l));return i}const Sj="bin";function uD(e){te.call(this,null,e)}uD.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Sj}]};const Aie=(e,t)=>gp(cs(e,t))/30;me(uD,te,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=oD(t.source,e.groupby,Fi),r=e.smooth||!1,a=e.field,s=e.step||Aie(n,a),o=Tc((v,b)=>a(v)-a(b)),l=e.as||Sj,f=i.length;let d=1/0,h=-1/0,p=0,y;for(;p<f;++p){const v=i[p].sort(o);y=-1;for(const b of ij(v,s,r,a))b<d&&(d=b),b>h&&(h=b),v[++y][l]=b}return this.value={start:d,stop:h,step:s},t.reflow(!0).modifies(l)}});function Aj(e){Ot.call(this,null,wie,e),this.modified(!0)}me(Aj,Ot);function wie(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:ar(n=>t(n,e),hi(t),tn(t))}function lD(e){te.call(this,[void 0,void 0],e)}lD.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};me(lD,te,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let a=n[0],s=n[1];if((r||a==null)&&(a=1/0,s=-1/0),t.visit(r?t.SOURCE:t.ADD,o=>{const l=fi(i(o));l!=null&&(l<a&&(a=l),l>s&&(s=l))}),!Number.isFinite(a)||!Number.isFinite(s)){let o=tn(i);o&&(o=` for field "${o}"`),t.dataflow.warn(`Infinite extent${o}: [${a}, ${s}]`),a=s=void 0}this.value=[a,s]}});function cD(e,t){Ot.call(this,e),this.parent=t,this.count=0}me(cD,Ot,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Zb(e){te.call(this,{},e),this._keys=Wd();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}me(Zb,te,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let a=ze(r,e)&&r[e],s,o;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(o=i||(o=this._group[e])&&o.tuple,s=n.dataflow,a=new cD(n.fork(n.NO_SOURCE),this),s.add(a).connect(t(s,e,o)),r[e]=a,this.activate(a)),a},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,a=this._keys,s=e.modified("key"),o=l=>this.subflow(l,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const f=ke(l),d=a.get(f);d!==void 0&&(a.delete(f),o(d).rem(l))}),t.visit(t.ADD,l=>{const f=i(l);a.set(ke(l),f),o(f).add(l)}),s||t.modified(i.fields)?t.visit(t.MOD,l=>{const f=ke(l),d=a.get(f),h=i(l);d===h?o(h).mod(l):(a.set(f,h),o(d).rem(l),o(h).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{o(a.get(ke(l))).mod(l)}),s&&t.visit(t.REFLOW,l=>{const f=ke(l),d=a.get(f),h=i(l);d!==h&&(a.set(f,h),o(d).rem(l),o(h).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}});function wj(e){Ot.call(this,null,_ie,e)}me(wj,Ot);function _ie(e){return this.value&&!e.modified()?this.value:De(e.name)?Fe(e.name).map(t=>Qr(t)):Qr(e.name,e.as)}function fD(e){te.call(this,Wd(),e)}fD.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};me(fD,te,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),a=r.add,s=r.rem,o=r.mod,l=e.expr;let f=!0;t.visit(t.REM,h=>{const p=ke(h);i.has(p)?i.delete(p):s.push(h)}),t.visit(t.ADD,h=>{l(h,e)?a.push(h):i.set(ke(h),1)});function d(h){const p=ke(h),y=l(h,e),v=i.get(p);y&&v?(i.delete(p),a.push(h)):!y&&!v?(i.set(p,1),s.push(h)):f&&y&&!v&&o.push(h)}return t.visit(t.MOD,d),e.modified()&&(f=!1,t.visit(t.REFLOW,d)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function dD(e){te.call(this,[],e)}dD.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};me(dD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=Ej(i,e.as||[]),a=e.index||null,s=r.length;return n.rem=this.value,t.visit(t.SOURCE,o=>{const l=i.map(v=>v(o)),f=l.reduce((v,b)=>Math.max(v,b.length),0);let d=0,h,p,y;for(;d<f;++d){for(p=R$(o),h=0;h<s;++h)p[r[h]]=(y=l[h][d])==null?null:y;a&&(p[a]=d),n.add.push(p)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(r)}});function hD(e){te.call(this,[],e)}hD.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};me(hD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(tn),a=e.as||["key","value"],s=a[0],o=a[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,f=>{for(let d=0,h;d<l;++d)h=R$(f),h[s]=r[d],h[o]=i[d](f),n.add.push(h)}),this.value=n.source=n.add,n.modifies(a)}});function gD(e){te.call(this,null,e)}gD.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};me(gD,te,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),a=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(a,s=>s[i]=n(s,e))}});function _j(e){te.call(this,[],e)}me(_j,te,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,a=e.size-r.length,s,o,l;if(a>0){for(s=[];--a>=0;)s.push(l=bt(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else o=r.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,r=r.slice(-a);return n.source=this.value=r,n}});const T1={value:"value",median:ZB,mean:oee,min:q_,max:Xl},Cie=[];function pD(e){te.call(this,[],e)}pD.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function $ie(e){var t=e.method||T1.value,n;if(T1[t]==null)ae("Unrecognized imputation method: "+t);else return t===T1.value?(n=e.value!==void 0?e.value:0,()=>n):T1[t]}function Die(e){const t=e.field;return n=>n?t(n):NaN}me(pD,te,{transform(e,t){var n=t.fork(t.ALL),i=$ie(e),r=Die(e),a=tn(e.field),s=tn(e.key),o=(e.groupby||[]).map(tn),l=Tie(t.source,e.groupby,e.key,e.keyvals),f=[],d=this.value,h=l.domain.length,p,y,v,b,E,S,w,_,C,$;for(E=0,_=l.length;E<_;++E)for(p=l[E],v=p.values,y=NaN,w=0;w<h;++w)if(p[w]==null){for(b=l.domain[w],$={_impute:!0},S=0,C=v.length;S<C;++S)$[o[S]]=v[S];$[s]=b,$[a]=Number.isNaN(y)?y=i(p,r):y,f.push(bt($))}return f.length&&(n.add=n.materialize(n.ADD).add.concat(f)),d.length&&(n.rem=n.materialize(n.REM).rem.concat(d)),this.value=f,n}});function Tie(e,t,n,i){var r=S=>S(E),a=[],s=i?i.slice():[],o={},l={},f,d,h,p,y,v,b,E;for(s.forEach((S,w)=>o[S]=w+1),p=0,b=e.length;p<b;++p)E=e[p],v=n(E),y=o[v]||(o[v]=s.push(v)),d=(f=t?t.map(r):Cie)+"",(h=l[d])||(h=l[d]=[],a.push(h),h.values=f),h[y-1]=E;return a.domain=s,a}function mD(e){Nu.call(this,e)}mD.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:yp},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};me(mD,Nu,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(r=n.value=n.value||this.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),n.changes(),t.visit(t.SOURCE,a=>{Ve(a,r[n.cellkey(a)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function yD(e){te.call(this,null,e)}yD.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};me(yD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=oD(i,e.groupby,e.field),a=(e.groupby||[]).map(tn),s=e.bandwidth,o=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],f=[];let d=e.extent,h=e.steps||e.minsteps||25,p=e.steps||e.maxsteps||200;o!=="pdf"&&o!=="cdf"&&ae("Invalid density method: "+o),e.resolve==="shared"&&(d||(d=cs(i,e.field)),h=p=e.steps||p),r.forEach(y=>{const v=q$(y,s)[o],b=e.counts?y.length:1,E=d||cs(y);Qb(v,E,h,p).forEach(S=>{const w={};for(let _=0;_<a.length;++_)w[a[_]]=y.dims[_];w[l[0]]=S[0],w[l[1]]=S[1]*b,f.push(bt(w))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});function Cj(e){Ot.call(this,null,Mie,e)}me(Cj,Ot);function Mie(e){return this.value&&!e.modified()?this.value:b$(e.fields,e.flat)}function $j(e){te.call(this,[],e),this._pending=null}me($j,te,{transform(e,t){const n=t.dataflow;return this._pending?dw(this,t,this._pending):kie(e)?t.StopPropagation:e.values?dw(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=Fe(r.data),a=>a.touch(this)))}:n.request(e.url,e.format).then(i=>dw(this,t,Fe(i.data)))}});function kie(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function dw(e,t,n){n.forEach(bt);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function vD(e){te.call(this,{},e)}vD.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};me(vD,te,{transform(e,t){const n=e.fields,i=e.index,r=e.values,a=e.default==null?null:e.default,s=e.modified(),o=n.length;let l=s?t.SOURCE:t.ADD,f=t,d=e.as,h,p,y;return r?(p=r.length,o>1&&!d&&ae('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==o*p&&ae('The "as" parameter has too few output field names.'),d=d||r.map(tn),h=function(v){for(var b=0,E=0,S,w;b<o;++b)if(w=i.get(n[b](v)),w==null)for(S=0;S<p;++S,++E)v[d[E]]=a;else for(S=0;S<p;++S,++E)v[d[E]]=r[S](w)}):(d||ae("Missing output field names."),h=function(v){for(var b=0,E;b<o;++b)E=i.get(n[b](v)),v[d[b]]=E??a}),s?f=t.reflow(!0):(y=n.some(v=>t.modified(v.fields)),l|=y?t.MOD:0),t.visit(l,h),f.modifies(d)}});function Dj(e){Ot.call(this,null,Nie,e)}me(Dj,Ot);function Nie(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,a,s;for(a=0;a<n;++a)s=t[a],s[0]<i&&(i=s[0]),s[1]>r&&(r=s[1]);return[i,r]}function Tj(e){Ot.call(this,null,Fie,e)}me(Tj,Ot);function Fie(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function Mj(e){te.call(this,null,e)}me(Mj,te,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function bD(e){Nu.call(this,e)}bD.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:yp,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};me(bD,Nu,{_transform:Nu.prototype.transform,transform(e,t){return this._transform(Oie(e,t),t)}});function Oie(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",a=hi(n).concat(hi(i)),s=zie(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>r),fields:s.map(o=>Rie(o,n,i,a)),as:s.map(o=>o+""),modified:e.modified.bind(e)}}function Rie(e,t,n,i){return ar(r=>t(r)===e?n(r):NaN,i,e+"")}function zie(e,t,n){const i={},r=[];return n.visit(n.SOURCE,a=>{const s=e(a);i[s]||(i[s]=1,r.push(s))}),r.sort(hp),t?r.slice(0,t):r}function kj(e){Zb.call(this,e)}me(kj,Zb,{transform(e,t){const n=e.subflow,i=e.field,r=a=>this.subflow(ke(a),n,t,a);return(e.modified("field")||i&&t.modified(hi(i)))&&ae("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,a=>{const s=r(a);i(a).forEach(o=>s.mod(o))}),t.visit(t.ADD,a=>{const s=r(a);i(a).forEach(o=>s.add(bt(o)))}),t.visit(t.REM,a=>{const s=r(a);i(a).forEach(o=>s.rem(o))})):(t.visit(t.MOD,a=>r(a).mod(a)),t.visit(t.ADD,a=>r(a).add(a)),t.visit(t.REM,a=>r(a).rem(a))),t.clean()&&t.runAfter(()=>this.clean()),t}});function xD(e){te.call(this,null,e)}xD.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};me(xD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=Ej(e.fields,e.as||[]),a=i?(o,l)=>Bie(o,l,i,r):qb;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,o=>{const l=ke(o);n.rem.push(s[l]),s[l]=null}),t.visit(t.ADD,o=>{const l=a(o,bt({}));s[ke(o)]=l,n.add.push(l)}),t.visit(t.MOD,o=>{n.mod.push(a(o,s[ke(o)]))}),n}});function Bie(e,t,n,i){for(let r=0,a=n.length;r<a;++r)t[i[r]]=n[r](e);return t}function Nj(e){te.call(this,null,e)}me(Nj,te,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function ED(e){te.call(this,null,e)}ED.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const Lie=1e-14;me(ED,te,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,a=oD(r,e.groupby,e.field),s=(e.groupby||[]).map(tn),o=[],l=e.step||.01,f=e.probs||Er(l/2,1-Lie,l),d=f.length;return a.forEach(h=>{const p=L$(h,f);for(let y=0;y<d;++y){const v={};for(let b=0;b<s.length;++b)v[s[b]]=h.dims[b];v[i[0]]=f[y],v[i[1]]=p[y],o.push(bt(v))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}});function Fj(e){te.call(this,null,e)}me(Fj,te,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const a=ke(r);n.rem.push(i[a]),i[a]=null}),t.visit(t.ADD,r=>{const a=R$(r);i[ke(r)]=a,n.add.push(a)}),t.visit(t.MOD,r=>{const a=i[ke(r)];for(const s in r)a[s]=r[s],n.modifies(s);n.mod.push(a)})),n}});function SD(e){te.call(this,[],e),this.count=0}SD.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};me(SD,te,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,a=this.value.reduce((d,h)=>(d[ke(h)]=1,d),{});let s=this.value,o=this.count,l=0;function f(d){let h,p;s.length<r?s.push(d):(p=~~((o+1)*Jr()),p<s.length&&p>=l&&(h=s[p],a[ke(h)]&&n.rem.push(h),s[p]=d)),++o}if(t.rem.length&&(t.visit(t.REM,d=>{const h=ke(d);a[h]&&(a[h]=-1,n.rem.push(d)),--o}),s=s.filter(d=>a[ke(d)]!==-1)),(t.rem.length||i)&&s.length<r&&t.source&&(l=o=s.length,t.visit(t.SOURCE,d=>{a[ke(d)]||f(d)}),l=-1),i&&s.length>r){const d=s.length-r;for(let h=0;h<d;++h)a[ke(s[h])]=-1,n.rem.push(s[h]);s=s.slice(d)}return t.mod.length&&t.visit(t.MOD,d=>{a[ke(d)]&&n.mod.push(d)}),t.add.length&&t.visit(t.ADD,f),(t.add.length||l<0)&&(n.add=s.filter(d=>!a[ke(d)])),this.count=o,this.value=n.source=s,n}});function AD(e){te.call(this,null,e)}AD.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};me(AD,te,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Er(e.start,e.stop,e.step||1).map(r=>{const a={};return a[i]=r,bt(a)}),n.add=t.add.concat(this.value),n}});function Oj(e){te.call(this,null,e),this.modified(!0)}me(Oj,te,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function wD(e){te.call(this,null,e)}const Rj=["unit0","unit1"];wD.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:C$,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Rj}]};me(wD,te,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",a=this._floor(e,t),s=(r?eh:Jd)(a.unit).offset,o=e.as||Rj,l=o[0],f=o[1],d=a.step;let h=a.start||1/0,p=a.stop||-1/0,y=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(hi(n)))&&(t=t.reflow(!0),y=t.SOURCE,h=1/0,p=-1/0),t.visit(y,v=>{const b=n(v);let E,S;b==null?(v[l]=null,i&&(v[f]=null)):(v[l]=E=S=a(b),i&&(v[f]=S=s(E,d)),E<h&&(h=E),S>p&&(p=S))}),a.start=h,a.stop=p,t.modifies(i?o:l)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:_L({extent:e.extent||cs(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=$$(i),s=this.value||{},o=(n?mL:pL)(a,r);return o.unit=st(a),o.units=a,o.step=r,o.start=s.start,o.stop=s.stop,this.value=o}});function zj(e){te.call(this,Wd(),e)}me(zj,te,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,a=o=>r.set(i(o),o);let s=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,o=>r.delete(i(o))),t.visit(t.ADD,a)):s=!1,this.modified(s),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function Bj(e){te.call(this,null,e)}me(Bj,te,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Tc(e.sort)):t.source).map(e.field))}});function jie(e,t,n,i){const r=Og[e](t,n);return{init:r.init||du,update:function(a,s){s[i]=r.next(a)}}}const Og={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Og.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||ae("ntile num must be greater than zero.");const n=Og.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||ae("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=Uie(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function Uie(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const Pie=Object.keys(Og);function Lj(e){const t=Fe(e.ops),n=Fe(e.fields),i=Fe(e.params),r=Fe(e.aggregate_params),a=Fe(e.as),s=this.outputs=[],o=this.windows=[],l={},f={},d=[],h=[];let p=!0;function y(v){Fe(hi(v)).forEach(b=>l[b]=1)}y(e.sort),t.forEach((v,b)=>{const E=n[b],S=i[b],w=r[b]||null,_=tn(E),C=hj(v,_,a[b]);if(y(E),s.push(C),ze(Og,v))o.push(jie(v,E,S,C));else{if(E==null&&v!=="count"&&ae("Null aggregate field specified."),v==="count"){d.push(C);return}p=!1;let $=f[_];$||($=f[_]=[],$.field=E,h.push($)),$.push(gj(v,w,C))}}),(d.length||h.length)&&(this.cell=Iie(h,d,p)),this.inputs=Object.keys(l)}const jj=Lj.prototype;jj.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};jj.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,a=i&&i.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(r[s]);for(s=e.p1;s<e.i1;++s)n.add(r[s]);n.set(t)}for(s=0;s<a;++s)i[s].update(e,t)};function Iie(e,t,n){e=e.map(l=>mj(l,l.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,a=i.agg=Array(r),s=0;s<r;++s)a[s]=new e[s](i);if(i.store)var o=i.data=new tD;return i.add=function(l){if(i.num+=1,!n){o&&o.add(l);for(let f=0;f<r;++f)a[f].add(a[f].get(l),l)}},i.rem=function(l){if(i.num-=1,!n){o&&o.rem(l);for(let f=0;f<r;++f)a[f].rem(a[f].get(l),l)}},i.set=function(l){let f,d;for(o&&o.values(),f=0,d=t.length;f<d;++f)l[t[f]]=i.num;if(!n)for(f=0,d=a.length;f<d;++f)a[f].set(l)},i.init=function(){i.num=0,o&&o.reset();for(let l=0;l<r;++l)a[l].init()},i}function _D(e){te.call(this,{},e),this._mlen=0,this._mods=[]}_D.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Pie.concat(yp)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};me(_D,te,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Tc(e.sort),r=eC(e.groupby),a=o=>this.group(r(o));let s=this.state;(!s||n)&&(s=this.state=new Lj(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,o=>a(o).add(o))):(t.visit(t.REM,o=>a(o).remove(o)),t.visit(t.ADD,o=>a(o).add(o)));for(let o=0,l=this._mlen;o<l;++o)qie(this._mods[o],s,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=yj(ke),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function qie(e,t,n,i){const r=i.sort,a=r&&!i.ignorePeers,s=i.frame||[null,0],o=e.data(n),l=o.length,f=a?Qd(r):null,d={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:r||bi(-1)};t.init();for(let h=0;h<l;++h)Hie(d,s,h,l),a&&Gie(d,f),t.update(d,o[h])}function Hie(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function Gie(e,t){const n=e.i0,i=e.i1-1,r=e.compare,a=e.data,s=a.length-1;n>0&&!r(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),i<s&&!r(a[i],a[i+1])&&(e.i1=t.right(a,a[i]))}const Yie=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Nu,bin:nD,collect:iD,compare:vj,countpattern:rD,cross:aD,density:sD,dotbin:uD,expression:Aj,extent:lD,facet:Zb,field:wj,filter:fD,flatten:dD,fold:hD,formula:gD,generate:_j,impute:pD,joinaggregate:mD,kde:yD,key:Cj,load:$j,lookup:vD,multiextent:Dj,multivalues:Tj,params:Mj,pivot:bD,prefacet:kj,project:xD,proxy:Nj,quantile:ED,relay:Fj,sample:SD,sequence:AD,sieve:Oj,subflow:cD,timeunit:wD,tupleindex:zj,values:Bj,window:_D},Symbol.toStringTag,{value:"Module"}));function xt(e){return function(){return e}}const mR=Math.abs,ai=Math.atan2,Al=Math.cos,Vie=Math.max,hw=Math.min,Va=Math.sin,Pl=Math.sqrt,oi=1e-12,vd=Math.PI,Zy=vd/2,Uj=2*vd;function Xie(e){return e>1?0:e<-1?vd:Math.acos(e)}function yR(e){return e>=1?Zy:e<=-1?-Zy:Math.asin(e)}const tC=Math.PI,nC=2*tC,Ol=1e-6,Wie=nC-Ol;function Pj(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Qie(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Pj;const n=10**t;return function(i){this._+=i[0];for(let r=1,a=i.length;r<a;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let CD=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Pj:Qie(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,a,s){this._append`C${+t},${+n},${+i},${+r},${this._x1=+a},${this._y1=+s}`}arcTo(t,n,i,r,a){if(t=+t,n=+n,i=+i,r=+r,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,l=i-t,f=r-n,d=s-t,h=o-n,p=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>Ol)if(!(Math.abs(h*l-f*d)>Ol)||!a)this._append`L${this._x1=t},${this._y1=n}`;else{let y=i-s,v=r-o,b=l*l+f*f,E=y*y+v*v,S=Math.sqrt(b),w=Math.sqrt(p),_=a*Math.tan((tC-Math.acos((b+p-E)/(2*S*w)))/2),C=_/w,$=_/S;Math.abs(C-1)>Ol&&this._append`L${t+C*d},${n+C*h}`,this._append`A${a},${a},0,0,${+(h*y>d*v)},${this._x1=t+$*l},${this._y1=n+$*f}`}}arc(t,n,i,r,a,s){if(t=+t,n=+n,i=+i,s=!!s,i<0)throw new Error(`negative radius: ${i}`);let o=i*Math.cos(r),l=i*Math.sin(r),f=t+o,d=n+l,h=1^s,p=s?r-a:a-r;this._x1===null?this._append`M${f},${d}`:(Math.abs(this._x1-f)>Ol||Math.abs(this._y1-d)>Ol)&&this._append`L${f},${d}`,i&&(p<0&&(p=p%nC+nC),p>Wie?this._append`A${i},${i},0,1,${h},${t-o},${n-l}A${i},${i},0,1,${h},${this._x1=f},${this._y1=d}`:p>Ol&&this._append`A${i},${i},0,${+(p>=tC)},${h},${this._x1=t+i*Math.cos(a)},${this._y1=n+i*Math.sin(a)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function Kb(){return new CD}Kb.prototype=CD.prototype;function Jb(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new CD(t)}function Zie(e){return e.innerRadius}function Kie(e){return e.outerRadius}function Jie(e){return e.startAngle}function ere(e){return e.endAngle}function tre(e){return e&&e.padAngle}function nre(e,t,n,i,r,a,s,o){var l=n-e,f=i-t,d=s-r,h=o-a,p=h*l-d*f;if(!(p*p<oi))return p=(d*(t-a)-h*(e-r))/p,[e+p*l,t+p*f]}function M1(e,t,n,i,r,a,s){var o=e-n,l=t-i,f=(s?a:-a)/Pl(o*o+l*l),d=f*l,h=-f*o,p=e+d,y=t+h,v=n+d,b=i+h,E=(p+v)/2,S=(y+b)/2,w=v-p,_=b-y,C=w*w+_*_,$=r-a,M=p*b-v*y,T=(_<0?-1:1)*Pl(Vie(0,$*$*C-M*M)),F=(M*_-w*T)/C,R=(-M*w-_*T)/C,B=(M*_+w*T)/C,L=(-M*w+_*T)/C,Y=F-E,H=R-S,U=B-E,z=L-S;return Y*Y+H*H>U*U+z*z&&(F=B,R=L),{cx:F,cy:R,x01:-d,y01:-h,x11:F*(r/$-1),y11:R*(r/$-1)}}function ire(){var e=Zie,t=Kie,n=xt(0),i=null,r=Jie,a=ere,s=tre,o=null,l=Jb(f);function f(){var d,h,p=+e.apply(this,arguments),y=+t.apply(this,arguments),v=r.apply(this,arguments)-Zy,b=a.apply(this,arguments)-Zy,E=mR(b-v),S=b>v;if(o||(o=d=l()),y<p&&(h=y,y=p,p=h),!(y>oi))o.moveTo(0,0);else if(E>Uj-oi)o.moveTo(y*Al(v),y*Va(v)),o.arc(0,0,y,v,b,!S),p>oi&&(o.moveTo(p*Al(b),p*Va(b)),o.arc(0,0,p,b,v,S));else{var w=v,_=b,C=v,$=b,M=E,T=E,F=s.apply(this,arguments)/2,R=F>oi&&(i?+i.apply(this,arguments):Pl(p*p+y*y)),B=hw(mR(y-p)/2,+n.apply(this,arguments)),L=B,Y=B,H,U;if(R>oi){var z=yR(R/p*Va(F)),O=yR(R/y*Va(F));(M-=z*2)>oi?(z*=S?1:-1,C+=z,$-=z):(M=0,C=$=(v+b)/2),(T-=O*2)>oi?(O*=S?1:-1,w+=O,_-=O):(T=0,w=_=(v+b)/2)}var I=y*Al(w),W=y*Va(w),K=p*Al($),k=p*Va($);if(B>oi){var V=y*Al(_),X=y*Va(_),ne=p*Al(C),ye=p*Va(C),le;if(E<vd)if(le=nre(I,W,ne,ye,V,X,K,k)){var be=I-le[0],Ye=W-le[1],it=V-le[0],xe=X-le[1],Ie=1/Va(Xie((be*it+Ye*xe)/(Pl(be*be+Ye*Ye)*Pl(it*it+xe*xe)))/2),Ge=Pl(le[0]*le[0]+le[1]*le[1]);L=hw(B,(p-Ge)/(Ie-1)),Y=hw(B,(y-Ge)/(Ie+1))}else L=Y=0}T>oi?Y>oi?(H=M1(ne,ye,I,W,y,Y,S),U=M1(V,X,K,k,y,Y,S),o.moveTo(H.cx+H.x01,H.cy+H.y01),Y<B?o.arc(H.cx,H.cy,Y,ai(H.y01,H.x01),ai(U.y01,U.x01),!S):(o.arc(H.cx,H.cy,Y,ai(H.y01,H.x01),ai(H.y11,H.x11),!S),o.arc(0,0,y,ai(H.cy+H.y11,H.cx+H.x11),ai(U.cy+U.y11,U.cx+U.x11),!S),o.arc(U.cx,U.cy,Y,ai(U.y11,U.x11),ai(U.y01,U.x01),!S))):(o.moveTo(I,W),o.arc(0,0,y,w,_,!S)):o.moveTo(I,W),!(p>oi)||!(M>oi)?o.lineTo(K,k):L>oi?(H=M1(K,k,V,X,p,-L,S),U=M1(I,W,ne,ye,p,-L,S),o.lineTo(H.cx+H.x01,H.cy+H.y01),L<B?o.arc(H.cx,H.cy,L,ai(H.y01,H.x01),ai(U.y01,U.x01),!S):(o.arc(H.cx,H.cy,L,ai(H.y01,H.x01),ai(H.y11,H.x11),!S),o.arc(0,0,p,ai(H.cy+H.y11,H.cx+H.x11),ai(U.cy+U.y11,U.cx+U.x11),S),o.arc(U.cx,U.cy,L,ai(U.y11,U.x11),ai(U.y01,U.x01),!S))):o.arc(0,0,p,$,C,S)}if(o.closePath(),d)return o=null,d+""||null}return f.centroid=function(){var d=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,h=(+r.apply(this,arguments)+ +a.apply(this,arguments))/2-vd/2;return[Al(h)*d,Va(h)*d]},f.innerRadius=function(d){return arguments.length?(e=typeof d=="function"?d:xt(+d),f):e},f.outerRadius=function(d){return arguments.length?(t=typeof d=="function"?d:xt(+d),f):t},f.cornerRadius=function(d){return arguments.length?(n=typeof d=="function"?d:xt(+d),f):n},f.padRadius=function(d){return arguments.length?(i=d==null?null:typeof d=="function"?d:xt(+d),f):i},f.startAngle=function(d){return arguments.length?(r=typeof d=="function"?d:xt(+d),f):r},f.endAngle=function(d){return arguments.length?(a=typeof d=="function"?d:xt(+d),f):a},f.padAngle=function(d){return arguments.length?(s=typeof d=="function"?d:xt(+d),f):s},f.context=function(d){return arguments.length?(o=d??null,f):o},f}function Ij(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qj(e){this._context=e}qj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $D(e){return new qj(e)}function Hj(e){return e[0]}function Gj(e){return e[1]}function Yj(e,t){var n=xt(!0),i=null,r=$D,a=null,s=Jb(o);e=typeof e=="function"?e:e===void 0?Hj:xt(e),t=typeof t=="function"?t:t===void 0?Gj:xt(t);function o(l){var f,d=(l=Ij(l)).length,h,p=!1,y;for(i==null&&(a=r(y=s())),f=0;f<=d;++f)!(f<d&&n(h=l[f],f,l))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+e(h,f,l),+t(h,f,l));if(y)return a=null,y+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:xt(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:xt(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:xt(!!l),o):n},o.curve=function(l){return arguments.length?(r=l,i!=null&&(a=r(i)),o):r},o.context=function(l){return arguments.length?(l==null?i=a=null:a=r(i=l),o):i},o}function Vj(e,t,n){var i=null,r=xt(!0),a=null,s=$D,o=null,l=Jb(f);e=typeof e=="function"?e:e===void 0?Hj:xt(+e),t=typeof t=="function"?t:xt(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Gj:xt(+n);function f(h){var p,y,v,b=(h=Ij(h)).length,E,S=!1,w,_=new Array(b),C=new Array(b);for(a==null&&(o=s(w=l())),p=0;p<=b;++p){if(!(p<b&&r(E=h[p],p,h))===S)if(S=!S)y=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=p-1;v>=y;--v)o.point(_[v],C[v]);o.lineEnd(),o.areaEnd()}S&&(_[p]=+e(E,p,h),C[p]=+t(E,p,h),o.point(i?+i(E,p,h):_[p],n?+n(E,p,h):C[p]))}if(w)return o=null,w+""||null}function d(){return Yj().defined(r).curve(s).context(a)}return f.x=function(h){return arguments.length?(e=typeof h=="function"?h:xt(+h),i=null,f):e},f.x0=function(h){return arguments.length?(e=typeof h=="function"?h:xt(+h),f):e},f.x1=function(h){return arguments.length?(i=h==null?null:typeof h=="function"?h:xt(+h),f):i},f.y=function(h){return arguments.length?(t=typeof h=="function"?h:xt(+h),n=null,f):t},f.y0=function(h){return arguments.length?(t=typeof h=="function"?h:xt(+h),f):t},f.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:xt(+h),f):n},f.lineX0=f.lineY0=function(){return d().x(e).y(t)},f.lineY1=function(){return d().x(e).y(n)},f.lineX1=function(){return d().x(i).y(t)},f.defined=function(h){return arguments.length?(r=typeof h=="function"?h:xt(!!h),f):r},f.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),f):s},f.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),f):a},f}const rre={draw(e,t){const n=Pl(t/vd);e.moveTo(n,0),e.arc(0,0,n,0,Uj)}};function are(e,t){let n=null,i=Jb(r);e=typeof e=="function"?e:xt(e||rre),t=typeof t=="function"?t:xt(t===void 0?64:+t);function r(){let a;if(n||(n=a=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return r.type=function(a){return arguments.length?(e=typeof a=="function"?a:xt(a),r):e},r.size=function(a){return arguments.length?(t=typeof a=="function"?a:xt(+a),r):t},r.context=function(a){return arguments.length?(n=a??null,r):n},r}function Fu(){}function Ky(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function ex(e){this._context=e}ex.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ky(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ky(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function sre(e){return new ex(e)}function Xj(e){this._context=e}Xj.prototype={areaStart:Fu,areaEnd:Fu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ky(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ore(e){return new Xj(e)}function Wj(e){this._context=e}Wj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Ky(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ure(e){return new Wj(e)}function Qj(e,t){this._basis=new ex(e),this._beta=t}Qj.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],a=e[n]-i,s=t[n]-r,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(i+l*a),this._beta*t[o]+(1-this._beta)*(r+l*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const lre=function e(t){function n(i){return t===1?new ex(i):new Qj(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function Jy(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function DD(e,t){this._context=e,this._k=(1-t)/6}DD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Jy(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Jy(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const cre=function e(t){function n(i){return new DD(i,t)}return n.tension=function(i){return e(+i)},n}(0);function TD(e,t){this._context=e,this._k=(1-t)/6}TD.prototype={areaStart:Fu,areaEnd:Fu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Jy(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const fre=function e(t){function n(i){return new TD(i,t)}return n.tension=function(i){return e(+i)},n}(0);function MD(e,t){this._context=e,this._k=(1-t)/6}MD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Jy(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const dre=function e(t){function n(i){return new MD(i,t)}return n.tension=function(i){return e(+i)},n}(0);function kD(e,t,n){var i=e._x1,r=e._y1,a=e._x2,s=e._y2;if(e._l01_a>oi){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>oi){var f=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*f+e._x1*e._l23_2a-t*e._l12_2a)/d,s=(s*f+e._y1*e._l23_2a-n*e._l12_2a)/d}e._context.bezierCurveTo(i,r,a,s,e._x2,e._y2)}function Zj(e,t){this._context=e,this._alpha=t}Zj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:kD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hre=function e(t){function n(i){return t?new Zj(i,t):new DD(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Kj(e,t){this._context=e,this._alpha=t}Kj.prototype={areaStart:Fu,areaEnd:Fu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:kD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const gre=function e(t){function n(i){return t?new Kj(i,t):new TD(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Jj(e,t){this._context=e,this._alpha=t}Jj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const pre=function e(t){function n(i){return t?new Jj(i,t):new MD(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function eU(e){this._context=e}eU.prototype={areaStart:Fu,areaEnd:Fu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function mre(e){return new eU(e)}function vR(e){return e<0?-1:1}function bR(e,t,n){var i=e._x1-e._x0,r=t-e._x1,a=(e._y1-e._y0)/(i||r<0&&-0),s=(n-e._y1)/(r||i<0&&-0),o=(a*r+s*i)/(i+r);return(vR(a)+vR(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function xR(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function gw(e,t,n){var i=e._x0,r=e._y0,a=e._x1,s=e._y1,o=(a-i)/3;e._context.bezierCurveTo(i+o,r+o*t,a-o,s-o*n,a,s)}function ev(e){this._context=e}ev.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gw(this,this._t0,xR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,gw(this,xR(this,n=bR(this,e,t)),n);break;default:gw(this,this._t0,n=bR(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function tU(e){this._context=new nU(e)}(tU.prototype=Object.create(ev.prototype)).point=function(e,t){ev.prototype.point.call(this,t,e)};function nU(e){this._context=e}nU.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,a){this._context.bezierCurveTo(t,e,i,n,a,r)}};function yre(e){return new ev(e)}function vre(e){return new tU(e)}function iU(e){this._context=e}iU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=ER(e),r=ER(t),a=0,s=1;s<n;++a,++s)this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ER(e){var t,n=e.length-1,i,r=new Array(n),a=new Array(n),s=new Array(n);for(r[0]=0,a[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,a[t]=4,s[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,a[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/a[t-1],a[t]-=i,s[t]-=i*s[t-1];for(r[n-1]=s[n-1]/a[n-1],t=n-2;t>=0;--t)r[t]=(s[t]-r[t+1])/a[t];for(a[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-r[t+1];return[r,a]}function bre(e){return new iU(e)}function tx(e,t){this._context=e,this._t=t}tx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function xre(e){return new tx(e,.5)}function Ere(e){return new tx(e,0)}function Sre(e){return new tx(e,1)}function Cu(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const Are=()=>typeof Image<"u"?Image:null;function bs(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const iC=Symbol("implicit");function ND(){var e=new LO,t=[],n=[],i=iC;function r(a){let s=e.get(a);if(s===void 0){if(i!==iC)return i;e.set(a,s=t.push(a)-1)}return n[s%n.length]}return r.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new LO;for(const s of a)e.has(s)||e.set(s,t.push(s)-1);return r},r.range=function(a){return arguments.length?(n=Array.from(a),r):n.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return ND(t,n).unknown(i)},bs.apply(r,arguments),r}function nh(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vp(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Yu(){}var rc=.7,bd=1/rc,nd="\\s*([+-]?\\d+)\\s*",Rg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wre=/^#([0-9a-f]{3,8})$/,_re=new RegExp(`^rgb\\(${nd},${nd},${nd}\\)$`),Cre=new RegExp(`^rgb\\(${rs},${rs},${rs}\\)$`),$re=new RegExp(`^rgba\\(${nd},${nd},${nd},${Rg}\\)$`),Dre=new RegExp(`^rgba\\(${rs},${rs},${rs},${Rg}\\)$`),Tre=new RegExp(`^hsl\\(${Rg},${rs},${rs}\\)$`),Mre=new RegExp(`^hsla\\(${Rg},${rs},${rs},${Rg}\\)$`),SR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nh(Yu,zg,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:AR,formatHex:AR,formatHex8:kre,formatHsl:Nre,formatRgb:wR,toString:wR});function AR(){return this.rgb().formatHex()}function kre(){return this.rgb().formatHex8()}function Nre(){return rU(this).formatHsl()}function wR(){return this.rgb().formatRgb()}function zg(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=wre.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?_R(t):n===3?new Fn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?k1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?k1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=_re.exec(e))?new Fn(t[1],t[2],t[3],1):(t=Cre.exec(e))?new Fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$re.exec(e))?k1(t[1],t[2],t[3],t[4]):(t=Dre.exec(e))?k1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Tre.exec(e))?DR(t[1],t[2]/100,t[3]/100,1):(t=Mre.exec(e))?DR(t[1],t[2]/100,t[3]/100,t[4]):SR.hasOwnProperty(e)?_R(SR[e]):e==="transparent"?new Fn(NaN,NaN,NaN,0):null}function _R(e){return new Fn(e>>16&255,e>>8&255,e&255,1)}function k1(e,t,n,i){return i<=0&&(e=t=n=NaN),new Fn(e,t,n,i)}function FD(e){return e instanceof Yu||(e=zg(e)),e?(e=e.rgb(),new Fn(e.r,e.g,e.b,e.opacity)):new Fn}function Ou(e,t,n,i){return arguments.length===1?FD(e):new Fn(e,t,n,i??1)}function Fn(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}nh(Fn,Ou,vp(Yu,{brighter(e){return e=e==null?bd:Math.pow(bd,e),new Fn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?rc:Math.pow(rc,e),new Fn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Fn(Wl(this.r),Wl(this.g),Wl(this.b),tv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:CR,formatHex:CR,formatHex8:Fre,formatRgb:$R,toString:$R}));function CR(){return`#${Il(this.r)}${Il(this.g)}${Il(this.b)}`}function Fre(){return`#${Il(this.r)}${Il(this.g)}${Il(this.b)}${Il((isNaN(this.opacity)?1:this.opacity)*255)}`}function $R(){const e=tv(this.opacity);return`${e===1?"rgb(":"rgba("}${Wl(this.r)}, ${Wl(this.g)}, ${Wl(this.b)}${e===1?")":`, ${e})`}`}function tv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Wl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Il(e){return e=Wl(e),(e<16?"0":"")+e.toString(16)}function DR(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ma(e,t,n,i)}function rU(e){if(e instanceof ma)return new ma(e.h,e.s,e.l,e.opacity);if(e instanceof Yu||(e=zg(e)),!e)return new ma;if(e instanceof ma)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),a=Math.max(t,n,i),s=NaN,o=a-r,l=(a+r)/2;return o?(t===a?s=(n-i)/o+(n<i)*6:n===a?s=(i-t)/o+2:s=(t-n)/o+4,o/=l<.5?a+r:2-a-r,s*=60):o=l>0&&l<1?0:s,new ma(s,o,l,e.opacity)}function nv(e,t,n,i){return arguments.length===1?rU(e):new ma(e,t,n,i??1)}function ma(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}nh(ma,nv,vp(Yu,{brighter(e){return e=e==null?bd:Math.pow(bd,e),new ma(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?rc:Math.pow(rc,e),new ma(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Fn(pw(e>=240?e-240:e+120,r,i),pw(e,r,i),pw(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new ma(TR(this.h),N1(this.s),N1(this.l),tv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=tv(this.opacity);return`${e===1?"hsl(":"hsla("}${TR(this.h)}, ${N1(this.s)*100}%, ${N1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function TR(e){return e=(e||0)%360,e<0?e+360:e}function N1(e){return Math.max(0,Math.min(1,e||0))}function pw(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const aU=Math.PI/180,sU=180/Math.PI,iv=18,oU=.96422,uU=1,lU=.82521,cU=4/29,id=6/29,fU=3*id*id,Ore=id*id*id;function dU(e){if(e instanceof as)return new as(e.l,e.a,e.b,e.opacity);if(e instanceof so)return hU(e);e instanceof Fn||(e=FD(e));var t=bw(e.r),n=bw(e.g),i=bw(e.b),r=mw((.2225045*t+.7168786*n+.0606169*i)/uU),a,s;return t===n&&n===i?a=s=r:(a=mw((.4360747*t+.3850649*n+.1430804*i)/oU),s=mw((.0139322*t+.0971045*n+.7141733*i)/lU)),new as(116*r-16,500*(a-r),200*(r-s),e.opacity)}function rv(e,t,n,i){return arguments.length===1?dU(e):new as(e,t,n,i??1)}function as(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}nh(as,rv,vp(Yu,{brighter(e){return new as(this.l+iv*(e??1),this.a,this.b,this.opacity)},darker(e){return new as(this.l-iv*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=oU*yw(t),e=uU*yw(e),n=lU*yw(n),new Fn(vw(3.1338561*t-1.6168667*e-.4906146*n),vw(-.9787684*t+1.9161415*e+.033454*n),vw(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function mw(e){return e>Ore?Math.pow(e,1/3):e/fU+cU}function yw(e){return e>id?e*e*e:fU*(e-cU)}function vw(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function bw(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Rre(e){if(e instanceof so)return new so(e.h,e.c,e.l,e.opacity);if(e instanceof as||(e=dU(e)),e.a===0&&e.b===0)return new so(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*sU;return new so(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function av(e,t,n,i){return arguments.length===1?Rre(e):new so(e,t,n,i??1)}function so(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function hU(e){if(isNaN(e.h))return new as(e.l,0,0,e.opacity);var t=e.h*aU;return new as(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}nh(so,av,vp(Yu,{brighter(e){return new so(this.h,this.c,this.l+iv*(e??1),this.opacity)},darker(e){return new so(this.h,this.c,this.l-iv*(e??1),this.opacity)},rgb(){return hU(this).rgb()}}));var gU=-.14861,OD=1.78277,RD=-.29227,nx=-.90649,Bg=1.97294,MR=Bg*nx,kR=Bg*OD,NR=OD*RD-nx*gU;function zre(e){if(e instanceof Ql)return new Ql(e.h,e.s,e.l,e.opacity);e instanceof Fn||(e=FD(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(NR*i+MR*t-kR*n)/(NR+MR-kR),a=i-r,s=(Bg*(n-r)-RD*a)/nx,o=Math.sqrt(s*s+a*a)/(Bg*r*(1-r)),l=o?Math.atan2(s,a)*sU-120:NaN;return new Ql(l<0?l+360:l,o,r,e.opacity)}function rC(e,t,n,i){return arguments.length===1?zre(e):new Ql(e,t,n,i??1)}function Ql(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}nh(Ql,rC,vp(Yu,{brighter(e){return e=e==null?bd:Math.pow(bd,e),new Ql(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?rc:Math.pow(rc,e),new Ql(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*aU,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Fn(255*(t+n*(gU*i+OD*r)),255*(t+n*(RD*i+nx*r)),255*(t+n*(Bg*i)),this.opacity)}}));function pU(e,t,n,i,r){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*n+(1+3*e+3*a-3*s)*i+s*r)/6}function mU(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],a=e[i+1],s=i>0?e[i-1]:2*r-a,o=i<t-1?e[i+2]:2*a-r;return pU((n-i/t)*t,s,r,a,o)}}function yU(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],a=e[i%t],s=e[(i+1)%t],o=e[(i+2)%t];return pU((n-i/t)*t,r,a,s,o)}}const ix=e=>()=>e;function vU(e,t){return function(n){return e+n*t}}function Bre(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function rx(e,t){var n=t-e;return n?vU(e,n>180||n<-180?n-360*Math.round(n/360):n):ix(isNaN(e)?t:e)}function Lre(e){return(e=+e)==1?On:function(t,n){return n-t?Bre(t,n,e):ix(isNaN(t)?n:t)}}function On(e,t){var n=t-e;return n?vU(e,n):ix(isNaN(e)?t:e)}const aC=function e(t){var n=Lre(t);function i(r,a){var s=n((r=Ou(r)).r,(a=Ou(a)).r),o=n(r.g,a.g),l=n(r.b,a.b),f=On(r.opacity,a.opacity);return function(d){return r.r=s(d),r.g=o(d),r.b=l(d),r.opacity=f(d),r+""}}return i.gamma=e,i}(1);function bU(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),a=new Array(n),s,o;for(s=0;s<n;++s)o=Ou(t[s]),i[s]=o.r||0,r[s]=o.g||0,a[s]=o.b||0;return i=e(i),r=e(r),a=e(a),o.opacity=1,function(l){return o.r=i(l),o.g=r(l),o.b=a(l),o+""}}}var jre=bU(mU),Ure=bU(yU);function zD(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(a){for(r=0;r<n;++r)i[r]=e[r]*(1-a)+t[r]*a;return i}}function xU(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Pre(e,t){return(xU(t)?zD:EU)(e,t)}function EU(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),a=new Array(n),s;for(s=0;s<i;++s)r[s]=Vu(e[s],t[s]);for(;s<n;++s)a[s]=t[s];return function(o){for(s=0;s<i;++s)a[s]=r[s](o);return a}}function SU(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function ga(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function AU(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Vu(e[r],t[r]):i[r]=t[r];return function(a){for(r in n)i[r]=n[r](a);return i}}var sC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xw=new RegExp(sC.source,"g");function Ire(e){return function(){return e}}function qre(e){return function(t){return e(t)+""}}function wU(e,t){var n=sC.lastIndex=xw.lastIndex=0,i,r,a,s=-1,o=[],l=[];for(e=e+"",t=t+"";(i=sC.exec(e))&&(r=xw.exec(t));)(a=r.index)>n&&(a=t.slice(n,a),o[s]?o[s]+=a:o[++s]=a),(i=i[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:ga(i,r)})),n=xw.lastIndex;return n<t.length&&(a=t.slice(n),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?qre(l[0].x):Ire(t):(t=l.length,function(f){for(var d=0,h;d<t;++d)o[(h=l[d]).i]=h.x(f);return o.join("")})}function Vu(e,t){var n=typeof t,i;return t==null||n==="boolean"?ix(t):(n==="number"?ga:n==="string"?(i=zg(t))?(t=i,aC):wU:t instanceof zg?aC:t instanceof Date?SU:xU(t)?zD:Array.isArray(t)?EU:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?AU:ga)(e,t)}function Hre(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Gre(e,t){var n=rx(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function bp(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var FR=180/Math.PI,oC={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _U(e,t,n,i,r,a){var s,o,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),e*i<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(t,e)*FR,skewX:Math.atan(l)*FR,scaleX:s,scaleY:o}}var F1;function Yre(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?oC:_U(t.a,t.b,t.c,t.d,t.e,t.f)}function Vre(e){return e==null||(F1||(F1=document.createElementNS("http://www.w3.org/2000/svg","g")),F1.setAttribute("transform",e),!(e=F1.transform.baseVal.consolidate()))?oC:(e=e.matrix,_U(e.a,e.b,e.c,e.d,e.e,e.f))}function CU(e,t,n,i){function r(f){return f.length?f.pop()+" ":""}function a(f,d,h,p,y,v){if(f!==h||d!==p){var b=y.push("translate(",null,t,null,n);v.push({i:b-4,x:ga(f,h)},{i:b-2,x:ga(d,p)})}else(h||p)&&y.push("translate("+h+t+p+n)}function s(f,d,h,p){f!==d?(f-d>180?d+=360:d-f>180&&(f+=360),p.push({i:h.push(r(h)+"rotate(",null,i)-2,x:ga(f,d)})):d&&h.push(r(h)+"rotate("+d+i)}function o(f,d,h,p){f!==d?p.push({i:h.push(r(h)+"skewX(",null,i)-2,x:ga(f,d)}):d&&h.push(r(h)+"skewX("+d+i)}function l(f,d,h,p,y,v){if(f!==h||d!==p){var b=y.push(r(y)+"scale(",null,",",null,")");v.push({i:b-4,x:ga(f,h)},{i:b-2,x:ga(d,p)})}else(h!==1||p!==1)&&y.push(r(y)+"scale("+h+","+p+")")}return function(f,d){var h=[],p=[];return f=e(f),d=e(d),a(f.translateX,f.translateY,d.translateX,d.translateY,h,p),s(f.rotate,d.rotate,h,p),o(f.skewX,d.skewX,h,p),l(f.scaleX,f.scaleY,d.scaleX,d.scaleY,h,p),f=d=null,function(y){for(var v=-1,b=p.length,E;++v<b;)h[(E=p[v]).i]=E.x(y);return h.join("")}}}var Xre=CU(Yre,"px, ","px)","deg)"),Wre=CU(Vre,", ",")",")"),Qre=1e-12;function OR(e){return((e=Math.exp(e))+1/e)/2}function Zre(e){return((e=Math.exp(e))-1/e)/2}function Kre(e){return((e=Math.exp(2*e))-1)/(e+1)}const Jre=function e(t,n,i){function r(a,s){var o=a[0],l=a[1],f=a[2],d=s[0],h=s[1],p=s[2],y=d-o,v=h-l,b=y*y+v*v,E,S;if(b<Qre)S=Math.log(p/f)/t,E=function(T){return[o+T*y,l+T*v,f*Math.exp(t*T*S)]};else{var w=Math.sqrt(b),_=(p*p-f*f+i*b)/(2*f*n*w),C=(p*p-f*f-i*b)/(2*p*n*w),$=Math.log(Math.sqrt(_*_+1)-_),M=Math.log(Math.sqrt(C*C+1)-C);S=(M-$)/t,E=function(T){var F=T*S,R=OR($),B=f/(n*w)*(R*Kre(t*F+$)-Zre($));return[o+B*y,l+B*v,f*R/OR(t*F+$)]}}return E.duration=S*1e3*t/Math.SQRT2,E}return r.rho=function(a){var s=Math.max(.001,+a),o=s*s,l=o*o;return e(s,o,l)},r}(Math.SQRT2,2,4);function $U(e){return function(t,n){var i=e((t=nv(t)).h,(n=nv(n)).h),r=On(t.s,n.s),a=On(t.l,n.l),s=On(t.opacity,n.opacity);return function(o){return t.h=i(o),t.s=r(o),t.l=a(o),t.opacity=s(o),t+""}}}const eae=$U(rx);var tae=$U(On);function nae(e,t){var n=On((e=rv(e)).l,(t=rv(t)).l),i=On(e.a,t.a),r=On(e.b,t.b),a=On(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=i(s),e.b=r(s),e.opacity=a(s),e+""}}function DU(e){return function(t,n){var i=e((t=av(t)).h,(n=av(n)).h),r=On(t.c,n.c),a=On(t.l,n.l),s=On(t.opacity,n.opacity);return function(o){return t.h=i(o),t.c=r(o),t.l=a(o),t.opacity=s(o),t+""}}}const iae=DU(rx);var rae=DU(On);function TU(e){return function t(n){n=+n;function i(r,a){var s=e((r=rC(r)).h,(a=rC(a)).h),o=On(r.s,a.s),l=On(r.l,a.l),f=On(r.opacity,a.opacity);return function(d){return r.h=s(d),r.s=o(d),r.l=l(Math.pow(d,n)),r.opacity=f(d),r+""}}return i.gamma=t,i}(1)}const aae=TU(rx);var sae=TU(On);function BD(e,t){t===void 0&&(t=e,e=Vu);for(var n=0,i=t.length-1,r=t[0],a=new Array(i<0?0:i);n<i;)a[n]=e(r,r=t[++n]);return function(s){var o=Math.max(0,Math.min(i-1,Math.floor(s*=i)));return a[o](s-o)}}function oae(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const uae=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Vu,interpolateArray:Pre,interpolateBasis:mU,interpolateBasisClosed:yU,interpolateCubehelix:aae,interpolateCubehelixLong:sae,interpolateDate:SU,interpolateDiscrete:Hre,interpolateHcl:iae,interpolateHclLong:rae,interpolateHsl:eae,interpolateHslLong:tae,interpolateHue:Gre,interpolateLab:nae,interpolateNumber:ga,interpolateNumberArray:zD,interpolateObject:AU,interpolateRgb:aC,interpolateRgbBasis:jre,interpolateRgbBasisClosed:Ure,interpolateRound:bp,interpolateString:wU,interpolateTransformCss:Xre,interpolateTransformSvg:Wre,interpolateZoom:Jre,piecewise:BD,quantize:oae},Symbol.toStringTag,{value:"Module"}));function lae(e){return function(){return e}}function uC(e){return+e}var RR=[0,1];function Zi(e){return e}function lC(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:lae(isNaN(t)?NaN:.5)}function cae(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function fae(e,t,n){var i=e[0],r=e[1],a=t[0],s=t[1];return r<i?(i=lC(r,i),a=n(s,a)):(i=lC(i,r),a=n(a,s)),function(o){return a(i(o))}}function dae(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),a=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=lC(e[s],e[s+1]),a[s]=n(t[s],t[s+1]);return function(o){var l=Mu(e,o,1,i)-1;return a[l](r[l](o))}}function xp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ax(){var e=RR,t=RR,n=Vu,i,r,a,s=Zi,o,l,f;function d(){var p=Math.min(e.length,t.length);return s!==Zi&&(s=cae(e[0],e[p-1])),o=p>2?dae:fae,l=f=null,h}function h(p){return p==null||isNaN(p=+p)?a:(l||(l=o(e.map(i),t,n)))(i(s(p)))}return h.invert=function(p){return s(r((f||(f=o(t,e.map(i),ga)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,uC),d()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),n=bp,d()},h.clamp=function(p){return arguments.length?(s=p?!0:Zi,d()):s!==Zi},h.interpolate=function(p){return arguments.length?(n=p,d()):n},h.unknown=function(p){return arguments.length?(a=p,h):a},function(p,y){return i=p,r=y,d()}}function MU(){return ax()(Zi,Zi)}function kU(e,t,n,i){var r=ku(e,t,n),a;switch(i=ic(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(a=iL(r,s))&&(i.precision=a),w$(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(a=rL(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=a-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(a=nL(r))&&(i.precision=a-(i.type==="%")*2);break}}return Ob(i)}function kc(e){var t=e.domain;return e.ticks=function(n){var i=t();return P_(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return kU(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,a=i.length-1,s=i[r],o=i[a],l,f,d=10;for(o<s&&(f=s,s=o,o=f,f=r,r=a,a=f);d-- >0;){if(f=I_(s,o,n),f===l)return i[r]=s,i[a]=o,t(i);if(f>0)s=Math.floor(s/f)*f,o=Math.ceil(o/f)*f;else if(f<0)s=Math.ceil(s*f)/f,o=Math.floor(o*f)/f;else break;l=f}return e},e}function NU(){var e=MU();return e.copy=function(){return xp(e,NU())},bs.apply(e,arguments),kc(e)}function FU(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,uC),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return FU(e).unknown(t)},e=arguments.length?Array.from(e,uC):[0,1],kc(n)}function OU(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],a=e[i],s;return a<r&&(s=n,n=i,i=s,s=r,r=a,a=s),e[n]=t.floor(r),e[i]=t.ceil(a),e}function zR(e){return Math.log(e)}function BR(e){return Math.exp(e)}function hae(e){return-Math.log(-e)}function gae(e){return-Math.exp(-e)}function pae(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mae(e){return e===10?pae:e===Math.E?Math.exp:t=>Math.pow(e,t)}function yae(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function LR(e){return(t,n)=>-e(-t,n)}function LD(e){const t=e(zR,BR),n=t.domain;let i=10,r,a;function s(){return r=yae(i),a=mae(i),n()[0]<0?(r=LR(r),a=LR(a),e(hae,gae)):e(zR,BR),t}return t.base=function(o){return arguments.length?(i=+o,s()):i},t.domain=function(o){return arguments.length?(n(o),s()):n()},t.ticks=o=>{const l=n();let f=l[0],d=l[l.length-1];const h=d<f;h&&([f,d]=[d,f]);let p=r(f),y=r(d),v,b;const E=o==null?10:+o;let S=[];if(!(i%1)&&y-p<E){if(p=Math.floor(p),y=Math.ceil(y),f>0){for(;p<=y;++p)for(v=1;v<i;++v)if(b=p<0?v/a(-p):v*a(p),!(b<f)){if(b>d)break;S.push(b)}}else for(;p<=y;++p)for(v=i-1;v>=1;--v)if(b=p>0?v/a(-p):v*a(p),!(b<f)){if(b>d)break;S.push(b)}S.length*2<E&&(S=P_(f,d,E))}else S=P_(p,y,Math.min(y-p,E)).map(a);return h?S.reverse():S},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=ic(l)).precision==null&&(l.trim=!0),l=Ob(l)),o===1/0)return l;const f=Math.max(1,i*o/t.ticks().length);return d=>{let h=d/a(Math.round(r(d)));return h*i<i-.5&&(h*=i),h<=f?l(d):""}},t.nice=()=>n(OU(n(),{floor:o=>a(Math.floor(r(o))),ceil:o=>a(Math.ceil(r(o)))})),t}function RU(){const e=LD(ax()).domain([1,10]);return e.copy=()=>xp(e,RU()).base(e.base()),bs.apply(e,arguments),e}function jR(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function UR(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function jD(e){var t=1,n=e(jR(t),UR(t));return n.constant=function(i){return arguments.length?e(jR(t=+i),UR(t)):t},kc(n)}function zU(){var e=jD(ax());return e.copy=function(){return xp(e,zU()).constant(e.constant())},bs.apply(e,arguments)}function PR(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vae(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function bae(e){return e<0?-e*e:e*e}function UD(e){var t=e(Zi,Zi),n=1;function i(){return n===1?e(Zi,Zi):n===.5?e(vae,bae):e(PR(n),PR(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},kc(t)}function PD(){var e=UD(ax());return e.copy=function(){return xp(e,PD()).exponent(e.exponent())},bs.apply(e,arguments),e}function xae(){return PD.apply(null,arguments).exponent(.5)}function BU(){var e=[],t=[],n=[],i;function r(){var s=0,o=Math.max(1,t.length);for(n=new Array(o-1);++s<o;)n[s-1]=QB(e,s/o);return a}function a(s){return s==null||isNaN(s=+s)?i:t[Mu(n,s)]}return a.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(lo),r()},a.range=function(s){return arguments.length?(t=Array.from(s),r()):t.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.quantiles=function(){return n.slice()},a.copy=function(){return BU().domain(e).range(t).unknown(i)},bs.apply(a,arguments)}function LU(){var e=0,t=1,n=1,i=[.5],r=[0,1],a;function s(l){return l!=null&&l<=l?r[Mu(i,l,0,n)]:a}function o(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*t-(l-n)*e)/(n+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,o()):r.slice()},s.invertExtent=function(l){var f=r.indexOf(l);return f<0?[NaN,NaN]:f<1?[e,i[0]]:f>=n?[i[n-1],t]:[i[f-1],i[f]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return i.slice()},s.copy=function(){return LU().domain([e,t]).range(r).unknown(a)},bs.apply(kc(s),arguments)}function jU(){var e=[.5],t=[0,1],n,i=1;function r(a){return a!=null&&a<=a?t[Mu(e,a,0,i)]:n}return r.domain=function(a){return arguments.length?(e=Array.from(a),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(a){return arguments.length?(t=Array.from(a),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},r.unknown=function(a){return arguments.length?(n=a,r):n},r.copy=function(){return jU().domain(e).range(t).unknown(n)},bs.apply(r,arguments)}function Eae(e){return new Date(e)}function Sae(e){return e instanceof Date?+e:+new Date(+e)}function ID(e,t,n,i,r,a,s,o,l,f){var d=MU(),h=d.invert,p=d.domain,y=f(".%L"),v=f(":%S"),b=f("%I:%M"),E=f("%I %p"),S=f("%a %d"),w=f("%b %d"),_=f("%B"),C=f("%Y");function $(M){return(l(M)<M?y:o(M)<M?v:s(M)<M?b:a(M)<M?E:i(M)<M?r(M)<M?S:w:n(M)<M?_:C)(M)}return d.invert=function(M){return new Date(h(M))},d.domain=function(M){return arguments.length?p(Array.from(M,Sae)):p().map(Eae)},d.ticks=function(M){var T=p();return e(T[0],T[T.length-1],M??10)},d.tickFormat=function(M,T){return T==null?$:f(T)},d.nice=function(M){var T=p();return(!M||typeof M.range!="function")&&(M=t(T[0],T[T.length-1],M??10)),M?p(OU(T,M)):d},d.copy=function(){return xp(d,ID(e,t,n,i,r,a,s,o,l,f))},d}function Aae(){return bs.apply(ID(Tee,Mee,fs,Mg,Zd,co,Bb,Rb,ao,T$).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function wae(){return bs.apply(ID($ee,Dee,ds,kg,Kd,wu,Lb,zb,ao,M$).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function sx(){var e=0,t=1,n,i,r,a,s=Zi,o=!1,l;function f(h){return h==null||isNaN(h=+h)?l:s(r===0?.5:(h=(a(h)-n)*r,o?Math.max(0,Math.min(1,h)):h))}f.domain=function(h){return arguments.length?([e,t]=h,n=a(e=+e),i=a(t=+t),r=n===i?0:1/(i-n),f):[e,t]},f.clamp=function(h){return arguments.length?(o=!!h,f):o},f.interpolator=function(h){return arguments.length?(s=h,f):s};function d(h){return function(p){var y,v;return arguments.length?([y,v]=p,s=h(y,v),f):[s(0),s(1)]}}return f.range=d(Vu),f.rangeRound=d(bp),f.unknown=function(h){return arguments.length?(l=h,f):l},function(h){return a=h,n=h(e),i=h(t),r=n===i?0:1/(i-n),f}}function Xu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function qD(){var e=kc(sx()(Zi));return e.copy=function(){return Xu(e,qD())},Gu.apply(e,arguments)}function UU(){var e=LD(sx()).domain([1,10]);return e.copy=function(){return Xu(e,UU()).base(e.base())},Gu.apply(e,arguments)}function PU(){var e=jD(sx());return e.copy=function(){return Xu(e,PU()).constant(e.constant())},Gu.apply(e,arguments)}function HD(){var e=UD(sx());return e.copy=function(){return Xu(e,HD()).exponent(e.exponent())},Gu.apply(e,arguments)}function _ae(){return HD.apply(null,arguments).exponent(.5)}function ox(){var e=0,t=.5,n=1,i=1,r,a,s,o,l,f=Zi,d,h=!1,p;function y(b){return isNaN(b=+b)?p:(b=.5+((b=+d(b))-a)*(i*b<i*a?o:l),f(h?Math.max(0,Math.min(1,b)):b))}y.domain=function(b){return arguments.length?([e,t,n]=b,r=d(e=+e),a=d(t=+t),s=d(n=+n),o=r===a?0:.5/(a-r),l=a===s?0:.5/(s-a),i=a<r?-1:1,y):[e,t,n]},y.clamp=function(b){return arguments.length?(h=!!b,y):h},y.interpolator=function(b){return arguments.length?(f=b,y):f};function v(b){return function(E){var S,w,_;return arguments.length?([S,w,_]=E,f=BD(b,[S,w,_]),y):[f(0),f(.5),f(1)]}}return y.range=v(Vu),y.rangeRound=v(bp),y.unknown=function(b){return arguments.length?(p=b,y):p},function(b){return d=b,r=b(e),a=b(t),s=b(n),o=r===a?0:.5/(a-r),l=a===s?0:.5/(s-a),i=a<r?-1:1,y}}function IU(){var e=kc(ox()(Zi));return e.copy=function(){return Xu(e,IU())},Gu.apply(e,arguments)}function qU(){var e=LD(ox()).domain([.1,1,10]);return e.copy=function(){return Xu(e,qU()).base(e.base())},Gu.apply(e,arguments)}function HU(){var e=jD(ox());return e.copy=function(){return Xu(e,HU()).constant(e.constant())},Gu.apply(e,arguments)}function GD(){var e=UD(ox());return e.copy=function(){return Xu(e,GD()).exponent(e.exponent())},Gu.apply(e,arguments)}function Cae(){return GD.apply(null,arguments).exponent(.5)}function xs(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const $ae=xs("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Dae=xs("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Tae=xs("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Mae=xs("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),kae=xs("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Nae=xs("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Fae=xs("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Oae=xs("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Rae=xs("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),zae=xs("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function YD(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const Bae="identity",xd="linear",bo="log",Ep="pow",Sp="sqrt",ux="symlog",ac="time",sc="utc",ss="sequential",ih="diverging",Ed="quantile",lx="quantize",cx="threshold",VD="ordinal",cC="point",GU="band",XD="bin-ordinal",Cn="continuous",Ap="discrete",wp="discretizing",ia="interpolating",WD="temporal";function Lae(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function jae(e){return function(t){const n=e.range();let i=t[0],r=t[1],a=-1,s,o,l,f;for(r<i&&(o=i,i=r,r=o),l=0,f=n.length;l<f;++l)n[l]>=i&&n[l]<=r&&(a<0&&(a=l),s=l);if(!(a<0))return i=e.invertExtent(n[a]),r=e.invertExtent(n[s]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function QD(){const e=ND().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,a,s=!1,o=0,l=0,f=.5;delete e.unknown;function d(){const h=t().length,p=i[1]<i[0],y=i[1-p],v=YD(h,o,l);let b=i[p-0];r=(y-b)/(v||1),s&&(r=Math.floor(r)),b+=(y-b-r*(h-o))*f,a=r*(1-o),s&&(b=Math.round(b),a=Math.round(a));const E=Er(h).map(S=>b+r*S);return n(p?E.reverse():E)}return e.domain=function(h){return arguments.length?(t(h),d()):t()},e.range=function(h){return arguments.length?(i=[+h[0],+h[1]],d()):i.slice()},e.rangeRound=function(h){return i=[+h[0],+h[1]],s=!0,d()},e.bandwidth=function(){return a},e.step=function(){return r},e.round=function(h){return arguments.length?(s=!!h,d()):s},e.padding=function(h){return arguments.length?(l=Math.max(0,Math.min(1,h)),o=l,d()):o},e.paddingInner=function(h){return arguments.length?(o=Math.max(0,Math.min(1,h)),d()):o},e.paddingOuter=function(h){return arguments.length?(l=Math.max(0,Math.min(1,h)),d()):l},e.align=function(h){return arguments.length?(f=Math.max(0,Math.min(1,h)),d()):f},e.invertRange=function(h){if(h[0]==null||h[1]==null)return;const p=i[1]<i[0],y=p?n().reverse():n(),v=y.length-1;let b=+h[0],E=+h[1],S,w,_;if(!(b!==b||E!==E)&&(E<b&&(_=b,b=E,E=_),!(E<y[0]||b>i[1-p])))return S=Math.max(0,Mu(y,b)-1),w=b===E?S:Mu(y,E)-1,b-y[S]>a+1e-10&&++S,p&&(_=S,S=v-w,w=v-_),S>w?void 0:t().slice(S,w+1)},e.invert=function(h){const p=e.invertRange([h,h]);return p&&p[0]},e.copy=function(){return QD().domain(t()).range(i).round(s).paddingInner(o).paddingOuter(l).align(f)},d()}function YU(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return YU(t())},e}function Uae(){return YU(QD().paddingInner(1))}var Pae=Array.prototype.map;function Iae(e){return Pae.call(e,fi)}const qae=Array.prototype.slice;function VU(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(Mu(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=Iae(i),n):e.slice()},n.range=function(i){return arguments.length?(t=qae.call(i),n):t.slice()},n.tickFormat=function(i,r){return kU(e[0],st(e),i??10,r)},n.copy=function(){return VU().domain(n.domain()).range(n.range())},n}const sv=new Map,XU=Symbol("vega_scale");function WU(e){return e[XU]=!0,e}function IR(e){return e&&e[XU]===!0}function Hae(e,t,n){const i=function(){const a=t();return a.invertRange||(a.invertRange=a.invert?Lae(a):a.invertExtent?jae(a):void 0),a.type=e,WU(a)};return i.metadata=wa(Fe(n)),i}function yt(e,t,n){return arguments.length>1?(sv.set(e,Hae(e,t,n)),this):QU(e)?sv.get(e):void 0}yt(Bae,FU);yt(xd,NU,Cn);yt(bo,RU,[Cn,bo]);yt(Ep,PD,Cn);yt(Sp,xae,Cn);yt(ux,zU,Cn);yt(ac,Aae,[Cn,WD]);yt(sc,wae,[Cn,WD]);yt(ss,qD,[Cn,ia]);yt(`${ss}-${xd}`,qD,[Cn,ia]);yt(`${ss}-${bo}`,UU,[Cn,ia,bo]);yt(`${ss}-${Ep}`,HD,[Cn,ia]);yt(`${ss}-${Sp}`,_ae,[Cn,ia]);yt(`${ss}-${ux}`,PU,[Cn,ia]);yt(`${ih}-${xd}`,IU,[Cn,ia]);yt(`${ih}-${bo}`,qU,[Cn,ia,bo]);yt(`${ih}-${Ep}`,GD,[Cn,ia]);yt(`${ih}-${Sp}`,Cae,[Cn,ia]);yt(`${ih}-${ux}`,HU,[Cn,ia]);yt(Ed,BU,[wp,Ed]);yt(lx,LU,wp);yt(cx,jU,wp);yt(XD,VU,[Ap,wp]);yt(VD,ND,Ap);yt(GU,QD,Ap);yt(cC,Uae,Ap);function QU(e){return sv.has(e)}function Nc(e,t){const n=sv.get(e);return n&&n.metadata[t]}function ZD(e){return Nc(e,Cn)}function Sd(e){return Nc(e,Ap)}function fC(e){return Nc(e,wp)}function ZU(e){return Nc(e,bo)}function Gae(e){return Nc(e,WD)}function KU(e){return Nc(e,ia)}function JU(e){return Nc(e,Ed)}const Yae=["clamp","base","constant","exponent"];function eP(e,t){const n=t[0],i=st(t)-n;return function(r){return e(n+r*i)}}function fx(e,t,n){return BD(KD(t||"rgb",n),e)}function tP(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function nP(e,t,n){const i=n-t;let r,a,s;return!i||!Number.isFinite(i)?bi(.5):(r=(a=e.type).indexOf("-"),a=r<0?a:a.slice(r+1),s=yt(a)().domain([t,n]).range([0,1]),Yae.forEach(o=>e[o]?s[o](e[o]()):0),s)}function KD(e,t){const n=uae[Vae(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Vae(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Xae={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Wae={accent:Dae,category10:$ae,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Tae,observable10:Mae,paired:kae,pastel1:Nae,pastel2:Fae,set1:Oae,set2:Rae,set3:zae,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function iP(e){if(De(e))return e;const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function rP(e,t){for(const n in e)JD(n,t(e[n]))}const qR={};rP(Wae,iP);rP(Xae,e=>fx(iP(e)));function JD(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(qR[e]=t,this):qR[e]}const py="symbol",Qae="discrete",Zae="gradient",Kae=e=>De(e)?e.map(t=>String(t)):String(e),Jae=(e,t)=>e[1]-t[1],ese=(e,t)=>t[1]-e[1];function eT(e,t,n){let i;return Tu(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(gp(e.domain())/n||1)+1))),Pe(t)&&(i=t.step,t=t.interval),ft(t)&&(t=e.type===ac?Jd(t):e.type==sc?eh(t):ae("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function aP(e,t,n){let i=e.range(),r=i[0],a=st(i),s=Jae;if(r>a&&(i=a,a=r,r=i,s=ese),r=Math.floor(r),a=Math.ceil(a),t=t.map(o=>[o,e(o)]).filter(o=>r<=o[1]&&o[1]<=a).sort(s).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],st(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,f)=>!(f%2));t.length<3&&(t=o)}return t}function tT(e,t){return e.bins?aP(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function sP(e,t,n,i,r,a){const s=t.type;let o=Kae;if(s===ac||r===ac)o=e.timeFormat(i);else if(s===sc||r===sc)o=e.utcFormat(i);else if(ZU(s)){const l=e.formatFloat(i);if(a||t.bins)o=l;else{const f=oP(t,n,!1);o=d=>f(d)?l(d):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,i)}else i&&(o=e.format(i));return o}function oP(e,t,n){const i=tT(e,t),r=e.base(),a=Math.log(r),s=Math.max(1,r*t/i.length),o=l=>{let f=l/Math.pow(r,Math.round(Math.log(l)/a));return f*r<r-.5&&(f*=r),f<=s};return n?i.filter(o):o}const dC={[Ed]:"quantiles",[lx]:"thresholds",[cx]:"domain"},uP={[Ed]:"quantiles",[lx]:"domain"};function lP(e,t){return e.bins?ise(e.bins):e.type===bo?oP(e,t,!0):dC[e.type]?nse(e[dC[e.type]]()):tT(e,t)}function tse(e,t,n){const i=t[uP[t.type]](),r=i.length;let a=r>1?i[1]-i[0]:i[0],s;for(s=1;s<r;++s)a=Math.min(a,i[s]-i[s-1]);return e.formatSpan(0,a,3*10,n)}function nse(e){const t=[-1/0].concat(e);return t.max=1/0,t}function ise(e){const t=e.slice(0,-1);return t.max=st(e),t}const rse=e=>dC[e.type]||e.bins;function cP(e,t,n,i,r,a,s){const o=uP[t.type]&&a!==ac&&a!==sc?tse(e,t,r):sP(e,t,n,r,a,s);return i===py&&rse(t)?ase(o):i===Qae?sse(o):ose(o)}const ase=e=>(t,n,i)=>{const r=HR(i[n+1],HR(i.max,1/0)),a=GR(t,e),s=GR(r,e);return a&&s?a+"  "+s:s?"< "+s:" "+a},HR=(e,t)=>e??t,sse=e=>(t,n)=>n?e(t):null,ose=e=>t=>e(t),GR=(e,t)=>Number.isFinite(e)?t(e):null;function use(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+st(t),a=r-i;if(e.type===cx){const s=n?a/n:.1;i-=s,r+=s,a=r-i}return s=>(s-i)/a}function lse(e,t,n,i){const r=i||t.type;return ft(n)&&Gae(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===ac?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===sc?e.utcFormat("%A, %d %B %Y, %X UTC"):cP(e,t,5,null,n,i,!0)}function fP(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=lse(e,t,n.format,n.formatType);if(fC(t.type)){const a=lP(t).slice(1).map(r),s=a.length;return`${s} boundar${s===1?"y":"ies"}: ${a.join(", ")}`}else if(Sd(t.type)){const a=t.domain(),s=a.length,o=s>i?a.slice(0,i-2).map(r).join(", ")+", ending with "+a.slice(-1).map(r):a.map(r).join(", ");return`${s} value${s===1?"":"s"}: ${o}`}else{const a=t.domain();return`values from ${r(a[0])} to ${r(st(a))}`}}let dP=0;function cse(){dP=0}const ov="p_";function nT(e){return e&&e.gradient}function hP(e,t,n){const i=e.gradient;let r=e.id,a=i==="radial"?ov:"";return r||(r=e.id="gradient_"+dP++,i==="radial"?(e.x1=Xa(e.x1,.5),e.y1=Xa(e.y1,.5),e.r1=Xa(e.r1,0),e.x2=Xa(e.x2,.5),e.y2=Xa(e.y2,.5),e.r2=Xa(e.r2,.5),a=ov):(e.x1=Xa(e.x1,0),e.y1=Xa(e.y1,0),e.x2=Xa(e.x2,1),e.y2=Xa(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+a+r+")"}function Xa(e,t){return e??t}function gP(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,a){return n.push({offset:r,color:a}),i}}}const YR={basis:{curve:sre},"basis-closed":{curve:ore},"basis-open":{curve:ure},bundle:{curve:lre,tension:"beta",value:.85},cardinal:{curve:cre,tension:"tension",value:0},"cardinal-open":{curve:dre,tension:"tension",value:0},"cardinal-closed":{curve:fre,tension:"tension",value:0},"catmull-rom":{curve:hre,tension:"alpha",value:.5},"catmull-rom-closed":{curve:gre,tension:"alpha",value:.5},"catmull-rom-open":{curve:pre,tension:"alpha",value:.5},linear:{curve:$D},"linear-closed":{curve:mre},monotone:{horizontal:vre,vertical:yre},natural:{curve:bre},step:{curve:xre},"step-after":{curve:Sre},"step-before":{curve:Ere}};function iT(e,t,n){var i=ze(YR,e)&&YR[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const fse={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},dse=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,hse=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,gse=/^((\s+,?\s*)|(,\s*))/,pse=/^[01]/;function Ad(e){const t=[];return(e.match(dse)||[]).forEach(i=>{let r=i[0];const a=r.toLowerCase(),s=fse[a],o=mse(a,s,i.slice(1).trim()),l=o.length;if(l<s||l&&l%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...o.slice(0,s)]),l!==s){a==="m"&&(r=r==="M"?"L":"l");for(let f=s;f<l;f+=s)t.push([r,...o.slice(f,f+s)])}}),t}function mse(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let a=0;a<t;++a){const s=e==="a"&&(a===3||a===4)?pse:hse,o=n.slice(r).match(s);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");r+=o[0].length,i.push(+o[0]);const l=n.slice(r).match(gse);l!==null&&(r+=l[0].length)}return i}const Ru=Math.PI/180,yse=1e-14,Bl=Math.PI/2,Ja=Math.PI*2,Rf=Math.sqrt(3)/2;var Ew={},Sw={},pP=[].join;function vse(e,t,n,i,r,a,s,o,l){const f=pP.call(arguments);if(Ew[f])return Ew[f];const d=s*Ru,h=Math.sin(d),p=Math.cos(d);n=Math.abs(n),i=Math.abs(i);const y=p*(o-e)*.5+h*(l-t)*.5,v=p*(l-t)*.5-h*(o-e)*.5;let b=y*y/(n*n)+v*v/(i*i);b>1&&(b=Math.sqrt(b),n*=b,i*=b);const E=p/n,S=h/n,w=-h/i,_=p/i,C=E*o+S*l,$=w*o+_*l,M=E*e+S*t,T=w*e+_*t;let R=1/((M-C)*(M-C)+(T-$)*(T-$))-.25;R<0&&(R=0);let B=Math.sqrt(R);a==r&&(B=-B);const L=.5*(C+M)-B*(T-$),Y=.5*($+T)+B*(M-C),H=Math.atan2($-Y,C-L);let z=Math.atan2(T-Y,M-L)-H;z<0&&a===1?z+=Ja:z>0&&a===0&&(z-=Ja);const O=Math.ceil(Math.abs(z/(Bl+.001))),I=[];for(let W=0;W<O;++W){const K=H+W*z/O,k=H+(W+1)*z/O;I[W]=[L,Y,K,k,n,i,h,p]}return Ew[f]=I}function bse(e){const t=pP.call(e);if(Sw[t])return Sw[t];var n=e[0],i=e[1],r=e[2],a=e[3],s=e[4],o=e[5],l=e[6],f=e[7];const d=f*s,h=-l*o,p=l*s,y=f*o,v=Math.cos(r),b=Math.sin(r),E=Math.cos(a),S=Math.sin(a),w=.5*(a-r),_=Math.sin(w*.5),C=8/3*_*_/Math.sin(w),$=n+v-C*b,M=i+b+C*v,T=n+E,F=i+S,R=T+C*S,B=F-C*E;return Sw[t]=[d*$+h*M,p*$+y*M,d*R+h*B,p*R+y*B,d*T+h*F,p*T+y*F]}const Ur=["l",0,0,0,0,0,0,0];function xse(e,t,n){const i=Ur[0]=e[0];if(i==="a"||i==="A")Ur[1]=t*e[1],Ur[2]=n*e[2],Ur[3]=e[3],Ur[4]=e[4],Ur[5]=e[5],Ur[6]=t*e[6],Ur[7]=n*e[7];else if(i==="h"||i==="H")Ur[1]=t*e[1];else if(i==="v"||i==="V")Ur[1]=n*e[1];else for(var r=1,a=e.length;r<a;++r)Ur[r]=(r%2==1?t:n)*e[r];return Ur}function Lg(e,t,n,i,r,a){var s,o=null,l=0,f=0,d=0,h=0,p,y,v,b,E=0,S=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),a==null&&(a=r),e.beginPath&&e.beginPath();for(var w=0,_=t.length;w<_;++w){switch(s=t[w],(r!==1||a!==1)&&(s=xse(s,r,a)),s[0]){case"l":l+=s[1],f+=s[2],e.lineTo(l+n,f+i);break;case"L":l=s[1],f=s[2],e.lineTo(l+n,f+i);break;case"h":l+=s[1],e.lineTo(l+n,f+i);break;case"H":l=s[1],e.lineTo(l+n,f+i);break;case"v":f+=s[1],e.lineTo(l+n,f+i);break;case"V":f=s[1],e.lineTo(l+n,f+i);break;case"m":l+=s[1],f+=s[2],E=l,S=f,e.moveTo(l+n,f+i);break;case"M":l=s[1],f=s[2],E=l,S=f,e.moveTo(l+n,f+i);break;case"c":p=l+s[5],y=f+s[6],d=l+s[3],h=f+s[4],e.bezierCurveTo(l+s[1]+n,f+s[2]+i,d+n,h+i,p+n,y+i),l=p,f=y;break;case"C":l=s[5],f=s[6],d=s[3],h=s[4],e.bezierCurveTo(s[1]+n,s[2]+i,d+n,h+i,l+n,f+i);break;case"s":p=l+s[3],y=f+s[4],d=2*l-d,h=2*f-h,e.bezierCurveTo(d+n,h+i,l+s[1]+n,f+s[2]+i,p+n,y+i),d=l+s[1],h=f+s[2],l=p,f=y;break;case"S":p=s[3],y=s[4],d=2*l-d,h=2*f-h,e.bezierCurveTo(d+n,h+i,s[1]+n,s[2]+i,p+n,y+i),l=p,f=y,d=s[1],h=s[2];break;case"q":p=l+s[3],y=f+s[4],d=l+s[1],h=f+s[2],e.quadraticCurveTo(d+n,h+i,p+n,y+i),l=p,f=y;break;case"Q":p=s[3],y=s[4],e.quadraticCurveTo(s[1]+n,s[2]+i,p+n,y+i),l=p,f=y,d=s[1],h=s[2];break;case"t":p=l+s[1],y=f+s[2],o[0].match(/[QqTt]/)===null?(d=l,h=f):o[0]==="t"?(d=2*l-v,h=2*f-b):o[0]==="q"&&(d=2*l-d,h=2*f-h),v=d,b=h,e.quadraticCurveTo(d+n,h+i,p+n,y+i),l=p,f=y,d=l+s[1],h=f+s[2];break;case"T":p=s[1],y=s[2],d=2*l-d,h=2*f-h,e.quadraticCurveTo(d+n,h+i,p+n,y+i),l=p,f=y;break;case"a":VR(e,l+n,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+l+n,s[7]+f+i]),l+=s[6],f+=s[7];break;case"A":VR(e,l+n,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+i]),l=s[6],f=s[7];break;case"z":case"Z":l=E,f=S,e.closePath();break}o=s}}function VR(e,t,n,i){const r=vse(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let a=0;a<r.length;++a){const s=bse(r[a]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const XR=.5773502691896257,WR={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ja)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,a=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-a),e.lineTo(r,-a),e.lineTo(0,-n),e.lineTo(-r,-a),e.lineTo(-i,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Rf*n,r=i-n*XR,a=n/4;e.moveTo(0,-i-r),e.lineTo(-a,i-r),e.lineTo(a,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Rf*n,r=i-n*XR;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Rf*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Rf*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Rf*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Rf*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function mP(e){return ze(WR,e)?WR[e]:Ese(e)}var Aw={};function Ese(e){if(!ze(Aw,e)){const t=Ad(e);Aw[e]={draw:function(n,i){Lg(n,t,0,0,Math.sqrt(i)/2)}}}return Aw[e]}const iu=.448084975506;function Sse(e){return e.x}function Ase(e){return e.y}function wse(e){return e.width}function _se(e){return e.height}function Vs(e){return typeof e=="function"?e:()=>+e}function O1(e,t,n){return Math.max(t,Math.min(e,n))}function yP(){var e=Sse,t=Ase,n=wse,i=_se,r=Vs(0),a=r,s=r,o=r,l=null;function f(d,h,p){var y,v=h??+e.call(this,d),b=p??+t.call(this,d),E=+n.call(this,d),S=+i.call(this,d),w=Math.min(E,S)/2,_=O1(+r.call(this,d),0,w),C=O1(+a.call(this,d),0,w),$=O1(+s.call(this,d),0,w),M=O1(+o.call(this,d),0,w);if(l||(l=y=Kb()),_<=0&&C<=0&&$<=0&&M<=0)l.rect(v,b,E,S);else{var T=v+E,F=b+S;l.moveTo(v+_,b),l.lineTo(T-C,b),l.bezierCurveTo(T-iu*C,b,T,b+iu*C,T,b+C),l.lineTo(T,F-M),l.bezierCurveTo(T,F-iu*M,T-iu*M,F,T-M,F),l.lineTo(v+$,F),l.bezierCurveTo(v+iu*$,F,v,F-iu*$,v,F-$),l.lineTo(v,b+_),l.bezierCurveTo(v,b+iu*_,v+iu*_,b,v+_,b),l.closePath()}if(y)return l=null,y+""||null}return f.x=function(d){return arguments.length?(e=Vs(d),f):e},f.y=function(d){return arguments.length?(t=Vs(d),f):t},f.width=function(d){return arguments.length?(n=Vs(d),f):n},f.height=function(d){return arguments.length?(i=Vs(d),f):i},f.cornerRadius=function(d,h,p,y){return arguments.length?(r=Vs(d),a=h!=null?Vs(h):r,o=p!=null?Vs(p):r,s=y!=null?Vs(y):a,f):r},f.context=function(d){return arguments.length?(l=d??null,f):l},f}function vP(){var e,t,n,i,r=null,a,s,o,l;function f(h,p,y){const v=y/2;if(a){var b=o-p,E=h-s;if(b||E){var S=Math.hypot(b,E),w=(b/=S)*l,_=(E/=S)*l,C=Math.atan2(E,b);r.moveTo(s-w,o-_),r.lineTo(h-b*v,p-E*v),r.arc(h,p,v,C-Math.PI,C),r.lineTo(s+w,o+_),r.arc(s,o,l,C,C+Math.PI)}else r.arc(h,p,v,0,Ja);r.closePath()}else a=1;s=h,o=p,l=v}function d(h){var p,y=h.length,v,b=!1,E;for(r==null&&(r=E=Kb()),p=0;p<=y;++p)!(p<y&&i(v=h[p],p,h))===b&&(b=!b)&&(a=0),b&&f(+e(v,p,h),+t(v,p,h),+n(v,p,h));if(E)return r=null,E+""||null}return d.x=function(h){return arguments.length?(e=h,d):e},d.y=function(h){return arguments.length?(t=h,d):t},d.size=function(h){return arguments.length?(n=h,d):n},d.defined=function(h){return arguments.length?(i=h,d):i},d.context=function(h){return arguments.length?(h==null?r=null:r=h,d):r},d}function _p(e,t){return e??t}const Cp=e=>e.x||0,$p=e=>e.y||0,Cse=e=>e.width||0,$se=e=>e.height||0,Dse=e=>(e.x||0)+(e.width||0),Tse=e=>(e.y||0)+(e.height||0),Mse=e=>e.startAngle||0,kse=e=>e.endAngle||0,Nse=e=>e.padAngle||0,Fse=e=>e.innerRadius||0,Ose=e=>e.outerRadius||0,Rse=e=>e.cornerRadius||0,zse=e=>_p(e.cornerRadiusTopLeft,e.cornerRadius)||0,Bse=e=>_p(e.cornerRadiusTopRight,e.cornerRadius)||0,Lse=e=>_p(e.cornerRadiusBottomRight,e.cornerRadius)||0,jse=e=>_p(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Use=e=>_p(e.size,64),Pse=e=>e.size||1,dx=e=>e.defined!==!1,Ise=e=>mP(e.shape||"circle"),qse=ire().startAngle(Mse).endAngle(kse).padAngle(Nse).innerRadius(Fse).outerRadius(Ose).cornerRadius(Rse),Hse=Vj().x(Cp).y1($p).y0(Tse).defined(dx),Gse=Vj().y($p).x1(Cp).x0(Dse).defined(dx),Yse=Yj().x(Cp).y($p).defined(dx),Vse=yP().x(Cp).y($p).width(Cse).height($se).cornerRadius(zse,Bse,Lse,jse),Xse=are().type(Ise).size(Use),Wse=vP().x(Cp).y($p).defined(dx).size(Pse);function rT(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Qse(e,t){return qse.context(e)(t)}function Zse(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?Gse:Hse).curve(iT(i,n.orient,n.tension)).context(e)(t)}function Kse(e,t){const n=t[0],i=n.interpolate||"linear";return Yse.curve(iT(i,n.orient,n.tension)).context(e)(t)}function rh(e,t,n,i){return Vse.context(e)(t,n,i)}function Jse(e,t){return(t.mark.shape||t.shape).context(e)(t)}function eoe(e,t){return Xse.context(e)(t)}function toe(e,t){return Wse.context(e)(t)}var bP=1;function xP(){bP=1}function aT(e,t,n){var i=t.clip,r=e._defs,a=t.clip_id||(t.clip_id="clip"+bP++),s=r.clipping[a]||(r.clipping[a]={id:a});return We(i)?s.path=i(null):rT(n)?s.path=rh(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+a+")"}function yn(e){this.clear(),e&&this.union(e)}yn.prototype={clone(){return new yn(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:a,y2:s}=this,o=Math.cos(e),l=Math.sin(e),f=t-t*o+n*l,d=n-t*l-n*o;return[o*i-l*r+f,l*i+o*r+d,o*i-l*s+f,l*i+o*s+d,o*a-l*r+f,l*a+o*r+d,o*a-l*s+f,l*a+o*s+d]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function hx(e){this.mark=e,this.bounds=this.bounds||new yn}function gx(e){hx.call(this,e),this.items=this.items||[]}me(gx,hx);class EP{constructor(t){this._pending=0,this._loader=t||Ub()}pending(){return this._pending}sanitizeURL(t){const n=this;return QR(n),n._loader.sanitize(t,{context:"href"}).then(i=>($0(n),i)).catch(()=>($0(n),null))}loadImage(t){const n=this,i=Are();return QR(n),n._loader.sanitize(t,{context:"image"}).then(r=>{const a=r.href;if(!a||!i)throw{url:a};const s=new i,o=ze(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(s.crossOrigin=o),s.onload=()=>$0(n),s.onerror=()=>$0(n),s.src=a,s}).catch(r=>($0(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))}ready(){const t=this;return new Promise(n=>{function i(r){t.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}}function QR(e){e._pending+=1}function $0(e){e._pending-=1}function wo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?noe(t,i):0))}return e}function noe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const ioe=Ja-1e-8;let px,my,yy,ql,hC,vy,gC,pC;const gu=(e,t)=>px.add(e,t),by=(e,t)=>gu(my=e,yy=t),ZR=e=>gu(e,px.y1),KR=e=>gu(px.x1,e),Ll=(e,t)=>hC*e+gC*t,jl=(e,t)=>vy*e+pC*t,ww=(e,t)=>gu(Ll(e,t),jl(e,t)),_w=(e,t)=>by(Ll(e,t),jl(e,t));function Dp(e,t){return px=e,t?(ql=t*Ru,hC=pC=Math.cos(ql),vy=Math.sin(ql),gC=-vy):(hC=pC=1,ql=vy=gC=0),roe}const roe={beginPath(){},closePath(){},moveTo:_w,lineTo:_w,rect(e,t,n,i){ql?(ww(e+n,t),ww(e+n,t+i),ww(e,t+i),_w(e,t)):(gu(e+n,t+i),by(e,t))},quadraticCurveTo(e,t,n,i){const r=Ll(e,t),a=jl(e,t),s=Ll(n,i),o=jl(n,i);JR(my,r,s,ZR),JR(yy,a,o,KR),by(s,o)},bezierCurveTo(e,t,n,i,r,a){const s=Ll(e,t),o=jl(e,t),l=Ll(n,i),f=jl(n,i),d=Ll(r,a),h=jl(r,a);e8(my,s,l,d,ZR),e8(yy,o,f,h,KR),by(d,h)},arc(e,t,n,i,r,a){if(i+=ql,r+=ql,my=n*Math.cos(r)+e,yy=n*Math.sin(r)+t,Math.abs(r-i)>ioe)gu(e-n,t-n),gu(e+n,t+n);else{const s=f=>gu(n*Math.cos(f)+e,n*Math.sin(f)+t);let o,l;if(s(i),s(r),r!==i)if(i=i%Ja,i<0&&(i+=Ja),r=r%Ja,r<0&&(r+=Ja),r<i&&(a=!a,o=i,i=r,r=o),a)for(r-=Ja,o=i-i%Bl,l=0;l<4&&o>r;++l,o-=Bl)s(o);else for(o=i-i%Bl+Bl,l=0;l<4&&o<r;++l,o=o+Bl)s(o)}}};function JR(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function e8(e,t,n,i,r){const a=i-e+3*t-3*n,s=e+n-2*t,o=e-t;let l=0,f=0,d;Math.abs(a)>yse?(d=s*s+o*a,d>=0&&(d=Math.sqrt(d),l=(-s+d)/a,f=(-s-d)/a)):l=.5*o/s,0<l&&l<1&&r(t8(l,e,t,n,i)),0<f&&f<1&&r(t8(f,e,t,n,i))}function t8(e,t,n,i,r){const a=1-e,s=a*a,o=e*e;return s*a*t+3*s*e*n+3*a*o*i+o*e*r}var $u=($u=Cu(1,1))?$u.getContext("2d"):null;const mC=new yn;function sT(e){return function(t,n){if(!$u)return!0;e($u,t),mC.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:a,y2:s}=mC;for(let o=r;o<=s;++o)for(let l=i;l<=a;++l)if($u.isPointInPath(l,o))return!0;return!1}}function oT(e,t){return t.contains(e.x||0,e.y||0)}function SP(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,a=e.height||0;return t.intersects(mC.set(n,i,n+r,i+a))}function AP(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:i;return Qf(t,n,i,r,a)}function Qf(e,t,n,i,r){const{x1:a,y1:s,x2:o,y2:l}=e,f=i-t,d=r-n;let h=0,p=1,y,v,b,E;for(E=0;E<4;++E){if(E===0&&(y=-f,v=-(a-t)),E===1&&(y=f,v=o-t),E===2&&(y=-d,v=-(s-n)),E===3&&(y=d,v=l-n),Math.abs(y)<1e-10&&v<0)return!1;if(b=v/y,y<0){if(b>p)return!1;b>h&&(h=b)}else if(y>0){if(b<h)return!1;b<p&&(p=b)}}return!0}function wd(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ca(e,t){return e??t}function n8(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function aoe(e,t,n){const i=n.width(),r=n.height();let a;if(t.gradient==="radial")a=e.createRadialGradient(n.x1+ca(t.x1,.5)*i,n.y1+ca(t.y1,.5)*r,Math.max(i,r)*ca(t.r1,0),n.x1+ca(t.x2,.5)*i,n.y1+ca(t.y2,.5)*r,Math.max(i,r)*ca(t.r2,.5));else{const s=ca(t.x1,0),o=ca(t.y1,0),l=ca(t.x2,1),f=ca(t.y2,0);if(s===l||o===f||i===r)a=e.createLinearGradient(n.x1+s*i,n.y1+o*r,n.x1+l*i,n.y1+f*r);else{const d=Cu(Math.ceil(i),Math.ceil(r)),h=d.getContext("2d");return h.scale(i,r),h.fillStyle=n8(h.createLinearGradient(s,o,l,f),t.stops),h.fillRect(0,0,i,r),e.createPattern(d,"no-repeat")}}return n8(a,t.stops)}function wP(e,t,n){return nT(n)?aoe(e,n,t.bounds):n}function uv(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=wP(e,t,t.fill),!0):!1}var soe=[];function _d(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=wP(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||soe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function ooe(e,t){return e.zindex-t.zindex||e.index-t.index}function uT(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,a;for(r=0,a=t.length;r<a;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(ooe)}function Ca(e,t){var n=e.items,i,r;if(!n||!n.length)return;const a=uT(e);if(a&&a.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=a}for(i=0,r=n.length;i<r;++i)t(n[i])}function lv(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const a=uT(e);for(a&&a.length&&(n=a),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===a){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function lT(e){return function(t,n,i){Ca(n,r=>{(!i||i.intersects(r.bounds))&&_P(e,t,r,r)})}}function uoe(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&_P(e,t,n.items[0],n.items)}}function _P(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(wd(t,n),n.fill&&uv(t,n,r)&&t.fill(),n.stroke&&_d(t,n,r)&&t.stroke()))}function mx(e){return e=e||Zr,function(t,n,i,r,a,s){return i*=t.pixelRatio,r*=t.pixelRatio,lv(n,o=>{const l=o.bounds;if(!(l&&!l.contains(a,s)||!l)&&e(t,o,i,r,a,s))return o})}}function Tp(e,t){return function(n,i,r,a){var s=Array.isArray(i)?i[0]:i,o=t??s.fill,l=s.stroke&&n.isPointInStroke,f,d;return l&&(f=s.strokeWidth,d=s.strokeCap,n.lineWidth=f??1,n.lineCap=d??"butt"),e(n,i)?!1:o&&n.isPointInPath(r,a)||l&&n.isPointInStroke(r,a)}}function cT(e){return mx(Tp(e))}function Zl(e,t){return"translate("+e+","+t+")"}function fT(e){return"rotate("+e+")"}function loe(e,t){return"scale("+e+","+t+")"}function CP(e){return Zl(e.x||0,e.y||0)}function coe(e){return Zl(e.x||0,e.y||0)+(e.angle?" "+fT(e.angle):"")}function foe(e){return Zl(e.x||0,e.y||0)+(e.angle?" "+fT(e.angle):"")+(e.scaleX||e.scaleY?" "+loe(e.scaleX||1,e.scaleY||1):"")}function dT(e,t,n){function i(s,o){s("transform",coe(o)),s("d",t(null,o))}function r(s,o){return t(Dp(s,o.angle),o),wo(s,o).translate(o.x||0,o.y||0)}function a(s,o){var l=o.x||0,f=o.y||0,d=o.angle||0;s.translate(l,f),d&&s.rotate(d*=Ru),s.beginPath(),t(s,o),d&&s.rotate(-d),s.translate(-l,-f)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:lT(a),pick:cT(a),isect:n||sT(a)}}var doe=dT("arc",Qse);function hoe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,a=1/0,s,o;--r>=0;)e[r].defined!==!1&&(o=Math.abs(e[r][i]-n),o<a&&(a=o,s=e[r]));return s}function goe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,a,s;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],a=e[i].y-t[1],s=r*r+a*a,s<n))return e[i];return null}function poe(e,t){for(var n=e.length,i,r,a;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],a=i*i+r*r,i=e[n].size||1,a<i*i))return e[n];return null}function hT(e,t,n){function i(l,f){var d=f.mark.items;d.length&&l("d",t(null,d))}function r(l,f){var d=f.items;return d.length===0?l:(t(Dp(l),d),wo(l,d[0]))}function a(l,f){l.beginPath(),t(l,f)}const s=Tp(a);function o(l,f,d,h,p,y){var v=f.items,b=f.bounds;return!v||!v.length||b&&!b.contains(p,y)?null:(d*=l.pixelRatio,h*=l.pixelRatio,s(l,v,d,h)?v[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:uoe(a),pick:o,isect:oT,tip:n}}var moe=hT("area",Zse,hoe);function yoe(e,t){var n=t.clip;e.save(),We(n)?(e.beginPath(),n(e),e.clip()):$P(e,t.group)}function $P(e,t){e.beginPath(),rT(t)?rh(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function DP(e){const t=ca(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function voe(e,t){e("transform",CP(t))}function TP(e,t){const n=DP(t);e("d",rh(null,t,n,n))}function boe(e,t){e("class","background"),e("aria-hidden",!0),TP(e,t)}function xoe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?TP(e,t):e("d","")}function Eoe(e,t,n){const i=t.clip?aT(n,t,t):null;e("clip-path",i)}function Soe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),wo(e,t),e.translate(t.x||0,t.y||0)}function jg(e,t,n,i){const r=DP(t);e.beginPath(),rh(e,t,(n||0)+r,(i||0)+r)}const Aoe=Tp(jg),woe=Tp(jg,!1),_oe=Tp(jg,!0);function Coe(e,t,n,i){Ca(t,r=>{const a=r.x||0,s=r.y||0,o=r.strokeForeground,l=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&l&&(jg(e,r,a,s),wd(e,r),r.fill&&uv(e,r,l)&&e.fill(),r.stroke&&!o&&_d(e,r,l)&&e.stroke()),e.save(),e.translate(a,s),r.clip&&$P(e,r),n&&n.translate(-a,-s),Ca(r,f=>{(f.marktype==="group"||i==null||i.includes(f.marktype))&&this.draw(e,f,n,i)}),n&&n.translate(a,s),e.restore(),o&&r.stroke&&l&&(jg(e,r,a,s),wd(e,r),_d(e,r,l)&&e.stroke())})}function $oe(e,t,n,i,r,a){if(t.bounds&&!t.bounds.contains(r,a)||!t.items)return null;const s=n*e.pixelRatio,o=i*e.pixelRatio;return lv(t,l=>{let f,d,h;const p=l.bounds;if(p&&!p.contains(r,a))return;d=l.x||0,h=l.y||0;const y=d+(l.width||0),v=h+(l.height||0),b=l.clip;if(b&&(r<d||r>y||a<h||a>v))return;if(e.save(),e.translate(d,h),d=r-d,h=a-h,b&&rT(l)&&!_oe(e,l,s,o))return e.restore(),null;const E=l.strokeForeground,S=t.interactive!==!1;return S&&E&&l.stroke&&woe(e,l,s,o)?(e.restore(),l):(f=lv(l,w=>Doe(w,d,h)?this.pick(w,n,i,d,h):null),!f&&S&&(l.fill||!E&&l.stroke)&&Aoe(e,l,s,o)&&(f=l),e.restore(),f||null)})}function Doe(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Toe={type:"group",tag:"g",nested:!1,attr:voe,bound:Soe,draw:Coe,pick:$oe,isect:SP,content:Eoe,background:boe,foreground:xoe},Ug={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function gT(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function pT(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function mT(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function yx(e,t){return e==="center"?t/2:e==="right"?t:0}function vx(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Moe(e,t,n){const i=gT(t,n),r=pT(t,i),a=mT(t,i),s=(t.x||0)-yx(t.align,r),o=(t.y||0)-vx(t.baseline,a),l=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",l,Ug["xmlns:xlink"],"xlink:href"),e("transform",Zl(s,o)),e("width",r),e("height",a),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function koe(e,t){const n=t.image,i=pT(t,n),r=mT(t,n),a=(t.x||0)-yx(t.align,i),s=(t.y||0)-vx(t.baseline,r);return e.set(a,s,a+i,s+r)}function Noe(e,t,n){Ca(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=gT(i,this);let a=pT(i,r),s=mT(i,r);if(a===0||s===0)return;let o=(i.x||0)-yx(i.align,a),l=(i.y||0)-vx(i.baseline,s),f,d,h,p;i.aspect!==!1&&(d=r.width/r.height,h=i.width/i.height,d===d&&h===h&&d!==h&&(h<d?(p=a/d,l+=(s-p)/2,s=p):(p=s*d,o+=(a-p)/2,a=p))),(r.complete||r.toDataURL)&&(wd(e,i),e.globalAlpha=(f=i.opacity)!=null?f:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,o,l,a,s))})}var Foe={type:"image",tag:"image",nested:!1,attr:Moe,bound:koe,draw:Noe,pick:mx(),isect:Zr,get:gT,xOffset:yx,yOffset:vx},Ooe=hT("line",Kse,goe);function Roe(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",foe(t)),e("d",t.path)}function xy(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,a=t.scaleX||1,s=t.scaleY||1,o=(t.angle||0)*Ru,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=Ad(n)).path=n),o&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(o),Lg(e,l,0,0,a,s),e.rotate(-o),e.translate(-i,-r)):Lg(e,l,i,r,a,s)}function zoe(e,t){return xy(Dp(e,t.angle),t)?e.set(0,0,0,0):wo(e,t,!0)}var Boe={type:"path",tag:"path",nested:!1,attr:Roe,bound:zoe,draw:lT(xy),pick:cT(xy),isect:sT(xy)};function Loe(e,t){e("d",rh(null,t))}function joe(e,t){var n,i;return wo(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function i8(e,t){e.beginPath(),rh(e,t)}var Uoe={type:"rect",tag:"path",nested:!1,attr:Loe,bound:joe,draw:lT(i8),pick:cT(i8),isect:SP};function Poe(e,t){e("transform",CP(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Ioe(e,t){var n,i;return wo(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function MP(e,t,n){var i,r,a,s;return t.stroke&&_d(e,t,n)?(i=t.x||0,r=t.y||0,a=t.x2!=null?t.x2:i,s=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(a,s),!0):!1}function qoe(e,t,n){Ca(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&MP(e,i,r)&&(wd(e,i),e.stroke())}})}function Hoe(e,t,n,i){return e.isPointInStroke?MP(e,t,1)&&e.isPointInStroke(n,i):!1}var Goe={type:"rule",tag:"line",nested:!1,attr:Poe,bound:Ioe,draw:qoe,pick:mx(Hoe),isect:AP},Yoe=dT("shape",Jse),Voe=dT("symbol",eoe,oT);const r8=BB();var Ar={height:Es,measureWidth:yT,estimateWidth:cv,width:cv,canvas:kP};kP(!0);function kP(e){Ar.width=e&&$u?yT:cv}function cv(e,t){return NP(Bu(e,t),Es(e))}function NP(e,t){return~~(.8*e.length*t)}function yT(e,t){return Es(e)<=0||!(t=Bu(e,t))?0:FP(t,bx(e))}function FP(e,t){const n=`(${t}) ${e}`;let i=r8.get(n);return i===void 0&&($u.font=t,i=$u.measureText(e).width,r8.set(n,i)),i}function Es(e){return e.fontSize!=null?+e.fontSize||0:11}function zu(e){return e.lineHeight!=null?e.lineHeight:Es(e)+2}function Xoe(e){return De(e)?e.length>1?e:e[0]:e}function Mp(e){return Xoe(e.lineBreak&&e.text&&!De(e.text)?e.text.split(e.lineBreak):e.text)}function vT(e){const t=Mp(e);return(De(t)?t.length-1:0)*zu(e)}function Bu(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Qoe(e,n):n}function Woe(e){if(Ar.width===yT){const t=bx(e);return n=>FP(n,t)}else if(Ar.width===cv){const t=Es(e);return n=>NP(n,t)}else return t=>Ar.width(e,t)}function Qoe(e,t){var n=+e.limit,i=Woe(e);if(i(t)<n)return t;var r=e.ellipsis||"",a=e.dir==="rtl",s=0,o=t.length,l;if(n-=i(r),a){for(;s<o;)l=s+o>>>1,i(t.slice(l))>n?s=l+1:o=l;return r+t.slice(s)}else{for(;s<o;)l=1+(s+o>>>1),i(t.slice(0,l))<n?s=l:o=l-1;return t.slice(0,s)+r}}function kp(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function bx(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Es(e)+"px "+kp(e,t)}function bT(e){var t=e.baseline,n=Es(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*zu(e):t==="line-bottom"?.29*n-.5*zu(e):0)}const Zoe={left:"start",center:"middle",right:"end"},hg=new yn;function xx(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Bl,t+=i*Math.cos(r),n+=i*Math.sin(r)),hg.x1=t,hg.y1=n,hg}function Koe(e,t){var n=t.dx||0,i=(t.dy||0)+bT(t),r=xx(t),a=r.x1,s=r.y1,o=t.angle||0,l;e("text-anchor",Zoe[t.align]||"start"),o?(l=Zl(a,s)+" "+fT(o),(n||i)&&(l+=" "+Zl(n,i))):l=Zl(a+n,s+i),e("transform",l)}function xT(e,t,n){var i=Ar.height(t),r=t.align,a=xx(t),s=a.x1,o=a.y1,l=t.dx||0,f=(t.dy||0)+bT(t)-Math.round(.8*i),d=Mp(t),h;if(De(d)?(i+=zu(t)*(d.length-1),h=d.reduce((p,y)=>Math.max(p,Ar.width(t,y)),0)):h=Ar.width(t,d),r==="center"?l-=h/2:r==="right"&&(l-=h),e.set(l+=s,f+=o,l+h,f+i),t.angle&&!n)e.rotate(t.angle*Ru,s,o);else if(n===2)return e.rotatedPoints(t.angle*Ru,s,o);return e}function Joe(e,t,n){Ca(t,i=>{var r=i.opacity==null?1:i.opacity,a,s,o,l,f,d,h;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=bx(i),e.textAlign=i.align||"left",a=xx(i),s=a.x1,o=a.y1,i.angle&&(e.save(),e.translate(s,o),e.rotate(i.angle*Ru),s=o=0),s+=i.dx||0,o+=(i.dy||0)+bT(i),d=Mp(i),wd(e,i),De(d))for(f=zu(i),l=0;l<d.length;++l)h=Bu(i,d[l]),i.fill&&uv(e,i,r)&&e.fillText(h,s,o),i.stroke&&_d(e,i,r)&&e.strokeText(h,s,o),o+=f;else h=Bu(i,d),i.fill&&uv(e,i,r)&&e.fillText(h,s,o),i.stroke&&_d(e,i,r)&&e.strokeText(h,s,o);i.angle&&e.restore()}})}function eue(e,t,n,i,r,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=xx(t),o=s.x1,l=s.y1,f=xT(hg,t,1),d=-t.angle*Ru,h=Math.cos(d),p=Math.sin(d),y=h*r-p*a+(o-h*o+p*l),v=p*r+h*a+(l-p*o-h*l);return f.contains(y,v)}function tue(e,t){const n=xT(hg,e,2);return Qf(t,n[0],n[1],n[2],n[3])||Qf(t,n[0],n[1],n[4],n[5])||Qf(t,n[4],n[5],n[6],n[7])||Qf(t,n[2],n[3],n[6],n[7])}var nue={type:"text",tag:"text",nested:!1,attr:Koe,bound:xT,draw:Joe,pick:mx(eue),isect:tue},iue=hT("trail",toe,poe),Tr={arc:doe,area:moe,group:Toe,image:Foe,line:Ooe,path:Boe,rect:Uoe,rule:Goe,shape:Yoe,symbol:Voe,text:nue,trail:iue};function yC(e,t,n){var i=Tr[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new yn),e,n)}var a8={mark:null};function OP(e,t,n){var i=Tr[e.marktype],r=i.bound,a=e.items,s=a&&a.length,o,l,f,d;if(i.nested)return s?f=a[0]:(a8.mark=e,f=a8),d=yC(f,r,n),t=t&&t.union(d)||d,t;if(t=t||e.bounds&&e.bounds.clear()||new yn,s)for(o=0,l=a.length;o<l;++o)t.union(yC(a[o],r,n));return e.bounds=t}const rue=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function RP(e,t){return JSON.stringify(e,rue,t)}function zP(e){const t=typeof e=="string"?JSON.parse(e):e;return BP(t)}function BP(e){var t=e.marktype,n=e.items,i,r,a;if(n)for(r=0,a=n.length;r<a;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&BP(n[r]);return t&&OP(e),e}class LP{constructor(t){arguments.length?this.root=zP(t):(this.root=s8({marktype:"group",name:"root",role:"frame"}),this.root.items=[new gx(this.root)])}toJSON(t){return RP(this.root,t||0)}mark(t,n,i){n=n||this.root.items[0];const r=s8(t,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}}function s8(e,t){const n={bounds:new yn,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function pu(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function ET(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function En(e,t,n,i){var r=e.childNodes[t],a;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(a=r||null,r=pu(e.ownerDocument,n,i),e.insertBefore(r,a)),r}function Ir(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function jP(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ex(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function aue(e,t,n,i){var r=e&&e.mark,a,s;if(r&&(a=Tr[r.marktype]).tip){for(s=Ex(t,n),s[0]-=i[0],s[1]-=i[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=a.tip(r.items,s)}return e}let ST=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||Ub(),this._tooltip=n||sue}initialize(t,n,i){return this._el=t,this._obj=i||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,i){for(let r=t?t.length:0;--r>=0;)if(t[r].type===n&&(!i||t[r].handler===i))return r;return-1}handlers(t){const n=this._handlers,i=[];if(t)i.push(...n[this.eventName(t)]);else for(const r in n)i.push(...n[r]);return i}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const a=new MouseEvent(t.type,t),s=pu(null,"a");for(const o in r)s.setAttribute(o,r[o]);s.dispatchEvent(a)}).catch(()=>{})}handleTooltip(t,n,i){if(n&&n.tooltip!=null){n=aue(n,t,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,r)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,a=t.bounds,s=a.width(),o=a.height();let l=a.x1+r[0]+i.left,f=a.y1+r[1]+i.top;for(;t.mark&&(t=t.mark.group);)l+=t.x||0,f+=t.y||0;return{x:l,y:f,width:s,height:o,left:l,top:f,right:l+s,bottom:f+o}}};function sue(e,t,n,i){e.element().setAttribute("title",i||"")}class Np{constructor(t){this._el=null,this._bgcolor=null,this._loader=new EP(t)}initialize(t,n,i,r,a){return this._el=t,this.resize(n,i,r,a)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,i,r){return this._width=t,this._height=n,this._origin=i||[0,0],this._scale=r||1,this}dirty(){}render(t,n){const i=this;return i._call=function(){i._render(t,n)},i._call(),i._call=null,i}_render(){}renderAsync(t,n){const i=this.render(t,n);return this._ready?this._ready.then(()=>i):Promise.resolve(i)}_load(t,n){var i=this,r=i._loader[t](n);if(!i._ready){const a=i._call;i._ready=i._loader.ready().then(s=>{s&&a(),i._ready=null})}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const oue="keydown",uue="keypress",lue="keyup",UP="dragenter",Ey="dragleave",PP="dragover",vC="pointerdown",cue="pointerup",fv="pointermove",Sy="pointerout",IP="pointerover",bC="mousedown",fue="mouseup",qP="mousemove",dv="mouseout",HP="mouseover",hv="click",due="dblclick",hue="wheel",GP="mousewheel",gv="touchstart",pv="touchmove",mv="touchend",gue=[oue,uue,lue,UP,Ey,PP,vC,cue,fv,Sy,IP,bC,fue,qP,dv,HP,hv,due,hue,GP,gv,pv,mv],xC=fv,gg=dv,EC=hv;class Fp extends ST{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=gue,this.pointermove=u8([fv,qP],[IP,HP],[Sy,dv]),this.dragover=u8([PP],[UP],[Ey]),this.pointerout=l8([Sy,dv]),this.dragleave=l8([Ey])}initialize(t,n,i){return this._canvas=t&&ET(t,"canvas"),[hv,bC,vC,fv,Sy,Ey].forEach(r=>o8(this,r)),super.initialize(t,n,i)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(GP,t)}pointerdown(t){this._down=this._active,this.fire(vC,t)}mousedown(t){this._down=this._active,this.fire(bC,t)}click(t){this._down===this._active&&(this.fire(hv,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(gv,t,!0)}touchmove(t){this.fire(pv,t,!0)}touchend(t){this.fire(mv,t,!0),this._touch=null}fire(t,n,i){const r=i?this._touch:this._active,a=this._handlers[t];if(n.vegaType=t,t===EC&&r&&r.href?this.handleHref(n,r,r.href):(t===xC||t===gg)&&this.handleTooltip(n,r,t!==gg),a)for(let s=0,o=a.length;s<o;++s)a[s].handler.call(this._obj,n,r)}on(t,n){const i=this.eventName(t),r=this._handlers;return this._handlerIndex(r[i],t,n)<0&&(o8(this,t),(r[i]||(r[i]=[])).push({type:t,handler:n})),this}off(t,n){const i=this.eventName(t),r=this._handlers[i],a=this._handlerIndex(r,t,n);return a>=0&&r.splice(a,1),this}pickEvent(t){const n=Ex(t,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])}pick(t,n,i,r,a){const s=this.context();return Tr[t.marktype].pick.call(this,s,t,n,i,r,a)}}const pue=e=>e===gv||e===pv||e===mv?[gv,pv,mv]:[e];function o8(e,t){pue(t).forEach(n=>mue(e,n))}function mue(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function Q0(e,t,n){t.forEach(i=>e.fire(i,n))}function u8(e,t,n){return function(i){const r=this._active,a=this.pickEvent(i);a===r?Q0(this,e,i):((!r||!r.exit)&&Q0(this,n,i),this._active=a,Q0(this,t,i),Q0(this,e,i))}}function l8(e){return function(t){Q0(this,e,t),this._active=null}}function yue(){return typeof window<"u"&&window.devicePixelRatio||1}function vue(e,t,n,i,r,a){const s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=s?yue():r;e.width=t*l,e.height=n*l;for(const f in a)o[f]=a[f];return s&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*i[0],l*i[1]),e}class yv extends Np{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new yn,this._tempb=new yn}initialize(t,n,i,r,a,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Cu(1,1,this._options.type),t&&this._canvas&&(Ir(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,i,r,a)}resize(t,n,i,r){if(super.resize(t,n,i,r),this._canvas)vue(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const a=this._options.externalContext;a||ae("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let i=t.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)}_render(t,n){const i=this.context(),r=this._origin,a=this._width,s=this._height,o=this._dirty,l=bue(r,a,s);i.save();const f=this._redraw||o.empty()?(this._redraw=!1,l.expand(1)):xue(i,l.intersect(o),r);return this.clear(-r[0],-r[1],a,s),this.draw(i,t,f,n),i.restore(),o.clear(),this}draw(t,n,i,r){if(n.marktype!=="group"&&r!=null&&!r.includes(n.marktype))return;const a=Tr[n.marktype];n.clip&&yoe(t,n),a.draw.call(this,t,n,i,r),n.clip&&t.restore()}clear(t,n,i,r){const a=this._options,s=this.context();a.type!=="pdf"&&!a.externalContext&&s.clearRect(t,n,i,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,n,i,r))}}const bue=(e,t,n)=>new yn().set(0,0,t,n).translate(-e[0],-e[1]);function xue(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class YP extends ST{constructor(t,n){super(t,n);const i=this;i._hrefHandler=Cw(i,(r,a)=>{a&&a.href&&i.handleHref(r,a,a.href)}),i._tooltipHandler=Cw(i,(r,a)=>{i.handleTooltip(r,a,r.type!==gg)})}initialize(t,n,i){let r=this._svg;return r&&(r.removeEventListener(EC,this._hrefHandler),r.removeEventListener(xC,this._tooltipHandler),r.removeEventListener(gg,this._tooltipHandler)),this._svg=r=t&&ET(t,"svg"),r&&(r.addEventListener(EC,this._hrefHandler),r.addEventListener(xC,this._tooltipHandler),r.addEventListener(gg,this._tooltipHandler)),super.initialize(t,n,i)}canvas(){return this._svg}on(t,n){const i=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[i],t,n)<0){const s={type:t,handler:n,listener:Cw(this,n)};(r[i]||(r[i]=[])).push(s),this._svg&&this._svg.addEventListener(i,s.listener)}return this}off(t,n){const i=this.eventName(t),r=this._handlers[i],a=this._handlerIndex(r,t,n);return a>=0&&(this._svg&&this._svg.removeEventListener(i,r[a].listener),r.splice(a,1)),this}}const Cw=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)},VP="aria-hidden",AT="aria-label",wT="role",_T="aria-roledescription",XP="graphics-object",CT="graphics-symbol",WP=(e,t,n)=>({[wT]:e,[_T]:t,[AT]:n||void 0}),Eue=wa(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),c8={axis:{desc:"axis",caption:wue},legend:{desc:"legend",caption:_ue},"title-text":{desc:"title",caption:e=>`Title text '${d8(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${d8(e)}'`}},f8={ariaRole:wT,ariaRoleDescription:_T,description:AT};function QP(e,t){const n=t.aria===!1;if(e(VP,n||void 0),n||t.description==null)for(const i in f8)e(f8[i],void 0);else{const i=t.mark.marktype;e(AT,t.description),e(wT,t.ariaRole||(i==="group"?XP:CT)),e(_T,t.ariaRoleDescription||`${i} mark`)}}function ZP(e){return e.aria===!1?{[VP]:!0}:Eue[e.role]?null:c8[e.role]?Aue(e,c8[e.role]):Sue(e)}function Sue(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return WP(n?XP:CT,`${t} mark container`,e.description)}function Aue(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return WP(t.role||CT,t.desc,n.description||i(n))}catch{return null}}function d8(e){return Fe(e.text).join(" ")}function wue(e){const t=e.datum,n=e.orient,i=t.title?KP(e):null,r=e.context,a=r.scales[t.scale].value,s=r.dataflow.locale(),o=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Sd(o)?"discrete":o} scale with ${fP(s,a,e)}`}function _ue(e){const t=e.datum,n=t.title?KP(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,a=Object.keys(r),s=e.context,o=s.scales[r[a[0]]].value,l=s.dataflow.locale();return $ue(i)+(n?` titled '${n}'`:"")+` for ${Cue(a)} with ${fP(l,o,e)}`}function KP(e){try{return Fe(st(e.items).items[0].text).join(" ")}catch{return null}}function Cue(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+st(e)}function $ue(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const JP=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Due=e=>JP(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function $T(){let e="",t="",n="";const i=[],r=()=>t=n="",a=l=>{t&&(e+=`${t}>${n}`,r()),i.push(l)},s=(l,f)=>(f!=null&&(t+=` ${l}="${Due(f)}"`),o),o={open(l){a(l),t="<"+l;for(var f=arguments.length,d=new Array(f>1?f-1:0),h=1;h<f;h++)d[h-1]=arguments[h];for(const p of d)for(const y in p)s(y,p[y]);return o},close(){const l=i.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,r(),o},attr:s,text:l=>(n+=JP(l),o),toString:()=>e};return o}const eI=e=>tI($T(),e)+"";function tI(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):tI(e,i)}return e.close()}const vv={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},bv={blend:"mix-blend-mode"},nI={fill:"none","stroke-miterlimit":10},D0=0,h8="http://www.w3.org/2000/xmlns/",xn=Ug.xmlns;class DT extends Np{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,i,r,a){return this._defs={},this._clearDefs(),t&&(this._svg=En(t,0,"svg",xn),this._svg.setAttributeNS(h8,"xmlns",xn),this._svg.setAttributeNS(h8,"xmlns:xlink",Ug["xmlns:xlink"]),this._svg.setAttribute("version",Ug.version),this._svg.setAttribute("class","marks"),Ir(t,1),this._root=En(this._svg,D0,"g",xn),mu(this._root,nI),Ir(this._svg,D0+1)),this.background(this._bgcolor),super.initialize(t,n,i,r,a)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svg&&(mu(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let i;n&&(t.removeAttribute("style"),i=En(t,D0,"rect",xn),mu(i,{width:this._width,height:this._height,fill:n}));const r=eI(t);return n&&(t.removeChild(i),this._svg.style.setProperty("background-color",n)),r}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),Ir(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,a,s,o,l,f;for(o=0,l=t.length;o<l;++o)if(i=t[o],r=i.mark,r.marktype!==a&&(a=r.marktype,s=Tr[a]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,g8(i,n),r.items.forEach(d=>{d.dirty=n})),!r.zdirty){if(i.exit){s.nested&&r.items.length?(f=r.items[0],f._svg&&this._update(s,f._svg,f)):i._svg&&(f=i._svg.parentNode,f&&f.removeChild(i._svg)),i._svg=null;continue}i=s.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,g8(i,n)):this._update(s,i._svg,i),i._update=n)}return!this._dirtyAll}mark(t,n,i,r){if(!this.isDirty(n))return n._svg;const a=this._svg,s=n.marktype,o=Tr[s],l=n.interactive===!1?"none":null,f=o.tag==="g",d=p8(n,t,i,"g",a);if(s!=="group"&&r!=null&&!r.includes(s))return Ir(d,0),n._svg;d.setAttribute("class",jP(n));const h=ZP(n);for(const b in h)Ai(d,b,h[b]);f||Ai(d,"pointer-events",l),Ai(d,"clip-path",n.clip?aT(this,n,n.group):null);let p=null,y=0;const v=b=>{const E=this.isDirty(b),S=p8(b,d,p,o.tag,a);E&&(this._update(o,S,b),f&&kue(this,S,b,r)),p=S,++y};return o.nested?n.items.length&&v(n.items[0]):Ca(n,v),Ir(d,y),d}_update(t,n,i){oo=n,li=n.__values__,QP(pg,i),t.attr(pg,i,this);const r=Fue[t.type];r&&r.call(this,t,n,i),oo&&this.style(oo,i)}style(t,n){if(n!=null){for(const i in vv){let r=i==="font"?kp(n):n[i];if(r===li[i])continue;const a=vv[i];r==null?t.removeAttribute(a):(nT(r)&&(r=hP(r,this._defs.gradient,iI())),t.setAttribute(a,r+"")),li[i]=r}for(const i in bv)Ay(t,bv[i],n[i])}}defs(){const t=this._svg,n=this._defs;let i=n.el,r=0;for(const a in n.gradient)i||(n.el=i=En(t,D0+1,"defs",xn)),r=Tue(i,n.gradient[a],r);for(const a in n.clipping)i||(n.el=i=En(t,D0+1,"defs",xn)),r=Mue(i,n.clipping[a],r);i&&(r===0?(t.removeChild(i),n.el=null):Ir(i,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function g8(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Tue(e,t,n){let i,r,a;if(t.gradient==="radial"){let s=En(e,n++,"pattern",xn);mu(s,{id:ov+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=En(s,0,"rect",xn),mu(s,{width:1,height:1,fill:`url(${iI()}#${t.id})`}),e=En(e,n++,"radialGradient",xn),mu(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=En(e,n++,"linearGradient",xn),mu(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)a=En(e,i,"stop",xn),a.setAttribute("offset",t.stops[i].offset),a.setAttribute("stop-color",t.stops[i].color);return Ir(e,i),n}function Mue(e,t,n){let i;return e=En(e,n,"clipPath",xn),e.setAttribute("id",t.id),t.path?(i=En(e,0,"path",xn),i.setAttribute("d",t.path)):(i=En(e,0,"rect",xn),mu(i,{x:0,y:0,width:t.width,height:t.height})),Ir(e,1),n+1}function kue(e,t,n,i){t=t.lastChild.previousSibling;let r,a=0;Ca(n,s=>{r=e.mark(t,s,r,i),++a}),Ir(t,1+a)}function p8(e,t,n,i,r){let a=e._svg,s;if(!a&&(s=t.ownerDocument,a=pu(s,i,xn),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},i==="g"))){const o=pu(s,"path",xn);a.appendChild(o),o.__data__=e;const l=pu(s,"g",xn);a.appendChild(l),l.__data__=e;const f=pu(s,"path",xn);a.appendChild(f),f.__data__=e,f.__values__={fill:"default"}}return(a.ownerSVGElement!==r||Nue(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function Nue(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let oo=null,li=null;const Fue={group(e,t,n){const i=oo=t.childNodes[2];li=i.__values__,e.foreground(pg,n,this),li=t.__values__,oo=t.childNodes[1],e.content(pg,n,this);const r=oo=t.childNodes[0];e.background(pg,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==li.events&&(Ai(i,"pointer-events",a),Ai(r,"pointer-events",a),li.events=a),n.strokeForeground&&n.stroke){const s=n.fill;Ai(i,"display",null),this.style(r,n),Ai(r,"stroke",null),s&&(n.fill=null),li=i.__values__,this.style(i,n),s&&(n.fill=s),oo=null}else Ai(i,"display","none")},image(e,t,n){n.smooth===!1?(Ay(t,"image-rendering","optimizeSpeed"),Ay(t,"image-rendering","pixelated")):Ay(t,"image-rendering",null)},text(e,t,n){const i=Mp(n);let r,a,s,o;De(i)?(a=i.map(l=>Bu(n,l)),r=a.join(`
`),r!==li.text&&(Ir(t,0),s=t.ownerDocument,o=zu(n),a.forEach((l,f)=>{const d=pu(s,"tspan",xn);d.__data__=n,d.textContent=l,f&&(d.setAttribute("x",0),d.setAttribute("dy",o)),t.appendChild(d)}),li.text=r)):(a=Bu(n,i),a!==li.text&&(t.textContent=a,li.text=a)),Ai(t,"font-family",kp(n)),Ai(t,"font-size",Es(n)+"px"),Ai(t,"font-style",n.fontStyle),Ai(t,"font-variant",n.fontVariant),Ai(t,"font-weight",n.fontWeight)}};function pg(e,t,n){t!==li[e]&&(n?Oue(oo,e,t,n):Ai(oo,e,t),li[e]=t)}function Ay(e,t,n){n!==li[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),li[t]=n)}function mu(e,t){for(const n in t)Ai(e,n,t[n])}function Ai(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Oue(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function iI(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class rI extends Np{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=$T();n.open("svg",Ve({},Ug,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",nI,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=Tr[n.marktype],r=i.tag,a=[QP,i.attr];t.open("g",{class:jP(n),"clip-path":n.clip?aT(this,n,n.group):null},ZP(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const s=o=>{const l=this.href(o);if(l&&t.open("a",l),t.open(r,this.attr(n,o,a,r!=="g"?r:null)),r==="text"){const f=Mp(o);if(De(f)){const d={x:0,dy:zu(o)};for(let h=0;h<f.length;++h)t.open("tspan",h?d:null).text(Bu(o,f[h])).close()}else t.text(Bu(o,f))}else if(r==="g"){const f=o.strokeForeground,d=o.fill,h=o.stroke;f&&h&&(o.stroke=null),t.open("path",this.attr(n,o,i.background,"bgrect")).close(),t.open("g",this.attr(n,o,i.content)),Ca(o,p=>this.mark(t,p)),t.close(),f&&h?(d&&(o.fill=null),o.stroke=h,t.open("path",this.attr(n,o,i.foreground,"bgrect")).close(),d&&(o.fill=d)):t.open("path",this.attr(n,o,i.foreground,"bgfore")).close()}t.close(),l&&t.close()};return i.nested?n.items&&n.items.length&&s(n.items[0]):Ca(n,s),t.close()}href(t){const n=t.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null}attr(t,n,i,r){const a={},s=(o,l,f,d)=>{a[d||o]=l};return Array.isArray(i)?i.forEach(o=>o(s,n,this)):i(s,n,this),r&&Rue(a,n,t,r,this._defs),a}defs(t){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){t.open("defs");for(const a in n){const s=n[a],o=s.stops;s.gradient==="radial"?(t.open("pattern",{id:ov+a,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+a+")"}).close(),t.close(),t.open("radialGradient",{id:a,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:a,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let l=0;l<o.length;++l)t.open("stop",{offset:o[l].offset,"stop-color":o[l].color}).close();t.close()}for(const a in i){const s=i[a];t.open("clipPath",{id:a}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}}}function Rue(e,t,n,i,r){let a;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(a=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=kp(t),e["font-size"]=Es(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in vv){let o=t[s];const l=vv[s];o==="transparent"&&(l==="fill"||l==="stroke")||o!=null&&(nT(o)&&(o=hP(o,r.gradient,"")),e[l]=o)}for(const s in bv){const o=t[s];o!=null&&(a=a||[],a.push(`${bv[s]}: ${o};`))}return a&&(e.style=a.join(" ")),e}const da={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function zue(e){da.svgMarkTypes=e.svgMarkTypes??["text"],da.svgOnTop=e.svgOnTop??!0,da.debug=e.debug??!1}class SC extends Np{constructor(t){super(t),this._svgRenderer=new DT(t),this._canvasRenderer=new yv(t)}initialize(t,n,i,r,a){this._root_el=En(t,0,"div");const s=En(this._root_el,0,"div"),o=En(this._root_el,1,"div");return this._root_el.style.position="relative",da.debug||(s.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=da.svgOnTop?o:s,this._canvasEl=da.svgOnTop?s:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,i,r,a),this._svgRenderer.initialize(this._svgEl,n,i,r,a),super.initialize(t,n,i,r,a)}dirty(t){return da.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(a=>!da.svgMarkTypes.includes(a));this._svgRenderer.render(t,da.svgMarkTypes),this._canvasRenderer.render(t,r)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svgRenderer.resize(t,n,i,r),this._canvasRenderer.resize(t,n,i,r),this}background(t){return da.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class aI extends Fp{constructor(t,n){super(t,n)}initialize(t,n,i){const r=En(En(t,0,"div"),da.svgOnTop?0:1,"div");return super.initialize(r,n,i)}}const sI="canvas",oI="hybrid",uI="png",lI="svg",cI="none",yu={Canvas:sI,PNG:uI,SVG:lI,Hybrid:oI,None:cI},oc={};oc[sI]=oc[uI]={renderer:yv,headless:yv,handler:Fp};oc[lI]={renderer:DT,headless:rI,handler:YP};oc[oI]={renderer:SC,headless:SC,handler:aI};oc[cI]={};function Sx(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(oc[e]=t,this):oc[e]}function fI(e,t,n){const i=[],r=new yn().union(t),a=e.marktype;return a?dI(e,r,n,i):a==="group"?hI(e,r,n,i):ae("Intersect scene must be mark node or group item.")}function dI(e,t,n,i){if(Bue(e,t,n)){const r=e.items,a=e.marktype,s=r.length;let o=0;if(a==="group")for(;o<s;++o)hI(r[o],t,n,i);else for(const l=Tr[a].isect;o<s;++o){const f=r[o];gI(f,t,l)&&i.push(f)}}return i}function Bue(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function hI(e,t,n,i){n&&n(e.mark)&&gI(e,t,Tr.group.isect)&&i.push(e);const r=e.items,a=r&&r.length;if(a){const s=e.x||0,o=e.y||0;t.translate(-s,-o);for(let l=0;l<a;++l)dI(r[l],t,n,i);t.translate(s,o)}return i}function gI(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const $w=new yn;function pI(e){const t=e.clip;if(We(t))t(Dp($w.clear()));else if(t)$w.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect($w)}const Lue=1e-9;function TT(e,t,n){return e===t?!0:n==="path"?mI(e,t):e instanceof Date&&t instanceof Date?+e==+t:Tu(e)&&Tu(t)?Math.abs(e-t)<=Lue:!e||!t||!Pe(e)&&!Pe(t)?e==t:jue(e,t)}function mI(e,t){return TT(Ad(e),Ad(t))}function jue(e,t){var n=Object.keys(e),i=Object.keys(t),r,a;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),a=n.length-1;a>=0;a--)if(n[a]!=i[a])return!1;for(a=n.length-1;a>=0;a--)if(r=n[a],!TT(e[r],t[r],r))return!1;return typeof e==typeof t}function Uue(){xP(),cse()}const Cd="top",ya="left",va="right",Lu="bottom",Pue="top-left",Iue="top-right",que="bottom-left",Hue="bottom-right",MT="start",AC="middle",wi="end",Gue="x",Yue="y",Ax="group",kT="axis",NT="title",Vue="frame",Xue="scope",FT="legend",yI="row-header",vI="row-footer",bI="row-title",xI="column-header",EI="column-footer",SI="column-title",Wue="padding",Que="symbol",AI="fit",wI="fit-x",_I="fit-y",Zue="pad",OT="none",R1="all",wC="each",RT="flush",vu="column",bu="row";function CI(e){te.call(this,null,e)}me(CI,te,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,a=Tr[r],s=a.bound;let o=i.bounds,l;if(a.nested)i.items.length&&n.dirty(i.items[0]),o=z1(i,s),i.items.forEach(f=>{f.bounds.clear().union(o)});else if(r===Ax||e.modified())switch(t.visit(t.MOD,f=>n.dirty(f)),o.clear(),i.items.forEach(f=>o.union(z1(f,s))),i.role){case kT:case FT:case NT:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,f=>{o.union(z1(f,s))}),t.visit(t.MOD,f=>{l=l||o.alignsWith(f.bounds),n.dirty(f),o.union(z1(f,s))}),l&&(o.clear(),i.items.forEach(f=>o.union(f.bounds)));return pI(i),t.modifies("bounds")}});function z1(e,t,n){return t(e.bounds.clear(),e,n)}const m8=":vega_identifier:";function zT(e){te.call(this,0,e)}zT.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};me(zT,te,{transform(e,t){const n=Kue(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,a=>a[i]=a[i]||++r),n.set(this.value=r),t}});function Kue(e){return e._signals[m8]||(e._signals[m8]=e.add(0))}function $I(e){te.call(this,null,e)}me($I,te,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Jue(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Ax?gx:hx;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Jue(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function DI(e){te.call(this,null,e)}const y8={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!TI(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},TI=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),v8=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,a;n<i;r=a,++n)if(TI(r,a=e[n].bounds,t))return!0},ele=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},tle=(e,t,n)=>{var i=e.range(),r=new yn;return t===Cd||t===Lu?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),a=>r.encloses(a.bounds)},b8=e=>(e.forEach(t=>t.opacity=1),e),x8=(e,t)=>e.reflow(t.modified()).modifies("opacity");me(DI,te,{transform(e,t){const n=y8[e.method]||y8.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,a,s;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(b8(r),t=x8(t,e)),t;if(r=r.filter(ele),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),a=b8(r),t=x8(t,e),a.length>=3&&v8(a,i)){do a=n(a,i);while(a.length>=3&&v8(a,i));a.length<3&&!st(r).opacity&&(a.length>1&&(st(a).opacity=0),st(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=tle(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(l=>{s(l)||(l.opacity=0)}));const o=a[0].mark.bounds.clear();return r.forEach(l=>{l.opacity&&o.union(l.bounds)}),t}});function MI(e){te.call(this,null,e)}me(MI,te,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const ui=new yn;function Zf(e,t,n){return e[t]===n?0:(e[t]=n,1)}function nle(e){var t=e.items[0].orient;return t===ya||t===va}function ile(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function rle(e,t,n,i){var r=t.items[0],a=r.datum,s=r.translate!=null?r.translate:.5,o=r.orient,l=ile(a),f=r.range,d=r.offset,h=r.position,p=r.minExtent,y=r.maxExtent,v=a.title&&r.items[l[2]].items[0],b=r.titlePadding,E=r.bounds,S=v&&vT(v),w=0,_=0,C,$;switch(ui.clear().union(E),E.clear(),(C=l[0])>-1&&E.union(r.items[C].bounds),(C=l[1])>-1&&E.union(r.items[C].bounds),o){case Cd:w=h||0,_=-d,$=Math.max(p,Math.min(y,-E.y1)),E.add(0,-$).add(f,0),v&&B1(e,v,$,b,S,0,-1,E);break;case ya:w=-d,_=h||0,$=Math.max(p,Math.min(y,-E.x1)),E.add(-$,0).add(0,f),v&&B1(e,v,$,b,S,1,-1,E);break;case va:w=n+d,_=h||0,$=Math.max(p,Math.min(y,E.x2)),E.add(0,0).add($,f),v&&B1(e,v,$,b,S,1,1,E);break;case Lu:w=h||0,_=i+d,$=Math.max(p,Math.min(y,E.y2)),E.add(0,0).add(f,$),v&&B1(e,v,$,b,0,0,1,E);break;default:w=r.x,_=r.y}return wo(E.translate(w,_),r),Zf(r,"x",w+s)|Zf(r,"y",_+s)&&(r.bounds=ui,e.dirty(r),r.bounds=E,e.dirty(r)),r.mark.bounds.clear().union(E)}function B1(e,t,n,i,r,a,s,o){const l=t.bounds;if(t.auto){const f=s*(n+r+i);let d=0,h=0;e.dirty(t),a?d=(t.x||0)-(t.x=f):h=(t.y||0)-(t.y=f),t.mark.bounds.clear().union(l.translate(-d,-h)),e.dirty(t)}o.union(l)}const E8=(e,t)=>Math.floor(Math.min(e,t)),S8=(e,t)=>Math.ceil(Math.max(e,t));function ale(e){var t=e.items,n=t.length,i=0,r,a;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],a=r.items,r.marktype===Ax)switch(r.role){case kT:case FT:case NT:break;case yI:s.rowheaders.push(...a);break;case vI:s.rowfooters.push(...a);break;case xI:s.colheaders.push(...a);break;case EI:s.colfooters.push(...a);break;case bI:s.rowtitle=a[0];break;case SI:s.coltitle=a[0];break;default:s.marks.push(...a)}return s}function sle(e){return new yn().set(0,0,e.width||0,e.height||0)}function ole(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function It(e,t,n){const i=Pe(e)?e[t]:e;return i??(n!==void 0?n:0)}function A8(e){return e<0?Math.ceil(-e):0}function kI(e,t,n){var i=!n.nodirty,r=n.bounds===RT?sle:ole,a=ui.set(0,0,0,0),s=It(n.align,vu),o=It(n.align,bu),l=It(n.padding,vu),f=It(n.padding,bu),d=n.columns||t.length,h=d<=0?1:Math.ceil(t.length/d),p=t.length,y=Array(p),v=Array(d),b=0,E=Array(p),S=Array(h),w=0,_=Array(p),C=Array(p),$=Array(p),M,T,F,R,B,L,Y,H,U,z,O;for(T=0;T<d;++T)v[T]=0;for(T=0;T<h;++T)S[T]=0;for(T=0;T<p;++T)L=t[T],B=$[T]=r(L),L.x=L.x||0,_[T]=0,L.y=L.y||0,C[T]=0,F=T%d,R=~~(T/d),b=Math.max(b,Y=Math.ceil(B.x2)),w=Math.max(w,H=Math.ceil(B.y2)),v[F]=Math.max(v[F],Y),S[R]=Math.max(S[R],H),y[T]=l+A8(B.x1),E[T]=f+A8(B.y1),i&&e.dirty(t[T]);for(T=0;T<p;++T)T%d===0&&(y[T]=0),T<d&&(E[T]=0);if(s===wC)for(F=1;F<d;++F){for(O=0,T=F;T<p;T+=d)O<y[T]&&(O=y[T]);for(T=F;T<p;T+=d)y[T]=O+v[F-1]}else if(s===R1){for(O=0,T=0;T<p;++T)T%d&&O<y[T]&&(O=y[T]);for(T=0;T<p;++T)T%d&&(y[T]=O+b)}else for(s=!1,F=1;F<d;++F)for(T=F;T<p;T+=d)y[T]+=v[F-1];if(o===wC)for(R=1;R<h;++R){for(O=0,T=R*d,M=T+d;T<M;++T)O<E[T]&&(O=E[T]);for(T=R*d;T<M;++T)E[T]=O+S[R-1]}else if(o===R1){for(O=0,T=d;T<p;++T)O<E[T]&&(O=E[T]);for(T=d;T<p;++T)E[T]=O+w}else for(o=!1,R=1;R<h;++R)for(T=R*d,M=T+d;T<M;++T)E[T]+=S[R-1];for(U=0,T=0;T<p;++T)U=y[T]+(T%d?U:0),_[T]+=U-t[T].x;for(F=0;F<d;++F)for(z=0,T=F;T<p;T+=d)z+=E[T],C[T]+=z-t[T].y;if(s&&It(n.center,vu)&&h>1)for(T=0;T<p;++T)B=s===R1?b:v[T%d],U=B-$[T].x2-t[T].x-_[T],U>0&&(_[T]+=U/2);if(o&&It(n.center,bu)&&d!==1)for(T=0;T<p;++T)B=o===R1?w:S[~~(T/d)],z=B-$[T].y2-t[T].y-C[T],z>0&&(C[T]+=z/2);for(T=0;T<p;++T)a.union($[T].translate(_[T],C[T]));switch(U=It(n.anchor,Gue),z=It(n.anchor,Yue),It(n.anchor,vu)){case wi:U-=a.width();break;case AC:U-=a.width()/2}switch(It(n.anchor,bu)){case wi:z-=a.height();break;case AC:z-=a.height()/2}for(U=Math.round(U),z=Math.round(z),a.clear(),T=0;T<p;++T)t[T].mark.bounds.clear();for(T=0;T<p;++T)L=t[T],L.x+=_[T]+=U,L.y+=C[T]+=z,a.union(L.mark.bounds.union(L.bounds.translate(_[T],C[T]))),i&&e.dirty(L);return a}function ule(e,t,n){var i=ale(t),r=i.marks,a=n.bounds===RT?lle:cle,s=n.offset,o=n.columns||r.length,l=o<=0?1:Math.ceil(r.length/o),f=l*o,d,h,p,y,v,b,E;const S=kI(e,r,n);S.empty()&&S.set(0,0,0,0),i.rowheaders&&(b=It(n.headerBand,bu,null),d=L1(e,i.rowheaders,r,o,l,-It(s,"rowHeader"),E8,0,a,"x1",0,o,1,b)),i.colheaders&&(b=It(n.headerBand,vu,null),h=L1(e,i.colheaders,r,o,o,-It(s,"columnHeader"),E8,1,a,"y1",0,1,o,b)),i.rowfooters&&(b=It(n.footerBand,bu,null),p=L1(e,i.rowfooters,r,o,l,It(s,"rowFooter"),S8,0,a,"x2",o-1,o,1,b)),i.colfooters&&(b=It(n.footerBand,vu,null),y=L1(e,i.colfooters,r,o,o,It(s,"columnFooter"),S8,1,a,"y2",f-o,1,o,b)),i.rowtitle&&(v=It(n.titleAnchor,bu),E=It(s,"rowTitle"),E=v===wi?p+E:d-E,b=It(n.titleBand,bu,.5),w8(e,i.rowtitle,E,0,S,b)),i.coltitle&&(v=It(n.titleAnchor,vu),E=It(s,"columnTitle"),E=v===wi?y+E:h-E,b=It(n.titleBand,vu,.5),w8(e,i.coltitle,E,1,S,b))}function lle(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function cle(e,t){return e.bounds[t]}function L1(e,t,n,i,r,a,s,o,l,f,d,h,p,y){var v=n.length,b=0,E=0,S,w,_,C,$,M,T,F,R;if(!v)return b;for(S=d;S<v;S+=h)n[S]&&(b=s(b,l(n[S],f)));if(!t.length)return b;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),b+=a,w=0,C=t.length;w<C;++w)e.dirty(t[w]),t[w].mark.bounds.clear();for(S=d,w=0,C=t.length;w<C;++w,S+=h){for(M=t[w],$=M.mark.bounds,_=S;_>=0&&(T=n[_])==null;_-=p);o?(F=y==null?T.x:Math.round(T.bounds.x1+y*T.bounds.width()),R=b):(F=b,R=y==null?T.y:Math.round(T.bounds.y1+y*T.bounds.height())),$.union(M.bounds.translate(F-(M.x||0),R-(M.y||0))),M.x=F,M.y=R,e.dirty(M),E=s(E,$[f])}return E}function w8(e,t,n,i,r,a){if(t){e.dirty(t);var s=n,o=n;i?s=Math.round(r.x1+a*r.width()):o=Math.round(r.y1+a*r.height()),t.bounds.translate(s-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=o,e.dirty(t)}}function fle(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function dle(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function hle(e,t,n,i,r,a,s){const o=fle(n,t),l=dle(e,o("offset",0)),f=o("anchor",MT),d=f===wi?1:f===AC?.5:0,h={align:wC,bounds:o("bounds",RT),columns:o("direction")==="vertical"?1:e.length,padding:o("margin",8),center:o("center"),nodirty:!0};switch(t){case ya:h.anchor={x:Math.floor(i.x1)-l,column:wi,y:d*(s||i.height()+2*i.y1),row:f};break;case va:h.anchor={x:Math.ceil(i.x2)+l,y:d*(s||i.height()+2*i.y1),row:f};break;case Cd:h.anchor={y:Math.floor(r.y1)-l,row:wi,x:d*(a||r.width()+2*r.x1),column:f};break;case Lu:h.anchor={y:Math.ceil(r.y2)+l,x:d*(a||r.width()+2*r.x1),column:f};break;case Pue:h.anchor={x:l,y:l};break;case Iue:h.anchor={x:a-l,y:l,column:wi};break;case que:h.anchor={x:l,y:s-l,row:wi};break;case Hue:h.anchor={x:a-l,y:s-l,column:wi,row:wi};break}return h}function gle(e,t){var n=t.items[0],i=n.datum,r=n.orient,a=n.bounds,s=n.x,o=n.y,l,f;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),mle(e,n,n.items[0].items[0]),a=ple(n,a),l=2*n.padding,f=2*n.padding,a.empty()||(l=Math.ceil(a.width()+l),f=Math.ceil(a.height()+f)),i.type===Que&&yle(n.items[0].items[0].items[0].items),r!==OT&&(n.x=s=0,n.y=o=0),n.width=l,n.height=f,wo(a.set(s,o,s+l,o+f),n),n.mark.bounds.clear().union(a),n}function ple(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function mle(e,t,n){var i=t.padding,r=i-n.x,a=i-n.y;if(!t.datum.title)(r||a)&&T0(e,n,r,a);else{var s=t.items[1].items[0],o=s.anchor,l=t.titlePadding||0,f=i-s.x,d=i-s.y;switch(s.orient){case ya:r+=Math.ceil(s.bounds.width())+l;break;case va:case Lu:break;default:a+=s.bounds.height()+l}switch((r||a)&&T0(e,n,r,a),s.orient){case ya:d+=zf(t,n,s,o,1,1);break;case va:f+=zf(t,n,s,wi,0,0)+l,d+=zf(t,n,s,o,1,1);break;case Lu:f+=zf(t,n,s,o,0,0),d+=zf(t,n,s,wi,-1,0,1)+l;break;default:f+=zf(t,n,s,o,0,0)}(f||d)&&T0(e,s,f,d),(f=Math.round(s.bounds.x1-i))<0&&(T0(e,n,-f,0),T0(e,s,-f,0))}}function zf(e,t,n,i,r,a,s){const o=e.datum.type!=="symbol",l=n.datum.vgrad,f=o&&(a||!l)&&!s?t.items[0]:t,d=f.bounds[r?"y2":"x2"]-e.padding,h=l&&a?d:0,p=l&&a?0:d,y=r<=0?0:vT(n);return Math.round(i===MT?h:i===wi?p-y:.5*(d-y))}function T0(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function yle(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function vle(e,t,n,i,r){var a=t.items[0],s=a.frame,o=a.orient,l=a.anchor,f=a.offset,d=a.padding,h=a.items[0].items[0],p=a.items[1]&&a.items[1].items[0],y=o===ya||o===va?i:n,v=0,b=0,E=0,S=0,w=0,_;if(s!==Ax?o===ya?(v=r.y2,y=r.y1):o===va?(v=r.y1,y=r.y2):(v=r.x1,y=r.x2):o===ya&&(v=i,y=0),_=l===MT?v:l===wi?y:(v+y)/2,p&&p.text){switch(o){case Cd:case Lu:w=h.bounds.height()+d;break;case ya:S=h.bounds.width()+d;break;case va:S=-h.bounds.width()-d;break}ui.clear().union(p.bounds),ui.translate(S-(p.x||0),w-(p.y||0)),Zf(p,"x",S)|Zf(p,"y",w)&&(e.dirty(p),p.bounds.clear().union(ui),p.mark.bounds.clear().union(ui),e.dirty(p)),ui.clear().union(p.bounds)}else ui.clear();switch(ui.union(h.bounds),o){case Cd:b=_,E=r.y1-ui.height()-f;break;case ya:b=r.x1-ui.width()-f,E=_;break;case va:b=r.x2+ui.width()+f,E=_;break;case Lu:b=_,E=r.y2+f;break;default:b=a.x,E=a.y}return Zf(a,"x",b)|Zf(a,"y",E)&&(ui.translate(b,E),e.dirty(a),a.bounds.clear().union(ui),t.bounds.clear().union(ui),e.dirty(a)),a.bounds}function NI(e){te.call(this,null,e)}me(NI,te,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&ule(n,i,e.layout),xle(n,i,e)}),ble(e.mark.group)?t.reflow():t}});function ble(e){return e&&e.mark.role!=="legend-entry"}function xle(e,t,n){var i=t.items,r=Math.max(0,t.width||0),a=Math.max(0,t.height||0),s=new yn().set(0,0,r,a),o=s.clone(),l=s.clone(),f=[],d,h,p,y,v,b;for(v=0,b=i.length;v<b;++v)switch(h=i[v],h.role){case kT:y=nle(h)?o:l,y.union(rle(e,h,r,a));break;case NT:d=h;break;case FT:f.push(gle(e,h));break;case Vue:case Xue:case yI:case vI:case bI:case xI:case EI:case SI:o.union(h.bounds),l.union(h.bounds);break;default:s.union(h.bounds)}if(f.length){const E={};f.forEach(S=>{p=S.orient||va,p!==OT&&(E[p]||(E[p]=[])).push(S)});for(const S in E){const w=E[S];kI(e,w,hle(w,S,n.legends,o,l,r,a))}f.forEach(S=>{const w=S.bounds;if(w.equals(S._bounds)||(S.bounds=S._bounds,e.dirty(S),S.bounds=w,e.dirty(S)),n.autosize&&(n.autosize.type===AI||n.autosize.type===wI||n.autosize.type===_I))switch(S.orient){case ya:case va:s.add(w.x1,0).add(w.x2,0);break;case Cd:case Lu:s.add(0,w.y1).add(0,w.y2)}else s.union(w)})}s.union(o).union(l),d&&s.union(vle(e,d,r,a,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),Ele(e,t,s,n)}function Ele(e,t,n,i){const r=i.autosize||{},a=r.type;if(e._autosize<1||!a)return;let s=e._width,o=e._height,l=Math.max(0,t.width||0),f=Math.max(0,Math.ceil(-n.x1)),d=Math.max(0,t.height||0),h=Math.max(0,Math.ceil(-n.y1));const p=Math.max(0,Math.ceil(n.x2-l)),y=Math.max(0,Math.ceil(n.y2-d));if(r.contains===Wue){const v=e.padding();s-=v.left+v.right,o-=v.top+v.bottom}a===OT?(f=0,h=0,l=s,d=o):a===AI?(l=Math.max(0,s-f-p),d=Math.max(0,o-h-y)):a===wI?(l=Math.max(0,s-f-p),o=d+h+y):a===_I?(s=l+f+p,d=Math.max(0,o-h-y)):a===Zue&&(s=l+f+p,o=d+h+y),e._resizeView(s,o,l,d,[f,h],r.resize)}const Sle=Object.freeze(Object.defineProperty({__proto__:null,bound:CI,identifier:zT,mark:$I,overlap:DI,render:MI,viewlayout:NI},Symbol.toStringTag,{value:"Module"}));function FI(e){te.call(this,null,e)}me(FI,te,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,a=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,o=eT(a,s,e.minstep),l=e.format||sP(n,a,o,e.formatSpecifier,e.formatType,!!e.values),f=e.values?aP(a,e.values,o):tT(a,o);return r&&(i.rem=r),r=f.map((d,h)=>bt({index:h/(f.length-1||1),value:d,label:l(d)})),e.extra&&r.length&&r.push(bt({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function OI(e){te.call(this,null,e)}function Ale(){return bt({})}function wle(e){const t=Wd().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}me(OI,te,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||Ale,a=e.key||ke,s=this.value;return De(i.encode)&&(i.encode=null),s&&(e.modified("key")||t.modified(a))&&ae("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=wle(a)),t.visit(t.ADD,o=>{const l=a(o);let f=s.get(l);f?f.exit?(s.empty--,i.add.push(f)):i.mod.push(f):(f=r(o),s.set(l,f),i.add.push(f)),f.datum=o,f.exit=!1}),t.visit(t.MOD,o=>{const l=a(o),f=s.get(l);f&&(f.datum=o,i.mod.push(f))}),t.visit(t.REM,o=>{const l=a(o),f=s.get(l);o===f.datum&&!f.exit&&(i.rem.push(f),f.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),i}});function RI(e){te.call(this,null,e)}me(RI,te,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,a=t.encode;if(De(a))if(n.changed()||a.every(h=>r[h]))a=a[0],n.encode=null;else return t.StopPropagation;var s=a==="enter",o=r.update||ru,l=r.enter||ru,f=r.exit||ru,d=(a&&!s?r[a]:o)||ru;if(t.changed(t.ADD)&&(t.visit(t.ADD,h=>{l(h,e),o(h,e)}),n.modifies(l.output),n.modifies(o.output),d!==ru&&d!==o&&(t.visit(t.ADD,h=>{d(h,e)}),n.modifies(d.output))),t.changed(t.REM)&&f!==ru&&(t.visit(t.REM,h=>{f(h,e)}),n.modifies(f.output)),s||d!==ru){const h=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(h,p=>{const y=l(p,e)||i;(d(p,e)||y)&&n.mod.push(p)}),n.mod.length&&n.modifies(l.output)):t.visit(h,p=>{(d(p,e)||i)&&n.mod.push(p)}),n.mod.length&&n.modifies(d.output)}return n.changed()?n:t.StopPropagation}});function zI(e){te.call(this,[],e)}me(zI,te,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,a=e.type||py,s=e.scale,o=+e.limit,l=eT(s,e.count==null?5:e.count,e.minstep),f=!!e.values||a===py,d=e.format||cP(n,s,l,a,e.formatSpecifier,e.formatType,f),h=e.values||lP(s,l),p,y,v,b,E;return r&&(i.rem=r),a===py?(o&&h.length>o?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=h.slice(0,o-1),E=!0):r=h,We(v=e.size)?(!e.values&&s(r[0])===0&&(r=r.slice(1)),b=r.reduce((S,w)=>Math.max(S,v(w,e)),0)):v=bi(b=v||8),r=r.map((S,w)=>bt({index:w,label:d(S,w,r),value:S,offset:b,size:v(S,e)})),E&&(E=h[r.length],r.push(bt({index:r.length,label:`${h.length-r.length} entries`,value:E,offset:b,size:v(E,e)})))):a===Zae?(p=s.domain(),y=nP(s,p[0],st(p)),h.length<3&&!e.values&&p[0]!==st(p)&&(h=[p[0],st(p)]),r=h.map((S,w)=>bt({index:w,label:d(S,w,h),value:S,perc:y(S)}))):(v=h.length-1,y=use(s),r=h.map((S,w)=>bt({index:w,label:d(S,w,h),value:S,perc:w?y(S):0,perc2:w===v?1:y(h[w+1])}))),i.source=r,i.add=r,this.value=r,i}});const _le=e=>e.source.x,Cle=e=>e.source.y,$le=e=>e.target.x,Dle=e=>e.target.y;function BT(e){te.call(this,{},e)}BT.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};me(BT,te,{transform(e,t){var n=e.sourceX||_le,i=e.sourceY||Cle,r=e.targetX||$le,a=e.targetY||Dle,s=e.as||"path",o=e.orient||"vertical",l=e.shape||"line",f=_8.get(l+"-"+o)||_8.get(l);return f||ae("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,d=>{d[s]=f(n(d),i(d),r(d),a(d))}),t.reflow(e.modified()).modifies(s)}});const BI=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,Tle=(e,t,n,i)=>BI(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),LI=(e,t,n,i)=>{var r=n-e,a=i-t,s=Math.hypot(r,a)/2,o=180*Math.atan2(a,r)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+o+" 0 1 "+n+","+i},Mle=(e,t,n,i)=>LI(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),jI=(e,t,n,i)=>{const r=n-e,a=i-t,s=.2*(r+a),o=.2*(a-r);return"M"+e+","+t+"C"+(e+s)+","+(t+o)+" "+(n+o)+","+(i-s)+" "+n+","+i},kle=(e,t,n,i)=>jI(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),Nle=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,Fle=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,Ole=(e,t,n,i)=>{const r=Math.cos(e),a=Math.sin(e),s=Math.cos(n),o=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*a+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*s+","+t*o+"L"+i*s+","+i*o},Rle=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},zle=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},Ble=(e,t,n,i)=>{const r=Math.cos(e),a=Math.sin(e),s=Math.cos(n),o=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*a+"C"+l*r+","+l*a+" "+l*s+","+l*o+" "+i*s+","+i*o},_8=Wd({line:BI,"line-radial":Tle,arc:LI,"arc-radial":Mle,curve:jI,"curve-radial":kle,"orthogonal-horizontal":Nle,"orthogonal-vertical":Fle,"orthogonal-radial":Ole,"diagonal-horizontal":Rle,"diagonal-vertical":zle,"diagonal-radial":Ble});function LT(e){te.call(this,null,e)}LT.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};me(LT,te,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],a=e.field||Xd,s=e.startAngle||0,o=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,f=l.map(a),d=f.length,h=s,p=(o-s)/JB(f),y=Er(d),v,b,E;for(e.sort&&y.sort((S,w)=>f[S]-f[w]),v=0;v<d;++v)E=f[y[v]],b=l[y[v]],b[i]=h,b[r]=h+=E*p;return this.value=f,t.reflow(e.modified()).modifies(n)}});const Lle=5;function jle(e){const t=e.type;return!e.bins&&(t===xd||t===Ep||t===Sp)}function UI(e){return ZD(e)&&e!==ss}const Ule=wa(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function PI(e){te.call(this,null,e),this.modified(!0)}me(PI,te,{transform(e,t){var n=t.dataflow,i=this.value,r=Ple(e);(!i||r!==i.type)&&(this.value=i=yt(r)());for(r in e)if(!Ule[r]){if(r==="padding"&&UI(i.type))continue;We(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return Vle(i,e,Yle(i,e,qle(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Ple(e){var t=e.type,n="",i;return t===ss?ss+"-"+xd:(Ile(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?ss+"-":i===3?ih+"-":""),(n+t||xd).toLowerCase())}function Ile(e){const t=e.type;return ZD(t)&&t!==ac&&t!==sc&&(e.scheme||e.range&&e.range.length&&e.range.every(ft))}function qle(e,t,n){const i=Hle(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,a=e.type,s=t.zero||t.zero===void 0&&jle(e),o,l;if(!r)return 0;if((s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(o=(r=r.slice()).length-1||1,s&&(r[0]>0&&(r[0]=0),r[o]<0&&(r[o]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[o]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const f=l>r[o]?o+1:l<r[0]?0:o;f!==o&&n.warn("Scale domainMid exceeds domain min or max.",l),r.splice(f,0,l)}return UI(a)&&t.padding&&r[0]!==st(r)&&(r=Gle(a,r,t.range,t.padding,t.exponent,t.constant)),e.domain(II(a,r,n)),a===VD&&e.unknown(t.domainImplicit?iC:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&eT(e,t.nice)||null),r.length}function Hle(e,t,n){return t?(e.domain(II(e.type,t,n)),t.length):-1}function Gle(e,t,n,i,r,a){var s=Math.abs(st(n)-n[0]),o=s/(s-2*i),l=e===bo?h$(t,null,o):e===Sp?qy(t,null,o,.5):e===Ep?qy(t,null,o,r||1):e===ux?g$(t,null,o,a||1):d$(t,null,o);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function II(e,t,n){if(ZU(e)){var i=Math.abs(t.reduce((r,a)=>r+(a<0?-1:a>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+$e(t))}return t}function Yle(e,t,n){let i=t.bins;if(i&&!De(i)){const r=e.domain(),a=r[0],s=st(r),o=i.step;let l=i.start==null?a:i.start,f=i.stop==null?s:i.stop;o||ae("Scale bins parameter missing step property."),l<a&&(l=o*Math.ceil(a/o)),f>s&&(f=o*Math.floor(s/o)),i=Er(l,f+o/2,o)}return i?e.bins=i:e.bins&&delete e.bins,e.type===XD&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function Vle(e,t,n){var i=e.type,r=t.round||!1,a=t.range;if(t.rangeStep!=null)a=Xle(i,t,n);else if(t.scheme&&(a=Wle(i,t,n),We(a))){if(e.interpolator)return e.interpolator(a);ae(`Scale type ${i} does not support interpolating color schemes.`)}if(a&&KU(i))return e.interpolator(fx(_C(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate(KD(t.interpolate,t.interpolateGamma)):We(e.round)?e.round(r):We(e.rangeRound)&&e.interpolate(r?bp:Vu),a&&e.range(_C(a,t.reverse))}function Xle(e,t,n){e!==GU&&e!==cC&&ae("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===cC?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*YD(n,r,i)]}function Wle(e,t,n){var i=t.schemeExtent,r,a;return De(t.scheme)?a=fx(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),a=JD(r),a||ae(`Unrecognized scheme name: ${t.scheme}`)),n=e===cx?n+1:e===XD?n-1:e===Ed||e===lx?+t.schemeCount||Lle:n,KU(e)?C8(a,i,t.reverse):We(a)?tP(C8(a,i),n):e===VD?a:a.slice(0,n)}function C8(e,t,n){return We(e)&&(t||n)?eP(e,_C(t||[0,1],n)):e}function _C(e,t){return t?e.slice().reverse():e}function qI(e){te.call(this,null,e)}me(qI,te,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Tc(e.sort)),this.modified(n),t}});const $8="zero",HI="center",GI="normalize",YI=["y0","y1"];function jT(e){te.call(this,null,e)}jT.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:$8,values:[$8,HI,GI]},{name:"as",type:"string",array:!0,length:2,default:YI}]};me(jT,te,{transform(e,t){var n=e.as||YI,i=n[0],r=n[1],a=Tc(e.sort),s=e.field||Xd,o=e.offset===HI?Qle:e.offset===GI?Zle:Kle,l,f,d,h;for(l=Jle(t.source,e.groupby,a,s),f=0,d=l.length,h=l.max;f<d;++f)o(l[f],h,s,i,r);return t.reflow(e.modified()).modifies(n)}});function Qle(e,t,n,i,r){for(var a=(t-e.sum)/2,s=e.length,o=0,l;o<s;++o)l=e[o],l[i]=a,l[r]=a+=Math.abs(n(l))}function Zle(e,t,n,i,r){for(var a=1/e.sum,s=0,o=e.length,l=0,f=0,d;l<o;++l)d=e[l],d[i]=s,d[r]=s=a*(f+=Math.abs(n(d)))}function Kle(e,t,n,i,r){for(var a=0,s=0,o=e.length,l=0,f,d;l<o;++l)d=e[l],f=+n(d),f<0?(d[i]=s,d[r]=s+=f):(d[i]=a,d[r]=a+=f)}function Jle(e,t,n,i){var r=[],a=b=>b(d),s,o,l,f,d,h,p,y,v;if(t==null)r.push(e.slice());else for(s={},o=0,l=e.length;o<l;++o)d=e[o],h=t.map(a),p=s[h],p||(s[h]=p=[],r.push(p)),p.push(d);for(h=0,v=0,f=r.length;h<f;++h){for(p=r[h],o=0,y=0,l=p.length;o<l;++o)y+=Math.abs(i(p[o]));p.sum=y,y>v&&(v=y),n&&p.sort(n)}return r.max=v,r}const ece=Object.freeze(Object.defineProperty({__proto__:null,axisticks:FI,datajoin:OI,encode:RI,legendentries:zI,linkpath:BT,pie:LT,scale:PI,sortitems:qI,stack:jT},Symbol.toStringTag,{value:"Module"}));var Oe=1e-6,xv=1e-12,Je=Math.PI,en=Je/2,Ev=Je/4,Oi=Je*2,sn=180/Je,Ze=Je/180,at=Math.abs,ah=Math.atan,ea=Math.atan2,Re=Math.cos,j1=Math.ceil,VI=Math.exp,CC=Math.hypot,Sv=Math.log,Dw=Math.pow,Ne=Math.sin,Gr=Math.sign||function(e){return e>0?1:e<0?-1:0},Ri=Math.sqrt,UT=Math.tan;function XI(e){return e>1?0:e<-1?Je:Math.acos(e)}function tr(e){return e>1?en:e<-1?-en:Math.asin(e)}function Qn(){}function Av(e,t){e&&T8.hasOwnProperty(e.type)&&T8[e.type](e,t)}var D8={Feature:function(e,t){Av(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Av(n[i].geometry,t)}},T8={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){$C(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)$C(n[i],t,0)},Polygon:function(e,t){M8(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)M8(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Av(n[i],t)}};function $C(e,t,n){var i=-1,r=e.length-n,a;for(t.lineStart();++i<r;)a=e[i],t.point(a[0],a[1],a[2]);t.lineEnd()}function M8(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)$C(e[n],t,1);t.polygonEnd()}function to(e,t){e&&D8.hasOwnProperty(e.type)?D8[e.type](e,t):Av(e,t)}var wv=new ki,_v=new ki,WI,QI,DC,TC,MC,gs={point:Qn,lineStart:Qn,lineEnd:Qn,polygonStart:function(){wv=new ki,gs.lineStart=tce,gs.lineEnd=nce},polygonEnd:function(){var e=+wv;_v.add(e<0?Oi+e:e),this.lineStart=this.lineEnd=this.point=Qn},sphere:function(){_v.add(Oi)}};function tce(){gs.point=ice}function nce(){ZI(WI,QI)}function ice(e,t){gs.point=ZI,WI=e,QI=t,e*=Ze,t*=Ze,DC=e,TC=Re(t=t/2+Ev),MC=Ne(t)}function ZI(e,t){e*=Ze,t*=Ze,t=t/2+Ev;var n=e-DC,i=n>=0?1:-1,r=i*n,a=Re(t),s=Ne(t),o=MC*s,l=TC*a+o*Re(r),f=o*i*Ne(r);wv.add(ea(f,l)),DC=e,TC=a,MC=s}function rce(e){return _v=new ki,to(e,gs),_v*2}function Cv(e){return[ea(e[1],e[0]),tr(e[2])]}function uc(e){var t=e[0],n=e[1],i=Re(n);return[i*Re(t),i*Ne(t),Ne(n)]}function U1(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function $d(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Tw(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function P1(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function $v(e){var t=Ri(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Vt,Xi,Kt,vr,Rl,KI,JI,rd,mg,lu,xo,Ks={point:kC,lineStart:k8,lineEnd:N8,polygonStart:function(){Ks.point=tq,Ks.lineStart=ace,Ks.lineEnd=sce,mg=new ki,gs.polygonStart()},polygonEnd:function(){gs.polygonEnd(),Ks.point=kC,Ks.lineStart=k8,Ks.lineEnd=N8,wv<0?(Vt=-(Kt=180),Xi=-(vr=90)):mg>Oe?vr=90:mg<-Oe&&(Xi=-90),xo[0]=Vt,xo[1]=Kt},sphere:function(){Vt=-(Kt=180),Xi=-(vr=90)}};function kC(e,t){lu.push(xo=[Vt=e,Kt=e]),t<Xi&&(Xi=t),t>vr&&(vr=t)}function eq(e,t){var n=uc([e*Ze,t*Ze]);if(rd){var i=$d(rd,n),r=[i[1],-i[0],0],a=$d(r,i);$v(a),a=Cv(a);var s=e-Rl,o=s>0?1:-1,l=a[0]*sn*o,f,d=at(s)>180;d^(o*Rl<l&&l<o*e)?(f=a[1]*sn,f>vr&&(vr=f)):(l=(l+360)%360-180,d^(o*Rl<l&&l<o*e)?(f=-a[1]*sn,f<Xi&&(Xi=f)):(t<Xi&&(Xi=t),t>vr&&(vr=t))),d?e<Rl?yr(Vt,e)>yr(Vt,Kt)&&(Kt=e):yr(e,Kt)>yr(Vt,Kt)&&(Vt=e):Kt>=Vt?(e<Vt&&(Vt=e),e>Kt&&(Kt=e)):e>Rl?yr(Vt,e)>yr(Vt,Kt)&&(Kt=e):yr(e,Kt)>yr(Vt,Kt)&&(Vt=e)}else lu.push(xo=[Vt=e,Kt=e]);t<Xi&&(Xi=t),t>vr&&(vr=t),rd=n,Rl=e}function k8(){Ks.point=eq}function N8(){xo[0]=Vt,xo[1]=Kt,Ks.point=kC,rd=null}function tq(e,t){if(rd){var n=e-Rl;mg.add(at(n)>180?n+(n>0?360:-360):n)}else KI=e,JI=t;gs.point(e,t),eq(e,t)}function ace(){gs.lineStart()}function sce(){tq(KI,JI),gs.lineEnd(),at(mg)>Oe&&(Vt=-(Kt=180)),xo[0]=Vt,xo[1]=Kt,rd=null}function yr(e,t){return(t-=e)<0?t+360:t}function oce(e,t){return e[0]-t[0]}function F8(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function uce(e){var t,n,i,r,a,s,o;if(vr=Kt=-(Vt=Xi=1/0),lu=[],to(e,Ks),n=lu.length){for(lu.sort(oce),t=1,i=lu[0],a=[i];t<n;++t)r=lu[t],F8(i,r[0])||F8(i,r[1])?(yr(i[0],r[1])>yr(i[0],i[1])&&(i[1]=r[1]),yr(r[0],i[1])>yr(i[0],i[1])&&(i[0]=r[0])):a.push(i=r);for(s=-1/0,n=a.length-1,t=0,i=a[n];t<=n;i=r,++t)r=a[t],(o=yr(i[1],r[0]))>s&&(s=o,Vt=r[0],Kt=i[1])}return lu=xo=null,Vt===1/0||Xi===1/0?[[NaN,NaN],[NaN,NaN]]:[[Vt,Xi],[Kt,vr]]}var Z0,Dv,Tv,Mv,kv,Nv,Fv,Ov,NC,FC,OC,nq,iq,_i,Ci,$i,ba={sphere:Qn,point:PT,lineStart:O8,lineEnd:R8,polygonStart:function(){ba.lineStart=fce,ba.lineEnd=dce},polygonEnd:function(){ba.lineStart=O8,ba.lineEnd=R8}};function PT(e,t){e*=Ze,t*=Ze;var n=Re(t);Op(n*Re(e),n*Ne(e),Ne(t))}function Op(e,t,n){++Z0,Tv+=(e-Tv)/Z0,Mv+=(t-Mv)/Z0,kv+=(n-kv)/Z0}function O8(){ba.point=lce}function lce(e,t){e*=Ze,t*=Ze;var n=Re(t);_i=n*Re(e),Ci=n*Ne(e),$i=Ne(t),ba.point=cce,Op(_i,Ci,$i)}function cce(e,t){e*=Ze,t*=Ze;var n=Re(t),i=n*Re(e),r=n*Ne(e),a=Ne(t),s=ea(Ri((s=Ci*a-$i*r)*s+(s=$i*i-_i*a)*s+(s=_i*r-Ci*i)*s),_i*i+Ci*r+$i*a);Dv+=s,Nv+=s*(_i+(_i=i)),Fv+=s*(Ci+(Ci=r)),Ov+=s*($i+($i=a)),Op(_i,Ci,$i)}function R8(){ba.point=PT}function fce(){ba.point=hce}function dce(){rq(nq,iq),ba.point=PT}function hce(e,t){nq=e,iq=t,e*=Ze,t*=Ze,ba.point=rq;var n=Re(t);_i=n*Re(e),Ci=n*Ne(e),$i=Ne(t),Op(_i,Ci,$i)}function rq(e,t){e*=Ze,t*=Ze;var n=Re(t),i=n*Re(e),r=n*Ne(e),a=Ne(t),s=Ci*a-$i*r,o=$i*i-_i*a,l=_i*r-Ci*i,f=CC(s,o,l),d=tr(f),h=f&&-d/f;NC.add(h*s),FC.add(h*o),OC.add(h*l),Dv+=d,Nv+=d*(_i+(_i=i)),Fv+=d*(Ci+(Ci=r)),Ov+=d*($i+($i=a)),Op(_i,Ci,$i)}function gce(e){Z0=Dv=Tv=Mv=kv=Nv=Fv=Ov=0,NC=new ki,FC=new ki,OC=new ki,to(e,ba);var t=+NC,n=+FC,i=+OC,r=CC(t,n,i);return r<xv&&(t=Nv,n=Fv,i=Ov,Dv<Oe&&(t=Tv,n=Mv,i=kv),r=CC(t,n,i),r<xv)?[NaN,NaN]:[ea(n,t)*sn,tr(i/r)*sn]}function RC(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function zC(e,t){return at(e)>Je&&(e-=Math.round(e/Oi)*Oi),[e,t]}zC.invert=zC;function aq(e,t,n){return(e%=Oi)?t||n?RC(B8(e),L8(t,n)):B8(e):t||n?L8(t,n):zC}function z8(e){return function(t,n){return t+=e,at(t)>Je&&(t-=Math.round(t/Oi)*Oi),[t,n]}}function B8(e){var t=z8(e);return t.invert=z8(-e),t}function L8(e,t){var n=Re(e),i=Ne(e),r=Re(t),a=Ne(t);function s(o,l){var f=Re(l),d=Re(o)*f,h=Ne(o)*f,p=Ne(l),y=p*n+d*i;return[ea(h*r-y*a,d*n-p*i),tr(y*r+h*a)]}return s.invert=function(o,l){var f=Re(l),d=Re(o)*f,h=Ne(o)*f,p=Ne(l),y=p*r-h*a;return[ea(h*r+p*a,d*n+y*i),tr(y*n-d*i)]},s}function pce(e){e=aq(e[0]*Ze,e[1]*Ze,e.length>2?e[2]*Ze:0);function t(n){return n=e(n[0]*Ze,n[1]*Ze),n[0]*=sn,n[1]*=sn,n}return t.invert=function(n){return n=e.invert(n[0]*Ze,n[1]*Ze),n[0]*=sn,n[1]*=sn,n},t}function mce(e,t,n,i,r,a){if(n){var s=Re(t),o=Ne(t),l=i*n;r==null?(r=t+i*Oi,a=t-l/2):(r=j8(s,r),a=j8(s,a),(i>0?r<a:r>a)&&(r+=i*Oi));for(var f,d=r;i>0?d>a:d<a;d-=l)f=Cv([s,-o*Re(d),-o*Ne(d)]),e.point(f[0],f[1])}}function j8(e,t){t=uc(t),t[0]-=e,$v(t);var n=XI(-t[1]);return((-t[2]<0?-n:n)+Oi-Oe)%Oi}function sq(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Qn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function wy(e,t){return at(e[0]-t[0])<Oe&&at(e[1]-t[1])<Oe}function I1(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function oq(e,t,n,i,r){var a=[],s=[],o,l;if(e.forEach(function(v){if(!((b=v.length-1)<=0)){var b,E=v[0],S=v[b],w;if(wy(E,S)){if(!E[2]&&!S[2]){for(r.lineStart(),o=0;o<b;++o)r.point((E=v[o])[0],E[1]);r.lineEnd();return}S[0]+=2*Oe}a.push(w=new I1(E,v,null,!0)),s.push(w.o=new I1(E,null,w,!1)),a.push(w=new I1(S,v,null,!1)),s.push(w.o=new I1(S,null,w,!0))}}),!!a.length){for(s.sort(t),U8(a),U8(s),o=0,l=s.length;o<l;++o)s[o].e=n=!n;for(var f=a[0],d,h;;){for(var p=f,y=!0;p.v;)if((p=p.n)===f)return;d=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(y)for(o=0,l=d.length;o<l;++o)r.point((h=d[o])[0],h[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(y)for(d=p.p.z,o=d.length-1;o>=0;--o)r.point((h=d[o])[0],h[1]);else i(p.x,p.p.x,-1,r);p=p.p}p=p.o,d=p.z,y=!y}while(!p.v);r.lineEnd()}}}function U8(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function Mw(e){return at(e[0])<=Je?e[0]:Gr(e[0])*((at(e[0])+Je)%Oi-Je)}function yce(e,t){var n=Mw(t),i=t[1],r=Ne(i),a=[Ne(n),-Re(n),0],s=0,o=0,l=new ki;r===1?i=en+Oe:r===-1&&(i=-en-Oe);for(var f=0,d=e.length;f<d;++f)if(p=(h=e[f]).length)for(var h,p,y=h[p-1],v=Mw(y),b=y[1]/2+Ev,E=Ne(b),S=Re(b),w=0;w<p;++w,v=C,E=M,S=T,y=_){var _=h[w],C=Mw(_),$=_[1]/2+Ev,M=Ne($),T=Re($),F=C-v,R=F>=0?1:-1,B=R*F,L=B>Je,Y=E*M;if(l.add(ea(Y*R*Ne(B),S*T+Y*Re(B))),s+=L?F+R*Oi:F,L^v>=n^C>=n){var H=$d(uc(y),uc(_));$v(H);var U=$d(a,H);$v(U);var z=(L^F>=0?-1:1)*tr(U[2]);(i>z||i===z&&(H[0]||H[1]))&&(o+=L^F>=0?1:-1)}}return(s<-Oe||s<Oe&&l<-xv)^o&1}function uq(e,t,n,i){return function(r){var a=t(r),s=sq(),o=t(s),l=!1,f,d,h,p={point:y,lineStart:b,lineEnd:E,polygonStart:function(){p.point=S,p.lineStart=w,p.lineEnd=_,d=[],f=[]},polygonEnd:function(){p.point=y,p.lineStart=b,p.lineEnd=E,d=KB(d);var C=yce(f,i);d.length?(l||(r.polygonStart(),l=!0),oq(d,bce,C,n,r)):C&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),d=f=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function y(C,$){e(C,$)&&r.point(C,$)}function v(C,$){a.point(C,$)}function b(){p.point=v,a.lineStart()}function E(){p.point=y,a.lineEnd()}function S(C,$){h.push([C,$]),o.point(C,$)}function w(){o.lineStart(),h=[]}function _(){S(h[0][0],h[0][1]),o.lineEnd();var C=o.clean(),$=s.result(),M,T=$.length,F,R,B;if(h.pop(),f.push(h),h=null,!!T){if(C&1){if(R=$[0],(F=R.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),M=0;M<F;++M)r.point((B=R[M])[0],B[1]);r.lineEnd()}return}T>1&&C&2&&$.push($.pop().concat($.shift())),d.push($.filter(vce))}}return p}}function vce(e){return e.length>1}function bce(e,t){return((e=e.x)[0]<0?e[1]-en-Oe:en-e[1])-((t=t.x)[0]<0?t[1]-en-Oe:en-t[1])}const P8=uq(function(){return!0},xce,Sce,[-Je,-en]);function xce(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(a,s){var o=a>0?Je:-Je,l=at(a-t);at(l-Je)<Oe?(e.point(t,n=(n+s)/2>0?en:-en),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(a,n),r=0):i!==o&&l>=Je&&(at(t-i)<Oe&&(t-=i*Oe),at(a-o)<Oe&&(a-=o*Oe),n=Ece(t,n,a,s),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(o,n),r=0),e.point(t=a,n=s),i=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Ece(e,t,n,i){var r,a,s=Ne(e-n);return at(s)>Oe?ah((Ne(t)*(a=Re(i))*Ne(n)-Ne(i)*(r=Re(t))*Ne(e))/(r*a*s)):(t+i)/2}function Sce(e,t,n,i){var r;if(e==null)r=n*en,i.point(-Je,r),i.point(0,r),i.point(Je,r),i.point(Je,0),i.point(Je,-r),i.point(0,-r),i.point(-Je,-r),i.point(-Je,0),i.point(-Je,r);else if(at(e[0]-t[0])>Oe){var a=e[0]<t[0]?Je:-Je;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(t[0],t[1])}function Ace(e){var t=Re(e),n=2*Ze,i=t>0,r=at(t)>Oe;function a(d,h,p,y){mce(y,e,n,p,d,h)}function s(d,h){return Re(d)*Re(h)>t}function o(d){var h,p,y,v,b;return{lineStart:function(){v=y=!1,b=1},point:function(E,S){var w=[E,S],_,C=s(E,S),$=i?C?0:f(E,S):C?f(E+(E<0?Je:-Je),S):0;if(!h&&(v=y=C)&&d.lineStart(),C!==y&&(_=l(h,w),(!_||wy(h,_)||wy(w,_))&&(w[2]=1)),C!==y)b=0,C?(d.lineStart(),_=l(w,h),d.point(_[0],_[1])):(_=l(h,w),d.point(_[0],_[1],2),d.lineEnd()),h=_;else if(r&&h&&i^C){var M;!($&p)&&(M=l(w,h,!0))&&(b=0,i?(d.lineStart(),d.point(M[0][0],M[0][1]),d.point(M[1][0],M[1][1]),d.lineEnd()):(d.point(M[1][0],M[1][1]),d.lineEnd(),d.lineStart(),d.point(M[0][0],M[0][1],3)))}C&&(!h||!wy(h,w))&&d.point(w[0],w[1]),h=w,y=C,p=$},lineEnd:function(){y&&d.lineEnd(),h=null},clean:function(){return b|(v&&y)<<1}}}function l(d,h,p){var y=uc(d),v=uc(h),b=[1,0,0],E=$d(y,v),S=U1(E,E),w=E[0],_=S-w*w;if(!_)return!p&&d;var C=t*S/_,$=-t*w/_,M=$d(b,E),T=P1(b,C),F=P1(E,$);Tw(T,F);var R=M,B=U1(T,R),L=U1(R,R),Y=B*B-L*(U1(T,T)-1);if(!(Y<0)){var H=Ri(Y),U=P1(R,(-B-H)/L);if(Tw(U,T),U=Cv(U),!p)return U;var z=d[0],O=h[0],I=d[1],W=h[1],K;O<z&&(K=z,z=O,O=K);var k=O-z,V=at(k-Je)<Oe,X=V||k<Oe;if(!V&&W<I&&(K=I,I=W,W=K),X?V?I+W>0^U[1]<(at(U[0]-z)<Oe?I:W):I<=U[1]&&U[1]<=W:k>Je^(z<=U[0]&&U[0]<=O)){var ne=P1(R,(-B+H)/L);return Tw(ne,T),[U,Cv(ne)]}}}function f(d,h){var p=i?e:Je-e,y=0;return d<-p?y|=1:d>p&&(y|=2),h<-p?y|=4:h>p&&(y|=8),y}return uq(s,o,a,i?[0,-e]:[-Je,e-Je])}function wce(e,t,n,i,r,a){var s=e[0],o=e[1],l=t[0],f=t[1],d=0,h=1,p=l-s,y=f-o,v;if(v=n-s,!(!p&&v>0)){if(v/=p,p<0){if(v<d)return;v<h&&(h=v)}else if(p>0){if(v>h)return;v>d&&(d=v)}if(v=r-s,!(!p&&v<0)){if(v/=p,p<0){if(v>h)return;v>d&&(d=v)}else if(p>0){if(v<d)return;v<h&&(h=v)}if(v=i-o,!(!y&&v>0)){if(v/=y,y<0){if(v<d)return;v<h&&(h=v)}else if(y>0){if(v>h)return;v>d&&(d=v)}if(v=a-o,!(!y&&v<0)){if(v/=y,y<0){if(v>h)return;v>d&&(d=v)}else if(y>0){if(v<d)return;v<h&&(h=v)}return d>0&&(e[0]=s+d*p,e[1]=o+d*y),h<1&&(t[0]=s+h*p,t[1]=o+h*y),!0}}}}}var K0=1e9,q1=-K0;function lq(e,t,n,i){function r(f,d){return e<=f&&f<=n&&t<=d&&d<=i}function a(f,d,h,p){var y=0,v=0;if(f==null||(y=s(f,h))!==(v=s(d,h))||l(f,d)<0^h>0)do p.point(y===0||y===3?e:n,y>1?i:t);while((y=(y+h+4)%4)!==v);else p.point(d[0],d[1])}function s(f,d){return at(f[0]-e)<Oe?d>0?0:3:at(f[0]-n)<Oe?d>0?2:1:at(f[1]-t)<Oe?d>0?1:0:d>0?3:2}function o(f,d){return l(f.x,d.x)}function l(f,d){var h=s(f,1),p=s(d,1);return h!==p?h-p:h===0?d[1]-f[1]:h===1?f[0]-d[0]:h===2?f[1]-d[1]:d[0]-f[0]}return function(f){var d=f,h=sq(),p,y,v,b,E,S,w,_,C,$,M,T={point:F,lineStart:Y,lineEnd:H,polygonStart:B,polygonEnd:L};function F(z,O){r(z,O)&&d.point(z,O)}function R(){for(var z=0,O=0,I=y.length;O<I;++O)for(var W=y[O],K=1,k=W.length,V=W[0],X,ne,ye=V[0],le=V[1];K<k;++K)X=ye,ne=le,V=W[K],ye=V[0],le=V[1],ne<=i?le>i&&(ye-X)*(i-ne)>(le-ne)*(e-X)&&++z:le<=i&&(ye-X)*(i-ne)<(le-ne)*(e-X)&&--z;return z}function B(){d=h,p=[],y=[],M=!0}function L(){var z=R(),O=M&&z,I=(p=KB(p)).length;(O||I)&&(f.polygonStart(),O&&(f.lineStart(),a(null,null,1,f),f.lineEnd()),I&&oq(p,o,z,a,f),f.polygonEnd()),d=f,p=y=v=null}function Y(){T.point=U,y&&y.push(v=[]),$=!0,C=!1,w=_=NaN}function H(){p&&(U(b,E),S&&C&&h.rejoin(),p.push(h.result())),T.point=F,C&&d.lineEnd()}function U(z,O){var I=r(z,O);if(y&&v.push([z,O]),$)b=z,E=O,S=I,$=!1,I&&(d.lineStart(),d.point(z,O));else if(I&&C)d.point(z,O);else{var W=[w=Math.max(q1,Math.min(K0,w)),_=Math.max(q1,Math.min(K0,_))],K=[z=Math.max(q1,Math.min(K0,z)),O=Math.max(q1,Math.min(K0,O))];wce(W,K,e,t,n,i)?(C||(d.lineStart(),d.point(W[0],W[1])),d.point(K[0],K[1]),I||d.lineEnd(),M=!1):I&&(d.lineStart(),d.point(z,O),M=!1)}w=z,_=O,C=I}return T}}function I8(e,t,n){var i=Er(e,t-Oe,n).concat(t);return function(r){return i.map(function(a){return[r,a]})}}function q8(e,t,n){var i=Er(e,t-Oe,n).concat(t);return function(r){return i.map(function(a){return[a,r]})}}function _ce(){var e,t,n,i,r,a,s,o,l=10,f=l,d=90,h=360,p,y,v,b,E=2.5;function S(){return{type:"MultiLineString",coordinates:w()}}function w(){return Er(j1(i/d)*d,n,d).map(v).concat(Er(j1(o/h)*h,s,h).map(b)).concat(Er(j1(t/l)*l,e,l).filter(function(_){return at(_%d)>Oe}).map(p)).concat(Er(j1(a/f)*f,r,f).filter(function(_){return at(_%h)>Oe}).map(y))}return S.lines=function(){return w().map(function(_){return{type:"LineString",coordinates:_}})},S.outline=function(){return{type:"Polygon",coordinates:[v(i).concat(b(s).slice(1),v(n).reverse().slice(1),b(o).reverse().slice(1))]}},S.extent=function(_){return arguments.length?S.extentMajor(_).extentMinor(_):S.extentMinor()},S.extentMajor=function(_){return arguments.length?(i=+_[0][0],n=+_[1][0],o=+_[0][1],s=+_[1][1],i>n&&(_=i,i=n,n=_),o>s&&(_=o,o=s,s=_),S.precision(E)):[[i,o],[n,s]]},S.extentMinor=function(_){return arguments.length?(t=+_[0][0],e=+_[1][0],a=+_[0][1],r=+_[1][1],t>e&&(_=t,t=e,e=_),a>r&&(_=a,a=r,r=_),S.precision(E)):[[t,a],[e,r]]},S.step=function(_){return arguments.length?S.stepMajor(_).stepMinor(_):S.stepMinor()},S.stepMajor=function(_){return arguments.length?(d=+_[0],h=+_[1],S):[d,h]},S.stepMinor=function(_){return arguments.length?(l=+_[0],f=+_[1],S):[l,f]},S.precision=function(_){return arguments.length?(E=+_,p=I8(a,r,90),y=q8(t,e,E),v=I8(o,s,90),b=q8(i,n,E),S):E},S.extentMajor([[-180,-90+Oe],[180,90-Oe]]).extentMinor([[-180,-80-Oe],[180,80+Oe]])}const Pg=e=>e;var kw=new ki,BC=new ki,cq,fq,LC,jC,no={point:Qn,lineStart:Qn,lineEnd:Qn,polygonStart:function(){no.lineStart=Cce,no.lineEnd=Dce},polygonEnd:function(){no.lineStart=no.lineEnd=no.point=Qn,kw.add(at(BC)),BC=new ki},result:function(){var e=kw/2;return kw=new ki,e}};function Cce(){no.point=$ce}function $ce(e,t){no.point=dq,cq=LC=e,fq=jC=t}function dq(e,t){BC.add(jC*e-LC*t),LC=e,jC=t}function Dce(){dq(cq,fq)}var Dd=1/0,Rv=Dd,Ig=-Dd,zv=Ig,Bv={point:Tce,lineStart:Qn,lineEnd:Qn,polygonStart:Qn,polygonEnd:Qn,result:function(){var e=[[Dd,Rv],[Ig,zv]];return Ig=zv=-(Rv=Dd=1/0),e}};function Tce(e,t){e<Dd&&(Dd=e),e>Ig&&(Ig=e),t<Rv&&(Rv=t),t>zv&&(zv=t)}var UC=0,PC=0,J0=0,Lv=0,jv=0,Kf=0,IC=0,qC=0,eg=0,hq,gq,es,ts,qr={point:lc,lineStart:H8,lineEnd:G8,polygonStart:function(){qr.lineStart=Nce,qr.lineEnd=Fce},polygonEnd:function(){qr.point=lc,qr.lineStart=H8,qr.lineEnd=G8},result:function(){var e=eg?[IC/eg,qC/eg]:Kf?[Lv/Kf,jv/Kf]:J0?[UC/J0,PC/J0]:[NaN,NaN];return UC=PC=J0=Lv=jv=Kf=IC=qC=eg=0,e}};function lc(e,t){UC+=e,PC+=t,++J0}function H8(){qr.point=Mce}function Mce(e,t){qr.point=kce,lc(es=e,ts=t)}function kce(e,t){var n=e-es,i=t-ts,r=Ri(n*n+i*i);Lv+=r*(es+e)/2,jv+=r*(ts+t)/2,Kf+=r,lc(es=e,ts=t)}function G8(){qr.point=lc}function Nce(){qr.point=Oce}function Fce(){pq(hq,gq)}function Oce(e,t){qr.point=pq,lc(hq=es=e,gq=ts=t)}function pq(e,t){var n=e-es,i=t-ts,r=Ri(n*n+i*i);Lv+=r*(es+e)/2,jv+=r*(ts+t)/2,Kf+=r,r=ts*e-es*t,IC+=r*(es+e),qC+=r*(ts+t),eg+=r*3,lc(es=e,ts=t)}function mq(e){this._context=e}mq.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Oi);break}}},result:Qn};var HC=new ki,Nw,yq,vq,tg,ng,qg={point:Qn,lineStart:function(){qg.point=Rce},lineEnd:function(){Nw&&bq(yq,vq),qg.point=Qn},polygonStart:function(){Nw=!0},polygonEnd:function(){Nw=null},result:function(){var e=+HC;return HC=new ki,e}};function Rce(e,t){qg.point=bq,yq=tg=e,vq=ng=t}function bq(e,t){tg-=e,ng-=t,HC.add(Ri(tg*tg+ng*ng)),tg=e,ng=t}let Y8,Uv,V8,X8;class W8{constructor(t){this._append=t==null?xq:zce(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==V8||this._append!==Uv){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,V8=i,Uv=this._append,X8=this._,this._=r}this._+=X8;break}}}result(){const t=this._;return this._="",t.length?t:null}}function xq(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function zce(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return xq;if(t!==Y8){const n=10**t;Y8=t,Uv=function(r){let a=1;this._+=r[0];for(const s=r.length;a<s;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}return Uv}function Eq(e,t){let n=3,i=4.5,r,a;function s(o){return o&&(typeof i=="function"&&a.pointRadius(+i.apply(this,arguments)),to(o,r(a))),a.result()}return s.area=function(o){return to(o,r(no)),no.result()},s.measure=function(o){return to(o,r(qg)),qg.result()},s.bounds=function(o){return to(o,r(Bv)),Bv.result()},s.centroid=function(o){return to(o,r(qr)),qr.result()},s.projection=function(o){return arguments.length?(r=o==null?(e=null,Pg):(e=o).stream,s):e},s.context=function(o){return arguments.length?(a=o==null?(t=null,new W8(n)):new mq(t=o),typeof i!="function"&&a.pointRadius(i),s):t},s.pointRadius=function(o){return arguments.length?(i=typeof o=="function"?o:(a.pointRadius(+o),+o),s):i},s.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const l=Math.floor(o);if(!(l>=0))throw new RangeError(`invalid digits: ${o}`);n=l}return t===null&&(a=new W8(n)),s},s.projection(e).digits(n).context(t)}function wx(e){return function(t){var n=new GC;for(var i in e)n[i]=e[i];return n.stream=t,n}}function GC(){}GC.prototype={constructor:GC,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function IT(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),to(n,e.stream(Bv)),t(Bv.result()),i!=null&&e.clipExtent(i),e}function _x(e,t,n){return IT(e,function(i){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],s=Math.min(r/(i[1][0]-i[0][0]),a/(i[1][1]-i[0][1])),o=+t[0][0]+(r-s*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(a-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,l])},n)}function qT(e,t,n){return _x(e,[[0,0],t],n)}function HT(e,t,n){return IT(e,function(i){var r=+t,a=r/(i[1][0]-i[0][0]),s=(r-a*(i[1][0]+i[0][0]))/2,o=-a*i[0][1];e.scale(150*a).translate([s,o])},n)}function GT(e,t,n){return IT(e,function(i){var r=+t,a=r/(i[1][1]-i[0][1]),s=-a*i[0][0],o=(r-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([s,o])},n)}var Q8=16,Bce=Re(30*Ze);function Z8(e,t){return+t?jce(e,t):Lce(e)}function Lce(e){return wx({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function jce(e,t){function n(i,r,a,s,o,l,f,d,h,p,y,v,b,E){var S=f-i,w=d-r,_=S*S+w*w;if(_>4*t&&b--){var C=s+p,$=o+y,M=l+v,T=Ri(C*C+$*$+M*M),F=tr(M/=T),R=at(at(M)-1)<Oe||at(a-h)<Oe?(a+h)/2:ea($,C),B=e(R,F),L=B[0],Y=B[1],H=L-i,U=Y-r,z=w*H-S*U;(z*z/_>t||at((S*H+w*U)/_-.5)>.3||s*p+o*y+l*v<Bce)&&(n(i,r,a,s,o,l,L,Y,R,C/=T,$/=T,M,b,E),E.point(L,Y),n(L,Y,R,C,$,M,f,d,h,p,y,v,b,E))}}return function(i){var r,a,s,o,l,f,d,h,p,y,v,b,E={point:S,lineStart:w,lineEnd:C,polygonStart:function(){i.polygonStart(),E.lineStart=$},polygonEnd:function(){i.polygonEnd(),E.lineStart=w}};function S(F,R){F=e(F,R),i.point(F[0],F[1])}function w(){h=NaN,E.point=_,i.lineStart()}function _(F,R){var B=uc([F,R]),L=e(F,R);n(h,p,d,y,v,b,h=L[0],p=L[1],d=F,y=B[0],v=B[1],b=B[2],Q8,i),i.point(h,p)}function C(){E.point=S,i.lineEnd()}function $(){w(),E.point=M,E.lineEnd=T}function M(F,R){_(r=F,R),a=h,s=p,o=y,l=v,f=b,E.point=_}function T(){n(h,p,d,y,v,b,a,s,r,o,l,f,Q8,i),E.lineEnd=C,C()}return E}}var Uce=wx({point:function(e,t){this.stream.point(e*Ze,t*Ze)}});function Pce(e){return wx({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function Ice(e,t,n,i,r){function a(s,o){return s*=i,o*=r,[t+e*s,n-e*o]}return a.invert=function(s,o){return[(s-t)/e*i,(n-o)/e*r]},a}function K8(e,t,n,i,r,a){if(!a)return Ice(e,t,n,i,r);var s=Re(a),o=Ne(a),l=s*e,f=o*e,d=s/e,h=o/e,p=(o*n-s*t)/e,y=(o*t+s*n)/e;function v(b,E){return b*=i,E*=r,[l*b-f*E+t,n-f*b-l*E]}return v.invert=function(b,E){return[i*(d*b-h*E+p),r*(y-h*b-d*E)]},v}function Ss(e){return Sq(function(){return e})()}function Sq(e){var t,n=150,i=480,r=250,a=0,s=0,o=0,l=0,f=0,d,h=0,p=1,y=1,v=null,b=P8,E=null,S,w,_,C=Pg,$=.5,M,T,F,R,B;function L(z){return F(z[0]*Ze,z[1]*Ze)}function Y(z){return z=F.invert(z[0],z[1]),z&&[z[0]*sn,z[1]*sn]}L.stream=function(z){return R&&B===z?R:R=Uce(Pce(d)(b(M(C(B=z)))))},L.preclip=function(z){return arguments.length?(b=z,v=void 0,U()):b},L.postclip=function(z){return arguments.length?(C=z,E=S=w=_=null,U()):C},L.clipAngle=function(z){return arguments.length?(b=+z?Ace(v=z*Ze):(v=null,P8),U()):v*sn},L.clipExtent=function(z){return arguments.length?(C=z==null?(E=S=w=_=null,Pg):lq(E=+z[0][0],S=+z[0][1],w=+z[1][0],_=+z[1][1]),U()):E==null?null:[[E,S],[w,_]]},L.scale=function(z){return arguments.length?(n=+z,H()):n},L.translate=function(z){return arguments.length?(i=+z[0],r=+z[1],H()):[i,r]},L.center=function(z){return arguments.length?(a=z[0]%360*Ze,s=z[1]%360*Ze,H()):[a*sn,s*sn]},L.rotate=function(z){return arguments.length?(o=z[0]%360*Ze,l=z[1]%360*Ze,f=z.length>2?z[2]%360*Ze:0,H()):[o*sn,l*sn,f*sn]},L.angle=function(z){return arguments.length?(h=z%360*Ze,H()):h*sn},L.reflectX=function(z){return arguments.length?(p=z?-1:1,H()):p<0},L.reflectY=function(z){return arguments.length?(y=z?-1:1,H()):y<0},L.precision=function(z){return arguments.length?(M=Z8(T,$=z*z),U()):Ri($)},L.fitExtent=function(z,O){return _x(L,z,O)},L.fitSize=function(z,O){return qT(L,z,O)},L.fitWidth=function(z,O){return HT(L,z,O)},L.fitHeight=function(z,O){return GT(L,z,O)};function H(){var z=K8(n,0,0,p,y,h).apply(null,t(a,s)),O=K8(n,i-z[0],r-z[1],p,y,h);return d=aq(o,l,f),T=RC(t,O),F=RC(d,T),M=Z8(T,$),U()}function U(){return R=B=null,L}return function(){return t=e.apply(this,arguments),L.invert=t.invert&&Y,H()}}function YT(e){var t=0,n=Je/3,i=Sq(e),r=i(t,n);return r.parallels=function(a){return arguments.length?i(t=a[0]*Ze,n=a[1]*Ze):[t*sn,n*sn]},r}function qce(e){var t=Re(e);function n(i,r){return[i*t,Ne(r)/t]}return n.invert=function(i,r){return[i/t,tr(r*t)]},n}function Hce(e,t){var n=Ne(e),i=(n+Ne(t))/2;if(at(i)<Oe)return qce(e);var r=1+n*(2*i-n),a=Ri(r)/i;function s(o,l){var f=Ri(r-2*i*Ne(l))/i;return[f*Ne(o*=i),a-f*Re(o)]}return s.invert=function(o,l){var f=a-l,d=ea(o,at(f))*Gr(f);return f*i<0&&(d-=Je*Gr(o)*Gr(f)),[d/i,tr((r-(o*o+f*f)*i*i)/(2*i))]},s}function Pv(){return YT(Hce).scale(155.424).center([0,33.6442])}function Aq(){return Pv().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Gce(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Yce(){var e,t,n=Aq(),i,r=Pv().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,s=Pv().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,l,f={point:function(p,y){l=[p,y]}};function d(p){var y=p[0],v=p[1];return l=null,i.point(y,v),l||(a.point(y,v),l)||(o.point(y,v),l)}d.invert=function(p){var y=n.scale(),v=n.translate(),b=(p[0]-v[0])/y,E=(p[1]-v[1])/y;return(E>=.12&&E<.234&&b>=-.425&&b<-.214?r:E>=.166&&E<.234&&b>=-.214&&b<-.115?s:n).invert(p)},d.stream=function(p){return e&&t===p?e:e=Gce([n.stream(t=p),r.stream(p),s.stream(p)])},d.precision=function(p){return arguments.length?(n.precision(p),r.precision(p),s.precision(p),h()):n.precision()},d.scale=function(p){return arguments.length?(n.scale(p),r.scale(p*.35),s.scale(p),d.translate(n.translate())):n.scale()},d.translate=function(p){if(!arguments.length)return n.translate();var y=n.scale(),v=+p[0],b=+p[1];return i=n.translate(p).clipExtent([[v-.455*y,b-.238*y],[v+.455*y,b+.238*y]]).stream(f),a=r.translate([v-.307*y,b+.201*y]).clipExtent([[v-.425*y+Oe,b+.12*y+Oe],[v-.214*y-Oe,b+.234*y-Oe]]).stream(f),o=s.translate([v-.205*y,b+.212*y]).clipExtent([[v-.214*y+Oe,b+.166*y+Oe],[v-.115*y-Oe,b+.234*y-Oe]]).stream(f),h()},d.fitExtent=function(p,y){return _x(d,p,y)},d.fitSize=function(p,y){return qT(d,p,y)},d.fitWidth=function(p,y){return HT(d,p,y)},d.fitHeight=function(p,y){return GT(d,p,y)};function h(){return e=t=null,d}return d.scale(1070)}function wq(e){return function(t,n){var i=Re(t),r=Re(n),a=e(i*r);return a===1/0?[2,0]:[a*r*Ne(t),a*Ne(n)]}}function Rp(e){return function(t,n){var i=Ri(t*t+n*n),r=e(i),a=Ne(r),s=Re(r);return[ea(t*a,i*s),tr(i&&n*a/i)]}}var _q=wq(function(e){return Ri(2/(1+e))});_q.invert=Rp(function(e){return 2*tr(e/2)});function Vce(){return Ss(_q).scale(124.75).clipAngle(180-.001)}var Cq=wq(function(e){return(e=XI(e))&&e/Ne(e)});Cq.invert=Rp(function(e){return e});function Xce(){return Ss(Cq).scale(79.4188).clipAngle(180-.001)}function Cx(e,t){return[e,Sv(UT((en+t)/2))]}Cx.invert=function(e,t){return[e,2*ah(VI(t))-en]};function Wce(){return $q(Cx).scale(961/Oi)}function $q(e){var t=Ss(e),n=t.center,i=t.scale,r=t.translate,a=t.clipExtent,s=null,o,l,f;t.scale=function(h){return arguments.length?(i(h),d()):i()},t.translate=function(h){return arguments.length?(r(h),d()):r()},t.center=function(h){return arguments.length?(n(h),d()):n()},t.clipExtent=function(h){return arguments.length?(h==null?s=o=l=f=null:(s=+h[0][0],o=+h[0][1],l=+h[1][0],f=+h[1][1]),d()):s==null?null:[[s,o],[l,f]]};function d(){var h=Je*i(),p=t(pce(t.rotate()).invert([0,0]));return a(s==null?[[p[0]-h,p[1]-h],[p[0]+h,p[1]+h]]:e===Cx?[[Math.max(p[0]-h,s),o],[Math.min(p[0]+h,l),f]]:[[s,Math.max(p[1]-h,o)],[l,Math.min(p[1]+h,f)]])}return d()}function H1(e){return UT((en+e)/2)}function Qce(e,t){var n=Re(e),i=e===t?Ne(e):Sv(n/Re(t))/Sv(H1(t)/H1(e)),r=n*Dw(H1(e),i)/i;if(!i)return Cx;function a(s,o){r>0?o<-en+Oe&&(o=-en+Oe):o>en-Oe&&(o=en-Oe);var l=r/Dw(H1(o),i);return[l*Ne(i*s),r-l*Re(i*s)]}return a.invert=function(s,o){var l=r-o,f=Gr(i)*Ri(s*s+l*l),d=ea(s,at(l))*Gr(l);return l*i<0&&(d-=Je*Gr(s)*Gr(l)),[d/i,2*ah(Dw(r/f,1/i))-en]},a}function Zce(){return YT(Qce).scale(109.5).parallels([30,30])}function Iv(e,t){return[e,t]}Iv.invert=Iv;function Kce(){return Ss(Iv).scale(152.63)}function Jce(e,t){var n=Re(e),i=e===t?Ne(e):(n-Re(t))/(t-e),r=n/i+e;if(at(i)<Oe)return Iv;function a(s,o){var l=r-o,f=i*s;return[l*Ne(f),r-l*Re(f)]}return a.invert=function(s,o){var l=r-o,f=ea(s,at(l))*Gr(l);return l*i<0&&(f-=Je*Gr(s)*Gr(l)),[f/i,r-Gr(i)*Ri(s*s+l*l)]},a}function efe(){return YT(Jce).scale(131.154).center([0,13.9389])}var yg=1.340264,vg=-.081106,bg=893e-6,xg=.003796,qv=Ri(3)/2,tfe=12;function Dq(e,t){var n=tr(qv*Ne(t)),i=n*n,r=i*i*i;return[e*Re(n)/(qv*(yg+3*vg*i+r*(7*bg+9*xg*i))),n*(yg+vg*i+r*(bg+xg*i))]}Dq.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,a=0,s,o,l;a<tfe&&(o=n*(yg+vg*i+r*(bg+xg*i))-t,l=yg+3*vg*i+r*(7*bg+9*xg*i),n-=s=o/l,i=n*n,r=i*i*i,!(at(s)<xv));++a);return[qv*e*(yg+3*vg*i+r*(7*bg+9*xg*i))/Re(n),tr(Ne(n)/qv)]};function nfe(){return Ss(Dq).scale(177.158)}function Tq(e,t){var n=Re(t),i=Re(e)*n;return[n*Ne(e)/i,Ne(t)/i]}Tq.invert=Rp(ah);function ife(){return Ss(Tq).scale(144.049).clipAngle(60)}function rfe(){var e=1,t=0,n=0,i=1,r=1,a=0,s,o,l=null,f,d,h,p=1,y=1,v=wx({point:function(C,$){var M=_([C,$]);this.stream.point(M[0],M[1])}}),b=Pg,E,S;function w(){return p=e*i,y=e*r,E=S=null,_}function _(C){var $=C[0]*p,M=C[1]*y;if(a){var T=M*s-$*o;$=$*s+M*o,M=T}return[$+t,M+n]}return _.invert=function(C){var $=C[0]-t,M=C[1]-n;if(a){var T=M*s+$*o;$=$*s-M*o,M=T}return[$/p,M/y]},_.stream=function(C){return E&&S===C?E:E=v(b(S=C))},_.postclip=function(C){return arguments.length?(b=C,l=f=d=h=null,w()):b},_.clipExtent=function(C){return arguments.length?(b=C==null?(l=f=d=h=null,Pg):lq(l=+C[0][0],f=+C[0][1],d=+C[1][0],h=+C[1][1]),w()):l==null?null:[[l,f],[d,h]]},_.scale=function(C){return arguments.length?(e=+C,w()):e},_.translate=function(C){return arguments.length?(t=+C[0],n=+C[1],w()):[t,n]},_.angle=function(C){return arguments.length?(a=C%360*Ze,o=Ne(a),s=Re(a),w()):a*sn},_.reflectX=function(C){return arguments.length?(i=C?-1:1,w()):i<0},_.reflectY=function(C){return arguments.length?(r=C?-1:1,w()):r<0},_.fitExtent=function(C,$){return _x(_,C,$)},_.fitSize=function(C,$){return qT(_,C,$)},_.fitWidth=function(C,$){return HT(_,C,$)},_.fitHeight=function(C,$){return GT(_,C,$)},_}function Mq(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}Mq.invert=function(e,t){var n=t,i=25,r;do{var a=n*n,s=a*a;n-=r=(n*(1.007226+a*(.015085+s*(-.044475+.028874*a-.005916*s)))-t)/(1.007226+a*(.015085*3+s*(-.044475*7+.028874*9*a-.005916*11*s)))}while(at(r)>Oe&&--i>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function afe(){return Ss(Mq).scale(175.295)}function kq(e,t){return[Re(t)*Ne(e),Ne(t)]}kq.invert=Rp(tr);function sfe(){return Ss(kq).scale(249.5).clipAngle(90+Oe)}function Nq(e,t){var n=Re(t),i=1+Re(e)*n;return[n*Ne(e)/i,Ne(t)/i]}Nq.invert=Rp(function(e){return 2*ah(e)});function ofe(){return Ss(Nq).scale(250).clipAngle(142)}function Fq(e,t){return[Sv(UT((en+t)/2)),-e]}Fq.invert=function(e,t){return[-t,2*ah(VI(e))-en]};function ufe(){var e=$q(Fq),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var lfe=Math.abs,YC=Math.cos,Hv=Math.sin,cfe=1e-6,Oq=Math.PI,VC=Oq/2,J8=ffe(2);function e7(e){return e>1?VC:e<-1?-VC:Math.asin(e)}function ffe(e){return e>0?Math.sqrt(e):0}function dfe(e,t){var n=e*Hv(t),i=30,r;do t-=r=(t+Hv(t)-n)/(1+YC(t));while(lfe(r)>cfe&&--i>0);return t/2}function hfe(e,t,n){function i(r,a){return[e*r*YC(a=dfe(n,a)),t*Hv(a)]}return i.invert=function(r,a){return a=e7(a/t),[r/(e*YC(a)),e7((2*a+Hv(2*a))/n)]},i}var gfe=hfe(J8/VC,J8,Oq);function pfe(){return Ss(gfe).scale(169.529)}const mfe=Eq(),XC=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function yfe(e,t){return function n(){const i=t();return i.type=e,i.path=Eq().projection(i),i.copy=i.copy||function(){const r=n();return XC.forEach(a=>{i[a]&&r[a](i[a]())}),r.path.pointRadius(i.path.pointRadius()),r},WU(i)}}function VT(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Gv[e]=yfe(e,t),this):Gv[e]||null}function Rq(e){return e&&e.path||mfe}const Gv={albers:Aq,albersusa:Yce,azimuthalequalarea:Vce,azimuthalequidistant:Xce,conicconformal:Zce,conicequalarea:Pv,conicequidistant:efe,equalEarth:nfe,equirectangular:Kce,gnomonic:ife,identity:rfe,mercator:Wce,mollweide:pfe,naturalEarth1:afe,orthographic:sfe,stereographic:ofe,transversemercator:ufe};for(const e in Gv)VT(e,Gv[e]);function vfe(){}const Xs=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function zq(){var e=1,t=1,n=o;function i(l,f){return f.map(d=>r(l,d))}function r(l,f){var d=[],h=[];return a(l,f,p=>{n(p,l,f),bfe(p)>0?d.push([p]):h.push(p)}),h.forEach(p=>{for(var y=0,v=d.length,b;y<v;++y)if(xfe((b=d[y])[0],p)!==-1){b.push(p);return}}),{type:"MultiPolygon",value:f,coordinates:d}}function a(l,f,d){var h=[],p=[],y,v,b,E,S,w;for(y=v=-1,E=l[0]>=f,Xs[E<<1].forEach(_);++y<e-1;)b=E,E=l[y+1]>=f,Xs[b|E<<1].forEach(_);for(Xs[E<<0].forEach(_);++v<t-1;){for(y=-1,E=l[v*e+e]>=f,S=l[v*e]>=f,Xs[E<<1|S<<2].forEach(_);++y<e-1;)b=E,E=l[v*e+e+y+1]>=f,w=S,S=l[v*e+y+1]>=f,Xs[b|E<<1|S<<2|w<<3].forEach(_);Xs[E|S<<3].forEach(_)}for(y=-1,S=l[v*e]>=f,Xs[S<<2].forEach(_);++y<e-1;)w=S,S=l[v*e+y+1]>=f,Xs[S<<2|w<<3].forEach(_);Xs[S<<3].forEach(_);function _(C){var $=[C[0][0]+y,C[0][1]+v],M=[C[1][0]+y,C[1][1]+v],T=s($),F=s(M),R,B;(R=p[T])?(B=h[F])?(delete p[R.end],delete h[B.start],R===B?(R.ring.push(M),d(R.ring)):h[R.start]=p[B.end]={start:R.start,end:B.end,ring:R.ring.concat(B.ring)}):(delete p[R.end],R.ring.push(M),p[R.end=F]=R):(R=h[F])?(B=p[T])?(delete h[R.start],delete p[B.end],R===B?(R.ring.push(M),d(R.ring)):h[B.start]=p[R.end]={start:B.start,end:R.end,ring:B.ring.concat(R.ring)}):(delete h[R.start],R.ring.unshift($),h[R.start=T]=R):h[T]=p[F]={start:T,end:F,ring:[$,M]}}}function s(l){return l[0]*2+l[1]*(e+1)*4}function o(l,f,d){l.forEach(h=>{var p=h[0],y=h[1],v=p|0,b=y|0,E,S=f[b*e+v];p>0&&p<e&&v===p&&(E=f[b*e+v-1],h[0]=p+(d-E)/(S-E)-.5),y>0&&y<t&&b===y&&(E=f[(b-1)*e+v],h[1]=y+(d-E)/(S-E)-.5)})}return i.contour=r,i.size=function(l){if(!arguments.length)return[e,t];var f=Math.floor(l[0]),d=Math.floor(l[1]);return f>=0&&d>=0||ae("invalid size"),e=f,t=d,i},i.smooth=function(l){return arguments.length?(n=l?o:vfe,i):n===o},i}function bfe(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function xfe(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=Efe(e,t[n]))return r;return 0}function Efe(e,t){for(var n=t[0],i=t[1],r=-1,a=0,s=e.length,o=s-1;a<s;o=a++){var l=e[a],f=l[0],d=l[1],h=e[o],p=h[0],y=h[1];if(Sfe(l,h,t))return 0;d>i!=y>i&&n<(p-f)*(i-d)/(y-d)+f&&(r=-r)}return r}function Sfe(e,t,n){var i;return Afe(e,t,n)&&wfe(e[i=+(e[0]===t[0])],n[i],t[i])}function Afe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function wfe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Bq(e,t,n){return function(i){var r=cs(i),a=n?Math.min(r[0],0):r[0],s=r[1],o=s-a,l=t?ku(a,s,e):o/(e+1);return Er(a+l,s,l)}}function XT(e){te.call(this,null,e)}XT.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};me(XT,te,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||Fi,a=zq().smooth(e.smooth!==!1),s=e.thresholds||_fe(i,r,e),o=e.as===null?null:e.as||"contour",l=[];return i.forEach(f=>{const d=r(f),h=a.size([d.width,d.height])(d.values,De(s)?s:s(d.values));Cfe(h,d,f,e),h.forEach(p=>{l.push(qb(f,bt(o!=null?{[o]:p}:p)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function _fe(e,t,n){const i=Bq(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Xl(t(r).values)))}function Cfe(e,t,n,i){let r=i.scale||t.scale,a=i.translate||t.translate;if(We(r)&&(r=r(n,i)),We(a)&&(a=a(n,i)),(r===1||r==null)&&!a)return;const s=(Tu(r)?r:r[0])||1,o=(Tu(r)?r:r[1])||1,l=a&&a[0]||0,f=a&&a[1]||0;e.forEach(Lq(t,s,o,l,f))}function Lq(e,t,n,i,r){const a=e.x1||0,s=e.y1||0,o=t*n<0;function l(h){h.forEach(f)}function f(h){o&&h.reverse(),h.forEach(d)}function d(h){h[0]=(h[0]-a)*t+i,h[1]=(h[1]-s)*n+r}return function(h){return h.coordinates.forEach(l),h}}function t7(e,t,n){const i=e>=0?e:U$(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Fw(e){return We(e)?e:bi(+e)}function jq(){var e=l=>l[0],t=l=>l[1],n=Xd,i=[-1,-1],r=960,a=500,s=2;function o(l,f){const d=t7(i[0],l,e)>>s,h=t7(i[1],l,t)>>s,p=d?d+2:0,y=h?h+2:0,v=2*p+(r>>s),b=2*y+(a>>s),E=new Float32Array(v*b),S=new Float32Array(v*b);let w=E;l.forEach(C=>{const $=p+(+e(C)>>s),M=y+(+t(C)>>s);$>=0&&$<v&&M>=0&&M<b&&(E[$+M*v]+=+n(C))}),d>0&&h>0?(Bf(v,b,E,S,d),Lf(v,b,S,E,h),Bf(v,b,E,S,d),Lf(v,b,S,E,h),Bf(v,b,E,S,d),Lf(v,b,S,E,h)):d>0?(Bf(v,b,E,S,d),Bf(v,b,S,E,d),Bf(v,b,E,S,d),w=S):h>0&&(Lf(v,b,E,S,h),Lf(v,b,S,E,h),Lf(v,b,E,S,h),w=S);const _=f?Math.pow(2,-2*s):1/JB(w);for(let C=0,$=v*b;C<$;++C)w[C]*=_;return{values:w,scale:1<<s,width:v,height:b,x1:p,y1:y,x2:p+(r>>s),y2:y+(a>>s)}}return o.x=function(l){return arguments.length?(e=Fw(l),o):e},o.y=function(l){return arguments.length?(t=Fw(l),o):t},o.weight=function(l){return arguments.length?(n=Fw(l),o):n},o.size=function(l){if(!arguments.length)return[r,a];var f=+l[0],d=+l[1];return f>=0&&d>=0||ae("invalid size"),r=f,a=d,o},o.cellSize=function(l){return arguments.length?((l=+l)>=1||ae("invalid cell size"),s=Math.floor(Math.log(l)/Math.LN2),o):1<<s},o.bandwidth=function(l){return arguments.length?(l=Fe(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&ae("invalid bandwidth"),i=l,o):i},o}function Bf(e,t,n,i,r){const a=(r<<1)+1;for(let s=0;s<t;++s)for(let o=0,l=0;o<e+r;++o)o<e&&(l+=n[o+s*e]),o>=r&&(o>=a&&(l-=n[o-a+s*e]),i[o-r+s*e]=l/Math.min(o+1,e-1+a-o,a))}function Lf(e,t,n,i,r){const a=(r<<1)+1;for(let s=0;s<e;++s)for(let o=0,l=0;o<t+r;++o)o<t&&(l+=n[s+o*e]),o>=r&&(o>=a&&(l-=n[s+(o-a)*e]),i[s+(o-r)*e]=l/Math.min(o+1,t-1+a-o,a))}function WT(e){te.call(this,null,e)}WT.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const $fe=["x","y","weight","size","cellSize","bandwidth"];function Uq(e,t){return $fe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}me(WT,te,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=Dfe(i,e.groupby),a=(e.groupby||[]).map(tn),s=Uq(jq(),e),o=e.as||"grid",l=[];function f(d,h){for(let p=0;p<a.length;++p)d[a[p]]=h[p];return d}return l=r.map(d=>bt(f({[o]:s(d,e.counts)},d.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function Dfe(e,t){var n=[],i=d=>d(o),r,a,s,o,l,f;if(t==null)n.push(e);else for(r={},a=0,s=e.length;a<s;++a)o=e[a],l=t.map(i),f=r[l],f||(r[l]=f=[],f.dims=l,n.push(f)),f.push(o);return n}function QT(e){te.call(this,null,e)}QT.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};me(QT,te,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=zq().smooth(e.smooth!==!1),r=e.values,a=e.thresholds||Bq(e.count||10,e.nice,!!r),s=e.size,o,l;return r||(r=t.materialize(t.SOURCE).source,o=Uq(jq(),e)(r,!0),l=Lq(o,o.scale||1,o.scale||1,0,0),s=[o.width,o.height],r=o.values),a=De(a)?a:a(r),r=i.size(s)(r,a),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(bt),n}});const WC="Feature",ZT="FeatureCollection",Tfe="MultiPoint";function KT(e){te.call(this,null,e)}KT.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};me(KT,te,{transform(e,t){var n=this._features,i=this._points,r=e.fields,a=r&&r[0],s=r&&r[1],o=e.geojson||!r&&Fi,l=t.ADD,f;f=e.modified()||t.changed(t.REM)||t.modified(hi(o))||a&&t.modified(hi(a))||s&&t.modified(hi(s)),(!this.value||f)&&(l=t.SOURCE,this._features=n=[],this._points=i=[]),o&&t.visit(l,d=>n.push(o(d))),a&&s&&(t.visit(l,d=>{var h=a(d),p=s(d);h!=null&&p!=null&&(h=+h)===h&&(p=+p)===p&&i.push([h,p])}),n=n.concat({type:WC,geometry:{type:Tfe,coordinates:i}})),this.value={type:ZT,features:n}}});function JT(e){te.call(this,null,e)}JT.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};me(JT,te,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||Fi,a=e.as||"path",s=n.SOURCE;!i||e.modified()?(this.value=i=Rq(e.projection),n.materialize().reflow()):s=r===Fi||t.modified(r.fields)?n.ADD_MOD:n.ADD;const o=Mfe(i,e.pointRadius);return n.visit(s,l=>l[a]=i(r(l))),i.pointRadius(o),n.modifies(a)}});function Mfe(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function eM(e){te.call(this,null,e)}eM.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};me(eM,te,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],a=e.as||["x","y"],s=a[0],o=a[1],l;function f(d){const h=n([i(d),r(d)]);h?(d[s]=h[0],d[o]=h[1]):(d[s]=void 0,d[o]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,f):(l=t.modified(i.fields)||t.modified(r.fields),t.visit(l?t.ADD_MOD:t.ADD,f)),t.modifies(a)}});function tM(e){te.call(this,null,e)}tM.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};me(tM,te,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",a=n.ADD;return(!i||e.modified())&&(this.value=i=kfe(Rq(e.projection),e.field||Qr("datum"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,s=>s[r]=i),n.modifies(r)}});function kfe(e,t,n){const i=n==null?r=>e(t(r)):r=>{var a=e.pointRadius(),s=e.pointRadius(n)(t(r));return e.pointRadius(a),s};return i.context=r=>(e.context(r),i),i}function nM(e){te.call(this,[],e),this.generator=_ce()}nM.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};me(nM,te,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const a in e)We(i[a])&&i[a](e[a]);return r=i(),n.length?t.mod.push(XL(n[0],r)):t.add.push(bt(r)),n[0]=r,t}});function iM(e){te.call(this,null,e)}iM.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};me(iM,te,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||Fi,a=Ffe(e.opacity,e),s=Nfe(e.color,e),o=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?Xl(n.map(f=>Xl(r(f).values))):0};return n.forEach(f=>{const d=r(f),h=Ve({},f,l);i||(h.$max=Xl(d.values||[])),f[o]=Ofe(d,h,s.dep?s:bi(s(h)),a.dep?a:bi(a(h)))}),t.reflow(!0).modifies(o)}});function Nfe(e,t){let n;return We(e)?(n=i=>Ou(e(i,t)),n.dep=Pq(e)):n=bi(Ou(e||"#888")),n}function Ffe(e,t){let n;return We(e)?(n=i=>e(i,t),n.dep=Pq(e)):e?n=bi(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function Pq(e){if(!We(e))return!1;const t=wa(hi(e));return t.$x||t.$y||t.$value||t.$max}function Ofe(e,t,n,i){const r=e.width,a=e.height,s=e.x1||0,o=e.y1||0,l=e.x2||r,f=e.y2||a,d=e.values,h=d?E=>d[E]:du,p=Cu(l-s,f-o),y=p.getContext("2d"),v=y.getImageData(0,0,l-s,f-o),b=v.data;for(let E=o,S=0;E<f;++E){t.$y=E-o;for(let w=s,_=E*r;w<l;++w,S+=4){t.$x=w-s,t.$value=h(w+_);const C=n(t);b[S+0]=C.r,b[S+1]=C.g,b[S+2]=C.b,b[S+3]=~~(255*i(t))}}return y.putImageData(v,0,0),p}function Iq(e){te.call(this,null,e),this.modified(!0)}me(Iq,te,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=zfe(e.type),XC.forEach(i=>{e[i]!=null&&n7(n,i,e[i])})):XC.forEach(i=>{e.modified(i)&&n7(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Rfe(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Rfe(e,t){const n=Bfe(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function zfe(e){const t=VT((e||"mercator").toLowerCase());return t||ae("Unrecognized projection type: "+e),t()}function n7(e,t,n){We(e[t])&&e[t](n)}function Bfe(e){return e=Fe(e),e.length===1?e[0]:{type:ZT,features:e.reduce((t,n)=>t.concat(Lfe(n)),[])}}function Lfe(e){return e.type===ZT?e.features:Fe(e).filter(t=>t!=null).map(t=>t.type===WC?t:{type:WC,geometry:t})}const jfe=Object.freeze(Object.defineProperty({__proto__:null,contour:QT,geojson:KT,geopath:JT,geopoint:eM,geoshape:tM,graticule:nM,heatmap:iM,isocontour:XT,kde2d:WT,projection:Iq},Symbol.toStringTag,{value:"Module"}));function Ufe(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var a,s=n.length,o,l=0,f=0;for(a=0;a<s;++a)o=n[a],l+=o.x,f+=o.y;for(l=(l/s-e)*i,f=(f/s-t)*i,a=0;a<s;++a)o=n[a],o.x-=l,o.y-=f}return r.initialize=function(a){n=a},r.x=function(a){return arguments.length?(e=+a,r):e},r.y=function(a){return arguments.length?(t=+a,r):t},r.strength=function(a){return arguments.length?(i=+a,r):i},r}function Pfe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return qq(this.cover(t,n),t,n,e)}function qq(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,a=e._root,s={data:i},o=e._x0,l=e._y0,f=e._x1,d=e._y1,h,p,y,v,b,E,S,w;if(!a)return e._root=s,e;for(;a.length;)if((b=t>=(h=(o+f)/2))?o=h:f=h,(E=n>=(p=(l+d)/2))?l=p:d=p,r=a,!(a=a[S=E<<1|b]))return r[S]=s,e;if(y=+e._x.call(null,a.data),v=+e._y.call(null,a.data),t===y&&n===v)return s.next=a,r?r[S]=s:e._root=s,e;do r=r?r[S]=new Array(4):e._root=new Array(4),(b=t>=(h=(o+f)/2))?o=h:f=h,(E=n>=(p=(l+d)/2))?l=p:d=p;while((S=E<<1|b)===(w=(v>=p)<<1|y>=h));return r[w]=a,r[S]=s,e}function Ife(e){var t,n,i=e.length,r,a,s=new Array(i),o=new Array(i),l=1/0,f=1/0,d=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(s[n]=r,o[n]=a,r<l&&(l=r),r>d&&(d=r),a<f&&(f=a),a>h&&(h=a));if(l>d||f>h)return this;for(this.cover(l,f).cover(d,h),n=0;n<i;++n)qq(this,s[n],o[n],e[n]);return this}function qfe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,a=(i=Math.floor(t))+1;else{for(var s=r-n||1,o=this._root,l,f;n>e||e>=r||i>t||t>=a;)switch(f=(t<i)<<1|e<n,l=new Array(4),l[f]=o,o=l,s*=2,f){case 0:r=n+s,a=i+s;break;case 1:n=r-s,a=i+s;break;case 2:r=n+s,i=a-s;break;case 3:n=r-s,i=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this}function Hfe(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Gfe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Di(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function Yfe(e,t,n){var i,r=this._x0,a=this._y0,s,o,l,f,d=this._x1,h=this._y1,p=[],y=this._root,v,b;for(y&&p.push(new Di(y,r,a,d,h)),n==null?n=1/0:(r=e-n,a=t-n,d=e+n,h=t+n,n*=n);v=p.pop();)if(!(!(y=v.node)||(s=v.x0)>d||(o=v.y0)>h||(l=v.x1)<r||(f=v.y1)<a))if(y.length){var E=(s+l)/2,S=(o+f)/2;p.push(new Di(y[3],E,S,l,f),new Di(y[2],s,S,E,f),new Di(y[1],E,o,l,S),new Di(y[0],s,o,E,S)),(b=(t>=S)<<1|e>=E)&&(v=p[p.length-1],p[p.length-1]=p[p.length-1-b],p[p.length-1-b]=v)}else{var w=e-+this._x.call(null,y.data),_=t-+this._y.call(null,y.data),C=w*w+_*_;if(C<n){var $=Math.sqrt(n=C);r=e-$,a=t-$,d=e+$,h=t+$,i=y.data}}return i}function Vfe(e){if(isNaN(d=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var t,n=this._root,i,r,a,s=this._x0,o=this._y0,l=this._x1,f=this._y1,d,h,p,y,v,b,E,S;if(!n)return this;if(n.length)for(;;){if((v=d>=(p=(s+l)/2))?s=p:l=p,(b=h>=(y=(o+f)/2))?o=y:f=y,t=n,!(n=n[E=b<<1|v]))return this;if(!n.length)break;(t[E+1&3]||t[E+2&3]||t[E+3&3])&&(i=t,S=E)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,r?(a?r.next=a:delete r.next,this):t?(a?t[E]=a:delete t[E],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[S]=n:this._root=n),this):(this._root=a,this)}function Xfe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Wfe(){return this._root}function Qfe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Zfe(e){var t=[],n,i=this._root,r,a,s,o,l;for(i&&t.push(new Di(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,a=n.x0,s=n.y0,o=n.x1,l=n.y1)&&i.length){var f=(a+o)/2,d=(s+l)/2;(r=i[3])&&t.push(new Di(r,f,d,o,l)),(r=i[2])&&t.push(new Di(r,a,d,f,l)),(r=i[1])&&t.push(new Di(r,f,s,o,d)),(r=i[0])&&t.push(new Di(r,a,s,f,d))}return this}function Kfe(e){var t=[],n=[],i;for(this._root&&t.push(new Di(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var a,s=i.x0,o=i.y0,l=i.x1,f=i.y1,d=(s+l)/2,h=(o+f)/2;(a=r[0])&&t.push(new Di(a,s,o,d,h)),(a=r[1])&&t.push(new Di(a,d,o,l,h)),(a=r[2])&&t.push(new Di(a,s,h,d,f)),(a=r[3])&&t.push(new Di(a,d,h,l,f))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Jfe(e){return e[0]}function ede(e){return arguments.length?(this._x=e,this):this._x}function tde(e){return e[1]}function nde(e){return arguments.length?(this._y=e,this):this._y}function rM(e,t,n){var i=new aM(t??Jfe,n??tde,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function aM(e,t,n,i,r,a){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function i7(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Li=rM.prototype=aM.prototype;Li.copy=function(){var e=new aM(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=i7(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=i7(i));return e};Li.add=Pfe;Li.addAll=Ife;Li.cover=qfe;Li.data=Hfe;Li.extent=Gfe;Li.find=Yfe;Li.remove=Vfe;Li.removeAll=Xfe;Li.root=Wfe;Li.size=Qfe;Li.visit=Zfe;Li.visitAfter=Kfe;Li.x=ede;Li.y=nde;function Ti(e){return function(){return e}}function xu(e){return(e()-.5)*1e-6}function ide(e){return e.x+e.vx}function rde(e){return e.y+e.vy}function ade(e){var t,n,i,r=1,a=1;typeof e!="function"&&(e=Ti(e==null?1:+e));function s(){for(var f,d=t.length,h,p,y,v,b,E,S=0;S<a;++S)for(h=rM(t,ide,rde).visitAfter(o),f=0;f<d;++f)p=t[f],b=n[p.index],E=b*b,y=p.x+p.vx,v=p.y+p.vy,h.visit(w);function w(_,C,$,M,T){var F=_.data,R=_.r,B=b+R;if(F){if(F.index>p.index){var L=y-F.x-F.vx,Y=v-F.y-F.vy,H=L*L+Y*Y;H<B*B&&(L===0&&(L=xu(i),H+=L*L),Y===0&&(Y=xu(i),H+=Y*Y),H=(B-(H=Math.sqrt(H)))/H*r,p.vx+=(L*=H)*(B=(R*=R)/(E+R)),p.vy+=(Y*=H)*B,F.vx-=L*(B=1-B),F.vy-=Y*B)}return}return C>y+B||M<y-B||$>v+B||T<v-B}}function o(f){if(f.data)return f.r=n[f.data.index];for(var d=f.r=0;d<4;++d)f[d]&&f[d].r>f.r&&(f.r=f[d].r)}function l(){if(t){var f,d=t.length,h;for(n=new Array(d),f=0;f<d;++f)h=t[f],n[h.index]=+e(h,f,t)}}return s.initialize=function(f,d){t=f,i=d,l()},s.iterations=function(f){return arguments.length?(a=+f,s):a},s.strength=function(f){return arguments.length?(r=+f,s):r},s.radius=function(f){return arguments.length?(e=typeof f=="function"?f:Ti(+f),l(),s):e},s}function sde(e){return e.index}function r7(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function ode(e){var t=sde,n=h,i,r=Ti(30),a,s,o,l,f,d=1;e==null&&(e=[]);function h(E){return 1/Math.min(o[E.source.index],o[E.target.index])}function p(E){for(var S=0,w=e.length;S<d;++S)for(var _=0,C,$,M,T,F,R,B;_<w;++_)C=e[_],$=C.source,M=C.target,T=M.x+M.vx-$.x-$.vx||xu(f),F=M.y+M.vy-$.y-$.vy||xu(f),R=Math.sqrt(T*T+F*F),R=(R-a[_])/R*E*i[_],T*=R,F*=R,M.vx-=T*(B=l[_]),M.vy-=F*B,$.vx+=T*(B=1-B),$.vy+=F*B}function y(){if(s){var E,S=s.length,w=e.length,_=new Map(s.map(($,M)=>[t($,M,s),$])),C;for(E=0,o=new Array(S);E<w;++E)C=e[E],C.index=E,typeof C.source!="object"&&(C.source=r7(_,C.source)),typeof C.target!="object"&&(C.target=r7(_,C.target)),o[C.source.index]=(o[C.source.index]||0)+1,o[C.target.index]=(o[C.target.index]||0)+1;for(E=0,l=new Array(w);E<w;++E)C=e[E],l[E]=o[C.source.index]/(o[C.source.index]+o[C.target.index]);i=new Array(w),v(),a=new Array(w),b()}}function v(){if(s)for(var E=0,S=e.length;E<S;++E)i[E]=+n(e[E],E,e)}function b(){if(s)for(var E=0,S=e.length;E<S;++E)a[E]=+r(e[E],E,e)}return p.initialize=function(E,S){s=E,f=S,y()},p.links=function(E){return arguments.length?(e=E,y(),p):e},p.id=function(E){return arguments.length?(t=E,p):t},p.iterations=function(E){return arguments.length?(d=+E,p):d},p.strength=function(E){return arguments.length?(n=typeof E=="function"?E:Ti(+E),v(),p):n},p.distance=function(E){return arguments.length?(r=typeof E=="function"?E:Ti(+E),b(),p):r},p}var ude={value:()=>{}};function Hq(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new _y(n)}function _y(e){this._=e}function lde(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}_y.prototype=Hq.prototype={constructor:_y,on:function(e,t){var n=this._,i=lde(e+"",n),r,a=-1,s=i.length;if(arguments.length<2){for(;++a<s;)if((r=(e=i[a]).type)&&(r=cde(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<s;)if(r=(e=i[a]).type)n[r]=a7(n[r],e.name,t);else if(t==null)for(r in n)n[r]=a7(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new _y(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,a;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],i=0,r=a.length;i<r;++i)a[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,a=i.length;r<a;++r)i[r].value.apply(t,n)}};function cde(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function a7(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=ude,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Td=0,ig=0,M0=0,Gq=1e3,Yv,rg,Vv=0,cc=0,$x=0,Hg=typeof performance=="object"&&performance.now?performance:Date,Yq=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function sM(){return cc||(Yq(fde),cc=Hg.now()+$x)}function fde(){cc=0}function Xv(){this._call=this._time=this._next=null}Xv.prototype=Vq.prototype={constructor:Xv,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?sM():+n)+(t==null?0:+t),!this._next&&rg!==this&&(rg?rg._next=this:Yv=this,rg=this),this._call=e,this._time=n,QC()},stop:function(){this._call&&(this._call=null,this._time=1/0,QC())}};function Vq(e,t,n){var i=new Xv;return i.restart(e,t,n),i}function dde(){sM(),++Td;for(var e=Yv,t;e;)(t=cc-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Td}function s7(){cc=(Vv=Hg.now())+$x,Td=ig=0;try{dde()}finally{Td=0,gde(),cc=0}}function hde(){var e=Hg.now(),t=e-Vv;t>Gq&&($x-=t,Vv=e)}function gde(){for(var e,t=Yv,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Yv=n);rg=e,QC(i)}function QC(e){if(!Td){ig&&(ig=clearTimeout(ig));var t=e-cc;t>24?(e<1/0&&(ig=setTimeout(s7,e-Hg.now()-$x)),M0&&(M0=clearInterval(M0))):(M0||(Vv=Hg.now(),M0=setInterval(hde,Gq)),Td=1,Yq(s7))}}function pde(e,t,n){var i=new Xv,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(a,s,o){s=+s,o=o==null?sM():+o,i._restart(function l(f){f+=r,i._restart(l,r+=s,o),a(f)},s,o)},i.restart(e,t,n),i)}const mde=1664525,yde=1013904223,o7=4294967296;function vde(){let e=1;return()=>(e=(mde*e+yde)%o7)/o7}function bde(e){return e.x}function xde(e){return e.y}var Ede=10,Sde=Math.PI*(3-Math.sqrt(5));function Ade(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,s=.6,o=new Map,l=Vq(h),f=Hq("tick","end"),d=vde();e==null&&(e=[]);function h(){p(),f.call("tick",t),n<i&&(l.stop(),f.call("end",t))}function p(b){var E,S=e.length,w;b===void 0&&(b=1);for(var _=0;_<b;++_)for(n+=(a-n)*r,o.forEach(function(C){C(n)}),E=0;E<S;++E)w=e[E],w.fx==null?w.x+=w.vx*=s:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=s:(w.y=w.fy,w.vy=0);return t}function y(){for(var b=0,E=e.length,S;b<E;++b){if(S=e[b],S.index=b,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var w=Ede*Math.sqrt(.5+b),_=b*Sde;S.x=w*Math.cos(_),S.y=w*Math.sin(_)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function v(b){return b.initialize&&b.initialize(e,d),b}return y(),t={tick:p,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(b){return arguments.length?(e=b,y(),o.forEach(v),t):e},alpha:function(b){return arguments.length?(n=+b,t):n},alphaMin:function(b){return arguments.length?(i=+b,t):i},alphaDecay:function(b){return arguments.length?(r=+b,t):+r},alphaTarget:function(b){return arguments.length?(a=+b,t):a},velocityDecay:function(b){return arguments.length?(s=1-b,t):1-s},randomSource:function(b){return arguments.length?(d=b,o.forEach(v),t):d},force:function(b,E){return arguments.length>1?(E==null?o.delete(b):o.set(b,v(E)),t):o.get(b)},find:function(b,E,S){var w=0,_=e.length,C,$,M,T,F;for(S==null?S=1/0:S*=S,w=0;w<_;++w)T=e[w],C=b-T.x,$=E-T.y,M=C*C+$*$,M<S&&(F=T,S=M);return F},on:function(b,E){return arguments.length>1?(f.on(b,E),t):f.on(b)}}}function wde(){var e,t,n,i,r=Ti(-30),a,s=1,o=1/0,l=.81;function f(y){var v,b=e.length,E=rM(e,bde,xde).visitAfter(h);for(i=y,v=0;v<b;++v)t=e[v],E.visit(p)}function d(){if(e){var y,v=e.length,b;for(a=new Array(v),y=0;y<v;++y)b=e[y],a[b.index]=+r(b,y,e)}}function h(y){var v=0,b,E,S=0,w,_,C;if(y.length){for(w=_=C=0;C<4;++C)(b=y[C])&&(E=Math.abs(b.value))&&(v+=b.value,S+=E,w+=E*b.x,_+=E*b.y);y.x=w/S,y.y=_/S}else{b=y,b.x=b.data.x,b.y=b.data.y;do v+=a[b.data.index];while(b=b.next)}y.value=v}function p(y,v,b,E){if(!y.value)return!0;var S=y.x-t.x,w=y.y-t.y,_=E-v,C=S*S+w*w;if(_*_/l<C)return C<o&&(S===0&&(S=xu(n),C+=S*S),w===0&&(w=xu(n),C+=w*w),C<s&&(C=Math.sqrt(s*C)),t.vx+=S*y.value*i/C,t.vy+=w*y.value*i/C),!0;if(y.length||C>=o)return;(y.data!==t||y.next)&&(S===0&&(S=xu(n),C+=S*S),w===0&&(w=xu(n),C+=w*w),C<s&&(C=Math.sqrt(s*C)));do y.data!==t&&(_=a[y.data.index]*i/C,t.vx+=S*_,t.vy+=w*_);while(y=y.next)}return f.initialize=function(y,v){e=y,n=v,d()},f.strength=function(y){return arguments.length?(r=typeof y=="function"?y:Ti(+y),d(),f):r},f.distanceMin=function(y){return arguments.length?(s=y*y,f):Math.sqrt(s)},f.distanceMax=function(y){return arguments.length?(o=y*y,f):Math.sqrt(o)},f.theta=function(y){return arguments.length?(l=y*y,f):Math.sqrt(l)},f}function _de(e){var t=Ti(.1),n,i,r;typeof e!="function"&&(e=Ti(e==null?0:+e));function a(o){for(var l=0,f=n.length,d;l<f;++l)d=n[l],d.vx+=(r[l]-d.x)*i[l]*o}function s(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return a.initialize=function(o){n=o,s()},a.strength=function(o){return arguments.length?(t=typeof o=="function"?o:Ti(+o),s(),a):t},a.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ti(+o),s(),a):e},a}function Cde(e){var t=Ti(.1),n,i,r;typeof e!="function"&&(e=Ti(e==null?0:+e));function a(o){for(var l=0,f=n.length,d;l<f;++l)d=n[l],d.vy+=(r[l]-d.y)*i[l]*o}function s(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return a.initialize=function(o){n=o,s()},a.strength=function(o){return arguments.length?(t=typeof o=="function"?o:Ti(+o),s(),a):t},a.y=function(o){return arguments.length?(e=typeof o=="function"?o:Ti(+o),s(),a):e},a}const u7={center:Ufe,collide:ade,nbody:wde,link:ode,x:_de,y:Cde},ag="forces",ZC=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],$de=["static","iterations"],Xq=["x","y","vx","vy"];function oM(e){te.call(this,null,e)}oM.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Xq}]};me(oM,te,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(ZC),a=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&Wq(n,e,0,t)):(this.value=n=Tde(t.source,e),n.on("tick",Dde(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified($de)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let o=this._argops,l=0,f=o.length,d;l<f;++l)if(d=o[l],!(d.name!==ag||d.op._argval.force!=="link")){for(var i=d.op._argops,r=0,a=i.length,s;r<a;++r)if(i[r].name==="links"&&(s=i[r].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(Xq)}});function Dde(e,t){return()=>e.touch(t).run()}function Tde(e,t){const n=Ade(e),i=n.stop,r=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,r()),n.stop=()=>(a=!0,i()),Wq(n,t,!0).on("end",()=>a=!0)}function Wq(e,t,n,i){var r=Fe(t.forces),a,s,o,l;for(a=0,s=ZC.length;a<s;++a)o=ZC[a],o!==ag&&t.modified(o)&&e[o](t[o]);for(a=0,s=r.length;a<s;++a)l=ag+a,o=n||t.modified(ag,a)?kde(r[a]):i&&Mde(r[a],i)?e.force(l):null,o&&e.force(l,o);for(s=e.numForces||0;a<s;++a)e.force(ag+a,null);return e.numForces=r.length,e}function Mde(e,t){var n,i;for(n in e)if(We(i=e[n])&&t.modified(hi(i)))return 1;return 0}function kde(e){var t,n;ze(u7,e.force)||ae("Unrecognized force: "+e.force),t=u7[e.force]();for(n in e)We(t[n])&&Nde(t[n],e[n],e);return t}function Nde(e,t,n){e(We(t)?i=>t(i,n):t)}const Fde=Object.freeze(Object.defineProperty({__proto__:null,force:oM},Symbol.toStringTag,{value:"Module"}));function Ode(e,t){return e.parent===t.parent?1:2}function Rde(e){return e.reduce(zde,0)/e.length}function zde(e,t){return e+t.x}function Bde(e){return 1+e.reduce(Lde,0)}function Lde(e,t){return Math.max(e,t.y)}function jde(e){for(var t;t=e.children;)e=t[0];return e}function Ude(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Pde(){var e=Ode,t=1,n=1,i=!1;function r(a){var s,o=0;a.eachAfter(function(p){var y=p.children;y?(p.x=Rde(y),p.y=Bde(y)):(p.x=s?o+=e(p,s):0,p.y=0,s=p)});var l=jde(a),f=Ude(a),d=l.x-e(l,f)/2,h=f.x+e(f,l)/2;return a.eachAfter(i?function(p){p.x=(p.x-a.x)*t,p.y=(a.y-p.y)*n}:function(p){p.x=(p.x-d)/(h-d)*t,p.y=(1-(a.y?p.y/a.y:1))*n})}return r.separation=function(a){return arguments.length?(e=a,r):e},r.size=function(a){return arguments.length?(i=!1,t=+a[0],n=+a[1],r):i?null:[t,n]},r.nodeSize=function(a){return arguments.length?(i=!0,t=+a[0],n=+a[1],r):i?[t,n]:null},r}function Ide(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function qde(){return this.eachAfter(Ide)}function Hde(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function Gde(e,t){for(var n=this,i=[n],r,a,s=-1;n=i.pop();)if(e.call(t,n,++s,this),r=n.children)for(a=r.length-1;a>=0;--a)i.push(r[a]);return this}function Yde(e,t){for(var n=this,i=[n],r=[],a,s,o,l=-1;n=i.pop();)if(r.push(n),a=n.children)for(s=0,o=a.length;s<o;++s)i.push(a[s]);for(;n=r.pop();)e.call(t,n,++l,this);return this}function Vde(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function Xde(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function Wde(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Qde(e){for(var t=this,n=Zde(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function Zde(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function Kde(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Jde(){return Array.from(this)}function ehe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function the(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*nhe(){var e=this,t,n=[e],i,r,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,a=i.length;r<a;++r)n.push(i[r]);while(n.length)}function uM(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=ahe)):t===void 0&&(t=rhe);for(var n=new Md(e),i,r=[n],a,s,o,l;i=r.pop();)if((s=t(i.data))&&(l=(s=Array.from(s)).length))for(i.children=s,o=l-1;o>=0;--o)r.push(a=s[o]=new Md(s[o])),a.parent=i,a.depth=i.depth+1;return n.eachBefore(Qq)}function ihe(){return uM(this).eachBefore(she)}function rhe(e){return e.children}function ahe(e){return Array.isArray(e)?e[1]:null}function she(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Qq(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Md(e){this.data=e,this.depth=this.height=0,this.parent=null}Md.prototype=uM.prototype={constructor:Md,count:qde,each:Hde,eachAfter:Yde,eachBefore:Gde,find:Vde,sum:Xde,sort:Wde,path:Qde,ancestors:Kde,descendants:Jde,leaves:ehe,links:the,copy:ihe,[Symbol.iterator]:nhe};function Cy(e){return e==null?null:Zq(e)}function Zq(e){if(typeof e!="function")throw new Error;return e}function Ul(){return 0}function Gf(e){return function(){return e}}const ohe=1664525,uhe=1013904223,l7=4294967296;function lhe(){let e=1;return()=>(e=(ohe*e+uhe)%l7)/l7}function che(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fhe(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function dhe(e,t){for(var n=0,i=(e=fhe(Array.from(e),t)).length,r=[],a,s;n<i;)a=e[n],s&&Kq(s,a)?++n:(s=ghe(r=hhe(r,a)),n=0);return s}function hhe(e,t){var n,i;if(Ow(t,e))return[t];for(n=0;n<e.length;++n)if(G1(t,e[n])&&Ow(sg(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(G1(sg(e[n],e[i]),t)&&G1(sg(e[n],t),e[i])&&G1(sg(e[i],t),e[n])&&Ow(Jq(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function G1(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function Kq(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Ow(e,t){for(var n=0;n<t.length;++n)if(!Kq(e,t[n]))return!1;return!0}function ghe(e){switch(e.length){case 1:return phe(e[0]);case 2:return sg(e[0],e[1]);case 3:return Jq(e[0],e[1],e[2])}}function phe(e){return{x:e.x,y:e.y,r:e.r}}function sg(e,t){var n=e.x,i=e.y,r=e.r,a=t.x,s=t.y,o=t.r,l=a-n,f=s-i,d=o-r,h=Math.sqrt(l*l+f*f);return{x:(n+a+l/h*d)/2,y:(i+s+f/h*d)/2,r:(h+r+o)/2}}function Jq(e,t,n){var i=e.x,r=e.y,a=e.r,s=t.x,o=t.y,l=t.r,f=n.x,d=n.y,h=n.r,p=i-s,y=i-f,v=r-o,b=r-d,E=l-a,S=h-a,w=i*i+r*r-a*a,_=w-s*s-o*o+l*l,C=w-f*f-d*d+h*h,$=y*v-p*b,M=(v*C-b*_)/($*2)-i,T=(b*E-v*S)/$,F=(y*_-p*C)/($*2)-r,R=(p*S-y*E)/$,B=T*T+R*R-1,L=2*(a+M*T+F*R),Y=M*M+F*F-a*a,H=-(Math.abs(B)>1e-6?(L+Math.sqrt(L*L-4*B*Y))/(2*B):Y/L);return{x:i+M+T*H,y:r+F+R*H,r:H}}function c7(e,t,n){var i=e.x-t.x,r,a,s=e.y-t.y,o,l,f=i*i+s*s;f?(a=t.r+n.r,a*=a,l=e.r+n.r,l*=l,a>l?(r=(f+l-a)/(2*f),o=Math.sqrt(Math.max(0,l/f-r*r)),n.x=e.x-r*i-o*s,n.y=e.y-r*s+o*i):(r=(f+a-l)/(2*f),o=Math.sqrt(Math.max(0,a/f-r*r)),n.x=t.x+r*i-o*s,n.y=t.y+r*s+o*i)):(n.x=t.x+n.r,n.y=t.y)}function f7(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function d7(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,a=(t.y*n.r+n.y*t.r)/i;return r*r+a*a}function Y1(e){this._=e,this.next=null,this.previous=null}function mhe(e,t){if(!(a=(e=che(e)).length))return 0;var n,i,r,a,s,o,l,f,d,h,p;if(n=e[0],n.x=0,n.y=0,!(a>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(a>2))return n.r+i.r;c7(i,n,r=e[2]),n=new Y1(n),i=new Y1(i),r=new Y1(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(l=3;l<a;++l){c7(n._,i._,r=e[l]),r=new Y1(r),f=i.next,d=n.previous,h=i._.r,p=n._.r;do if(h<=p){if(f7(f._,r._)){i=f,n.next=i,i.previous=n,--l;continue e}h+=f._.r,f=f.next}else{if(f7(d._,r._)){n=d,n.next=i,i.previous=n,--l;continue e}p+=d._.r,d=d.previous}while(f!==d.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,s=d7(n);(r=r.next)!==i;)(o=d7(r))<s&&(n=r,s=o);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=dhe(n,t),l=0;l<a;++l)n=e[l],n.x-=r.x,n.y-=r.y;return r.r}function yhe(e){return Math.sqrt(e.value)}function vhe(){var e=null,t=1,n=1,i=Ul;function r(a){const s=lhe();return a.x=t/2,a.y=n/2,e?a.eachBefore(h7(e)).eachAfter(Rw(i,.5,s)).eachBefore(g7(1)):a.eachBefore(h7(yhe)).eachAfter(Rw(Ul,1,s)).eachAfter(Rw(i,a.r/Math.min(t,n),s)).eachBefore(g7(Math.min(t,n)/(2*a.r))),a}return r.radius=function(a){return arguments.length?(e=Cy(a),r):e},r.size=function(a){return arguments.length?(t=+a[0],n=+a[1],r):[t,n]},r.padding=function(a){return arguments.length?(i=typeof a=="function"?a:Gf(+a),r):i},r}function h7(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Rw(e,t,n){return function(i){if(r=i.children){var r,a,s=r.length,o=e(i)*t||0,l;if(o)for(a=0;a<s;++a)r[a].r+=o;if(l=mhe(r,n),o)for(a=0;a<s;++a)r[a].r-=o;i.r=l+o}}}function g7(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function eH(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function zp(e,t,n,i,r){for(var a=e.children,s,o=-1,l=a.length,f=e.value&&(i-t)/e.value;++o<l;)s=a[o],s.y0=n,s.y1=r,s.x0=t,s.x1=t+=s.value*f}function bhe(){var e=1,t=1,n=0,i=!1;function r(s){var o=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/o,s.eachBefore(a(t,o)),i&&s.eachBefore(eH),s}function a(s,o){return function(l){l.children&&zp(l,l.x0,s*(l.depth+1)/o,l.x1,s*(l.depth+2)/o);var f=l.x0,d=l.y0,h=l.x1-n,p=l.y1-n;h<f&&(f=h=(f+h)/2),p<d&&(d=p=(d+p)/2),l.x0=f,l.y0=d,l.x1=h,l.y1=p}}return r.round=function(s){return arguments.length?(i=!!s,r):i},r.size=function(s){return arguments.length?(e=+s[0],t=+s[1],r):[e,t]},r.padding=function(s){return arguments.length?(n=+s,r):n},r}var xhe={depth:-1},p7={},zw={};function Ehe(e){return e.id}function She(e){return e.parentId}function m7(){var e=Ehe,t=She,n;function i(r){var a=Array.from(r),s=e,o=t,l,f,d,h,p,y,v,b,E=new Map;if(n!=null){const S=a.map((C,$)=>Ahe(n(C,$,r))),w=S.map(y7),_=new Set(S).add("");for(const C of w)_.has(C)||(_.add(C),S.push(C),w.push(y7(C)),a.push(zw));s=(C,$)=>S[$],o=(C,$)=>w[$]}for(d=0,l=a.length;d<l;++d)f=a[d],y=a[d]=new Md(f),(v=s(f,d,r))!=null&&(v+="")&&(b=y.id=v,E.set(b,E.has(b)?p7:y)),(v=o(f,d,r))!=null&&(v+="")&&(y.parent=v);for(d=0;d<l;++d)if(y=a[d],v=y.parent){if(p=E.get(v),!p)throw new Error("missing: "+v);if(p===p7)throw new Error("ambiguous: "+v);p.children?p.children.push(y):p.children=[y],y.parent=p}else{if(h)throw new Error("multiple roots");h=y}if(!h)throw new Error("no root");if(n!=null){for(;h.data===zw&&h.children.length===1;)h=h.children[0],--l;for(let S=a.length-1;S>=0&&(y=a[S],y.data===zw);--S)y.data=null}if(h.parent=xhe,h.eachBefore(function(S){S.depth=S.parent.depth+1,--l}).eachBefore(Qq),h.parent=null,l>0)throw new Error("cycle");return h}return i.id=function(r){return arguments.length?(e=Cy(r),i):e},i.parentId=function(r){return arguments.length?(t=Cy(r),i):t},i.path=function(r){return arguments.length?(n=Cy(r),i):n},i}function Ahe(e){e=`${e}`;let t=e.length;return KC(e,t-1)&&!KC(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function y7(e){let t=e.length;if(t<2)return"";for(;--t>1&&!KC(e,t););return e.slice(0,t)}function KC(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}function whe(e,t){return e.parent===t.parent?1:2}function Bw(e){var t=e.children;return t?t[0]:e.t}function Lw(e){var t=e.children;return t?t[t.length-1]:e.t}function _he(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Che(e){for(var t=0,n=0,i=e.children,r=i.length,a;--r>=0;)a=i[r],a.z+=t,a.m+=t,t+=a.s+(n+=a.c)}function $he(e,t,n){return e.a.parent===t.parent?e.a:n}function $y(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}$y.prototype=Object.create(Md.prototype);function Dhe(e){for(var t=new $y(e,0),n,i=[t],r,a,s,o;n=i.pop();)if(a=n._.children)for(n.children=new Array(o=a.length),s=o-1;s>=0;--s)i.push(r=n.children[s]=new $y(a[s],s)),r.parent=n;return(t.parent=new $y(null,0)).children=[t],t}function The(){var e=whe,t=1,n=1,i=null;function r(f){var d=Dhe(f);if(d.eachAfter(a),d.parent.m=-d.z,d.eachBefore(s),i)f.eachBefore(l);else{var h=f,p=f,y=f;f.eachBefore(function(w){w.x<h.x&&(h=w),w.x>p.x&&(p=w),w.depth>y.depth&&(y=w)});var v=h===p?1:e(h,p)/2,b=v-h.x,E=t/(p.x+v+b),S=n/(y.depth||1);f.eachBefore(function(w){w.x=(w.x+b)*E,w.y=w.depth*S})}return f}function a(f){var d=f.children,h=f.parent.children,p=f.i?h[f.i-1]:null;if(d){Che(f);var y=(d[0].z+d[d.length-1].z)/2;p?(f.z=p.z+e(f._,p._),f.m=f.z-y):f.z=y}else p&&(f.z=p.z+e(f._,p._));f.parent.A=o(f,p,f.parent.A||h[0])}function s(f){f._.x=f.z+f.parent.m,f.m+=f.parent.m}function o(f,d,h){if(d){for(var p=f,y=f,v=d,b=p.parent.children[0],E=p.m,S=y.m,w=v.m,_=b.m,C;v=Lw(v),p=Bw(p),v&&p;)b=Bw(b),y=Lw(y),y.a=f,C=v.z+w-p.z-E+e(v._,p._),C>0&&(_he($he(v,f,h),f,C),E+=C,S+=C),w+=v.m,E+=p.m,_+=b.m,S+=y.m;v&&!Lw(y)&&(y.t=v,y.m+=w-S),p&&!Bw(b)&&(b.t=p,b.m+=E-_,h=f)}return h}function l(f){f.x*=t,f.y=f.depth*n}return r.separation=function(f){return arguments.length?(e=f,r):e},r.size=function(f){return arguments.length?(i=!1,t=+f[0],n=+f[1],r):i?null:[t,n]},r.nodeSize=function(f){return arguments.length?(i=!0,t=+f[0],n=+f[1],r):i?[t,n]:null},r}function Dx(e,t,n,i,r){for(var a=e.children,s,o=-1,l=a.length,f=e.value&&(r-n)/e.value;++o<l;)s=a[o],s.x0=t,s.x1=i,s.y0=n,s.y1=n+=s.value*f}var tH=(1+Math.sqrt(5))/2;function nH(e,t,n,i,r,a){for(var s=[],o=t.children,l,f,d=0,h=0,p=o.length,y,v,b=t.value,E,S,w,_,C,$,M;d<p;){y=r-n,v=a-i;do E=o[h++].value;while(!E&&h<p);for(S=w=E,$=Math.max(v/y,y/v)/(b*e),M=E*E*$,C=Math.max(w/M,M/S);h<p;++h){if(E+=f=o[h].value,f<S&&(S=f),f>w&&(w=f),M=E*E*$,_=Math.max(w/M,M/S),_>C){E-=f;break}C=_}s.push(l={value:E,dice:y<v,children:o.slice(d,h)}),l.dice?zp(l,n,i,r,b?i+=v*E/b:a):Dx(l,n,i,b?n+=y*E/b:r,a),b-=E,d=h}return s}const iH=function e(t){function n(i,r,a,s,o){nH(t,i,r,a,s,o)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(tH);function Mhe(){var e=iH,t=!1,n=1,i=1,r=[0],a=Ul,s=Ul,o=Ul,l=Ul,f=Ul;function d(p){return p.x0=p.y0=0,p.x1=n,p.y1=i,p.eachBefore(h),r=[0],t&&p.eachBefore(eH),p}function h(p){var y=r[p.depth],v=p.x0+y,b=p.y0+y,E=p.x1-y,S=p.y1-y;E<v&&(v=E=(v+E)/2),S<b&&(b=S=(b+S)/2),p.x0=v,p.y0=b,p.x1=E,p.y1=S,p.children&&(y=r[p.depth+1]=a(p)/2,v+=f(p)-y,b+=s(p)-y,E-=o(p)-y,S-=l(p)-y,E<v&&(v=E=(v+E)/2),S<b&&(b=S=(b+S)/2),e(p,v,b,E,S))}return d.round=function(p){return arguments.length?(t=!!p,d):t},d.size=function(p){return arguments.length?(n=+p[0],i=+p[1],d):[n,i]},d.tile=function(p){return arguments.length?(e=Zq(p),d):e},d.padding=function(p){return arguments.length?d.paddingInner(p).paddingOuter(p):d.paddingInner()},d.paddingInner=function(p){return arguments.length?(a=typeof p=="function"?p:Gf(+p),d):a},d.paddingOuter=function(p){return arguments.length?d.paddingTop(p).paddingRight(p).paddingBottom(p).paddingLeft(p):d.paddingTop()},d.paddingTop=function(p){return arguments.length?(s=typeof p=="function"?p:Gf(+p),d):s},d.paddingRight=function(p){return arguments.length?(o=typeof p=="function"?p:Gf(+p),d):o},d.paddingBottom=function(p){return arguments.length?(l=typeof p=="function"?p:Gf(+p),d):l},d.paddingLeft=function(p){return arguments.length?(f=typeof p=="function"?p:Gf(+p),d):f},d}function khe(e,t,n,i,r){var a=e.children,s,o=a.length,l,f=new Array(o+1);for(f[0]=l=s=0;s<o;++s)f[s+1]=l+=a[s].value;d(0,o,e.value,t,n,i,r);function d(h,p,y,v,b,E,S){if(h>=p-1){var w=a[h];w.x0=v,w.y0=b,w.x1=E,w.y1=S;return}for(var _=f[h],C=y/2+_,$=h+1,M=p-1;$<M;){var T=$+M>>>1;f[T]<C?$=T+1:M=T}C-f[$-1]<f[$]-C&&h+1<$&&--$;var F=f[$]-_,R=y-F;if(E-v>S-b){var B=y?(v*R+E*F)/y:E;d(h,$,F,v,b,B,S),d($,p,R,B,b,E,S)}else{var L=y?(b*R+S*F)/y:S;d(h,$,F,v,b,E,L),d($,p,R,v,L,E,S)}}}function Nhe(e,t,n,i,r){(e.depth&1?Dx:zp)(e,t,n,i,r)}const Fhe=function e(t){function n(i,r,a,s,o){if((l=i._squarify)&&l.ratio===t)for(var l,f,d,h,p=-1,y,v=l.length,b=i.value;++p<v;){for(f=l[p],d=f.children,h=f.value=0,y=d.length;h<y;++h)f.value+=d[h].value;f.dice?zp(f,r,a,s,b?a+=(o-a)*f.value/b:o):Dx(f,r,a,b?r+=(s-r)*f.value/b:s,o),b-=f.value}else i._squarify=l=nH(t,i,r,a,s,o),l.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(tH);function JC(e,t,n){const i={};return e.each(r=>{const a=r.data;n(a)&&(i[t(a)]=r)}),e.lookup=i,e}function lM(e){te.call(this,null,e)}lM.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Ohe=e=>e.values;me(lM,te,{transform(e,t){t.source||ae("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),a=this.value;return(!a||i||t.changed())&&(a&&a.each(s=>{s.children&&Ib(s.data)&&r.rem.push(s.data)}),this.value=a=uM({values:Fe(e.keys).reduce((s,o)=>(s.key(o),s),Rhe()).entries(r.source)},Ohe),n&&a.each(s=>{s.children&&(s=bt(s.data),r.add.push(s),r.source.push(s))}),JC(a,ke,ke)),r.source.root=a,r}});function Rhe(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,a){if(a>=e.length)return r;const s=r.length,o=e[a++],l={},f={};let d=-1,h,p,y;for(;++d<s;)h=o(p=r[d])+"",(y=l[h])?y.push(p):l[h]=[p];for(h in l)f[h]=n(l[h],a);return f}function i(r,a){if(++a>e.length)return r;const s=[];for(const o in r)s.push({key:o,values:i(r[o],a)});return s}return t}function _o(e){te.call(this,null,e)}const zhe=(e,t)=>e.parent===t.parent?1:2;me(_o,te,{transform(e,t){(!t.source||!t.source.root)&&ae(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,a=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Tc(e.sort,s=>s.data)),Bhe(n,this.params,e),n.separation&&n.separation(e.separation!==!1?zhe:Xd);try{this.value=n(r)}catch(s){ae(s)}return r.each(s=>Lhe(s,i,a)),t.reflow(e.modified()).modifies(a).modifies("leaf")}});function Bhe(e,t,n){for(let i,r=0,a=t.length;r<a;++r)i=t[r],i in n&&e[i](n[i])}function Lhe(e,t,n){const i=e.data,r=t.length-1;for(let a=0;a<r;++a)i[n[a]]=e[t[a]];i[n[r]]=e.children?e.children.length:0}const e3=["x","y","r","depth","children"];function cM(e){_o.call(this,e)}cM.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:e3.length,default:e3}]};me(cM,_o,{layout:vhe,params:["radius","size","padding"],fields:e3});const t3=["x0","y0","x1","y1","depth","children"];function fM(e){_o.call(this,e)}fM.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:t3.length,default:t3}]};me(fM,_o,{layout:bhe,params:["size","round","padding"],fields:t3});function dM(e){te.call(this,null,e)}dM.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};me(dM,te,{transform(e,t){t.source||ae("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),a=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),a&&(n=r.source.length?JC(m7().id(e.key).parentId(e.parentKey)(r.source),e.key,Zr):JC(m7()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const v7={tidy:The,cluster:Pde},n3=["x","y","depth","children"];function hM(e){_o.call(this,e)}hM.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:n3.length,default:n3}]};me(hM,_o,{layout(e){const t=e||"tidy";if(ze(v7,t))return v7[t]();ae("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:n3});function gM(e){te.call(this,[],e)}gM.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};me(gM,te,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),a={};return i||ae("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,s=>a[ke(s)]=1),i.each(s=>{const o=s.data,l=s.parent&&s.parent.data;l&&a[ke(o)]&&a[ke(l)]&&r.add.push(bt({source:l,target:o}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>a[ke(s)]=1),n.forEach(s=>{(a[ke(s.source)]||a[ke(s.target)])&&r.mod.push(s)})),r}});const b7={binary:khe,dice:zp,slice:Dx,slicedice:Nhe,squarify:iH,resquarify:Fhe},i3=["x0","y0","x1","y1","depth","children"];function pM(e){_o.call(this,e)}pM.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:i3.length,default:i3}]};me(pM,_o,{layout(){const e=Mhe();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ze(b7,t)?e.tile(b7[t]):ae("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:i3});const jhe=Object.freeze(Object.defineProperty({__proto__:null,nest:lM,pack:cM,partition:fM,stratify:dM,tree:hM,treelinks:gM,treemap:pM},Symbol.toStringTag,{value:"Module"})),jw=4278190080;function Uhe(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function Phe(e,t,n,i,r){const a=e.width,s=e.height,o=i||r,l=Cu(a,s).getContext("2d"),f=Cu(a,s).getContext("2d"),d=o&&Cu(a,s).getContext("2d");n.forEach(F=>Dy(l,F,!1)),Dy(f,t,!1),o&&Dy(d,t,!0);const h=Uw(l,a,s),p=Uw(f,a,s),y=o&&Uw(d,a,s),v=e.bitmap(),b=o&&e.bitmap();let E,S,w,_,C,$,M,T;for(S=0;S<s;++S)for(E=0;E<a;++E)C=S*a+E,$=h[C]&jw,T=p[C]&jw,M=o&&y[C]&jw,($||M||T)&&(w=e(E),_=e(S),!r&&($||T)&&v.set(w,_),o&&($||M)&&b.set(w,_));return[v,b]}function Uw(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function Dy(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(a=>Dy(e,a.items,n))}):Tr[i].draw(e,{items:n?t.map(Ihe):t})}function Ihe(e){const t=qb(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const Ws=5,Ei=31,Gg=32,cu=new Uint32Array(Gg+1),pa=new Uint32Array(Gg+1);pa[0]=0;cu[0]=~pa[0];for(let e=1;e<=Gg;++e)pa[e]=pa[e-1]<<1|1,cu[e]=~pa[e];function qhe(e,t){const n=new Uint32Array(~~((e*t+Gg)/Gg));function i(a,s){n[a]|=s}function r(a,s){n[a]&=s}return{array:n,get:(a,s)=>{const o=s*e+a;return n[o>>>Ws]&1<<(o&Ei)},set:(a,s)=>{const o=s*e+a;i(o>>>Ws,1<<(o&Ei))},clear:(a,s)=>{const o=s*e+a;r(o>>>Ws,~(1<<(o&Ei)))},getRange:(a,s,o,l)=>{let f=l,d,h,p,y;for(;f>=s;--f)if(d=f*e+a,h=f*e+o,p=d>>>Ws,y=h>>>Ws,p===y){if(n[p]&cu[d&Ei]&pa[(h&Ei)+1])return!0}else{if(n[p]&cu[d&Ei]||n[y]&pa[(h&Ei)+1])return!0;for(let v=p+1;v<y;++v)if(n[v])return!0}return!1},setRange:(a,s,o,l)=>{let f,d,h,p,y;for(;s<=l;++s)if(f=s*e+a,d=s*e+o,h=f>>>Ws,p=d>>>Ws,h===p)i(h,cu[f&Ei]&pa[(d&Ei)+1]);else for(i(h,cu[f&Ei]),i(p,pa[(d&Ei)+1]),y=h+1;y<p;++y)i(y,4294967295)},clearRange:(a,s,o,l)=>{let f,d,h,p,y;for(;s<=l;++s)if(f=s*e+a,d=s*e+o,h=f>>>Ws,p=d>>>Ws,h===p)r(h,pa[f&Ei]|cu[(d&Ei)+1]);else for(r(h,pa[f&Ei]),r(p,cu[(d&Ei)+1]),y=h+1;y<p;++y)r(y,0)},outOfBounds:(a,s,o,l)=>a<0||s<0||l>=t||o>=e}}function Hhe(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),a=~~((t+2*n+i)/i),s=o=>~~((o+n)/i);return s.invert=o=>o*i-n,s.bitmap=()=>qhe(r,a),s.ratio=i,s.padding=n,s.width=e,s.height=t,s}function Ghe(e,t,n,i){const r=e.width,a=e.height;return function(s){const o=s.datum.datum.items[i].items,l=o.length,f=s.datum.fontSize,d=Ar.width(s.datum,s.datum.text);let h=0,p,y,v,b,E,S,w;for(let _=0;_<l;++_)p=o[_].x,v=o[_].y,y=o[_].x2===void 0?p:o[_].x2,b=o[_].y2===void 0?v:o[_].y2,E=(p+y)/2,S=(v+b)/2,w=Math.abs(y-p+b-v),w>=h&&(h=w,s.x=E,s.y=S);return E=d/2,S=f/2,p=s.x-E,y=s.x+E,v=s.y-S,b=s.y+S,s.align="center",p<0&&y<=r?s.align="left":0<=p&&r<y&&(s.align="right"),s.baseline="middle",v<0&&b<=a?s.baseline="top":0<=v&&a<b&&(s.baseline="bottom"),!0}}function Wv(e,t,n,i,r,a){let s=n/2;return e-s<0||e+s>r||t-(s=i/2)<0||t+s>a}function Eu(e,t,n,i,r,a,s,o){const l=r*a/(i*2),f=e(t-l),d=e(t+l),h=e(n-(a=a/2)),p=e(n+a);return s.outOfBounds(f,h,d,p)||s.getRange(f,h,d,p)||o&&o.getRange(f,h,d,p)}function Yhe(e,t,n,i){const r=e.width,a=e.height,s=t[0],o=t[1];function l(f,d,h,p,y){const v=e.invert(f),b=e.invert(d);let E=h,S=a,w;if(!Wv(v,b,p,y,r,a)&&!Eu(e,v,b,y,p,E,s,o)&&!Eu(e,v,b,y,p,y,s,null)){for(;S-E>=1;)w=(E+S)/2,Eu(e,v,b,y,p,w,s,o)?S=w:E=w;if(E>h)return[v,b,E,!0]}}return function(f){const d=f.datum.datum.items[i].items,h=d.length,p=f.datum.fontSize,y=Ar.width(f.datum,f.datum.text);let v=n?p:0,b=!1,E=!1,S=0,w,_,C,$,M,T,F,R,B,L,Y,H,U,z,O,I,W;for(let K=0;K<h;++K){for(w=d[K].x,C=d[K].y,_=d[K].x2===void 0?w:d[K].x2,$=d[K].y2===void 0?C:d[K].y2,w>_&&(W=w,w=_,_=W),C>$&&(W=C,C=$,$=W),B=e(w),Y=e(_),L=~~((B+Y)/2),H=e(C),z=e($),U=~~((H+z)/2),F=L;F>=B;--F)for(R=U;R>=H;--R)I=l(F,R,v,y,p),I&&([f.x,f.y,v,b]=I);for(F=L;F<=Y;++F)for(R=U;R<=z;++R)I=l(F,R,v,y,p),I&&([f.x,f.y,v,b]=I);!b&&!n&&(O=Math.abs(_-w+$-C),M=(w+_)/2,T=(C+$)/2,O>=S&&!Wv(M,T,y,p,r,a)&&!Eu(e,M,T,p,y,p,s,null)&&(S=O,f.x=M,f.y=T,E=!0))}return b||E?(M=y/2,T=p/2,s.setRange(e(f.x-M),e(f.y-T),e(f.x+M),e(f.y+T)),f.align="center",f.baseline="middle",!0):!1}}const Vhe=[-1,-1,1,1],Xhe=[-1,1,-1,1];function Whe(e,t,n,i){const r=e.width,a=e.height,s=t[0],o=t[1],l=e.bitmap();return function(f){const d=f.datum.datum.items[i].items,h=d.length,p=f.datum.fontSize,y=Ar.width(f.datum,f.datum.text),v=[];let b=n?p:0,E=!1,S=!1,w=0,_,C,$,M,T,F,R,B,L,Y,H,U;for(let z=0;z<h;++z){for(_=d[z].x,$=d[z].y,C=d[z].x2===void 0?_:d[z].x2,M=d[z].y2===void 0?$:d[z].y2,v.push([e((_+C)/2),e(($+M)/2)]);v.length;)if([R,B]=v.pop(),!(s.get(R,B)||o.get(R,B)||l.get(R,B))){l.set(R,B);for(let O=0;O<4;++O)T=R+Vhe[O],F=B+Xhe[O],l.outOfBounds(T,F,T,F)||v.push([T,F]);if(T=e.invert(R),F=e.invert(B),L=b,Y=a,!Wv(T,F,y,p,r,a)&&!Eu(e,T,F,p,y,L,s,o)&&!Eu(e,T,F,p,y,p,s,null)){for(;Y-L>=1;)H=(L+Y)/2,Eu(e,T,F,p,y,H,s,o)?Y=H:L=H;L>b&&(f.x=T,f.y=F,b=L,E=!0)}}!E&&!n&&(U=Math.abs(C-_+M-$),T=(_+C)/2,F=($+M)/2,U>=w&&!Wv(T,F,y,p,r,a)&&!Eu(e,T,F,p,y,p,s,null)&&(w=U,f.x=T,f.y=F,S=!0))}return E||S?(T=y/2,F=p/2,s.setRange(e(f.x-T),e(f.y-F),e(f.x+T),e(f.y+F)),f.align="center",f.baseline="middle",!0):!1}}const Qhe=["right","center","left"],Zhe=["bottom","middle","top"];function Khe(e,t,n,i){const r=e.width,a=e.height,s=t[0],o=t[1],l=i.length;return function(f){const d=f.boundary,h=f.datum.fontSize;if(d[2]<0||d[5]<0||d[0]>r||d[3]>a)return!1;let p=f.textWidth??0,y,v,b,E,S,w,_,C,$,M,T,F,R,B,L;for(let Y=0;Y<l;++Y){if(y=(n[Y]&3)-1,v=(n[Y]>>>2&3)-1,b=y===0&&v===0||i[Y]<0,E=y&&v?Math.SQRT1_2:1,S=i[Y]<0?-1:1,w=d[1+y]+i[Y]*y*E,T=d[4+v]+S*h*v/2+i[Y]*v*E,C=T-h/2,$=T+h/2,F=e(w),B=e(C),L=e($),!p)if(x7(F,F,B,L,s,o,w,w,C,$,d,b))p=Ar.width(f.datum,f.datum.text);else continue;if(M=w+S*p*y/2,w=M-p/2,_=M+p/2,F=e(w),R=e(_),x7(F,R,B,L,s,o,w,_,C,$,d,b))return f.x=y?y*S<0?_:w:M,f.y=v?v*S<0?$:C:T,f.align=Qhe[y*S+1],f.baseline=Zhe[v*S+1],s.setRange(F,B,R,L),!0}return!1}}function x7(e,t,n,i,r,a,s,o,l,f,d,h){return!(r.outOfBounds(e,n,t,i)||(h&&a||r).getRange(e,n,t,i))}const Pw=0,Iw=4,qw=8,Hw=0,Gw=1,Yw=2,Jhe={"top-left":Pw+Hw,top:Pw+Gw,"top-right":Pw+Yw,left:Iw+Hw,middle:Iw+Gw,right:Iw+Yw,"bottom-left":qw+Hw,bottom:qw+Gw,"bottom-right":qw+Yw},e0e={naive:Ghe,"reduced-search":Yhe,floodfill:Whe};function t0e(e,t,n,i,r,a,s,o,l,f,d){if(!e.length)return e;const h=Math.max(i.length,r.length),p=n0e(i,h),y=i0e(r,h),v=r0e(e[0].datum),b=v==="group"&&e[0].datum.items[l].marktype,E=b==="area",S=a0e(v,b,o,l),w=f===null||f===1/0,_=E&&d==="naive";let C=-1,$=-1;const M=e.map(B=>{const L=w?Ar.width(B,B.text):void 0;return C=Math.max(C,L),$=Math.max($,B.fontSize),{datum:B,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:S(B),textWidth:L}});f=f===null||f===1/0?Math.max(C,$)+Math.max(...i):f;const T=Hhe(t[0],t[1],f);let F;if(!_){n&&M.sort((Y,H)=>n(Y.datum,H.datum));let B=!1;for(let Y=0;Y<y.length&&!B;++Y)B=y[Y]===5||p[Y]<0;const L=(v&&s||E)&&e.map(Y=>Y.datum);F=a.length||L?Phe(T,L||[],a,B,E):Uhe(T,s&&M)}const R=E?e0e[d](T,F,s,l):Khe(T,F,y,p);return M.forEach(B=>B.opacity=+R(B)),M}function n0e(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function i0e(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=Jhe[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function r0e(e){return e&&e.mark&&e.mark.marktype}function a0e(e,t,n,i){const r=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return e?e==="line"||e==="area"?a=>r(a.datum):t==="line"?a=>{const s=a.datum.items[i].items;return r(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:a=>{const s=a.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:r}const r3=["x","y","opacity","align","baseline"],rH=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function mM(e){te.call(this,null,e)}mM.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:rH},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:r3.length,default:r3}]};me(mM,te,{transform(e,t){function n(a){const s=e[a];return We(s)&&t.modified(s.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&ae("Size parameter should be specified as a [width, height] array.");const r=e.as||r3;return t0e(t.materialize(t.SOURCE).source||[],e.size,e.sort,Fe(e.offset==null?1:e.offset),Fe(e.anchor||rH),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(a=>{const s=a.datum;s[r[0]]=a.x,s[r[1]]=a.y,s[r[2]]=a.opacity,s[r[3]]=a.align,s[r[4]]=a.baseline}),t.reflow(i).modifies(r)}});const s0e=Object.freeze(Object.defineProperty({__proto__:null,label:mM},Symbol.toStringTag,{value:"Module"}));function aH(e,t){var n=[],i=function(d){return d(o)},r,a,s,o,l,f;if(t==null)n.push(e);else for(r={},a=0,s=e.length;a<s;++a)o=e[a],l=t.map(i),f=r[l],f||(r[l]=f=[],f.dims=l,n.push(f)),f.push(o);return n}function yM(e){te.call(this,null,e)}yM.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};me(yM,te,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=aH(i,e.groupby),a=(e.groupby||[]).map(tn),s=a.length,o=e.as||[tn(e.x),tn(e.y)],l=[];r.forEach(f=>{dj(f,e.x,e.y,e.bandwidth||.3).forEach(d=>{const h={};for(let p=0;p<s;++p)h[a[p]]=f.dims[p];h[o[0]]=d[0],h[o[1]]=d[1],l.push(bt(h))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const a3={constant:K$,linear:J$,log:uj,exp:lj,pow:cj,quad:eD,poly:fj},o0e=(e,t)=>e==="poly"?t:e==="quad"?2:1;function vM(e){te.call(this,null,e)}vM.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(a3)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};me(vM,te,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=aH(i,e.groupby),a=(e.groupby||[]).map(tn),s=e.method||"linear",o=e.order==null?3:e.order,l=o0e(s,o),f=e.as||[tn(e.x),tn(e.y)],d=a3[s],h=[];let p=e.extent;ze(a3,s)||ae("Invalid regression method: "+s),p!=null&&s==="log"&&p[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),p=null),r.forEach(y=>{if(y.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const b=d(y,e.x,e.y,o);if(e.params){h.push(bt({keys:y.dims,coef:b.coef,rSquared:b.rSquared}));return}const E=p||cs(y,e.x),S=w=>{const _={};for(let C=0;C<a.length;++C)_[a[C]]=y.dims[C];_[f[0]]=w[0],_[f[1]]=w[1],h.push(bt(_))};s==="linear"||s==="constant"?E.forEach(w=>S([w,b.predict(w)])):Qb(b.predict,E,25,200).forEach(S)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=h}return n}});const u0e=Object.freeze(Object.defineProperty({__proto__:null,loess:yM,regression:vM},Symbol.toStringTag,{value:"Module"})),fo=11102230246251565e-32,si=134217729,l0e=(3+8*fo)*fo;function Vw(e,t,n,i,r){let a,s,o,l,f=t[0],d=i[0],h=0,p=0;d>f==d>-f?(a=f,f=t[++h]):(a=d,d=i[++p]);let y=0;if(h<e&&p<n)for(d>f==d>-f?(s=f+a,o=a-(s-f),f=t[++h]):(s=d+a,o=a-(s-d),d=i[++p]),a=s,o!==0&&(r[y++]=o);h<e&&p<n;)d>f==d>-f?(s=a+f,l=s-a,o=a-(s-l)+(f-l),f=t[++h]):(s=a+d,l=s-a,o=a-(s-l)+(d-l),d=i[++p]),a=s,o!==0&&(r[y++]=o);for(;h<e;)s=a+f,l=s-a,o=a-(s-l)+(f-l),f=t[++h],a=s,o!==0&&(r[y++]=o);for(;p<n;)s=a+d,l=s-a,o=a-(s-l)+(d-l),d=i[++p],a=s,o!==0&&(r[y++]=o);return(a!==0||y===0)&&(r[y++]=a),y}function c0e(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function Bp(e){return new Float64Array(e)}const f0e=(3+16*fo)*fo,d0e=(2+12*fo)*fo,h0e=(9+64*fo)*fo*fo,jf=Bp(4),E7=Bp(8),S7=Bp(12),A7=Bp(16),Si=Bp(4);function g0e(e,t,n,i,r,a,s){let o,l,f,d,h,p,y,v,b,E,S,w,_,C,$,M,T,F;const R=e-r,B=n-r,L=t-a,Y=i-a;C=R*Y,p=si*R,y=p-(p-R),v=R-y,p=si*Y,b=p-(p-Y),E=Y-b,$=v*E-(C-y*b-v*b-y*E),M=L*B,p=si*L,y=p-(p-L),v=L-y,p=si*B,b=p-(p-B),E=B-b,T=v*E-(M-y*b-v*b-y*E),S=$-T,h=$-S,jf[0]=$-(S+h)+(h-T),w=C+S,h=w-C,_=C-(w-h)+(S-h),S=_-M,h=_-S,jf[1]=_-(S+h)+(h-M),F=w+S,h=F-w,jf[2]=w-(F-h)+(S-h),jf[3]=F;let H=c0e(4,jf),U=d0e*s;if(H>=U||-H>=U||(h=e-R,o=e-(R+h)+(h-r),h=n-B,f=n-(B+h)+(h-r),h=t-L,l=t-(L+h)+(h-a),h=i-Y,d=i-(Y+h)+(h-a),o===0&&l===0&&f===0&&d===0)||(U=h0e*s+l0e*Math.abs(H),H+=R*d+Y*o-(L*f+B*l),H>=U||-H>=U))return H;C=o*Y,p=si*o,y=p-(p-o),v=o-y,p=si*Y,b=p-(p-Y),E=Y-b,$=v*E-(C-y*b-v*b-y*E),M=l*B,p=si*l,y=p-(p-l),v=l-y,p=si*B,b=p-(p-B),E=B-b,T=v*E-(M-y*b-v*b-y*E),S=$-T,h=$-S,Si[0]=$-(S+h)+(h-T),w=C+S,h=w-C,_=C-(w-h)+(S-h),S=_-M,h=_-S,Si[1]=_-(S+h)+(h-M),F=w+S,h=F-w,Si[2]=w-(F-h)+(S-h),Si[3]=F;const z=Vw(4,jf,4,Si,E7);C=R*d,p=si*R,y=p-(p-R),v=R-y,p=si*d,b=p-(p-d),E=d-b,$=v*E-(C-y*b-v*b-y*E),M=L*f,p=si*L,y=p-(p-L),v=L-y,p=si*f,b=p-(p-f),E=f-b,T=v*E-(M-y*b-v*b-y*E),S=$-T,h=$-S,Si[0]=$-(S+h)+(h-T),w=C+S,h=w-C,_=C-(w-h)+(S-h),S=_-M,h=_-S,Si[1]=_-(S+h)+(h-M),F=w+S,h=F-w,Si[2]=w-(F-h)+(S-h),Si[3]=F;const O=Vw(z,E7,4,Si,S7);C=o*d,p=si*o,y=p-(p-o),v=o-y,p=si*d,b=p-(p-d),E=d-b,$=v*E-(C-y*b-v*b-y*E),M=l*f,p=si*l,y=p-(p-l),v=l-y,p=si*f,b=p-(p-f),E=f-b,T=v*E-(M-y*b-v*b-y*E),S=$-T,h=$-S,Si[0]=$-(S+h)+(h-T),w=C+S,h=w-C,_=C-(w-h)+(S-h),S=_-M,h=_-S,Si[1]=_-(S+h)+(h-M),F=w+S,h=F-w,Si[2]=w-(F-h)+(S-h),Si[3]=F;const I=Vw(O,S7,4,Si,A7);return A7[I-1]}function V1(e,t,n,i,r,a){const s=(t-a)*(n-r),o=(e-r)*(i-a),l=s-o,f=Math.abs(s+o);return Math.abs(l)>=f0e*f?l:-g0e(e,t,n,i,r,a,f)}const w7=Math.pow(2,-52),X1=new Uint32Array(512);class Qv{static from(t,n=b0e,i=x0e){const r=t.length,a=new Float64Array(r*2);for(let s=0;s<r;s++){const o=t[s];a[2*s]=n(o),a[2*s+1]=i(o)}return new Qv(a)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:a}=this,s=t.length>>1;let o=1/0,l=1/0,f=-1/0,d=-1/0;for(let R=0;R<s;R++){const B=t[2*R],L=t[2*R+1];B<o&&(o=B),L<l&&(l=L),B>f&&(f=B),L>d&&(d=L),this._ids[R]=R}const h=(o+f)/2,p=(l+d)/2;let y,v,b;for(let R=0,B=1/0;R<s;R++){const L=Xw(h,p,t[2*R],t[2*R+1]);L<B&&(y=R,B=L)}const E=t[2*y],S=t[2*y+1];for(let R=0,B=1/0;R<s;R++){if(R===y)continue;const L=Xw(E,S,t[2*R],t[2*R+1]);L<B&&L>0&&(v=R,B=L)}let w=t[2*v],_=t[2*v+1],C=1/0;for(let R=0;R<s;R++){if(R===y||R===v)continue;const B=y0e(E,S,w,_,t[2*R],t[2*R+1]);B<C&&(b=R,C=B)}let $=t[2*b],M=t[2*b+1];if(C===1/0){for(let L=0;L<s;L++)this._dists[L]=t[2*L]-t[0]||t[2*L+1]-t[1];Jf(this._ids,this._dists,0,s-1);const R=new Uint32Array(s);let B=0;for(let L=0,Y=-1/0;L<s;L++){const H=this._ids[L],U=this._dists[H];U>Y&&(R[B++]=H,Y=U)}this.hull=R.subarray(0,B),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(V1(E,S,w,_,$,M)<0){const R=v,B=w,L=_;v=b,w=$,_=M,b=R,$=B,M=L}const T=v0e(E,S,w,_,$,M);this._cx=T.x,this._cy=T.y;for(let R=0;R<s;R++)this._dists[R]=Xw(t[2*R],t[2*R+1],T.x,T.y);Jf(this._ids,this._dists,0,s-1),this._hullStart=y;let F=3;i[y]=n[b]=v,i[v]=n[y]=b,i[b]=n[v]=y,r[y]=0,r[v]=1,r[b]=2,a.fill(-1),a[this._hashKey(E,S)]=y,a[this._hashKey(w,_)]=v,a[this._hashKey($,M)]=b,this.trianglesLen=0,this._addTriangle(y,v,b,-1,-1,-1);for(let R=0,B,L;R<this._ids.length;R++){const Y=this._ids[R],H=t[2*Y],U=t[2*Y+1];if(R>0&&Math.abs(H-B)<=w7&&Math.abs(U-L)<=w7||(B=H,L=U,Y===y||Y===v||Y===b))continue;let z=0;for(let k=0,V=this._hashKey(H,U);k<this._hashSize&&(z=a[(V+k)%this._hashSize],!(z!==-1&&z!==i[z]));k++);z=n[z];let O=z,I;for(;I=i[O],V1(H,U,t[2*O],t[2*O+1],t[2*I],t[2*I+1])>=0;)if(O=I,O===z){O=-1;break}if(O===-1)continue;let W=this._addTriangle(O,Y,i[O],-1,-1,r[O]);r[Y]=this._legalize(W+2),r[O]=W,F++;let K=i[O];for(;I=i[K],V1(H,U,t[2*K],t[2*K+1],t[2*I],t[2*I+1])<0;)W=this._addTriangle(K,Y,I,r[Y],-1,r[K]),r[Y]=this._legalize(W+2),i[K]=K,F--,K=I;if(O===z)for(;I=n[O],V1(H,U,t[2*I],t[2*I+1],t[2*O],t[2*O+1])<0;)W=this._addTriangle(I,Y,O,-1,r[O],r[I]),this._legalize(W+2),r[I]=W,i[O]=O,F--,O=I;this._hullStart=n[Y]=O,i[O]=n[K]=Y,i[Y]=K,a[this._hashKey(H,U)]=Y,a[this._hashKey(t[2*O],t[2*O+1])]=O}this.hull=new Uint32Array(F);for(let R=0,B=this._hullStart;R<F;R++)this.hull[R]=B,B=i[B];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(p0e(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let a=0,s=0;for(;;){const o=i[t],l=t-t%3;if(s=l+(t+2)%3,o===-1){if(a===0)break;t=X1[--a];continue}const f=o-o%3,d=l+(t+1)%3,h=f+(o+2)%3,p=n[s],y=n[t],v=n[d],b=n[h];if(m0e(r[2*p],r[2*p+1],r[2*y],r[2*y+1],r[2*v],r[2*v+1],r[2*b],r[2*b+1])){n[t]=b,n[o]=p;const S=i[h];if(S===-1){let _=this._hullStart;do{if(this._hullTri[_]===h){this._hullTri[_]=t;break}_=this._hullPrev[_]}while(_!==this._hullStart)}this._link(t,S),this._link(o,i[s]),this._link(s,h);const w=f+(o+1)%3;a<X1.length&&(X1[a++]=w)}else{if(a===0)break;t=X1[--a]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,a,s){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=n,this._triangles[o+2]=i,this._link(o,r),this._link(o+1,a),this._link(o+2,s),this.trianglesLen+=3,o}}function p0e(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Xw(e,t,n,i){const r=e-n,a=t-i;return r*r+a*a}function m0e(e,t,n,i,r,a,s,o){const l=e-s,f=t-o,d=n-s,h=i-o,p=r-s,y=a-o,v=l*l+f*f,b=d*d+h*h,E=p*p+y*y;return l*(h*E-b*y)-f*(d*E-b*p)+v*(d*y-h*p)<0}function y0e(e,t,n,i,r,a){const s=n-e,o=i-t,l=r-e,f=a-t,d=s*s+o*o,h=l*l+f*f,p=.5/(s*f-o*l),y=(f*d-o*h)*p,v=(s*h-l*d)*p;return y*y+v*v}function v0e(e,t,n,i,r,a){const s=n-e,o=i-t,l=r-e,f=a-t,d=s*s+o*o,h=l*l+f*f,p=.5/(s*f-o*l),y=e+(f*d-o*h)*p,v=t+(s*h-l*d)*p;return{x:y,y:v}}function Jf(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const a=e[r],s=t[a];let o=r-1;for(;o>=n&&t[e[o]]>s;)e[o+1]=e[o--];e[o+1]=a}else{const r=n+i>>1;let a=n+1,s=i;k0(e,r,a),t[e[n]]>t[e[i]]&&k0(e,n,i),t[e[a]]>t[e[i]]&&k0(e,a,i),t[e[n]]>t[e[a]]&&k0(e,n,a);const o=e[a],l=t[o];for(;;){do a++;while(t[e[a]]<l);do s--;while(t[e[s]]>l);if(s<a)break;k0(e,a,s)}e[n+1]=e[s],e[s]=o,i-a+1>=s-n?(Jf(e,t,a,i),Jf(e,t,n,s-1)):(Jf(e,t,n,s-1),Jf(e,t,a,i))}}function k0(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function b0e(e){return e[0]}function x0e(e){return e[1]}const _7=1e-6;class Hl{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,a=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${a}`:(Math.abs(this._x1-r)>_7||Math.abs(this._y1-a)>_7)&&(this._+="L"+r+","+a),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=a}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class s3{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let E0e=class{constructor(t,[n,i,r,a]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((a=+a)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=a,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let a,s;const o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let b=0,E=0,S=i.length,w,_;b<S;b+=3,E+=2){const C=i[b]*2,$=i[b+1]*2,M=i[b+2]*2,T=t[C],F=t[C+1],R=t[$],B=t[$+1],L=t[M],Y=t[M+1],H=R-T,U=B-F,z=L-T,O=Y-F,I=(H*O-U*z)*2;if(Math.abs(I)<1e-9){if(a===void 0){a=s=0;for(const K of n)a+=t[K*2],s+=t[K*2+1];a/=n.length,s/=n.length}const W=1e9*Math.sign((a-T)*O-(s-F)*z);w=(T+L)/2-W*O,_=(F+Y)/2+W*z}else{const W=1/I,K=H*H+U*U,k=z*z+O*O;w=T+(O*K-U*k)*W,_=F+(H*k-z*K)*W}o[E]=w,o[E+1]=_}let l=n[n.length-1],f,d=l*4,h,p=t[2*l],y,v=t[2*l+1];r.fill(0);for(let b=0;b<n.length;++b)l=n[b],f=d,h=p,y=v,d=l*4,p=t[2*l],v=t[2*l+1],r[f+2]=r[d]=y-v,r[f+3]=r[d+1]=p-h}render(t){const n=t==null?t=new Hl:void 0,{delaunay:{halfedges:i,inedges:r,hull:a},circumcenters:s,vectors:o}=this;if(a.length<=1)return null;for(let d=0,h=i.length;d<h;++d){const p=i[d];if(p<d)continue;const y=Math.floor(d/3)*2,v=Math.floor(p/3)*2,b=s[y],E=s[y+1],S=s[v],w=s[v+1];this._renderSegment(b,E,S,w,t)}let l,f=a[a.length-1];for(let d=0;d<a.length;++d){l=f,f=a[d];const h=Math.floor(r[f]/3)*2,p=s[h],y=s[h+1],v=l*4,b=this._project(p,y,o[v+2],o[v+3]);b&&this._renderSegment(p,y,b[0],b[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Hl:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Hl:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let a=r.length;for(;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(let s=2;s<a;s+=2)(r[s]!==r[s-2]||r[s+1]!==r[s-1])&&n.lineTo(r[s],r[s+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new s3;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,a){let s;const o=this._regioncode(t,n),l=this._regioncode(i,r);o===0&&l===0?(a.moveTo(t,n),a.lineTo(i,r)):(s=this._clipSegment(t,n,i,r,o,l))&&(a.moveTo(s[0],s[1]),a.lineTo(s[2],s[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let a=0,s=n.length;a<s;a+=2)for(let o=0,l=r.length;o<l;o+=2)if(n[a]===r[o]&&n[a+1]===r[o+1]&&n[(a+2)%s]===r[(o+l-2)%l]&&n[(a+3)%s]===r[(o+l-1)%l]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:a}}=this,s=i[t];if(s===-1)return null;const o=[];let l=s;do{const f=Math.floor(l/3);if(o.push(n[f*2],n[f*2+1]),l=l%3===2?l-2:l+1,a[l]!==t)break;l=r[l]}while(l!==s&&l!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,a,s,o=n[i-2],l=n[i-1],f,d=this._regioncode(o,l),h,p=0;for(let y=0;y<i;y+=2)if(a=o,s=l,o=n[y],l=n[y+1],f=d,d=this._regioncode(o,l),f===0&&d===0)h=p,p=0,r?r.push(o,l):r=[o,l];else{let v,b,E,S,w;if(f===0){if((v=this._clipSegment(a,s,o,l,f,d))===null)continue;[b,E,S,w]=v}else{if((v=this._clipSegment(o,l,a,s,d,f))===null)continue;[S,w,b,E]=v,h=p,p=this._edgecode(b,E),h&&p&&this._edge(t,h,p,r,r.length),r?r.push(b,E):r=[b,E]}h=p,p=this._edgecode(S,w),h&&p&&this._edge(t,h,p,r,r.length),r?r.push(S,w):r=[S,w]}if(r)h=p,p=this._edgecode(r[0],r[1]),h&&p&&this._edge(t,h,p,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,a,s){const o=a<s;for(o&&([t,n,i,r,a,s]=[i,r,t,n,s,a]);;){if(a===0&&s===0)return o?[i,r,t,n]:[t,n,i,r];if(a&s)return null;let l,f,d=a||s;d&8?(l=t+(i-t)*(this.ymax-n)/(r-n),f=this.ymax):d&4?(l=t+(i-t)*(this.ymin-n)/(r-n),f=this.ymin):d&2?(f=n+(r-n)*(this.xmax-t)/(i-t),l=this.xmax):(f=n+(r-n)*(this.xmin-t)/(i-t),l=this.xmin),a?(t=l,n=f,a=this._regioncode(t,n)):(i=l,r=f,s=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,a,s){let o=Array.from(n),l;if((l=this._project(o[0],o[1],i,r))&&o.unshift(l[0],l[1]),(l=this._project(o[o.length-2],o[o.length-1],a,s))&&o.push(l[0],l[1]),o=this._clipFinite(t,o))for(let f=0,d=o.length,h,p=this._edgecode(o[d-2],o[d-1]);f<d;f+=2)h=p,p=this._edgecode(o[f],o[f+1]),h&&p&&(f=this._edge(t,h,p,o,f),d=o.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(t,n,i,r,a){for(;n!==i;){let s,o;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,o=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,o=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,o=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,o=this.ymin;break}(r[a]!==s||r[a+1]!==o)&&this.contains(t,s,o)&&(r.splice(a,0,s,o),a+=2)}return a}_project(t,n,i,r){let a=1/0,s,o,l;if(r<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/r)<a&&(l=this.ymin,o=t+(a=s)*i)}else if(r>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/r)<a&&(l=this.ymax,o=t+(a=s)*i)}if(i>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/i)<a&&(o=this.xmax,l=n+(a=s)*r)}else if(i<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/i)<a&&(o=this.xmin,l=n+(a=s)*r)}return[o,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const S0e=2*Math.PI,Uf=Math.pow;function A0e(e){return e[0]}function w0e(e){return e[1]}function _0e(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],a=2*t[i+1],s=2*t[i+2];if((n[s]-n[r])*(n[a+1]-n[r+1])-(n[a]-n[r])*(n[s+1]-n[r+1])>1e-10)return!1}return!0}function C0e(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class bM{static from(t,n=A0e,i=w0e,r){return new bM("length"in t?$0e(t,n,i,r):Float64Array.from(D0e(t,n,i,r)))}constructor(t){this._delaunator=new Qv(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&_0e(t)){this.collinear=Int32Array.from({length:n.length/2},(p,y)=>y).sort((p,y)=>n[2*p]-n[2*y]||n[2*p+1]-n[2*y+1]);const l=this.collinear[0],f=this.collinear[this.collinear.length-1],d=[n[2*l],n[2*l+1],n[2*f],n[2*f+1]],h=1e-8*Math.hypot(d[3]-d[1],d[2]-d[0]);for(let p=0,y=n.length/2;p<y;++p){const v=C0e(n[2*p],n[2*p+1],h);n[2*p]=v[0],n[2*p+1]=v[1]}this._delaunator=new Qv(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let l=0,f=i.length;l<f;++l){const d=a[l%3===2?l-2:l+1];(i[l]===-1||s[d]===-1)&&(s[d]=l)}for(let l=0,f=r.length;l<f;++l)o[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],s[r[0]]=1,r.length===2&&(s[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new E0e(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:a,triangles:s,collinear:o}=this;if(o){const h=o.indexOf(t);h>0&&(yield o[h-1]),h<o.length-1&&(yield o[h+1]);return}const l=n[t];if(l===-1)return;let f=l,d=-1;do{if(yield d=s[f],f=f%3===2?f-2:f+1,s[f]!==t)return;if(f=a[f],f===-1){const h=i[(r[t]+1)%i.length];h!==d&&(yield h);return}}while(f!==l)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let a;for(;(a=this._step(i,t,n))>=0&&a!==i&&a!==r;)i=a;return a}_step(t,n,i){const{inedges:r,hull:a,_hullIndex:s,halfedges:o,triangles:l,points:f}=this;if(r[t]===-1||!f.length)return(t+1)%(f.length>>1);let d=t,h=Uf(n-f[t*2],2)+Uf(i-f[t*2+1],2);const p=r[t];let y=p;do{let v=l[y];const b=Uf(n-f[v*2],2)+Uf(i-f[v*2+1],2);if(b<h&&(h=b,d=v),y=y%3===2?y-2:y+1,l[y]!==t)break;if(y=o[y],y===-1){if(y=a[(s[t]+1)%a.length],y!==v&&Uf(n-f[y*2],2)+Uf(i-f[y*2+1],2)<h)return y;break}}while(y!==p);return d}render(t){const n=t==null?t=new Hl:void 0,{points:i,halfedges:r,triangles:a}=this;for(let s=0,o=r.length;s<o;++s){const l=r[s];if(l<s)continue;const f=a[s]*2,d=a[l]*2;t.moveTo(i[f],i[f+1]),t.lineTo(i[d],i[d+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new Hl:void 0,{points:r}=this;for(let a=0,s=r.length;a<s;a+=2){const o=r[a],l=r[a+1];t.moveTo(o+n,l),t.arc(o,l,n,0,S0e)}return i&&i.value()}renderHull(t){const n=t==null?t=new Hl:void 0,{hull:i,points:r}=this,a=i[0]*2,s=i.length;t.moveTo(r[a],r[a+1]);for(let o=1;o<s;++o){const l=2*i[o];t.lineTo(r[l],r[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new s3;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Hl:void 0,{points:r,triangles:a}=this,s=a[t*=3]*2,o=a[t+1]*2,l=a[t+2]*2;return n.moveTo(r[s],r[s+1]),n.lineTo(r[o],r[o+1]),n.lineTo(r[l],r[l+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new s3;return this.renderTriangle(t,n),n.value()}}function $0e(e,t,n,i){const r=e.length,a=new Float64Array(r*2);for(let s=0;s<r;++s){const o=e[s];a[s*2]=t.call(i,o,s,e),a[s*2+1]=n.call(i,o,s,e)}return a}function*D0e(e,t,n,i){let r=0;for(const a of e)yield t.call(i,a,r,e),yield n.call(i,a,r,e),++r}function xM(e){te.call(this,null,e)}xM.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const T0e=[-1e5,-1e5,1e5,1e5];me(xM,te,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:T0e;const a=this.value=bM.from(i,e.x,e.y).voronoi(r);for(let s=0,o=i.length;s<o;++s){const l=a.cellPolygon(s);i[s][n]=l&&!k0e(l)?M0e(l):null}return t.reflow(e.modified()).modifies(n)}});function M0e(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}function k0e(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const N0e=Object.freeze(Object.defineProperty({__proto__:null,voronoi:xM},Symbol.toStringTag,{value:"Module"}));var Ww=Math.PI/180,og=64,Ty=2048;function F0e(){var e=[256,256],t,n,i,r,a,s,o,l=sH,f=[],d=Math.random,h={};h.layout=function(){for(var v=p(Cu()),b=j0e((e[0]>>5)*e[1]),E=null,S=f.length,w=-1,_=[],C=f.map(M=>({text:t(M),font:n(M),style:r(M),weight:a(M),rotate:s(M),size:~~(i(M)+1e-14),padding:o(M),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:M})).sort((M,T)=>T.size-M.size);++w<S;){var $=C[w];$.x=e[0]*(d()+.5)>>1,$.y=e[1]*(d()+.5)>>1,O0e(v,$,C,w),$.hasText&&y(b,$,E)&&(_.push($),E?z0e(E,$):E=[{x:$.x+$.x0,y:$.y+$.y0},{x:$.x+$.x1,y:$.y+$.y1}],$.x-=e[0]>>1,$.y-=e[1]>>1)}return _};function p(v){v.width=v.height=1;var b=Math.sqrt(v.getContext("2d").getImageData(0,0,1,1).data.length>>2);v.width=(og<<5)/b,v.height=Ty/b;var E=v.getContext("2d");return E.fillStyle=E.strokeStyle="red",E.textAlign="center",{context:E,ratio:b}}function y(v,b,E){for(var S=b.x,w=b.y,_=Math.hypot(e[0],e[1]),C=l(e),$=d()<.5?1:-1,M=-$,T,F,R;(T=C(M+=$))&&(F=~~T[0],R=~~T[1],!(Math.min(Math.abs(F),Math.abs(R))>=_));)if(b.x=S+F,b.y=w+R,!(b.x+b.x0<0||b.y+b.y0<0||b.x+b.x1>e[0]||b.y+b.y1>e[1])&&(!E||!R0e(b,v,e[0]))&&(!E||B0e(b,E))){for(var B=b.sprite,L=b.width>>5,Y=e[0]>>5,H=b.x-(L<<4),U=H&127,z=32-U,O=b.y1-b.y0,I=(b.y+b.y0)*Y+(H>>5),W,K=0;K<O;K++){W=0;for(var k=0;k<=L;k++)v[I+k]|=W<<z|(k<L?(W=B[K*L+k])>>>U:0);I+=Y}return b.sprite=null,!0}return!1}return h.words=function(v){return arguments.length?(f=v,h):f},h.size=function(v){return arguments.length?(e=[+v[0],+v[1]],h):e},h.font=function(v){return arguments.length?(n=wl(v),h):n},h.fontStyle=function(v){return arguments.length?(r=wl(v),h):r},h.fontWeight=function(v){return arguments.length?(a=wl(v),h):a},h.rotate=function(v){return arguments.length?(s=wl(v),h):s},h.text=function(v){return arguments.length?(t=wl(v),h):t},h.spiral=function(v){return arguments.length?(l=U0e[v]||v,h):l},h.fontSize=function(v){return arguments.length?(i=wl(v),h):i},h.padding=function(v){return arguments.length?(o=wl(v),h):o},h.random=function(v){return arguments.length?(d=v,h):d},h}function O0e(e,t,n,i){if(!t.sprite){var r=e.context,a=e.ratio;r.clearRect(0,0,(og<<5)/a,Ty/a);var s=0,o=0,l=0,f=n.length,d,h,p,y,v;for(--i;++i<f;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,d=r.measureText(t.text+"m").width*a,p=t.size<<1,t.rotate){var b=Math.sin(t.rotate*Ww),E=Math.cos(t.rotate*Ww),S=d*E,w=d*b,_=p*E,C=p*b;d=Math.max(Math.abs(S+C),Math.abs(S-C))+31>>5<<5,p=~~Math.max(Math.abs(w+_),Math.abs(w-_))}else d=d+31>>5<<5;if(p>l&&(l=p),s+d>=og<<5&&(s=0,o+=l,l=0),o+p>=Ty)break;r.translate((s+(d>>1))/a,(o+(p>>1))/a),t.rotate&&r.rotate(t.rotate*Ww),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=d,t.height=p,t.xoff=s,t.yoff=o,t.x1=d>>1,t.y1=p>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=d}for(var $=r.getImageData(0,0,(og<<5)/a,Ty/a).data,M=[];--i>=0;)if(t=n[i],!!t.hasText){for(d=t.width,h=d>>5,p=t.y1-t.y0,y=0;y<p*h;y++)M[y]=0;if(s=t.xoff,s==null)return;o=t.yoff;var T=0,F=-1;for(v=0;v<p;v++){for(y=0;y<d;y++){var R=h*v+(y>>5),B=$[(o+v)*(og<<5)+(s+y)<<2]?1<<31-y%32:0;M[R]|=B,T|=B}T?F=v:(t.y0++,p--,v--,o++)}t.y1=t.y0+F,t.sprite=M.slice(0,(t.y1-t.y0)*h)}}}function R0e(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,a=e.x-(r<<4),s=a&127,o=32-s,l=e.y1-e.y0,f=(e.y+e.y0)*n+(a>>5),d,h=0;h<l;h++){d=0;for(var p=0;p<=r;p++)if((d<<o|(p<r?(d=i[h*r+p])>>>s:0))&t[f+p])return!0;f+=n}return!1}function z0e(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function B0e(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function sH(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function L0e(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(a){var s=a<0?-1:1;switch(Math.sqrt(1+4*s*a)-s&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function j0e(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function wl(e){return typeof e=="function"?e:function(){return e}}var U0e={archimedean:sH,rectangular:L0e};const oH=["x","y","font","fontSize","fontStyle","fontWeight","angle"],P0e=["text","font","rotate","fontSize","fontStyle","fontWeight"];function EM(e){te.call(this,F0e(),e)}EM.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:oH}]};me(EM,te,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&ae("Wordcloud size dimensions must be non-zero.");function n(v){const b=e[v];return We(b)&&t.modified(b.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||P0e.some(n)))return;const r=t.materialize(t.SOURCE).source,a=this.value,s=e.as||oH;let o=e.fontSize||14,l;if(We(o)?l=e.fontSizeRange:o=bi(o),l){const v=o,b=yt("sqrt")().domain(cs(r,v)).range(l);o=E=>b(v(E))}r.forEach(v=>{v[s[0]]=NaN,v[s[1]]=NaN,v[s[3]]=0});const f=a.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(o).random(Jr).layout(),d=a.size(),h=d[0]>>1,p=d[1]>>1,y=f.length;for(let v=0,b,E;v<y;++v)b=f[v],E=b.datum,E[s[0]]=b.x+h,E[s[1]]=b.y+p,E[s[2]]=b.font,E[s[3]]=b.size,E[s[4]]=b.style,E[s[5]]=b.weight,E[s[6]]=b.rotate;return t.reflow(i).modifies(s)}});const I0e=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:EM},Symbol.toStringTag,{value:"Module"})),q0e=e=>new Uint8Array(e),H0e=e=>new Uint16Array(e),Eg=e=>new Uint32Array(e);function G0e(){let e=8,t=[],n=Eg(0),i=W1(0,e),r=W1(0,e);return{data:()=>t,seen:()=>n=Y0e(n,t.length),add(a){for(let s=0,o=t.length,l=a.length,f;s<l;++s)f=a[s],f._index=o++,t.push(f)},remove(a,s){const o=t.length,l=Array(o-a),f=t;let d,h,p;for(h=0;!s[h]&&h<o;++h)l[h]=t[h],f[h]=h;for(p=h;h<o;++h)d=t[h],s[h]?f[h]=-1:(f[h]=p,i[p]=i[h],r[p]=r[h],l[p]=d,d._index=p++),i[h]=0;return t=l,f},size:()=>t.length,curr:()=>i,prev:()=>r,reset:a=>r[a]=i[a],all:()=>e<257?255:e<65537?65535:4294967295,set(a,s){i[a]|=s},clear(a,s){i[a]&=~s},resize(a,s){const o=i.length;(a>o||s>e)&&(e=Math.max(s,e),i=W1(a,e,i),r=W1(a,e))}}}function Y0e(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function W1(e,t,n){const i=(t<257?q0e:t<65537?H0e:Eg)(e);return n&&i.set(n),i}function C7(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,a){const s=this,o=s.bisect(s.range,r.value),l=r.index,f=o[0],d=o[1],h=l.length;let p;for(p=0;p<f;++p)a[l[p]]|=i;for(p=d;p<h;++p)a[l[p]]|=i;return s}}}function $7(){let e=Eg(0),t=[],n=0;function i(o,l,f){if(!l.length)return[];const d=n,h=l.length,p=Eg(h);let y=Array(h),v,b,E;for(E=0;E<h;++E)y[E]=o(l[E]),p[E]=E;if(y=V0e(y,p),d)v=t,b=e,t=Array(d+h),e=Eg(d+h),X0e(f,v,b,d,y,p,h,t,e);else{if(f>0)for(E=0;E<h;++E)p[E]+=f;t=y,e=p}return n=d+h,{index:p,value:y}}function r(o,l){const f=n;let d,h,p;for(h=0;!l[e[h]]&&h<f;++h);for(p=h;h<f;++h)l[d=e[h]]||(e[p]=d,t[p]=t[h],++p);n=f-o}function a(o){for(let l=0,f=n;l<f;++l)e[l]=o[e[l]]}function s(o,l){let f;return l?f=l.length:(l=t,f=n),[JJ(l,o[0],0,f),Mu(l,o[1],0,f)]}return{insert:i,remove:r,bisect:s,reindex:a,index:()=>e,size:()=>n}}function V0e(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],a=e[i];return r<a?-1:r>a?1:0}),nee(e,t)}function X0e(e,t,n,i,r,a,s,o,l){let f=0,d=0,h;for(h=0;f<i&&d<s;++h)t[f]<r[d]?(o[h]=t[f],l[h]=n[f++]):(o[h]=r[d],l[h]=a[d++]+e);for(;f<i;++f,++h)o[h]=t[f],l[h]=n[f];for(;d<s;++d,++h)o[h]=r[d],l[h]=a[d]+e}function SM(e){te.call(this,G0e(),e),this._indices=null,this._dims=null}SM.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};me(SM,te,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},a=this._dims=[],s=i.length;let o=0,l,f;for(;o<s;++o)l=n[o].fname,f=r[l]||(r[l]=$7()),a.push(C7(f,o,i[o]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,a=this._indices,s=this._dims,o=this.value,l=o.curr(),f=o.prev(),d=o.all(),h=n.rem=n.add,p=n.mod,y=r.length,v={};let b,E,S,w,_,C,$,M,T;if(f.set(l),t.rem.length&&(_=this.remove(e,t,n)),t.add.length&&o.add(t.add),t.mod.length)for(C={},w=t.mod,$=0,M=w.length;$<M;++$)C[w[$]._index]=1;for($=0;$<y;++$)T=i[$],(!s[$]||e.modified("fields",$)||t.modified(T.fields))&&(S=T.fname,(b=v[S])||(a[S]=E=$7(),v[S]=b=E.insert(T,t.source,0)),s[$]=C7(E,$,r[$]).onAdd(b,l));for($=0,M=o.data().length;$<M;++$)_[$]||(f[$]!==l[$]?h.push($):C[$]&&l[$]!==d&&p.push($));return o.mask=(1<<y)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,a=this._dims,s=this._indices,o=e.fields,l={},f=n.add,d=r.size()+i.length,h=a.length;let p=r.size(),y,v,b;r.resize(d,h),r.add(i);const E=r.curr(),S=r.prev(),w=r.all();for(y=0;y<h;++y)v=o[y].fname,b=l[v]||(l[v]=s[v].insert(o[y],i,p)),a[y].onAdd(b,E);for(;p<d;++p)S[p]=w,E[p]!==w&&f.push(p)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),a=i.all(),s=e.mod;let o,l,f;for(o=0,l=s.length;o<l;++o)f=s[o]._index,r[f]!==a&&n.push(f)},remove(e,t,n){const i=this._indices,r=this.value,a=r.curr(),s=r.prev(),o=r.all(),l={},f=n.rem,d=t.rem;let h,p,y,v;for(h=0,p=d.length;h<p;++h)y=d[h]._index,l[y]=1,s[y]=v=a[y],a[y]=o,v!==o&&f.push(y);for(y in i)i[y].remove(p,l);return this.reindex(t,p,l),l},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const a=r.remove(t,n);for(const s in i)i[s].reindex(a)})},update(e,t,n){const i=this._dims,r=e.query,a=t.stamp,s=i.length;let o=0,l,f;for(n.filters=0,f=0;f<s;++f)e.modified("query",f)&&(l=f,++o);if(o===1)o=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(f=0,o=0;f<s;++f)e.modified("query",f)&&(o|=i[f].one,this.incrementAll(i[f],r[f],a,n.add),n.rem=n.add);return o},incrementAll(e,t,n,i){const r=this.value,a=r.seen(),s=r.curr(),o=r.prev(),l=e.index(),f=e.bisect(e.range),d=e.bisect(t),h=d[0],p=d[1],y=f[0],v=f[1],b=e.one;let E,S,w;if(h<y)for(E=h,S=Math.min(y,p);E<S;++E)w=l[E],a[w]!==n&&(o[w]=s[w],a[w]=n,i.push(w)),s[w]^=b;else if(h>y)for(E=y,S=Math.min(h,v);E<S;++E)w=l[E],a[w]!==n&&(o[w]=s[w],a[w]=n,i.push(w)),s[w]^=b;if(p>v)for(E=Math.max(h,v),S=p;E<S;++E)w=l[E],a[w]!==n&&(o[w]=s[w],a[w]=n,i.push(w)),s[w]^=b;else if(p<v)for(E=Math.max(y,p),S=v;E<S;++E)w=l[E],a[w]!==n&&(o[w]=s[w],a[w]=n,i.push(w)),s[w]^=b;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,a=r.curr(),s=e.index(),o=e.bisect(e.range),l=e.bisect(t),f=l[0],d=l[1],h=o[0],p=o[1],y=e.one;let v,b,E;if(f<h)for(v=f,b=Math.min(h,d);v<b;++v)E=s[v],a[E]^=y,n.push(E);else if(f>h)for(v=h,b=Math.min(f,p);v<b;++v)E=s[v],a[E]^=y,i.push(E);if(d>p)for(v=Math.max(f,p),b=d;v<b;++v)E=s[v],a[E]^=y,n.push(E);else if(d<p)for(v=Math.max(h,d),b=p;v<b;++v)E=s[v],a[E]^=y,i.push(E);e.range=t.slice()}});function AM(e){te.call(this,null,e)}AM.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};me(AM,te,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)===0)return t.StopPropagation;const a=t.fork(t.ALL),s=i.data(),o=i.curr(),l=i.prev(),f=d=>o[d]&n?null:s[d];return a.filter(a.MOD,f),r&r-1?(a.filter(a.ADD,d=>{const h=o[d]&n;return!h&&h^l[d]&n?s[d]:null}),a.filter(a.REM,d=>{const h=o[d]&n;return h&&!(h^(h^l[d]&n))?s[d]:null})):(a.filter(a.ADD,f),a.filter(a.REM,d=>(o[d]&n)===r?s[d]:null)),a.filter(a.SOURCE,d=>f(d._index))}});const W0e=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:SM,resolvefilter:AM},Symbol.toStringTag,{value:"Module"})),Q0e="RawCode",fc="Literal",Z0e="Property",K0e="Identifier",J0e="ArrayExpression",ege="BinaryExpression",uH="CallExpression",tge="ConditionalExpression",nge="LogicalExpression",ige="MemberExpression",rge="ObjectExpression",age="UnaryExpression";function Fa(e){this.type=e}Fa.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=sge(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function sge(e){switch(e.type){case J0e:return e.elements;case ege:case nge:return[e.left,e.right];case uH:return[e.callee].concat(e.arguments);case tge:return[e.test,e.consequent,e.alternate];case ige:return[e.object,e.property];case rge:return e.properties;case Z0e:return[e.key,e.value];case age:return[e.argument];case K0e:case fc:case Q0e:default:return[]}}var As,Ae,ie,pi,_t,Tx=1,Lp=2,dc=3,Wu=4,Mx=5,Fc=6,Yi=7,jp=8,oge=9;As={};As[Tx]="Boolean";As[Lp]="<end>";As[dc]="Identifier";As[Wu]="Keyword";As[Mx]="Null";As[Fc]="Numeric";As[Yi]="Punctuator";As[jp]="String";As[oge]="RegularExpression";var uge="ArrayExpression",lge="BinaryExpression",cge="CallExpression",fge="ConditionalExpression",lH="Identifier",dge="Literal",hge="LogicalExpression",gge="MemberExpression",pge="ObjectExpression",mge="Property",yge="UnaryExpression",Rn="Unexpected token %0",vge="Unexpected number",bge="Unexpected string",xge="Unexpected identifier",Ege="Unexpected reserved word",Sge="Unexpected end of input",o3="Invalid regular expression",Qw="Invalid regular expression: missing /",cH="Octal literals are not allowed in strict mode.",Age="Duplicate data property in object literal not allowed in strict mode",Zn="ILLEGAL",Yg="Disabled.",wge=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),_ge=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function kx(e,t){if(!e)throw new Error("ASSERT: "+t)}function Js(e){return e>=48&&e<=57}function wM(e){return"0123456789abcdefABCDEF".includes(e)}function Sg(e){return"01234567".includes(e)}function Cge(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function Vg(e){return e===10||e===13||e===8232||e===8233}function Up(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&wge.test(String.fromCharCode(e))}function Zv(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&_ge.test(String.fromCharCode(e))}const $ge={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function fH(){for(;ie<pi;){const e=Ae.charCodeAt(ie);if(Cge(e)||Vg(e))++ie;else break}}function u3(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)ie<pi&&wM(Ae[ie])?(i=Ae[ie++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):gt({},Rn,Zn);return String.fromCharCode(r)}function Dge(){var e,t,n,i;for(e=Ae[ie],t=0,e==="}"&&gt({},Rn,Zn);ie<pi&&(e=Ae[ie++],!!wM(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&gt({},Rn,Zn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function dH(){var e,t;for(e=Ae.charCodeAt(ie++),t=String.fromCharCode(e),e===92&&(Ae.charCodeAt(ie)!==117&&gt({},Rn,Zn),++ie,e=u3("u"),(!e||e==="\\"||!Up(e.charCodeAt(0)))&&gt({},Rn,Zn),t=e);ie<pi&&(e=Ae.charCodeAt(ie),!!Zv(e));)++ie,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Ae.charCodeAt(ie)!==117&&gt({},Rn,Zn),++ie,e=u3("u"),(!e||e==="\\"||!Zv(e.charCodeAt(0)))&&gt({},Rn,Zn),t+=e);return t}function Tge(){var e,t;for(e=ie++;ie<pi;){if(t=Ae.charCodeAt(ie),t===92)return ie=e,dH();if(Zv(t))++ie;else break}return Ae.slice(e,ie)}function Mge(){var e,t,n;return e=ie,t=Ae.charCodeAt(ie)===92?dH():Tge(),t.length===1?n=dc:$ge.hasOwnProperty(t)?n=Wu:t==="null"?n=Mx:t==="true"||t==="false"?n=Tx:n=dc,{type:n,value:t,start:e,end:ie}}function Zw(){var e=ie,t=Ae.charCodeAt(ie),n,i=Ae[ie],r,a,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ie,{type:Yi,value:String.fromCharCode(t),start:e,end:ie};default:if(n=Ae.charCodeAt(ie+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ie+=2,{type:Yi,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:ie};case 33:case 61:return ie+=2,Ae.charCodeAt(ie)===61&&++ie,{type:Yi,value:Ae.slice(e,ie),start:e,end:ie}}}if(s=Ae.substr(ie,4),s===">>>=")return ie+=4,{type:Yi,value:s,start:e,end:ie};if(a=s.substr(0,3),a===">>>"||a==="<<="||a===">>=")return ie+=3,{type:Yi,value:a,start:e,end:ie};if(r=a.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return ie+=2,{type:Yi,value:r,start:e,end:ie};if(r==="//"&&gt({},Rn,Zn),"<>=!+-*%&|^/".includes(i))return++ie,{type:Yi,value:i,start:e,end:ie};gt({},Rn,Zn)}function kge(e){let t="";for(;ie<pi&&wM(Ae[ie]);)t+=Ae[ie++];return t.length===0&&gt({},Rn,Zn),Up(Ae.charCodeAt(ie))&&gt({},Rn,Zn),{type:Fc,value:parseInt("0x"+t,16),start:e,end:ie}}function Nge(e){let t="0"+Ae[ie++];for(;ie<pi&&Sg(Ae[ie]);)t+=Ae[ie++];return(Up(Ae.charCodeAt(ie))||Js(Ae.charCodeAt(ie)))&&gt({},Rn,Zn),{type:Fc,value:parseInt(t,8),octal:!0,start:e,end:ie}}function D7(){var e,t,n;if(n=Ae[ie],kx(Js(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=ie,e="",n!=="."){if(e=Ae[ie++],n=Ae[ie],e==="0"){if(n==="x"||n==="X")return++ie,kge(t);if(Sg(n))return Nge(t);n&&Js(n.charCodeAt(0))&&gt({},Rn,Zn)}for(;Js(Ae.charCodeAt(ie));)e+=Ae[ie++];n=Ae[ie]}if(n==="."){for(e+=Ae[ie++];Js(Ae.charCodeAt(ie));)e+=Ae[ie++];n=Ae[ie]}if(n==="e"||n==="E")if(e+=Ae[ie++],n=Ae[ie],(n==="+"||n==="-")&&(e+=Ae[ie++]),Js(Ae.charCodeAt(ie)))for(;Js(Ae.charCodeAt(ie));)e+=Ae[ie++];else gt({},Rn,Zn);return Up(Ae.charCodeAt(ie))&&gt({},Rn,Zn),{type:Fc,value:parseFloat(e),start:t,end:ie}}function Fge(){var e="",t,n,i,r,a=!1;for(t=Ae[ie],kx(t==="'"||t==='"',"String literal must starts with a quote"),n=ie,++ie;ie<pi;)if(i=Ae[ie++],i===t){t="";break}else if(i==="\\")if(i=Ae[ie++],!i||!Vg(i.charCodeAt(0)))switch(i){case"u":case"x":Ae[ie]==="{"?(++ie,e+=Dge()):e+=u3(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Sg(i)?(r="01234567".indexOf(i),r!==0&&(a=!0),ie<pi&&Sg(Ae[ie])&&(a=!0,r=r*8+"01234567".indexOf(Ae[ie++]),"0123".includes(i)&&ie<pi&&Sg(Ae[ie])&&(r=r*8+"01234567".indexOf(Ae[ie++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&Ae[ie]===`
`&&++ie;else{if(Vg(i.charCodeAt(0)))break;e+=i}return t!==""&&gt({},Rn,Zn),{type:jp,value:e,octal:a,start:n,end:ie}}function Oge(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";gt({},o3)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{gt({},o3)}try{return new RegExp(e,t)}catch{return null}}function Rge(){var e,t,n,i,r;for(e=Ae[ie],kx(e==="/","Regular expression literal must start with a slash"),t=Ae[ie++],n=!1,i=!1;ie<pi;)if(e=Ae[ie++],t+=e,e==="\\")e=Ae[ie++],Vg(e.charCodeAt(0))&&gt({},Qw),t+=e;else if(Vg(e.charCodeAt(0)))gt({},Qw);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||gt({},Qw),r=t.substr(1,t.length-2),{value:r,literal:t}}function zge(){var e,t,n;for(t="",n="";ie<pi&&(e=Ae[ie],!!Zv(e.charCodeAt(0)));)++ie,e==="\\"&&ie<pi?gt({},Rn,Zn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&gt({},o3,n),{value:n,literal:t}}function Bge(){var e,t,n,i;return _t=null,fH(),e=ie,t=Rge(),n=zge(),i=Oge(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:ie}}function Lge(e){return e.type===dc||e.type===Wu||e.type===Tx||e.type===Mx}function hH(){if(fH(),ie>=pi)return{type:Lp,start:ie,end:ie};const e=Ae.charCodeAt(ie);return Up(e)?Mge():e===40||e===41||e===59?Zw():e===39||e===34?Fge():e===46?Js(Ae.charCodeAt(ie+1))?D7():Zw():Js(e)?D7():Zw()}function Wi(){const e=_t;return ie=e.end,_t=hH(),ie=e.end,e}function gH(){const e=ie;_t=hH(),ie=e}function jge(e){const t=new Fa(uge);return t.elements=e,t}function T7(e,t,n){const i=new Fa(e==="||"||e==="&&"?hge:lge);return i.operator=e,i.left=t,i.right=n,i}function Uge(e,t){const n=new Fa(cge);return n.callee=e,n.arguments=t,n}function Pge(e,t,n){const i=new Fa(fge);return i.test=e,i.consequent=t,i.alternate=n,i}function _M(e){const t=new Fa(lH);return t.name=e,t}function ug(e){const t=new Fa(dge);return t.value=e.value,t.raw=Ae.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function M7(e,t,n){const i=new Fa(gge);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function Ige(e){const t=new Fa(pge);return t.properties=e,t}function k7(e,t,n){const i=new Fa(mge);return i.key=t,i.value=n,i.kind=e,i}function qge(e,t){const n=new Fa(yge);return n.operator=e,n.argument=t,n.prefix=!0,n}function gt(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(a,s)=>(kx(s<i.length,"Message reference must be in range"),i[s]));throw n=new Error(r),n.index=ie,n.description=r,n}function Nx(e){e.type===Lp&&gt(e,Sge),e.type===Fc&&gt(e,vge),e.type===jp&&gt(e,bge),e.type===dc&&gt(e,xge),e.type===Wu&&gt(e,Ege),gt(e,Rn,e.value)}function mi(e){const t=Wi();(t.type!==Yi||t.value!==e)&&Nx(t)}function Lt(e){return _t.type===Yi&&_t.value===e}function Kw(e){return _t.type===Wu&&_t.value===e}function Hge(){const e=[];for(ie=_t.start,mi("[");!Lt("]");)Lt(",")?(Wi(),e.push(null)):(e.push(hc()),Lt("]")||mi(","));return Wi(),jge(e)}function N7(){ie=_t.start;const e=Wi();return e.type===jp||e.type===Fc?(e.octal&&gt(e,cH),ug(e)):_M(e.value)}function Gge(){var e,t,n,i;if(ie=_t.start,e=_t,e.type===dc)return n=N7(),mi(":"),i=hc(),k7("init",n,i);if(e.type===Lp||e.type===Yi)Nx(e);else return t=N7(),mi(":"),i=hc(),k7("init",t,i)}function Yge(){var e=[],t,n,i,r={},a=String;for(ie=_t.start,mi("{");!Lt("}");)t=Gge(),t.key.type===lH?n=t.key.name:n=a(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?gt({},Age):r[i]=!0,e.push(t),Lt("}")||mi(",");return mi("}"),Ige(e)}function Vge(){mi("(");const e=CM();return mi(")"),e}const Xge={if:1};function Wge(){var e,t,n;if(Lt("("))return Vge();if(Lt("["))return Hge();if(Lt("{"))return Yge();if(e=_t.type,ie=_t.start,e===dc||Xge[_t.value])n=_M(Wi().value);else if(e===jp||e===Fc)_t.octal&&gt(_t,cH),n=ug(Wi());else{if(e===Wu)throw new Error(Yg);e===Tx?(t=Wi(),t.value=t.value==="true",n=ug(t)):e===Mx?(t=Wi(),t.value=null,n=ug(t)):Lt("/")||Lt("/=")?(n=ug(Bge()),gH()):Nx(Wi())}return n}function Qge(){const e=[];if(mi("("),!Lt(")"))for(;ie<pi&&(e.push(hc()),!Lt(")"));)mi(",");return mi(")"),e}function Zge(){ie=_t.start;const e=Wi();return Lge(e)||Nx(e),_M(e.value)}function Kge(){return mi("."),Zge()}function Jge(){mi("[");const e=CM();return mi("]"),e}function epe(){var e,t,n;for(e=Wge();;)if(Lt("."))n=Kge(),e=M7(".",e,n);else if(Lt("("))t=Qge(),e=Uge(e,t);else if(Lt("["))n=Jge(),e=M7("[",e,n);else break;return e}function F7(){const e=epe();if(_t.type===Yi&&(Lt("++")||Lt("--")))throw new Error(Yg);return e}function My(){var e,t;if(_t.type!==Yi&&_t.type!==Wu)t=F7();else{if(Lt("++")||Lt("--"))throw new Error(Yg);if(Lt("+")||Lt("-")||Lt("~")||Lt("!"))e=Wi(),t=My(),t=qge(e.value,t);else{if(Kw("delete")||Kw("void")||Kw("typeof"))throw new Error(Yg);t=F7()}}return t}function O7(e){let t=0;if(e.type!==Yi&&e.type!==Wu)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function tpe(){var e,t,n,i,r,a,s,o,l,f;if(e=_t,l=My(),i=_t,r=O7(i),r===0)return l;for(i.prec=r,Wi(),t=[e,_t],s=My(),a=[l,i,s];(r=O7(_t))>0;){for(;a.length>2&&r<=a[a.length-2].prec;)s=a.pop(),o=a.pop().value,l=a.pop(),t.pop(),n=T7(o,l,s),a.push(n);i=Wi(),i.prec=r,a.push(i),t.push(_t),n=My(),a.push(n)}for(f=a.length-1,n=a[f],t.pop();f>1;)t.pop(),n=T7(a[f-1].value,a[f-2],n),f-=2;return n}function hc(){var e,t,n;return e=tpe(),Lt("?")&&(Wi(),t=hc(),mi(":"),n=hc(),e=Pge(e,t,n)),e}function CM(){const e=hc();if(Lt(","))throw new Error(Yg);return e}function pH(e){Ae=e,ie=0,pi=Ae.length,_t=null,gH();const t=CM();if(_t.type!==Lp)throw new Error("Unexpect token after expression.");return t}var mH={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function yH(e){function t(s,o,l,f){let d=e(o[0]);return l&&(d=l+"("+d+")",l.lastIndexOf("new ",0)===0&&(d="("+d+")")),d+"."+s+(f<0?"":f===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(s,o,l){return f=>t(s,f,o,l)}const i="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&ae("Missing arguments to clamp function."),s.length>3&&ae("Too many arguments to clamp function.");const o=s.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),btoa:"btoa",atob:"atob",regexp:a,test:n("test",a),if:function(s){s.length<3&&ae("Missing arguments to if function."),s.length>3&&ae("Too many arguments to if function.");const o=s.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function npe(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function vH(e){e=e||{};const t=e.allowed?wa(e.allowed):{},n=e.forbidden?wa(e.forbidden):{},i=e.constants||mH,r=(e.functions||yH)(h),a=e.globalvar,s=e.fieldvar,o=We(a)?a:v=>`${a}["${v}"]`;let l={},f={},d=0;function h(v){if(ft(v))return v;const b=p[v.type];return b==null&&ae("Unsupported type: "+v.type),b(v)}const p={Literal:v=>v.raw,Identifier:v=>{const b=v.name;return d>0?b:ze(n,b)?ae("Illegal identifier: "+b):ze(i,b)?i[b]:ze(t,b)?b:(l[b]=1,o(b))},MemberExpression:v=>{const b=!v.computed,E=h(v.object);b&&(d+=1);const S=h(v.property);return E===s&&(f[npe(S)]=1),b&&(d-=1),E+(b?"."+S:"["+S+"]")},CallExpression:v=>{v.callee.type!=="Identifier"&&ae("Illegal callee type: "+v.callee.type);const b=v.callee.name,E=v.arguments,S=ze(r,b)&&r[b];return S||ae("Unrecognized function: "+b),We(S)?S(E):S+"("+E.map(h).join(",")+")"},ArrayExpression:v=>"["+v.elements.map(h).join(",")+"]",BinaryExpression:v=>"("+h(v.left)+" "+v.operator+" "+h(v.right)+")",UnaryExpression:v=>"("+v.operator+h(v.argument)+")",ConditionalExpression:v=>"("+h(v.test)+"?"+h(v.consequent)+":"+h(v.alternate)+")",LogicalExpression:v=>"("+h(v.left)+v.operator+h(v.right)+")",ObjectExpression:v=>"{"+v.properties.map(h).join(",")+"}",Property:v=>{d+=1;const b=h(v.key);return d-=1,b+":"+h(v.value)}};function y(v){const b={code:h(v),globals:Object.keys(l),fields:Object.keys(f)};return l={},f={},b}return y.functions=r,y.constants=i,y}const R7=Symbol("vega_selection_getter");function bH(e){return(!e.getter||!e.getter[R7])&&(e.getter=Qr(e.field),e.getter[R7]=!0),e.getter}const $M="intersect",z7="union",ipe="vlMulti",rpe="vlPoint",B7="or",ape="and",Ka="_vgsid_",Xg=Qr(Ka),spe="E",ope="R",upe="R-E",lpe="R-LE",cpe="R-RE",fpe="E-LT",dpe="E-LTE",hpe="E-GT",gpe="E-GTE",ppe="E-VALID",mpe="E-ONE",Kv="index:unit";function L7(e,t){for(var n=t.fields,i=t.values,r=n.length,a=0,s,o;a<r;++a)if(o=n[a],s=bH(o)(e),Au(s)&&(s=fi(s)),Au(i[a])&&(i[a]=fi(i[a])),De(i[a])&&Au(i[a][0])&&(i[a]=i[a].map(fi)),o.type===spe){if(De(i[a])?!i[a].includes(s):s!==i[a])return!1}else if(o.type===ope){if(!Wf(s,i[a]))return!1}else if(o.type===cpe){if(!Wf(s,i[a],!0,!1))return!1}else if(o.type===upe){if(!Wf(s,i[a],!1,!1))return!1}else if(o.type===lpe){if(!Wf(s,i[a],!1,!0))return!1}else if(o.type===fpe){if(s>=i[a])return!1}else if(o.type===dpe){if(s>i[a])return!1}else if(o.type===hpe){if(s<=i[a])return!1}else if(o.type===gpe){if(s<i[a])return!1}else if(o.type===ppe){if(s===null||isNaN(s))return!1}else if(o.type===mpe&&i[a].indexOf(s)===-1)return!1;return!0}function ype(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],a=i?i[Kv]&&i[Kv].value:void 0,s=n===$M,o=r.length,l=0,f,d,h,p,y;l<o;++l)if(f=r[l],a&&s){if(d=d||{},h=d[p=f.unit]||0,h===-1)continue;if(y=L7(t,f),d[p]=y?-1:++h,y&&a.size===1)return!0;if(!y&&h===a.get(p).count)return!1}else if(y=L7(t,f),s^y)return y;return o&&s}const xH=Qd(Xg),vpe=xH.left,bpe=xH.right;function xpe(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],a=i?i[Kv]&&i[Kv].value:void 0,s=n===$M,o=Xg(t),l=vpe(r,o);if(l===r.length||Xg(r[l])!==o)return!1;if(a&&s){if(a.size===1)return!0;if(bpe(r,o)-l<a.size)return!1}return!0}function Epe(e,t){return e.map(n=>Ve(t.fields?{values:t.fields.map(i=>bH(i)(n.datum))}:{[Ka]:Xg(n.datum)},t))}function Spe(e,t,n,i){for(var r=this.context.data[e],a=r?r.values.value:[],s={},o={},l={},f,d,h,p,y,v,b,E,S,w,_=a.length,C=0,$,M;C<_;++C)if(f=a[C],p=f.unit,d=f.fields,h=f.values,d&&h){for($=0,M=d.length;$<M;++$)y=d[$],b=s[y.field]||(s[y.field]={}),E=b[p]||(b[p]=[]),l[y.field]=S=y.type.charAt(0),w=Jw[`${S}_union`],b[p]=w(E,Fe(h[$]));n&&(E=o[p]||(o[p]=[]),E.push(Fe(h).reduce((T,F,R)=>(T[d[R].field]=F,T),{})))}else y=Ka,v=Xg(f),b=s[y]||(s[y]={}),E=b[p]||(b[p]=[]),E.push(v),n&&(E=o[p]||(o[p]=[]),E.push({[Ka]:v}));if(t=t||z7,s[Ka]?s[Ka]=Jw[`${Ka}_${t}`](...Object.values(s[Ka])):Object.keys(s).forEach(T=>{s[T]=Object.keys(s[T]).map(F=>s[T][F]).reduce((F,R)=>F===void 0?R:Jw[`${l[T]}_${t}`](F,R))}),a=Object.keys(o),n&&a.length){const T=i?rpe:ipe;s[T]=t===z7?{[B7]:a.reduce((F,R)=>(F.push(...o[R]),F),[])}:{[ape]:a.map(F=>({[B7]:o[F]}))}}return s}var Jw={[`${Ka}_union`]:fee,[`${Ka}_intersect`]:lee,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=fi(t[0]),i=fi(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=fi(t[0]),i=fi(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const Ape=":",wpe="@";function DM(e,t,n,i){t[0].type!==fc&&ae("First argument to selection functions must be a string literal.");const r=t[0].value,a=t.length>=2&&st(t).value,s="unit",o=wpe+s,l=Ape+r;a===$M&&!ze(i,o)&&(i[o]=n.getData(r).indataRef(n,s)),ze(i,l)||(i[l]=n.getData(r).tuplesRef())}function EH(e){const t=this.context.data[e];return t?t.values.value:[]}function _pe(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Cpe(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Zr).insert(t)),1}function $pe(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const Pp=e=>function(t,n){const i=this.context.dataflow.locale();return t===null?"null":i[e](n)(t)},Dpe=Pp("format"),SH=Pp("timeFormat"),Tpe=Pp("utcFormat"),Mpe=Pp("timeParse"),kpe=Pp("utcParse"),Q1=new Date(2e3,0,1);function Fx(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Q1.setYear(2e3),Q1.setMonth(e),Q1.setDate(t),SH.call(this,Q1,n))}function Npe(e){return Fx.call(this,e,1,"%B")}function Fpe(e){return Fx.call(this,e,1,"%b")}function Ope(e){return Fx.call(this,0,2+e,"%A")}function Rpe(e){return Fx.call(this,0,2+e,"%a")}const zpe=":",Bpe="@",l3="%",AH="$";function TM(e,t,n,i){t[0].type!==fc&&ae("First argument to data functions must be a string literal.");const r=t[0].value,a=zpe+r;if(!ze(a,i))try{i[a]=n.getData(r).tuplesRef()}catch{}}function Lpe(e,t,n,i){t[0].type!==fc&&ae("First argument to indata must be a string literal."),t[1].type!==fc&&ae("Second argument to indata must be a string literal.");const r=t[0].value,a=t[1].value,s=Bpe+a;ze(s,i)||(i[s]=n.getData(r).indataRef(n,a))}function Ni(e,t,n,i){if(t[0].type===fc)j7(n,i,t[0].value);else for(e in n.scales)j7(n,i,e)}function j7(e,t,n){const i=l3+n;if(!ze(t,i))try{t[i]=e.scaleRef(n)}catch{}}function ws(e,t){if(ft(e)){const n=t.scales[e];return n&&IR(n.value)?n.value:void 0}else if(We(e))return IR(e)?e:void 0}function jpe(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Ni,n._range=Ni,n._scale=Ni;const i=r=>"_["+(r.type===fc?$e(l3+r.value):$e(l3)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function MM(e,t){return function(n,i,r){if(n){const a=ws(n,(r||this).context);return a&&a.path[e](i)}else return t(i)}}const Upe=MM("area",rce),Ppe=MM("bounds",uce),Ipe=MM("centroid",gce);function qpe(e,t){const n=ws(e,(t||this).context);return n&&n.scale()}function Hpe(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function kM(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function Gpe(){return kM(this.context.dataflow,"warn",arguments)}function Ype(){return kM(this.context.dataflow,"info",arguments)}function Vpe(){return kM(this.context.dataflow,"debug",arguments)}function e_(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function c3(e){const t=Ou(e),n=e_(t.r),i=e_(t.g),r=e_(t.b);return .2126*n+.7152*i+.0722*r}function Xpe(e,t){const n=c3(e),i=c3(t),r=Math.max(n,i),a=Math.min(n,i);return(r+.05)/(a+.05)}function Wpe(){const e=[].slice.call(arguments);return e.unshift({}),Ve(...e)}function wH(e,t){return e===t||e!==e&&t!==t?!0:De(e)?De(t)&&e.length===t.length?Qpe(e,t):!1:Pe(e)&&Pe(t)?_H(e,t):!1}function Qpe(e,t){for(let n=0,i=e.length;n<i;++n)if(!wH(e[n],t[n]))return!1;return!0}function _H(e,t){for(const n in e)if(!wH(e[n],t[n]))return!1;return!0}function U7(e){return t=>_H(e,t)}function Zpe(e,t,n,i,r,a){const s=this.context.dataflow,o=this.context.data[e],l=o.input,f=s.stamp();let d=o.changes,h,p;if(s._trigger===!1||!(l.value.length||t||i))return 0;if((!d||d.stamp<f)&&(o.changes=d=s.changeset(),d.stamp=f,s.runAfter(()=>{o.modified=!0,s.pulse(l,d).run()},!0,1)),n&&(h=n===!0?Zr:De(n)||Ib(n)?n:U7(n),d.remove(h)),t&&d.insert(t),i&&(h=U7(i),l.value.some(h)?d.remove(h):d.insert(i)),r)for(p in a)d.modify(r,p,a[p]);return 1}function Kpe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function Jpe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const P7={};function eme(e,t){const n=P7[t]||(P7[t]=Qr(t));return De(e)?e.map(n):n(e)}function Ox(e){return De(e)||ArrayBuffer.isView(e)?e:null}function NM(e){return Ox(e)||(ft(e)?e:null)}function tme(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ox(e).join(...n)}function nme(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return NM(e).indexOf(...n)}function ime(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return NM(e).lastIndexOf(...n)}function rme(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return NM(e).slice(...n)}function ame(e,t,n){return We(n)&&ae("Function argument passed to replace."),!ft(t)&&!v$(t)&&ae("Please pass a string or RegExp argument to replace."),String(e).replace(t,n)}function sme(e){return Ox(e).slice().reverse()}function ome(e){return Ox(e).slice().sort(hp)}function ume(e,t,n){return YD(e||0,t||0,n||0)}function lme(e,t){const n=ws(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function cme(e,t){const n=ws(e,(t||this).context);return n?n.copy():void 0}function fme(e,t){const n=ws(e,(t||this).context);return n?n.domain():[]}function dme(e,t,n){const i=ws(e,(n||this).context);return i?De(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function hme(e,t){const n=ws(e,(t||this).context);return n&&n.range?n.range():[]}function gme(e,t,n){const i=ws(e,(n||this).context);return i?i(t):void 0}function pme(e,t,n,i,r){e=ws(e,(r||this).context);const a=gP(t,n);let s=e.domain(),o=s[0],l=st(s),f=Fi;return l-o?f=nP(e,o,l):e=(e.interpolator?yt("sequential")().interpolator(e.interpolator()):yt("linear")().interpolate(e.interpolate()).range(e.range())).domain([o=0,l=1]),e.ticks&&(s=e.ticks(+i||15),o!==s[0]&&s.unshift(o),l!==st(s)&&s.push(l)),s.forEach(d=>a.stop(f(d),e(d))),a}function mme(e,t,n){const i=ws(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function yme(e){let t=null;return function(n){return n?Lg(n,t=t||Ad(e)):e}}const CH=e=>e.data;function $H(e,t){const n=EH.call(t,e);return n.root&&n.root.lookup||{}}function vme(e,t,n){const i=$H(e,this),r=i[t],a=i[n];return r&&a?r.path(a).map(CH):void 0}function bme(e,t){const n=$H(e,this)[t];return n?n.ancestors().map(CH):void 0}const DH=()=>typeof window<"u"&&window||null;function xme(){const e=DH();return e?e.screen:{}}function Eme(){const e=DH();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Sme(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function TH(e,t,n){if(!e)return[];const[i,r]=e,a=new yn().set(i[0],i[1],r[0],r[1]),s=n||this.context.dataflow.scenegraph().root;return fI(s,a,Ame(t))}function Ame(e){let t=null;if(e){const n=Fe(e.marktype),i=Fe(e.markname);t=r=>(!n.length||n.some(a=>r.marktype===a))&&(!i.length||i.some(a=>r.name===a))}return t}function wme(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=Fe(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function _me(e){return Fe(e).reduce((t,n,i)=>{let[r,a]=n;return t+=i==0?`M ${r},${a} `:i===e.length-1?" Z":`L ${r},${a} `},"")}function Cme(e,t,n){const{x:i,y:r,mark:a}=n,s=new yn().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,f]of t)l<s.x1&&(s.x1=l),l>s.x2&&(s.x2=l),f<s.y1&&(s.y1=f),f>s.y2&&(s.y2=f);return s.translate(i,r),TH([[s.x1,s.y1],[s.x2,s.y2]],e,a).filter(l=>$me(l.x,l.y,t))}function $me(e,t,n){let i=0;for(let r=0,a=n.length-1;r<n.length;a=r++){const[s,o]=n[a],[l,f]=n[r];f>t!=o>t&&e<(s-l)*(t-f)/(o-f)+l&&i++}return i&1}const Wg={random(){return Jr()},cumulativeNormal:Vb,cumulativeLogNormal:Y$,cumulativeUniform:Q$,densityNormal:P$,densityLogNormal:G$,densityUniform:W$,quantileNormal:Xb,quantileLogNormal:V$,quantileUniform:Z$,sampleNormal:Yb,sampleLogNormal:H$,sampleUniform:X$,isArray:De,isBoolean:y$,isDate:Au,isDefined(e){return e!==void 0},isNumber:Tu,isObject:Pe,isRegExp:v$,isString:ft,isTuple:Ib,isValid(e){return e!=null&&e===e},toBoolean:x$,toDate(e){return E$(e)},toNumber:fi,toString:S$,indexof:nme,join:tme,lastindexof:ime,replace:ame,reverse:sme,sort:ome,slice:rme,flush:OB,lerp:zB,merge:Wpe,pad:jB,peek:st,pluck:eme,span:gp,inrange:Wf,truncate:UB,rgb:Ou,lab:rv,hcl:av,hsl:nv,luminance:c3,contrast:Xpe,sequence:Er,format:Dpe,utcFormat:Tpe,utcParse:kpe,utcOffset:bL,utcSequence:SL,timeFormat:SH,timeParse:Mpe,timeOffset:vL,timeSequence:EL,timeUnitSpecifier:oL,monthFormat:Npe,monthAbbrevFormat:Fpe,dayFormat:Ope,dayAbbrevFormat:Rpe,quarter:MB,utcquarter:kB,week:lL,utcweek:dL,dayofyear:uL,utcdayofyear:fL,warn:Gpe,info:Ype,debug:Vpe,extent(e){return cs(e)},inScope:Hpe,intersect:TH,clampRange:NB,pinchDistance:Kpe,pinchAngle:Jpe,screen:xme,containerSize:Sme,windowSize:Eme,bandspace:ume,setdata:Cpe,pathShape:yme,panLinear:CB,panLog:$B,panPow:DB,panSymlog:TB,zoomLinear:d$,zoomLog:h$,zoomPow:qy,zoomSymlog:g$,encode:$pe,modify:Zpe,lassoAppend:wme,lassoPath:_me,intersectLasso:Cme},Dme=["view","item","group","xy","x","y"],Tme="event.vega.",MH="this.",FM={},kH={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${$e(AH+e)}]`,functions:Mme,constants:mH,visitors:FM},f3=vH(kH);function Mme(e){const t=yH(e);Dme.forEach(n=>t[n]=Tme+n);for(const n in Wg)t[n]=MH+n;return Ve(t,jpe(e,Wg,FM)),t}function cn(e,t,n){return arguments.length===1?Wg[e]:(Wg[e]=t,n&&(FM[e]=n),f3&&(f3.functions[e]=MH+e),this)}cn("bandwidth",lme,Ni);cn("copy",cme,Ni);cn("domain",fme,Ni);cn("range",hme,Ni);cn("invert",dme,Ni);cn("scale",gme,Ni);cn("gradient",pme,Ni);cn("geoArea",Upe,Ni);cn("geoBounds",Ppe,Ni);cn("geoCentroid",Ipe,Ni);cn("geoShape",mme,Ni);cn("geoScale",qpe,Ni);cn("indata",_pe,Lpe);cn("data",EH,TM);cn("treePath",vme,TM);cn("treeAncestors",bme,TM);cn("vlSelectionTest",ype,DM);cn("vlSelectionIdTest",xpe,DM);cn("vlSelectionResolve",Spe,DM);cn("vlSelectionTuples",Epe);function ps(e,t){const n={};let i;try{e=ft(e)?e:$e(e)+"",i=pH(e)}catch{ae("Expression parse error: "+e)}i.visit(a=>{if(a.type!==uH)return;const s=a.callee.name,o=kH.visitors[s];o&&o(s,a.arguments,t,n)});const r=f3(i);return r.globals.forEach(a=>{const s=AH+a;!ze(n,s)&&t.getSignal(a)&&(n[s]=t.signalRef(a))}),{$expr:Ve({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function kme(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const Nme=wa(["rule"]),I7=wa(["group","image","rect"]);function Fme(e,t){let n="";return Nme[t]||(e.x2&&(e.x?(I7[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(I7[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function OM(e){return(e+"").toLowerCase()}function Ome(e){return OM(e)==="operator"}function Rme(e){return OM(e)==="collect"}function N0(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function zme(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var Bme={operator:(e,t)=>N0(e,["_"],t.code),parameter:(e,t)=>N0(e,["datum","_"],t.code),event:(e,t)=>N0(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return N0(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const a in i){const s="o["+$e(a)+"]";r+=`$=${i[a].code};if(${s}!==$)${s}=$,m=1;`}return r+=Fme(i,n),r+="return m;",N0(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map($e).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(a,s)=>{const o=t[s];let l,f;return a.path?(l=`a${a.path}`,f=`b${a.path}`):((n=n||{})["f"+s]=a,l=`this.f${s}(a)`,f=`this.f${s}(b)`),zme(l,f,-o,o)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function Lme(e){const t=this;Ome(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function jme(e){const t=this;if(e.params){const n=t.get(e.id);n||ae("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Ume(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=De(r)?r.map(a=>q7(a,n,t)):q7(r,n,t)}return t}function q7(e,t,n){if(!e||!Pe(e))return e;for(let i=0,r=H7.length,a;i<r;++i)if(a=H7[i],ze(e,a.key))return a.parse(e,t,n);return e}var H7=[{key:"$ref",parse:Pme},{key:"$key",parse:qme},{key:"$expr",parse:Ime},{key:"$field",parse:Hme},{key:"$encode",parse:Yme},{key:"$compare",parse:Gme},{key:"$context",parse:Vme},{key:"$subflow",parse:Xme},{key:"$tupleid",parse:Wme}];function Pme(e,t){return t.get(e.$ref)||ae("Operator not defined: "+e.$ref)}function Ime(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=ar(t.parameterExpression(e.$expr),e.$fields))}function qme(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=b$(e.$key,e.$flat,t.expr.codegen))}function Hme(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Qr(e.$field,e.$name,t.expr.codegen))}function Gme(e,t){const n="c:"+e.$compare+"_"+e.$order,i=Fe(e.$compare).map(r=>r&&r.$tupleid?ke:r);return t.fn[n]||(t.fn[n]=p$(i,e.$order,t.expr.codegen))}function Yme(e,t){const n=e.$encode,i={};for(const r in n){const a=n[r];i[r]=ar(t.encodeExpression(a.$expr),a.$fields),i[r].output=a.$output}return i}function Vme(e,t){return t}function Xme(e,t){const n=e.$subflow;return function(i,r,a){const s=t.fork().parse(n),o=s.get(n.operators[0].id),l=s.signals.parent;return l&&l.set(a),o.detachSubflow=()=>t.detach(s),o}}function Wme(){return ke}function Qme(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(a=>t.get(a)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(a=>t.get(a)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&ae("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function Zme(e){var t=this,n=Pe(n=e.source)?n.$ref:n,i=t.get(n),r=null,a=e.update,s=void 0;i||ae("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),a&&a.$expr&&(a.$params&&(s=t.parseParameters(a.$params)),a=t.handlerExpression(a.$expr)),t.update(e,i,r,a,s)}const Kme={skip:!0};function Jme(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(a=>{const s=t.signals[a];e.signals(a,s)&&(i[a]=s.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(a=>{const s=t.data[a];e.data(a,s)&&(r[a]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(a=>a.getState(e))),n}function e1e(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(a=>{n.update(t.signals[a],r[a],Kme)}),Object.keys(i||{}).forEach(a=>{n.pulse(t.data[a].input,n.changeset().remove(Zr).insert(i[a]))}),(e.subcontext||[]).forEach((a,s)=>{const o=t.subcontext[s];o&&o.setState(a)})}function NH(e,t,n,i){return new FH(e,t,n,i)}function FH(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Bme,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function G7(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}FH.prototype=G7.prototype={fork(){const e=new G7(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),Rme(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let a=n.get(e.parent.$ref);a?(i.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(e.parent.$ref),i.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const s=n.data[a]||(n.data[a]={});e.data[a].forEach(o=>s[o]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[OM(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:kme,parseOperator:Lme,parseOperatorParameters:jme,parseParameters:Ume,parseStream:Qme,parseUpdate:Zme,getState:Jme,setState:e1e};function t1e(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),OH(t,e.description()))}function OH(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function n1e(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const t_="default";function i1e(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:t_,item:null}));e.on(e.events("view","pointermove"),t,(n,i)=>{const r=t.value,a=r?ft(r)?r:r.user:t_,s=i.item&&i.item.cursor||null;return r&&a===r.user&&s==r.item?r:{user:a,item:s}}),e.add(null,function(n){let i=n.cursor,r=this.value;return ft(i)||(r=i.item,i=i.user),d3(e,i&&i!==t_?i:r||i),r},{cursor:t})}function d3(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Jv(e,t){var n=e._runtime.data;return ze(n,t)||ae("Unrecognized data set: "+t),n[t]}function r1e(e,t){return arguments.length<2?Jv(this,e).values.value:Rx.call(this,e,Mc().remove(Zr).insert(t))}function Rx(e,t){WL(t)||ae("Second argument to changes must be a changeset.");const n=Jv(this,e);return n.modified=!0,this.pulse(n.input,t)}function a1e(e,t){return Rx.call(this,e,Mc().insert(t))}function s1e(e,t){return Rx.call(this,e,Mc().remove(t))}function RH(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function zH(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function zx(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function o1e(e){var t=zx(e),n=RH(e),i=zH(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(a){e.error(a)}})}function u1e(e,t,n){var i=e._renderer,r=i&&i.canvas(),a,s,o;return r&&(o=zx(e),s=t.changedTouches?t.changedTouches[0]:t,a=Ex(s,r),a[0]-=o[0],a[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=l1e(e,n,a),t}function l1e(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(s){var o=i,l;if(s){for(l=t;l;l=l.mark.group)if(l.mark.name===s){o=l;break}}return o&&o.mark&&o.mark.interactive?o:{}}function a(s){if(!s)return n;ft(s)&&(s=r(s));const o=n.slice();for(;s;)o[0]-=s.x||0,o[1]-=s.y||0,s=s.mark&&s.mark.group;return o}return{view:bi(e),item:bi(t||{}),group:r,xy:a,x:s=>a(s)[0],y:s=>a(s)[1]}}const Y7="view",c1e="timer",f1e="window",d1e={trap:!1};function h1e(e){const t=Ve({defaults:{}},e),n=(i,r)=>{r.forEach(a=>{De(i[a])&&(i[a]=wa(i[a]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function BH(e,t,n,i){e._eventListeners.push({type:n,sources:Fe(t),handler:i})}function g1e(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function Z1(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||Pe(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function p1e(e,t,n){var i=this,r=new Gb(n),a=function(f,d){i.runAsync(null,()=>{e===Y7&&g1e(i,t)&&f.preventDefault(),r.receive(u1e(i,f,d))})},s;if(e===c1e)Z1(i,"timer",t)&&i.timer(a,t);else if(e===Y7)Z1(i,"view",t)&&i.addEventListener(t,a,d1e);else if(e===f1e?Z1(i,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&Z1(i,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)i.warn("Can not resolve event source: "+e);else{for(var o=0,l=s.length;o<l;++o)s[o].addEventListener(t,a);BH(i,s,t,a)}return r}function V7(e){return e.item}function X7(e){return e.item.mark.source}function W7(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function m1e(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",V7),X7,W7(e)),this.on(this.events("view","pointerout",V7),X7,W7(t)),this}function y1e(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),i=this._eventListeners,r,a,s,o,l;for(r=t.length;--r>=0;)t[r].stop();for(r=i.length;--r>=0;)for(s=i[r],a=s.sources.length;--a>=0;)s.sources[a].removeEventListener(s.type,s.handler);for(e&&e.call(this,this._handler,null,null,null),r=n.length;--r>=0;)l=n[r].type,o=n[r].handler,this._handler.off(l,o);return this}function wr(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const v1e="vega-bind",b1e="vega-bind-name",x1e="vega-bind-radio";function E1e(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,s)})}},i.debounce&&(r.update=m$(i.debounce,r.update))),(i.input==null&&i.element?S1e:w1e)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function S1e(e,t,n,i){const r=n.event||"input",a=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,a),BH(i,t,r,a),e.set=s=>{t.value=s,t.dispatchEvent(A1e(r))}}function A1e(e){return typeof Event<"u"?new Event(e):{type:e}}function w1e(e,t,n,i){const r=i.signal(n.signal),a=wr("div",{class:v1e}),s=n.input==="radio"?a:a.appendChild(wr("label"));s.appendChild(wr("span",{class:b1e},n.name||n.signal)),t.appendChild(a);let o=_1e;switch(n.input){case"checkbox":o=C1e;break;case"select":o=$1e;break;case"radio":o=D1e;break;case"range":o=T1e;break}o(e,s,n,r)}function _1e(e,t,n,i){const r=wr("input");for(const a in n)a!=="signal"&&a!=="element"&&r.setAttribute(a==="input"?"type":a,n[a]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=a=>r.value=a}function C1e(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const a=wr("input",r);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=s=>a.checked=!!s||null}function $1e(e,t,n,i){const r=wr("select",{name:n.signal}),a=n.labels||[];n.options.forEach((s,o)=>{const l={value:s};eb(s,i)&&(l.selected=!0),r.appendChild(wr("option",l,(a[o]||s)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=s=>{for(let o=0,l=n.options.length;o<l;++o)if(eb(n.options[o],s)){r.selectedIndex=o;return}}}function D1e(e,t,n,i){const r=wr("span",{class:x1e}),a=n.labels||[];t.appendChild(r),e.elements=n.options.map((s,o)=>{const l={type:"radio",name:n.signal,value:s};eb(s,i)&&(l.checked=!0);const f=wr("input",l);f.addEventListener("change",()=>e.update(s));const d=wr("label",{},(a[o]||s)+"");return d.prepend(f),r.appendChild(d),f}),e.set=s=>{const o=e.elements,l=o.length;for(let f=0;f<l;++f)eb(o[f].value,s)&&(o[f].checked=!0)}}function T1e(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,a=n.min||Math.min(0,r,+i)||0,s=n.step||ku(a,r,100),o=wr("input",{type:"range",name:n.signal,min:a,max:r,step:s});o.value=i;const l=wr("span",{},+i);t.appendChild(o),t.appendChild(l);const f=()=>{l.textContent=o.value,e.update(+o.value)};o.addEventListener("input",f),o.addEventListener("change",f),e.elements=[o],e.set=d=>{o.value=d,l.textContent=d}}function eb(e,t){return e===t||e+""==t+""}function LH(e,t,n,i,r,a){return t=t||new i(e.loader()),t.initialize(n,RH(e),zH(e),zx(e),r,a).background(e.background())}function RM(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function M1e(e,t,n,i){const r=new i(e.loader(),RM(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,zx(e),e);return t&&t.handlers().forEach(a=>{r.on(a.type,a.handler)}),r}function k1e(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,a=Sx(i);e=n._el=e?n_(n,e,!0):null,t1e(n),a||n.error("Unrecognized renderer type: "+i);const s=a.handler||Fp,o=e?a.renderer:a.headless;return n._renderer=o?LH(n,n._renderer,e,o):null,n._handler=M1e(n,n._handler,e,s),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=n_(n,t,!0):e.appendChild(wr("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&r!=="container"&&(l.element=n_(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{E1e(n,l.element||t,l)})),n}function n_(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const F0=e=>+e||0,N1e=e=>({top:e,bottom:e,left:e,right:e});function Q7(e){return Pe(e)?{top:F0(e.top),bottom:F0(e.bottom),left:F0(e.left),right:F0(e.right)}:N1e(F0(e))}async function zM(e,t,n,i){const r=Sx(t),a=r&&r.headless;return a||ae("Unrecognized renderer type: "+t),await e.runAsync(),LH(e,null,null,a,n,i).renderAsync(e._scenegraph.root)}async function F1e(e,t){e!==yu.Canvas&&e!==yu.SVG&&e!==yu.PNG&&ae("Unrecognized image type: "+e);const n=await zM(this,e,t);return e===yu.SVG?O1e(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function O1e(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function R1e(e,t){return(await zM(this,yu.Canvas,e,t)).canvas()}async function z1e(e){return(await zM(this,yu.SVG,e)).svg()}function B1e(e,t,n){return NH(e,yd,Wg,n).parse(t)}function L1e(e){var t=this._runtime.scales;return ze(t,e)||ae("Unrecognized scale or projection: "+e),t[e].value}var jH="width",UH="height",BM="padding",Z7={skip:!0};function PH(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===BM?i.left+i.right:0)}function IH(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===BM?i.top+i.bottom:0)}function j1e(e){var t=e._signals,n=t[jH],i=t[UH],r=t[BM];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,o=>{e._width=o.size,e._viewWidth=PH(e,o.size),a()},{size:n}),e._resizeHeight=e.add(null,o=>{e._height=o.size,e._viewHeight=IH(e,o.size),a()},{size:i});const s=e.add(null,a,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,s.rank=r.rank+1}function U1e(e,t,n,i,r,a){this.runAfter(s=>{let o=0;s._autosize=0,s.width()!==n&&(o=1,s.signal(jH,n,Z7),s._resizeWidth.skip(!0)),s.height()!==i&&(o=1,s.signal(UH,i,Z7),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==r[0]||s._origin[1]!==r[1])&&(s._resize=1,s._origin=r),o&&s.run("enter"),a&&s.runAfter(l=>l.resize())},!1,1)}function P1e(e){return this._runtime.getState(e||{data:I1e,signals:q1e,recurse:!0})}function I1e(e,t){return t.modified&&De(t.input.value)&&!e.startsWith("_:vega:_")}function q1e(e,t){return!(e==="parent"||t instanceof yd.proxy)}function H1e(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function G1e(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(pde(n,t))}function Y1e(e,t,n,i){const r=e.element();r&&r.setAttribute("title",V1e(i))}function V1e(e){return e==null?"":De(e)?qH(e):Pe(e)&&!Au(e)?X1e(e):e+""}function X1e(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(De(n)?qH(n):HH(n))}).join(`
`)}function qH(e){return"["+e.map(HH).join(", ")+"]"}function HH(e){return De(e)?"[]":Pe(e)&&!Au(e)?"{}":e}function W1e(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e!=null&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function GH(e,t){const n=this;if(t=t||{},td.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const a=Ve({},e.locale,t.locale);n.locale(jL(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||yu.Canvas,n._scenegraph=new LP;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Y1e,n._redraw=!0,n._handler=new Fp().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=h1e(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=B1e(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(a=>({state:null,param:Ve({},a)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=PH(n,n._width),n._viewHeight=IH(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,j1e(n),n1e(n),i1e(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function K1(e,t){return ze(e._signals,t)?e._signals[t]:ae("Unrecognized signal name: "+$e(t))}function YH(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function K7(e,t,n,i){let r=YH(n,i);return r||(r=RM(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function J7(e,t,n){const i=YH(t,n);return i&&t._targets.remove(i),e}me(GH,td,{async evaluate(e,t,n){if(await td.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,o1e(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&hy(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&OH(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=K1(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Q7(e)):Q7(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Sx(e)||ae("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(td.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(K1(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:U1e,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=RM(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,a;--i>=0;)if(a=n[i].type,r=n[i].handler,e===a&&(t===r||t===r.raw)){this._handler.off(a,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return K7(this,e,K1(this,e),t)},removeSignalListener(e,t){return J7(this,K1(this,e),t)},addDataListener(e,t){return K7(this,e,Jv(this,e).values,t)},removeDataListener(e,t){return J7(this,Jv(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=d3(this,null);this._globalCursor=!!e,t&&d3(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:G1e,events:p1e,finalize:y1e,hover:m1e,data:r1e,change:Rx,insert:a1e,remove:s1e,scale:L1e,initialize:k1e,toImageURL:F1e,toCanvas:R1e,toSVG:z1e,getState:P1e,setState:H1e,_watchPixelRatio:W1e});const Q1e="view",tb="[",nb="]",VH="{",XH="}",Z1e=":",WH=",",K1e="@",J1e=">",eye=/[[\]{}]/,tye={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let QH,ZH;function KH(e,t,n){return QH=t||Q1e,ZH=n||tye,JH(e.trim()).map(h3)}function nye(e){return ZH[e]}function Ag(e,t,n,i,r){const a=e.length;let s=0,o;for(;t<a;++t){if(o=e[t],!s&&o===n)return t;r&&r.indexOf(o)>=0?--s:i&&i.indexOf(o)>=0&&++s}return t}function JH(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Ag(e,r,WH,tb+VH,nb+XH),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function h3(e){return e[0]==="["?iye(e):rye(e)}function iye(e){const t=e.length;let n=1,i;if(n=Ag(e,n,nb,tb,nb),n===t)throw"Empty between selector: "+e;if(i=JH(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==J1e)throw"Expected '>' after between selector: "+e;i=i.map(h3);const r=h3(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function rye(e){const t={source:QH},n=[];let i=[0,0],r=0,a=0,s=e.length,o=0,l,f;if(e[s-1]===XH){if(o=e.lastIndexOf(VH),o>=0){try{i=aye(e.substring(o+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),s=e.length}else throw"Unmatched right brace: "+e;o=0}if(!s)throw e;if(e[0]===K1e&&(r=++o),l=Ag(e,o,Z1e),l<s&&(n.push(e.substring(a,l).trim()),a=o=++l),o=Ag(e,o,tb),o===s)n.push(e.substring(a,s).trim());else if(n.push(e.substring(a,o).trim()),f=[],a=++o,a===s)throw"Unmatched left bracket: "+e;for(;o<s;){if(o=Ag(e,o,nb),o===s)throw"Unmatched left bracket: "+e;if(f.push(e.substring(a,o).trim()),o<s-1&&e[++o]!==tb)throw"Expected left bracket: "+e;a=++o}if(!(s=n.length)||eye.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],r?t.markname=n[0].slice(1):nye(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),f!=null&&(t.filter=f),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function aye(e){const t=e.split(WH);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function sye(e){return Pe(e)?e:{type:e||"pad"}}const O0=e=>+e||0,oye=e=>({top:e,bottom:e,left:e,right:e});function uye(e){return Pe(e)?e.signal?e:{top:O0(e.top),bottom:O0(e.bottom),left:O0(e.left),right:O0(e.right)}:oye(O0(e))}const zn=e=>Pe(e)&&!De(e)?Ve({},e):{value:e};function e9(e,t,n,i){return n!=null?(Pe(n)&&!De(n)||De(n)&&n.length&&Pe(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function ei(e,t,n){for(const i in t)e9(e,i,t[i]);for(const i in n)e9(e,i,n[i],"update")}function sh(e,t,n){for(const i in t)n&&ze(n,i)||(e[i]=Ve(e[i]||{},t[i]));return e}function Yf(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const LM="mark",jM="frame",UM="scope",lye="axis",cye="axis-domain",fye="axis-grid",dye="axis-label",hye="axis-tick",gye="axis-title",pye="legend",mye="legend-band",yye="legend-entry",vye="legend-gradient",eG="legend-label",bye="legend-symbol",xye="legend-title",Eye="title",Sye="title-text",Aye="title-subtitle";function wye(e,t,n,i,r){const a={},s={};let o,l,f,d;l="lineBreak",t==="text"&&r[l]!=null&&!Yf(l,e)&&i_(a,l,r[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),d=n===jM?r.group:n===LM?Ve({},r.mark,r[t]):null;for(l in d)f=Yf(l,e)||(l==="fill"||l==="stroke")&&(Yf("fill",e)||Yf("stroke",e)),f||i_(a,l,d[l]);Fe(i).forEach(h=>{const p=r.style&&r.style[h];for(const y in p)Yf(y,e)||i_(a,y,p[y])}),e=Ve({},e);for(l in a)d=a[l],d.signal?(o=o||{})[l]=d:s[l]=d;return e.enter=Ve(s,e.enter),o&&(e.update=Ve(o,e.update)),e}function i_(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const tG=e=>ft(e)?$e(e):e.signal?`(${e.signal})`:nG(e);function Bx(e){if(e.gradient!=null)return Cye(e);let t=e.signal?`(${e.signal})`:e.color?_ye(e.color):e.field!=null?nG(e.field):e.value!==void 0?$e(e.value):void 0;return e.scale!=null&&(t=$ye(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${ky(e.exponent)})`),e.mult!=null&&(t+=`*${ky(e.mult)}`),e.offset!=null&&(t+=`+${ky(e.offset)}`),e.round&&(t=`round(${t})`),t}const J1=(e,t,n,i)=>`(${e}(${[t,n,i].map(Bx).join(",")})+'')`;function _ye(e){return e.c?J1("hcl",e.h,e.c,e.l):e.h||e.s?J1("hsl",e.h,e.s,e.l):e.l||e.a?J1("lab",e.l,e.a,e.b):e.r||e.g||e.b?J1("rgb",e.r,e.g,e.b):null}function Cye(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:$e(n));for(;t.length&&st(t)==null;)t.pop();return t.unshift(tG(e.gradient)),`gradient(${t.join(",")})`}function ky(e){return Pe(e)?"("+Bx(e)+")":e}function nG(e){return iG(Pe(e)?e:{datum:e})}function iG(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):ae("Invalid field reference: "+$e(e));return e.signal||(i=ft(i)?Tb(i).map($e).join("]["):iG(i)),t+"["+i+"]"}function $ye(e,t){const n=tG(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+ky(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Dye(e){let t="";return e.forEach(n=>{const i=Bx(n);t+=n.test?`(${n.test})?${i}:`:i}),st(t)===":"&&(t+="null"),t}function rG(e,t,n,i,r,a){const s={};a=a||{},a.encoders={$encode:s},e=wye(e,t,n,i,r.config);for(const o in e)s[o]=Tye(e[o],t,a,r);return a}function Tye(e,t,n,i){const r={},a={};for(const s in e)e[s]!=null&&(r[s]=kye(Mye(e[s]),i,n,a));return{$expr:{marktype:t,channels:r},$fields:Object.keys(a),$output:Object.keys(e)}}function Mye(e){return De(e)?Dye(e):Bx(e)}function kye(e,t,n,i){const r=ps(e,t);return r.$fields.forEach(a=>i[a]=1),Ve(n,r.$params),r.$expr}const Nye="outer",Fye=["value","update","init","react","bind"];function t9(e,t){ae(e+' for "outer" push: '+$e(t))}function aG(e,t){const n=e.name;if(e.push===Nye)t.signals[n]||t9("No prior signal definition",n),Fye.forEach(i=>{e[i]!==void 0&&t9("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function g3(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function Lx(e,t,n,i){return new g3(e,t,n,i)}function ib(e,t){return Lx("operator",e,t)}function Me(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Qg(e,t){return t?{$field:e,$name:t}:{$field:e}}const p3=Qg("key");function n9(e,t){return{$compare:e,$order:t}}function Oye(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const Rye="ascending",zye="descending";function Bye(e){return Pe(e)?(e.order===zye?"-":"+")+jx(e.op,e.field):""}function jx(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const PM="scope",m3="view";function wn(e){return e&&e.signal}function Lye(e){return e&&e.expr}function Ny(e){if(wn(e))return!0;if(Pe(e)){for(const t in e)if(Ny(e[t]))return!0}return!1}function ha(e,t){return e??t}function Kl(e){return e&&e.signal||e}const i9="timer";function Zg(e,t){return(e.merge?Uye:e.stream?Pye:e.type?Iye:ae("Invalid stream specification: "+$e(e)))(e,t)}function jye(e){return e===PM?m3:e||m3}function Uye(e,t){const n=e.merge.map(r=>Zg(r,t)),i=IM({merge:n},e,t);return t.addStream(i).id}function Pye(e,t){const n=Zg(e.stream,t),i=IM({stream:n},e,t);return t.addStream(i).id}function Iye(e,t){let n;e.type===i9?(n=t.event(i9,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(jye(e.source),e.type);const i=IM({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function IM(e,t,n){let i=t.between;return i&&(i.length!==2&&ae('Stream "between" parameter must have 2 entries: '+$e(t)),e.between=[Zg(i[0],n),Zg(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(qye(t.marktype,t.markname,t.markrole)),t.source===PM&&i.push("inScope(event.item)"),i.length&&(e.filter=ps("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function qye(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const Hye={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Gye(e,t,n){const i=e.encode,r={target:n};let a=e.events,s=e.update,o=[];a||ae("Signal update missing events specification."),ft(a)&&(a=KH(a,t.isSubscope()?PM:m3)),a=Fe(a).filter(l=>l.signal||l.scale?(o.push(l),0):1),o.length>1&&(o=[Vye(o)]),a.length&&o.push(a.length>1?{merge:a}:a[0]),i!=null&&(s&&ae("Signal encode and update are mutually exclusive."),s="encode(item(),"+$e(i)+")"),r.update=ft(s)?ps(s,t):s.expr!=null?ps(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Hye,$params:{$value:t.signalRef(s.signal)}}:ae("Invalid signal update specification."),e.force&&(r.options={force:!0}),o.forEach(l=>t.addUpdate(Ve(Yye(l,t),r)))}function Yye(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Zg(e,t)}}function Vye(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Xye(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?ae("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=ps(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>Gye(r,t,n.id))}const Nt=e=>(t,n,i)=>Lx(e,n,t||void 0,i),sG=Nt("aggregate"),Wye=Nt("axisticks"),oG=Nt("bound"),Oa=Nt("collect"),r9=Nt("compare"),Qye=Nt("datajoin"),uG=Nt("encode"),Zye=Nt("expression"),Kye=Nt("facet"),Jye=Nt("field"),eve=Nt("key"),tve=Nt("legendentries"),nve=Nt("load"),ive=Nt("mark"),rve=Nt("multiextent"),ave=Nt("multivalues"),sve=Nt("overlap"),ove=Nt("params"),lG=Nt("prefacet"),uve=Nt("projection"),lve=Nt("proxy"),cve=Nt("relay"),cG=Nt("render"),fve=Nt("scale"),Oc=Nt("sieve"),dve=Nt("sortitems"),fG=Nt("viewlayout"),hve=Nt("values");let gve=0;const dG={min:"min",max:"max",count:"sum"};function pve(e,t){const n=e.type||"linear";QU(n)||ae("Unrecognized scale type: "+$e(n)),t.addScale(e.name,{type:n,domain:void 0})}function mve(e,t){const n=t.getScale(e.name).params;let i;n.domain=hG(e.domain,e,t),e.range!=null&&(n.range=pG(e,t,n)),e.interpolate!=null&&Cve(e.interpolate,n),e.nice!=null&&(n.nice=_ve(e.nice,t)),e.bins!=null&&(n.bins=wve(e.bins,t));for(i in e)ze(n,i)||i==="name"||(n[i]=Yr(e[i],t))}function Yr(e,t){return Pe(e)?e.signal?t.signalRef(e.signal):ae("Unsupported object: "+$e(e)):e}function Fy(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Yr(n,t))}function Ux(e){ae("Can not find data set: "+$e(e))}function hG(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&ae("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(De(e)?yve:e.fields?bve:vve)(e,t,n)}function yve(e,t,n){return e.map(i=>Yr(i,n))}function vve(e,t,n){const i=n.getData(e.data);return i||Ux(e.data),Sd(t.type)?i.valuesRef(n,e.field,gG(e.sort,!1)):JU(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function bve(e,t,n){const i=e.data,r=e.fields.reduce((a,s)=>(s=ft(s)?{data:i,field:s}:De(s)||s.signal?xve(s,n):s,a.push(s),a),[]);return(Sd(t.type)?Eve:JU(t.type)?Sve:Ave)(e,n,r)}function xve(e,t){const n="_:vega:_"+gve++,i=Oa({});if(De(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+$e(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Oc({})]),{data:n,field:"data"}}function Eve(e,t,n){const i=gG(e.sort,!0);let r,a;const s=n.map(f=>{const d=t.getData(f.data);return d||Ux(f.data),d.countsRef(t,f.field,i)}),o={groupby:p3,pulse:s};i&&(r=i.op||"count",a=i.field?jx(r,i.field):"count",o.ops=[dG[r]],o.fields=[t.fieldRef(a)],o.as=[a]),r=t.add(sG(o));const l=t.add(Oa({pulse:Me(r)}));return a=t.add(hve({field:p3,sort:t.sortRef(i),pulse:Me(l)})),Me(a)}function gG(e,t){return e&&(!e.field&&!e.op?Pe(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?ae("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!dG[e.op]&&ae("Multiple domain scales can not be sorted using "+e.op)),e}function Sve(e,t,n){const i=n.map(r=>{const a=t.getData(r.data);return a||Ux(r.data),a.domainRef(t,r.field)});return Me(t.add(ave({values:i})))}function Ave(e,t,n){const i=n.map(r=>{const a=t.getData(r.data);return a||Ux(r.data),a.extentRef(t,r.field)});return Me(t.add(rve({extents:i})))}function wve(e,t){return e.signal||De(e)?Fy(e,t):t.objectProperty(e)}function _ve(e,t){return e.signal?t.signalRef(e.signal):Pe(e)?{interval:Yr(e.interval),step:Yr(e.step)}:Yr(e)}function Cve(e,t){t.interpolate=Yr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Yr(e.gamma))}function pG(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(ft(r)){if(i&&ze(i,r))return e=Ve({},e,{range:i[r]}),pG(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Sd(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:ae("Unrecognized scale range value: "+$e(r))}else if(r.scheme){n.scheme=De(r.scheme)?Fy(r.scheme,t):Yr(r.scheme,t),r.extent&&(n.schemeExtent=Fy(r.extent,t)),r.count&&(n.schemeCount=Yr(r.count,t));return}else if(r.step){n.rangeStep=Yr(r.step,t);return}else{if(Sd(e.type)&&!De(r))return hG(r,e,t);De(r)||ae("Unsupported range type: "+$e(r))}return r.map(a=>(De(a)?Fy:Yr)(a,t))}function $ve(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=y3(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=y3(n[r],r,t));t.addProjection(e.name,i)}function y3(e,t,n){return De(e)?e.map(i=>y3(i,t,n)):Pe(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:ae("Unsupported parameter object: "+$e(e)):e}const Ra="top",oh="left",uh="right",ju="bottom",mG="center",Dve="vertical",Tve="start",Mve="middle",kve="end",v3="index",qM="label",Nve="offset",kd="perc",Fve="perc2",Xr="value",Ip="guide-label",HM="guide-title",Ove="group-title",Rve="group-subtitle",a9="symbol",Oy="gradient",b3="discrete",x3="size",zve="shape",Bve="fill",Lve="stroke",jve="strokeWidth",Uve="strokeDash",Pve="opacity",GM=[x3,zve,Bve,Lve,jve,Uve,Pve],qp={name:1,style:1,interactive:1},ut={value:0},Wr={value:1},Px="group",yG="rect",YM="rule",Ive="symbol",Rc="text";function Kg(e){return e.type=Px,e.interactive=e.interactive||!1,e}function sr(e,t){const n=(i,r)=>ha(e[i],ha(t[i],r));return n.isVertical=i=>Dve===ha(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ha(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ha(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ha(e.columns,ha(t.columns,+n.isVertical(!0))),n}function vG(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function qve(e,t,n){const i=t.config.style[n];return i&&i[e]}function Ix(e,t,n){return`item.anchor === '${Tve}' ? ${e} : item.anchor === '${kve}' ? ${t} : ${n}`}const VM=Ix($e(oh),$e(uh),$e(mG));function Hve(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},Pe(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function bG(e,t){return t?e?Pe(e)?Object.assign({},e,{offset:bG(e.offset,t)}):{value:e,offset:t}:t:e}function Mr(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=sh(e.encode,t,qp)):e.interactive=!1,e}function Gve(e,t,n,i){const r=sr(e,n),a=r.isVertical(),s=r.gradientThickness(),o=r.gradientLength();let l,f,d,h,p;a?(f=[0,1],d=[0,0],h=s,p=o):(f=[0,0],d=[1,0],h=o,p=s);const y={enter:l={opacity:ut,x:ut,y:ut,width:zn(h),height:zn(p)},update:Ve({},l,{opacity:Wr,fill:{gradient:t,start:f,stop:d}}),exit:{opacity:ut}};return ei(y,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),Mr({type:yG,role:vye,encode:y},i)}function Yve(e,t,n,i,r){const a=sr(e,n),s=a.isVertical(),o=a.gradientThickness(),l=a.gradientLength();let f,d,h,p,y="";s?(f="y",h="y2",d="x",p="width",y="1-"):(f="x",h="x2",d="y",p="height");const v={opacity:ut,fill:{scale:t,field:Xr}};v[f]={signal:y+"datum."+kd,mult:l},v[d]=ut,v[h]={signal:y+"datum."+Fve,mult:l},v[p]=zn(o);const b={enter:v,update:Ve({},v,{opacity:Wr}),exit:{opacity:ut}};return ei(b,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Mr({type:yG,role:mye,key:Xr,from:r,encode:b},i)}const Vve=`datum.${kd}<=0?"${oh}":datum.${kd}>=1?"${uh}":"${mG}"`,Xve=`datum.${kd}<=0?"${ju}":datum.${kd}>=1?"${Ra}":"${Mve}"`;function s9(e,t,n,i){const r=sr(e,t),a=r.isVertical(),s=zn(r.gradientThickness()),o=r.gradientLength();let l=r("labelOverlap"),f,d,h,p,y="";const v={enter:f={opacity:ut},update:d={opacity:Wr,text:{field:qM}},exit:{opacity:ut}};return ei(v,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:ha(e.labelLimit,t.gradientLabelLimit)}),a?(f.align={value:"left"},f.baseline=d.baseline={signal:Xve},h="y",p="x",y="1-"):(f.align=d.align={signal:Vve},f.baseline={value:"top"},h="x",p="y"),f[h]=d[h]={signal:y+"datum."+kd,mult:o},f[p]=d[p]=s,s.offset=ha(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r("labelSeparation"),method:l,order:"datum."+v3}:void 0,Mr({type:Rc,role:eG,style:Ip,key:Xr,from:i,encode:v,overlap:l},n)}function Wve(e,t,n,i,r){const a=sr(e,t),s=n.entries,o=!!(s&&s.interactive),l=s?s.name:void 0,f=a("clipHeight"),d=a("symbolOffset"),h={data:"value"},p=`(${r}) ? datum.${Nve} : datum.${x3}`,y=f?zn(f):{field:x3},v=`datum.${v3}`,b=`max(1, ${r})`;let E,S,w,_,C;y.mult=.5,E={enter:S={opacity:ut,x:{signal:p,mult:.5,offset:d},y},update:w={opacity:Wr,x:S.x,y:S.y},exit:{opacity:ut}};let $=null,M=null;e.fill||($=t.symbolBaseFillColor,M=t.symbolBaseStrokeColor),ei(E,{fill:a("symbolFillColor",$),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",M),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),GM.forEach(B=>{e[B]&&(w[B]=S[B]={scale:e[B],field:Xr})});const T=Mr({type:Ive,role:bye,key:Xr,from:h,clip:f?!0:void 0,encode:E},n.symbols),F=zn(d);F.offset=a("labelOffset"),E={enter:S={opacity:ut,x:{signal:p,offset:F},y},update:w={opacity:Wr,text:{field:qM},x:S.x,y:S.y},exit:{opacity:ut}},ei(E,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const R=Mr({type:Rc,role:eG,style:Ip,key:Xr,from:h,encode:E},n.labels);return E={enter:{noBound:{value:!f},width:ut,height:f?zn(f):ut,opacity:ut},exit:{opacity:ut},update:w={opacity:Wr,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(_=`ceil(item.mark.items.length / ${b})`,w.row.signal=`${v}%${_}`,w.column.signal=`floor(${v} / ${_})`,C={field:["row",v]}):(w.row.signal=`floor(${v} / ${b})`,w.column.signal=`${v} % ${b}`,C={field:v}),w.column.signal=`(${r})?${w.column.signal}:${v}`,i={facet:{data:i,name:"value",groupby:v3}},Kg({role:UM,from:i,encode:sh(E,s,qp),marks:[T,R],name:l,interactive:o,sort:C})}function Qve(e,t){const n=sr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const XM='item.orient === "left"',WM='item.orient === "right"',qx=`(${XM} || ${WM})`,Zve=`datum.vgrad && ${qx}`,Kve=Ix('"top"','"bottom"','"middle"'),Jve=Ix('"right"','"left"','"center"'),ebe=`datum.vgrad && ${WM} ? (${Jve}) : (${qx} && !(datum.vgrad && ${XM})) ? "left" : ${VM}`,tbe=`item._anchor || (${qx} ? "middle" : "start")`,nbe=`${Zve} ? (${XM} ? -90 : 90) : 0`,ibe=`${qx} ? (datum.vgrad ? (${WM} ? "bottom" : "top") : ${Kve}) : "top"`;function rbe(e,t,n,i){const r=sr(e,t),a={enter:{opacity:ut},update:{opacity:Wr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:ut}};return ei(a,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:tbe},angle:{signal:nbe},align:{signal:ebe},baseline:{signal:ibe},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),Mr({type:Rc,role:xye,style:HM,from:i,encode:a},n)}function abe(e,t){let n;return Pe(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+o9(e.path)+")":e.sphere&&(n="geoShape("+o9(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function o9(e){return Pe(e)&&e.signal?e.signal:$e(e)}function xG(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Px?UM:t||LM}function sbe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||xG(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function obe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function QM(e,t){const n=KL(e.type);n||ae("Unrecognized transform type: "+$e(e.type));const i=Lx(n.type.toLowerCase(),null,EG(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function EG(e,t,n){const i={},r=e.params.length;for(let a=0;a<r;++a){const s=e.params[a];i[s.name]=ube(s,t,n)}return i}function ube(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return lbe(e,t,n);if(r===void 0){e.required&&ae("Missing required "+$e(t.type)+" parameter: "+$e(e.name));return}else{if(i==="param")return cbe(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!wn(r)?r.map(a=>u9(e,a,n)):u9(e,r,n)}function u9(e,t,n){const i=e.type;if(wn(t))return c9(i)?ae("Expression references can not be signals."):r_(i)?n.fieldRef(t):f9(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||r_(i);return r&&fbe(t)?n.exprRef(t.expr,t.as):r&&dbe(t)?Qg(t.field,t.as):c9(i)?ps(t,n):hbe(i)?Me(n.getData(t).values):r_(i)?Qg(t):f9(i)?n.compareRef(t):t}}function lbe(e,t,n){return ft(t.from)||ae('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function cbe(e,t,n){const i=t[e.name];return e.array?(De(i)||ae("Expected an array of sub-parameters. Instead: "+$e(i)),i.map(r=>l9(e,r,n))):l9(e,i,n)}function l9(e,t,n){const i=e.params.length;let r;for(let s=0;s<i;++s){r=e.params[s];for(const o in r.key)if(r.key[o]!==t[o]){r=null;break}if(r)break}r||ae("Unsupported parameter: "+$e(t));const a=Ve(EG(r,t,n),r.key);return Me(n.add(ove(a)))}const fbe=e=>e&&e.expr,dbe=e=>e&&e.field,hbe=e=>e==="data",c9=e=>e==="expr",r_=e=>e==="field",f9=e=>e==="compare";function gbe(e,t,n){let i,r,a,s,o;return e?(i=e.facet)&&(t||ae("Only group marks can be faceted."),i.field!=null?s=o=Ry(i,n):(e.data?o=Me(n.getData(e.data).aggregate):(a=QM(Ve({type:"aggregate",groupby:Fe(i.groupby)},i.aggregate),n),a.params.key=n.keyRef(i.groupby),a.params.pulse=Ry(i,n),s=o=Me(n.add(a))),r=n.keyRef(i.groupby,!0))):s=Me(n.add(Oa(null,[{}]))),s||(s=Ry(e,n)),{key:r,pulse:s,parent:o}}function Ry(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Me(t.getData(e.data).output)}function gc(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}gc.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let a=t[0],s=null,o=1;for(a&&a.type==="load"&&(a=t[1]),e.add(t[0]);o<n;++o)t[o].params.pulse=Me(t[o-1]),e.add(t[o]),t[o].type==="aggregate"&&(s=t[o]);return new gc(e,a,r,i,s)};function SG(e){return ft(e)?e:null}function d9(e,t,n){const i=jx(n.op,n.field);let r;if(t.ops){for(let a=0,s=t.as.length;a<s;++a)if(t.as[a]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function R0(e,t,n,i,r,a,s){const o=t[n]||(t[n]={}),l=Bye(a);let f=SG(r),d,h;if(f!=null&&(e=t.scope,f=f+(l?"|"+l:""),d=o[f]),!d){const p=a?{field:p3,pulse:t.countsRef(e,r,a)}:{field:e.fieldRef(r),pulse:Me(t.output)};l&&(p.sort=e.sortRef(a)),h=e.add(Lx(i,void 0,p)),s&&(t.index[r]=h),d=Me(h),f!=null&&(o[f]=d)}return d}gc.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),a=SG(t);let s,o,l;return a!=null&&(e=i.scope,s=r[a]),s?n&&n.field&&d9(e,s.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:Me(i.output)},n&&n.field&&d9(e,l,n),o=e.add(sG(l)),s=e.add(Oa({pulse:Me(o)})),s={agg:o,ref:Me(s)},a!=null&&(r[a]=s)),s.ref},tuplesRef(){return Me(this.values)},extentRef(e,t){return R0(e,this,"extent","extent",t,!1)},domainRef(e,t){return R0(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return R0(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return R0(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return R0(e,this,"indata","tupleindex",t,!0,!0)}};function pbe(e,t,n){const i=e.from.facet,r=i.name,a=Ry(i,t);let s;i.name||ae("Facet must have a name: "+$e(i)),i.data||ae("Facet must reference a data set: "+$e(i)),i.field?s=t.add(lG({field:t.fieldRef(i.field),pulse:a})):i.groupby?s=t.add(Kye({key:t.keyRef(i.groupby),group:Me(t.proxy(n.parent)),pulse:a})):ae("Facet must specify groupby or field: "+$e(i));const o=t.fork(),l=o.add(Oa()),f=o.add(Oc({pulse:Me(l)}));o.addData(r,new gc(o,l,l,f)),o.addSignal("parent",null),s.params.subflow={$subflow:o.parse(e).toRuntime()}}function mbe(e,t,n){const i=t.add(lG({pulse:n.pulse})),r=t.fork();r.add(Oc()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function AG(e,t,n){const i=e.remove,r=e.insert,a=e.toggle,s=e.modify,o=e.values,l=t.add(ib()),f="if("+e.trigger+',modify("'+n+'",'+[r,i,a,s,o].map(h=>h??"null").join(",")+"),0)",d=ps(f,t);l.update=d.$expr,l.params=d.$params}function Hx(e,t){const n=xG(e),i=e.type===Px,r=e.from&&e.from.facet,a=e.overlap;let s=e.layout||n===UM||n===jM,o,l,f,d,h,p,y;const v=n===LM||s||r,b=gbe(e.from,i,t);l=t.add(Qye({key:b.key||(e.key?Qg(e.key):void 0),pulse:b.pulse,clean:!i}));const E=Me(l);l=f=t.add(Oa({pulse:E})),l=t.add(ive({markdef:sbe(e),interactive:obe(e.interactive,t),clip:abe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Me(l)}));const S=Me(l);l=d=t.add(uG(rG(e.encode,e.type,n,e.style,t,{mod:!1,pulse:S}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(M=>{const T=QM(M,t),F=T.metadata;(F.generates||F.changes)&&ae("Mark transforms should not generate new data."),F.nomod||(d.params.mod=!0),T.params.pulse=Me(l),t.add(l=T)}),e.sort&&(l=t.add(dve({sort:t.compareRef(e.sort),pulse:Me(l)})));const w=Me(l);(r||s)&&(s=t.add(fG({layout:t.objectProperty(e.layout),legends:t.legends,mark:S,pulse:w})),p=Me(s));const _=t.add(oG({mark:S,pulse:p||w}));y=Me(_),i&&(v&&(o=t.operators,o.pop(),s&&o.pop()),t.pushState(w,p||y,E),r?pbe(e,t,b):v?mbe(e,t,b):t.parse(e),t.popState(),v&&(s&&o.push(s),o.push(_))),a&&(y=ybe(a,y,t));const C=t.add(cG({pulse:y})),$=t.add(Oc({pulse:Me(C)},void 0,t.parent()));e.name!=null&&(h=e.name,t.addData(h,new gc(t,f,C,$)),e.on&&e.on.forEach(M=>{(M.insert||M.remove||M.toggle)&&ae("Marks only support modify triggers."),AG(M,t,h)}))}function ybe(e,t,n){const i=e.method,r=e.bound,a=e.separation,s={separation:wn(a)?n.signalRef(a.signal):a,method:wn(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),r){const o=r.tolerance;s.boundTolerance=wn(o)?n.signalRef(o.signal):+o,s.boundScale=n.scaleRef(r.scale),s.boundOrient=r.orient}return Me(n.add(sve(s)))}function vbe(e,t){const n=t.config.legend,i=e.encode||{},r=sr(e,n),a=i.legend||{},s=a.name||void 0,o=a.interactive,l=a.style,f={};let d=0,h,p,y;GM.forEach(_=>e[_]?(f[_]=e[_],d=d||e[_]):0),d||ae("Missing valid scale for legend.");const v=bbe(e,t.scaleType(d)),b={title:e.title!=null,scales:f,type:v,vgrad:v!=="symbol"&&r.isVertical()},E=Me(t.add(Oa(null,[b]))),S={enter:{x:{value:0},y:{value:0}}},w=Me(t.add(tve(p={type:v,scale:t.scaleRef(d),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return v===Oy?(y=[Gve(e,d,n,i.gradient),s9(e,n,i.labels,w)],p.count=p.count||t.signalRef(`max(2,2*floor((${Kl(r.gradientLength())})/100))`)):v===b3?y=[Yve(e,d,n,i.gradient,w),s9(e,n,i.labels,w)]:(h=Qve(e,n),y=[Wve(e,n,i,w,Kl(h.columns))],p.size=Sbe(e,t,y[0].marks)),y=[Kg({role:yye,from:E,encode:S,marks:y,layout:h,interactive:o})],b.title&&y.push(rbe(e,n,i.title,E)),Hx(Kg({role:pye,from:E,encode:sh(Ebe(r,e,n),a,qp),marks:y,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:s,interactive:o,style:l}),t)}function bbe(e,t){let n=e.type||a9;return!e.type&&xbe(e)===1&&(e.fill||e.stroke)&&(n=ZD(t)?Oy:fC(t)?b3:a9),n!==Oy?n:fC(t)?b3:Oy}function xbe(e){return GM.reduce((t,n)=>t+(e[n]?1:0),0)}function Ebe(e,t,n){const i={enter:{},update:{}};return ei(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Sbe(e,t,n){const i=Kl(h9("size",e,n)),r=Kl(h9("strokeWidth",e,n)),a=Kl(Abe(n[1].encode,t,Ip));return ps(`max(ceil(sqrt(${i})+${r}),${a})`,t)}function h9(e,t,n){return t[e]?`scale("${t[e]}",datum)`:vG(e,n[0].encode)}function Abe(e,t,n){return vG("fontSize",e)||qve("fontSize",t,n)}const wbe=`item.orient==="${oh}"?-90:item.orient==="${uh}"?90:0`;function _be(e,t){e=ft(e)?{text:e}:e;const n=sr(e,t.config.title),i=e.encode||{},r=i.group||{},a=r.name||void 0,s=r.interactive,o=r.style,l=[],f={},d=Me(t.add(Oa(null,[f])));return l.push(Dbe(e,n,Cbe(e),d)),e.subtitle&&l.push(Tbe(e,n,i.subtitle,d)),Hx(Kg({role:Eye,from:d,encode:$be(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:s,style:o}),t)}function Cbe(e){const t=e.encode;return t&&t.title||Ve({name:e.name,interactive:e.interactive,style:e.style},t)}function $be(e,t){const n={enter:{},update:{}};return ei(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:VM},angle:{signal:wbe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),sh(n,t,qp)}function Dbe(e,t,n,i){const r={value:0},a=e.text,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return ei(s,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Mr({type:Rc,role:Sye,style:Ove,from:i,encode:s},n)}function Tbe(e,t,n,i){const r={value:0},a=e.subtitle,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return ei(s,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Mr({type:Rc,role:Aye,style:Rve,from:i,encode:s},n)}function Mbe(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(QM(i,t))}),e.on&&e.on.forEach(i=>{AG(i,t,e.name)}),t.addDataPipeline(e.name,kbe(e,t,n))}function kbe(e,t,n){const i=[];let r=null,a=!1,s=!1,o,l,f,d,h;for(e.values?wn(e.values)||Ny(e.format)?(i.push(g9(t,e)),i.push(r=_l())):i.push(r=_l({$ingest:e.values,$format:e.format})):e.url?Ny(e.url)||Ny(e.format)?(i.push(g9(t,e)),i.push(r=_l())):i.push(r=_l({$request:e.url,$format:e.format})):e.source&&(r=o=Fe(e.source).map(p=>Me(t.getData(p).output)),i.push(null)),l=0,f=n.length;l<f;++l)d=n[l],h=d.metadata,!r&&!h.source&&i.push(r=_l()),i.push(d),h.generates&&(s=!0),h.modifies&&!s&&(a=!0),h.source?r=d:h.changes&&(r=null);return o&&(f=o.length-1,i[0]=cve({derive:a,pulse:f?o:o[0]}),(a||f)&&i.splice(1,0,_l())),r||i.push(_l()),i.push(Oc({})),i}function _l(e){const t=Oa({},e);return t.metadata={source:!0},t}function g9(e,t){return nve({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const wG=e=>e===ju||e===Ra,Gx=(e,t,n)=>wn(e)?Rbe(e.signal,t,n):e===oh||e===Ra?t:n,Bn=(e,t,n)=>wn(e)?Fbe(e.signal,t,n):wG(e)?t:n,Sa=(e,t,n)=>wn(e)?Obe(e.signal,t,n):wG(e)?n:t,_G=(e,t,n)=>wn(e)?zbe(e.signal,t,n):e===Ra?{value:t}:{value:n},Nbe=(e,t,n)=>wn(e)?Bbe(e.signal,t,n):e===uh?{value:t}:{value:n},Fbe=(e,t,n)=>CG(`${e} === '${Ra}' || ${e} === '${ju}'`,t,n),Obe=(e,t,n)=>CG(`${e} !== '${Ra}' && ${e} !== '${ju}'`,t,n),Rbe=(e,t,n)=>ZM(`${e} === '${oh}' || ${e} === '${Ra}'`,t,n),zbe=(e,t,n)=>ZM(`${e} === '${Ra}'`,t,n),Bbe=(e,t,n)=>ZM(`${e} === '${uh}'`,t,n),CG=(e,t,n)=>(t=t!=null?zn(t):t,n=n!=null?zn(n):n,p9(t)&&p9(n)?(t=t?t.signal||$e(t.value):null,n=n?n.signal||$e(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Ve({test:e},t)].concat(n||[])),p9=e=>e==null||Object.keys(e).length===1,ZM=(e,t,n)=>({signal:`${e} ? (${ed(t)}) : (${ed(n)})`}),Lbe=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${oh}' ? (${ed(i)}) : `:"")+(n!=null?`${e} === '${ju}' ? (${ed(n)}) : `:"")+(r!=null?`${e} === '${uh}' ? (${ed(r)}) : `:"")+(t!=null?`${e} === '${Ra}' ? (${ed(t)}) : `:"")+"(null)"}),ed=e=>wn(e)?e.signal:e==null?null:$e(e),jbe=(e,t)=>t===0?0:wn(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},ad=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Pf(e,t,n,i){let r;if(t&&ze(t,e))return t[e];if(ze(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[HM][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Ip][r]}return null}function m9(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function Ube(e,t){var n=t.config,i=n.style,r=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,o,l,f;if(wn(s)){const h=m9([n.axisX,n.axisY]),p=m9([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);o={};for(f of h)o[f]=Bn(s,Pf(f,n.axisX,r,i),Pf(f,n.axisY,r,i));l={};for(f of p)l[f]=Lbe(s.signal,Pf(f,n.axisTop,r,i),Pf(f,n.axisBottom,r,i),Pf(f,n.axisLeft,r,i),Pf(f,n.axisRight,r,i))}else o=s===Ra||s===ju?n.axisX:n.axisY,l=n["axis"+s[0].toUpperCase()+s.slice(1)];return o||l||a?Ve({},r,o,l,a):r}function Pbe(e,t,n,i){const r=sr(e,t),a=e.orient;let s,o;const l={enter:s={opacity:ut},update:o={opacity:Wr},exit:{opacity:ut}};ei(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const f=y9(e,0),d=y9(e,1);return s.x=o.x=Bn(a,f,ut),s.x2=o.x2=Bn(a,d),s.y=o.y=Sa(a,f,ut),s.y2=o.y2=Sa(a,d),Mr({type:YM,role:cye,from:i,encode:l},n)}function y9(e,t){return{scale:e.scale,range:t}}function Ibe(e,t,n,i,r){const a=sr(e,t),s=e.orient,o=e.gridScale,l=Gx(s,1,-1),f=qbe(e.offset,l);let d,h,p;const y={enter:d={opacity:ut},update:p={opacity:Wr},exit:h={opacity:ut}};ei(y,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const v={scale:e.scale,field:Xr,band:r.band,extra:r.extra,offset:r.offset,round:a("tickRound")},b=Bn(s,{signal:"height"},{signal:"width"}),E=o?{scale:o,range:0,mult:l,offset:f}:{value:0,offset:f},S=o?{scale:o,range:1,mult:l,offset:f}:Ve(b,{mult:l,offset:f});return d.x=p.x=Bn(s,v,E),d.y=p.y=Sa(s,v,E),d.x2=p.x2=Sa(s,S),d.y2=p.y2=Bn(s,S),h.x=Bn(s,v),h.y=Sa(s,v),Mr({type:YM,role:fye,key:Xr,from:i,encode:y},n)}function qbe(e,t){if(t!==1)if(!Pe(e))e=wn(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Ve({},e);for(;n.mult!=null;)if(Pe(n.mult))n=n.mult=Ve({},n.mult);else return n.mult=wn(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Hbe(e,t,n,i,r,a){const s=sr(e,t),o=e.orient,l=Gx(o,-1,1);let f,d,h;const p={enter:f={opacity:ut},update:h={opacity:Wr},exit:d={opacity:ut}};ei(p,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const y=zn(r);y.mult=l;const v={scale:e.scale,field:Xr,band:a.band,extra:a.extra,offset:a.offset,round:s("tickRound")};return h.y=f.y=Bn(o,ut,v),h.y2=f.y2=Bn(o,y),d.x=Bn(o,v),h.x=f.x=Sa(o,ut,v),h.x2=f.x2=Sa(o,y),d.y=Sa(o,v),Mr({type:YM,role:hye,key:Xr,from:i,encode:p},n)}function a_(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function Gbe(e,t,n,i,r,a){const s=sr(e,t),o=e.orient,l=e.scale,f=Gx(o,-1,1),d=Kl(s("labelFlush")),h=Kl(s("labelFlushOffset")),p=s("labelAlign"),y=s("labelBaseline");let v=d===0||!!d,b;const E=zn(r);E.mult=f,E.offset=zn(s("labelPadding")||0),E.offset.mult=f;const S={scale:l,field:Xr,band:.5,offset:bG(a.offset,s("labelOffset"))},w=Bn(o,v?a_(l,d,'"left"','"right"','"center"'):{value:"center"},Nbe(o,"left","right")),_=Bn(o,_G(o,"bottom","top"),v?a_(l,d,'"top"','"bottom"','"middle"'):{value:"middle"}),C=a_(l,d,`-(${h})`,h,0);v=v&&h;const $={opacity:ut,x:Bn(o,S,E),y:Sa(o,S,E)},M={enter:$,update:b={opacity:Wr,text:{field:qM},x:$.x,y:$.y,align:w,baseline:_},exit:{opacity:ut,x:$.x,y:$.y}};ei(M,{dx:!p&&v?Bn(o,C):null,dy:!y&&v?Sa(o,C):null}),ei(M,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:p,baseline:y});const T=s("labelBound");let F=s("labelOverlap");return F=F||T?{separation:s("labelSeparation"),method:F,order:"datum.index",bound:T?{scale:l,orient:o,tolerance:T}:null}:void 0,b.align!==w&&(b.align=ad(b.align,w)),b.baseline!==_&&(b.baseline=ad(b.baseline,_)),Mr({type:Rc,role:dye,style:Ip,key:Xr,from:i,encode:M,overlap:F},n)}function Ybe(e,t,n,i){const r=sr(e,t),a=e.orient,s=Gx(a,-1,1);let o,l;const f={enter:o={opacity:ut,anchor:zn(r("titleAnchor",null)),align:{signal:VM}},update:l=Ve({},o,{opacity:Wr,text:zn(e.title)}),exit:{opacity:ut}},d={signal:`lerp(range("${e.scale}"), ${Ix(0,1,.5)})`};return l.x=Bn(a,d),l.y=Sa(a,d),o.angle=Bn(a,ut,jbe(s,90)),o.baseline=Bn(a,_G(a,ju,Ra),{value:ju}),l.angle=o.angle,l.baseline=o.baseline,ei(f,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),Vbe(r,a,f,n),f.update.align=ad(f.update.align,o.align),f.update.angle=ad(f.update.angle,o.angle),f.update.baseline=ad(f.update.baseline,o.baseline),Mr({type:Rc,role:gye,style:HM,from:i,encode:f},n)}function Vbe(e,t,n,i){const r=(o,l)=>o!=null?(n.update[l]=ad(zn(o),n.update[l]),!1):!Yf(l,i),a=r(e("titleX"),"x"),s=r(e("titleY"),"y");n.enter.auto=s===a?zn(s):Bn(t,zn(s),zn(a))}function Xbe(e,t){const n=Ube(e,t),i=e.encode||{},r=i.axis||{},a=r.name||void 0,s=r.interactive,o=r.style,l=sr(e,n),f=Hve(l),d={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},h=Me(t.add(Oa({},[d]))),p=Me(t.add(Wye({scale:t.scaleRef(e.scale),extra:t.property(f.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),y=[];let v;return d.grid&&y.push(Ibe(e,n,i.grid,p,f)),d.ticks&&(v=l("tickSize"),y.push(Hbe(e,n,i.ticks,p,v,f))),d.labels&&(v=d.ticks?v:0,y.push(Gbe(e,n,i.labels,p,v,f))),d.domain&&y.push(Pbe(e,n,i.domain,h)),d.title&&y.push(Ybe(e,n,i.title,h)),Hx(Kg({role:lye,from:h,encode:sh(Wbe(l,e),r,qp),marks:y,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:a,interactive:s,style:o}),t)}function Wbe(e,t){const n={enter:{},update:{}};return ei(n,{orient:e("orient"),offset:e("offset")||0,position:ha(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function $G(e,t,n){const i=Fe(e.signals),r=Fe(e.scales);return n||i.forEach(a=>aG(a,t)),Fe(e.projections).forEach(a=>$ve(a,t)),r.forEach(a=>pve(a,t)),Fe(e.data).forEach(a=>Mbe(a,t)),r.forEach(a=>mve(a,t)),(n||i).forEach(a=>Xye(a,t)),Fe(e.axes).forEach(a=>Xbe(a,t)),Fe(e.marks).forEach(a=>Hx(a,t)),Fe(e.legends).forEach(a=>vbe(a,t)),e.title&&_be(e.title,t),t.parseLambdas(),t}const Qbe=e=>sh({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Zbe(e,t){const n=t.config,i=Me(t.root=t.add(ib())),r=Kbe(e,n);r.forEach(f=>aG(f,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const a=t.add(Oa()),s=t.add(uG(rG(Qbe(e.encode),Px,jM,e.style,t,{pulse:Me(a)}))),o=t.add(fG({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Me(s)}));t.operators.pop(),t.pushState(Me(s),Me(o),null),$G(e,t,r),t.operators.push(o);let l=t.add(oG({mark:i,pulse:Me(o)}));return l=t.add(cG({pulse:Me(l)})),l=t.add(Oc({pulse:Me(l)})),t.addData("root",new gc(t,a,a,l)),t}function z0(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Kbe(e,t){const n=s=>ha(e[s],t[s]),i=[z0("background",n("background")),z0("autosize",sye(n("autosize"))),z0("padding",uye(n("padding"))),z0("width",n("width")||0),z0("height",n("height")||0)],r=i.reduce((s,o)=>(s[o.name]=o,s),{}),a={};return Fe(e.signals).forEach(s=>{ze(r,s.name)?s=Ve(r[s.name],s):i.push(s),a[s.name]=s}),Fe(t.signals).forEach(s=>{!ze(a,s.name)&&!ze(r,s.name)&&i.push(s)}),i}function DG(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function v9(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}DG.prototype=v9.prototype={parse(e){return $G(e,this)},fork(){return new v9(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof g3?Me(e):e;return this.add(lve({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,a){let s,o;i&&(s=i.data||(i.data={}),o=s[r]||(s[r]=[]),o.push(a))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Me(this.add(Oc({pulse:e})))),this._parent.push(t),this._lookup.push(n?Me(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return st(this._parent)},encode(){return st(this._encode)},lookup(){return st(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(ft(e))return Qg(e,t);e.signal||ae("Unsupported field reference: "+$e(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Me(this.add(Jye(r)))}return i},compareRef(e){let t=!1;const n=a=>wn(a)?(t=!0,this.signalRef(a.signal)):Lye(a)?(t=!0,this.exprRef(a.expr)):a,i=Fe(e.field).map(n),r=Fe(e.order).map(n);return t?Me(this.add(r9({fields:i,orders:r}))):n9(i,r)},keyRef(e,t){let n=!1;const i=a=>wn(a)?(n=!0,Me(r[a.signal])):a,r=this.signals;return e=Fe(e).map(i),n?Me(this.add(eve({fields:e,flat:t}))):Oye(e,t)},sortRef(e){if(!e)return e;const t=jx(e.op,e.field),n=e.order||Rye;return n.signal?Me(this.add(r9({fields:t,orders:this.signalRef(n.signal)}))):n9(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return ze(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&ae("Duplicate signal name: "+$e(e));const n=t instanceof g3?t:this.add(ib(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||ae("Unrecognized signal name: "+$e(e)),this.signals[e]},signalRef(e){return this.signals[e]?Me(this.signals[e]):(ze(this.lambdas,e)||(this.lambdas[e]=this.add(ib(null))),Me(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=ps(i,this),a=this.lambdas[i];a.params=r.$params,a.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Pe(e)?e:this.signalRef(e.signal||KM(e))},exprRef(e,t){const n={expr:ps(e,this)};return t&&(n.expr.$name=t),Me(this.add(Zye(n)))},addBinding(e,t){this.bindings||ae("Nested signals do not support binding: "+$e(e)),this.bindings.push(Ve({signal:e},t))},addScaleProj(e,t){ze(this.scales,e)&&ae("Duplicate scale or projection name: "+$e(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,fve(t))},addProjection(e,t){this.addScaleProj(e,uve(t))},getScale(e){return this.scales[e]||ae("Unrecognized scale name: "+$e(e)),this.scales[e]},scaleRef(e){return Me(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ze(this.data,e)&&ae("Duplicate data set name: "+$e(e)),this.data[e]=t},getData(e){return this.data[e]||ae("Undefined data set name: "+$e(e)),this.data[e]},addDataPipeline(e,t){return ze(this.data,e)&&ae("Duplicate data set name: "+$e(e)),this.addData(e,gc.fromEntries(this,t))}};function KM(e){return(De(e)?Jbe:exe)(e)}function Jbe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(Pe(r)?r.signal||KM(r):$e(r))}return n+"]"}function exe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+$e(i)+":"+(Pe(r)?r.signal||KM(r):$e(r));return t+"}"}function txe(){const e="sans-serif",i="#4c78a8",r="#000",a="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function nxe(e,t,n){return Pe(e)||ae("Input Vega specification must be an object."),t=Mb(txe(),t,e.config),Zbe(e,new DG(t,n)).toRuntime()}var ixe="5.33.0";Ve(yd,Yie,Sle,ece,jfe,Fde,s0e,jhe,u0e,N0e,I0e,W0e);const rxe=Object.freeze(Object.defineProperty({__proto__:null,Bounds:yn,CanvasHandler:Fp,CanvasRenderer:yv,DATE:er,DAY:ci,DAYOFYEAR:hs,Dataflow:td,Debug:xB,Error:f$,EventStream:Gb,Gradient:gP,GroupItem:gx,HOURS:$r,Handler:ST,HybridHandler:aI,HybridRenderer:SC,Info:bB,Item:hx,MILLISECONDS:_a,MINUTES:Dr,MONTH:gi,Marks:Tr,MultiPulse:z$,None:yB,Operator:Ot,Parameters:Hb,Pulse:_u,QUARTER:Ji,RenderType:yu,Renderer:Np,ResourceLoader:EP,SECONDS:Kr,SVGHandler:YP,SVGRenderer:DT,SVGStringRenderer:rI,Scenegraph:LP,TIME_UNITS:C$,Transform:te,View:GH,WEEK:Sn,Warn:vB,YEAR:Jn,accessor:ar,accessorFields:hi,accessorName:tn,array:Fe,ascending:hp,bandwidthNRD:U$,bin:tj,bootstrapCI:nj,boundClip:pI,boundContext:Dp,boundItem:yC,boundMark:OP,boundStroke:wo,changeset:Mc,clampRange:NB,codegenExpression:vH,compare:p$,constant:bi,cumulativeLogNormal:Y$,cumulativeNormal:Vb,cumulativeUniform:Q$,dayofyear:uL,debounce:m$,defaultLocale:k$,definition:KL,densityLogNormal:G$,densityNormal:P$,densityUniform:W$,domChild:En,domClear:Ir,domCreate:pu,domFind:ET,dotbin:ij,error:ae,expressionFunction:cn,extend:Ve,extent:cs,extentIndex:FB,falsy:ru,fastmap:Wd,field:Qr,flush:OB,font:bx,fontFamily:kp,fontSize:Es,format:dy,formatLocale:Wy,formats:O$,hasOwnProperty:ze,id:dp,identity:Fi,inferType:PL,inferTypes:IL,ingest:bt,inherits:me,inrange:Wf,interpolate:KD,interpolateColors:fx,interpolateRange:eP,intersect:fI,intersectBoxLine:Qf,intersectPath:sT,intersectPoint:oT,intersectRule:AP,isArray:De,isBoolean:y$,isDate:Au,isFunction:We,isIterable:RB,isNumber:Tu,isObject:Pe,isRegExp:v$,isString:ft,isTuple:Ib,key:b$,lerp:zB,lineHeight:zu,loader:Ub,locale:jL,logger:EB,lruCache:BB,markup:$T,merge:LB,mergeConfig:Mb,multiLineOffset:vT,one:Xd,pad:jB,panLinear:CB,panLog:$B,panPow:DB,panSymlog:TB,parse:nxe,parseExpression:pH,parseSelector:KH,path:Kb,pathCurves:iT,pathEqual:mI,pathParse:Ad,pathRectangle:yP,pathRender:Lg,pathSymbols:mP,pathTrail:vP,peek:st,point:Ex,projection:VT,quantileLogNormal:V$,quantileNormal:Xb,quantileUniform:Z$,quantiles:L$,quantizeInterpolator:tP,quarter:MB,quartiles:j$,get random(){return Jr},randomInteger:Qne,randomKDE:q$,randomLCG:Wne,randomLogNormal:aj,randomMixture:sj,randomNormal:I$,randomUniform:oj,read:GL,regressionConstant:K$,regressionExp:lj,regressionLinear:J$,regressionLoess:dj,regressionLog:uj,regressionPoly:fj,regressionPow:cj,regressionQuad:eD,renderModule:Sx,repeat:I0,resetDefaultLocale:Yte,resetSVGClipId:xP,resetSVGDefIds:Uue,responseType:HL,runtimeContext:NH,sampleCurve:Qb,sampleLogNormal:H$,sampleNormal:Yb,sampleUniform:X$,scale:yt,sceneEqual:TT,sceneFromJSON:zP,scenePickVisit:lv,sceneToJSON:RP,sceneVisit:Ca,sceneZOrder:uT,scheme:JD,serializeXML:eI,setHybridRendererOptions:zue,setRandom:Vne,span:gp,splitAccessPath:Tb,stringValue:$e,textMetrics:Ar,timeBin:_L,timeFloor:pL,timeFormatLocale:Ng,timeInterval:Jd,timeOffset:vL,timeSequence:EL,timeUnitSpecifier:oL,timeUnits:$$,toBoolean:x$,toDate:E$,toNumber:fi,toSet:wa,toString:S$,transform:JL,transforms:yd,truncate:UB,truthy:Zr,tupleid:ke,typeParsers:J_,utcFloor:mL,utcInterval:eh,utcOffset:bL,utcSequence:SL,utcdayofyear:fL,utcquarter:kB,utcweek:dL,version:ixe,visitArray:ou,week:lL,writeConfig:kb,zero:du,zoomLinear:d$,zoomLog:h$,zoomPow:qy,zoomSymlog:g$},Symbol.toStringTag,{value:"Module"}));function lh(e,t,n){return e.fields=t||[],e.fname=n,e}function axe(e){return e.length===1?sxe(e[0]):oxe(e)}const sxe=e=>function(t){return t[e]},oxe=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function s_(e){throw Error(e)}function zc(e){const t=[],n=e.length;let i=null,r=0,a="",s,o,l;e=e+"";function f(){t.push(a+e.substring(s,o)),a="",s=o+1}for(s=o=0;o<n;++o)if(l=e[o],l==="\\")a+=e.substring(s,o++),s=o;else if(l===i)f(),i=null,r=-1;else{if(i)continue;s===r&&l==='"'||s===r&&l==="'"?(s=o+1,i=l):l==="."&&!r?o>s?f():s=o+1:l==="["?(o>s&&f(),r=s=o+1):l==="]"&&(r||s_("Access path missing open bracket: "+e),r>0&&f(),r=0,s=o+1)}return r&&s_("Access path missing closing bracket: "+e),i&&s_("Access path missing closing quote: "+e),o>s&&(o++,f()),t}function uxe(e,t,n){const i=zc(e);return e=i.length===1?i[0]:e,lh(axe(i),[e],e)}uxe("id");const lxe=lh(e=>e,[],"identity");lh(()=>0,[],"zero");lh(()=>1,[],"one");lh(()=>!0,[],"true");lh(()=>!1,[],"false");function cxe(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const fxe=1,TG=2,dxe=3,hxe=4;function gxe(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cxe,i=e;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=fxe&&n("error","ERROR",arguments),this},warn(){return i>=TG&&n("warn","WARN",arguments),this},info(){return i>=dxe&&n("log","INFO",arguments),this},debug(){return i>=hxe&&n("log","DEBUG",arguments),this}}}var Se=Array.isArray;function dt(e){return e===Object(e)}const b9=e=>e!=="__proto__";function MG(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const a in r)if(a==="signals")i.signals=pxe(i.signals,r.signals);else{const s=a==="legend"?{layout:1}:a==="style"?!0:null;Yx(i,a,r[a],s)}return i},{})}function Yx(e,t,n,i){if(!b9(t))return;let r,a;if(dt(n)&&!Se(n)){a=dt(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Yx(a,r,n[r]):b9(r)&&(a[r]=n[r])}else e[t]=n}function pxe(e,t){if(e==null)return t;const n={},i=[];function r(a){n[a.name]||(n[a.name]=1,i.push(a))}return t.forEach(r),e.forEach(r),i}function on(e){return e!=null?Se(e)?e:[e]:[]}function mxe(e){return typeof e=="function"}function pn(e,t){return Object.hasOwn(e,t)}function Hp(e){return typeof e=="boolean"}function Ht(e){return typeof e=="number"}function He(e){return typeof e=="string"}function ct(e){return Se(e)?"["+e.map(ct)+"]":dt(e)||He(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}const yxe="view",rb="[",ab="]",kG="{",NG="}",vxe=":",FG=",",bxe="@",xxe=">",Exe=/[[\]{}]/,Sxe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let OG,RG;function ch(e,t,n){return OG=t||yxe,RG=Sxe,zG(e.trim()).map(E3)}function Axe(e){return RG[e]}function wg(e,t,n,i,r){const a=e.length;let s=0,o;for(;t<a;++t){if(o=e[t],!s&&o===n)return t;r&&r.includes(o)?--s:i&&i.includes(o)&&++s}return t}function zG(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=wg(e,r,FG,rb+kG,ab+NG),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function E3(e){return e[0]==="["?wxe(e):_xe(e)}function wxe(e){const t=e.length;let n=1,i;if(n=wg(e,n,ab,rb,ab),n===t)throw"Empty between selector: "+e;if(i=zG(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==xxe)throw"Expected '>' after between selector: "+e;i=i.map(E3);const r=E3(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function _xe(e){const t={source:OG},n=[];let i=[0,0],r=0,a=0,s=e.length,o=0,l,f;if(e[s-1]===NG){if(o=e.lastIndexOf(kG),o>=0){try{i=Cxe(e.substring(o+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),s=e.length}else throw"Unmatched right brace: "+e;o=0}if(!s)throw e;if(e[0]===bxe&&(r=++o),l=wg(e,o,vxe),l<s&&(n.push(e.substring(a,l).trim()),a=o=++l),o=wg(e,o,rb),o===s)n.push(e.substring(a,s).trim());else if(n.push(e.substring(a,o).trim()),f=[],a=++o,a===s)throw"Unmatched left bracket: "+e;for(;o<s;){if(o=wg(e,o,ab),o===s)throw"Unmatched left bracket: "+e;if(f.push(e.substring(a,o).trim()),o<s-1&&e[++o]!==rb)throw"Expected left bracket: "+e;a=++o}if(!(s=n.length)||Exe.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],r?t.markname=n[0].slice(1):Axe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),f!=null&&(t.filter=f),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Cxe(e){const t=e.split(FG);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}const $xe="RawCode",Dxe="Literal",Txe="Property",Mxe="Identifier",kxe="ArrayExpression",Nxe="BinaryExpression",Fxe="CallExpression",Oxe="ConditionalExpression",Rxe="LogicalExpression",zxe="MemberExpression",Bxe="ObjectExpression",Lxe="UnaryExpression";function za(e){this.type=e}za.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=jxe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function jxe(e){switch(e.type){case kxe:return e.elements;case Nxe:case Rxe:return[e.left,e.right];case Fxe:return[e.callee].concat(e.arguments);case Oxe:return[e.test,e.consequent,e.alternate];case zxe:return[e.object,e.property];case Bxe:return e.properties;case Txe:return[e.key,e.value];case Lxe:return[e.argument];case Mxe:case Dxe:case $xe:default:return[]}}var _s,we,re,yi,Ct,Vx=1,Gp=2,pc=3,Qu=4,Xx=5,Bc=6,Vi=7,Yp=8,Uxe=9;_s={};_s[Vx]="Boolean";_s[Gp]="<end>";_s[pc]="Identifier";_s[Qu]="Keyword";_s[Xx]="Null";_s[Bc]="Numeric";_s[Vi]="Punctuator";_s[Yp]="String";_s[Uxe]="RegularExpression";var Pxe="ArrayExpression",Ixe="BinaryExpression",qxe="CallExpression",Hxe="ConditionalExpression",BG="Identifier",Gxe="Literal",Yxe="LogicalExpression",Vxe="MemberExpression",Xxe="ObjectExpression",Wxe="Property",Qxe="UnaryExpression",Ln="Unexpected token %0",Zxe="Unexpected number",Kxe="Unexpected string",Jxe="Unexpected identifier",e2e="Unexpected reserved word",t2e="Unexpected end of input",S3="Invalid regular expression",o_="Invalid regular expression: missing /",LG="Octal literals are not allowed in strict mode.",n2e="Duplicate data property in object literal not allowed in strict mode",Kn="ILLEGAL",Jg="Disabled.",i2e=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),r2e=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Wx(e,t){if(!e)throw new Error("ASSERT: "+t)}function eo(e){return e>=48&&e<=57}function JM(e){return"0123456789abcdefABCDEF".includes(e)}function _g(e){return"01234567".includes(e)}function a2e(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function ep(e){return e===10||e===13||e===8232||e===8233}function Vp(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&i2e.test(String.fromCharCode(e))}function sb(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&r2e.test(String.fromCharCode(e))}const s2e={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jG(){for(;re<yi;){const e=we.charCodeAt(re);if(a2e(e)||ep(e))++re;else break}}function A3(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)re<yi&&JM(we[re])?(i=we[re++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):pt({},Ln,Kn);return String.fromCharCode(r)}function o2e(){var e,t,n,i;for(e=we[re],t=0,e==="}"&&pt({},Ln,Kn);re<yi&&(e=we[re++],!!JM(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&pt({},Ln,Kn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function UG(){var e,t;for(e=we.charCodeAt(re++),t=String.fromCharCode(e),e===92&&(we.charCodeAt(re)!==117&&pt({},Ln,Kn),++re,e=A3("u"),(!e||e==="\\"||!Vp(e.charCodeAt(0)))&&pt({},Ln,Kn),t=e);re<yi&&(e=we.charCodeAt(re),!!sb(e));)++re,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),we.charCodeAt(re)!==117&&pt({},Ln,Kn),++re,e=A3("u"),(!e||e==="\\"||!sb(e.charCodeAt(0)))&&pt({},Ln,Kn),t+=e);return t}function u2e(){var e,t;for(e=re++;re<yi;){if(t=we.charCodeAt(re),t===92)return re=e,UG();if(sb(t))++re;else break}return we.slice(e,re)}function l2e(){var e,t,n;return e=re,t=we.charCodeAt(re)===92?UG():u2e(),t.length===1?n=pc:s2e.hasOwnProperty(t)?n=Qu:t==="null"?n=Xx:t==="true"||t==="false"?n=Vx:n=pc,{type:n,value:t,start:e,end:re}}function u_(){var e=re,t=we.charCodeAt(re),n,i=we[re],r,a,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++re,{type:Vi,value:String.fromCharCode(t),start:e,end:re};default:if(n=we.charCodeAt(re+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return re+=2,{type:Vi,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:re};case 33:case 61:return re+=2,we.charCodeAt(re)===61&&++re,{type:Vi,value:we.slice(e,re),start:e,end:re}}}if(s=we.substr(re,4),s===">>>=")return re+=4,{type:Vi,value:s,start:e,end:re};if(a=s.substr(0,3),a===">>>"||a==="<<="||a===">>=")return re+=3,{type:Vi,value:a,start:e,end:re};if(r=a.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return re+=2,{type:Vi,value:r,start:e,end:re};if(r==="//"&&pt({},Ln,Kn),"<>=!+-*%&|^/".includes(i))return++re,{type:Vi,value:i,start:e,end:re};pt({},Ln,Kn)}function c2e(e){let t="";for(;re<yi&&JM(we[re]);)t+=we[re++];return t.length===0&&pt({},Ln,Kn),Vp(we.charCodeAt(re))&&pt({},Ln,Kn),{type:Bc,value:parseInt("0x"+t,16),start:e,end:re}}function f2e(e){let t="0"+we[re++];for(;re<yi&&_g(we[re]);)t+=we[re++];return(Vp(we.charCodeAt(re))||eo(we.charCodeAt(re)))&&pt({},Ln,Kn),{type:Bc,value:parseInt(t,8),octal:!0,start:e,end:re}}function x9(){var e,t,n;if(n=we[re],Wx(eo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=re,e="",n!=="."){if(e=we[re++],n=we[re],e==="0"){if(n==="x"||n==="X")return++re,c2e(t);if(_g(n))return f2e(t);n&&eo(n.charCodeAt(0))&&pt({},Ln,Kn)}for(;eo(we.charCodeAt(re));)e+=we[re++];n=we[re]}if(n==="."){for(e+=we[re++];eo(we.charCodeAt(re));)e+=we[re++];n=we[re]}if(n==="e"||n==="E")if(e+=we[re++],n=we[re],(n==="+"||n==="-")&&(e+=we[re++]),eo(we.charCodeAt(re)))for(;eo(we.charCodeAt(re));)e+=we[re++];else pt({},Ln,Kn);return Vp(we.charCodeAt(re))&&pt({},Ln,Kn),{type:Bc,value:parseFloat(e),start:t,end:re}}function d2e(){var e="",t,n,i,r,a=!1;for(t=we[re],Wx(t==="'"||t==='"',"String literal must starts with a quote"),n=re,++re;re<yi;)if(i=we[re++],i===t){t="";break}else if(i==="\\")if(i=we[re++],!i||!ep(i.charCodeAt(0)))switch(i){case"u":case"x":we[re]==="{"?(++re,e+=o2e()):e+=A3(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:_g(i)?(r="01234567".indexOf(i),r!==0&&(a=!0),re<yi&&_g(we[re])&&(a=!0,r=r*8+"01234567".indexOf(we[re++]),"0123".includes(i)&&re<yi&&_g(we[re])&&(r=r*8+"01234567".indexOf(we[re++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&we[re]===`
`&&++re;else{if(ep(i.charCodeAt(0)))break;e+=i}return t!==""&&pt({},Ln,Kn),{type:Yp,value:e,octal:a,start:n,end:re}}function h2e(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";pt({},S3)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{pt({},S3)}try{return new RegExp(e,t)}catch{return null}}function g2e(){var e,t,n,i,r;for(e=we[re],Wx(e==="/","Regular expression literal must start with a slash"),t=we[re++],n=!1,i=!1;re<yi;)if(e=we[re++],t+=e,e==="\\")e=we[re++],ep(e.charCodeAt(0))&&pt({},o_),t+=e;else if(ep(e.charCodeAt(0)))pt({},o_);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||pt({},o_),r=t.substr(1,t.length-2),{value:r,literal:t}}function p2e(){var e,t,n;for(t="",n="";re<yi&&(e=we[re],!!sb(e.charCodeAt(0)));)++re,e==="\\"&&re<yi?pt({},Ln,Kn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&pt({},S3,n),{value:n,literal:t}}function m2e(){var e,t,n,i;return Ct=null,jG(),e=re,t=g2e(),n=p2e(),i=h2e(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:re}}function y2e(e){return e.type===pc||e.type===Qu||e.type===Vx||e.type===Xx}function PG(){if(jG(),re>=yi)return{type:Gp,start:re,end:re};const e=we.charCodeAt(re);return Vp(e)?l2e():e===40||e===41||e===59?u_():e===39||e===34?d2e():e===46?eo(we.charCodeAt(re+1))?x9():u_():eo(e)?x9():u_()}function Qi(){const e=Ct;return re=e.end,Ct=PG(),re=e.end,e}function IG(){const e=re;Ct=PG(),re=e}function v2e(e){const t=new za(Pxe);return t.elements=e,t}function E9(e,t,n){const i=new za(e==="||"||e==="&&"?Yxe:Ixe);return i.operator=e,i.left=t,i.right=n,i}function b2e(e,t){const n=new za(qxe);return n.callee=e,n.arguments=t,n}function x2e(e,t,n){const i=new za(Hxe);return i.test=e,i.consequent=t,i.alternate=n,i}function ek(e){const t=new za(BG);return t.name=e,t}function lg(e){const t=new za(Gxe);return t.value=e.value,t.raw=we.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function S9(e,t,n){const i=new za(Vxe);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function E2e(e){const t=new za(Xxe);return t.properties=e,t}function A9(e,t,n){const i=new za(Wxe);return i.key=t,i.value=n,i.kind=e,i}function S2e(e,t){const n=new za(Qxe);return n.operator=e,n.argument=t,n.prefix=!0,n}function pt(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(a,s)=>(Wx(s<i.length,"Message reference must be in range"),i[s]));throw n=new Error(r),n.index=re,n.description=r,n}function Qx(e){e.type===Gp&&pt(e,t2e),e.type===Bc&&pt(e,Zxe),e.type===Yp&&pt(e,Kxe),e.type===pc&&pt(e,Jxe),e.type===Qu&&pt(e,e2e),pt(e,Ln,e.value)}function vi(e){const t=Qi();(t.type!==Vi||t.value!==e)&&Qx(t)}function jt(e){return Ct.type===Vi&&Ct.value===e}function l_(e){return Ct.type===Qu&&Ct.value===e}function A2e(){const e=[];for(re=Ct.start,vi("[");!jt("]");)jt(",")?(Qi(),e.push(null)):(e.push(mc()),jt("]")||vi(","));return Qi(),v2e(e)}function w9(){re=Ct.start;const e=Qi();return e.type===Yp||e.type===Bc?(e.octal&&pt(e,LG),lg(e)):ek(e.value)}function w2e(){var e,t,n,i;if(re=Ct.start,e=Ct,e.type===pc)return n=w9(),vi(":"),i=mc(),A9("init",n,i);if(e.type===Gp||e.type===Vi)Qx(e);else return t=w9(),vi(":"),i=mc(),A9("init",t,i)}function _2e(){var e=[],t,n,i,r={},a=String;for(re=Ct.start,vi("{");!jt("}");)t=w2e(),t.key.type===BG?n=t.key.name:n=a(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?pt({},n2e):r[i]=!0,e.push(t),jt("}")||vi(",");return vi("}"),E2e(e)}function C2e(){vi("(");const e=tk();return vi(")"),e}const $2e={if:1};function D2e(){var e,t,n;if(jt("("))return C2e();if(jt("["))return A2e();if(jt("{"))return _2e();if(e=Ct.type,re=Ct.start,e===pc||$2e[Ct.value])n=ek(Qi().value);else if(e===Yp||e===Bc)Ct.octal&&pt(Ct,LG),n=lg(Qi());else{if(e===Qu)throw new Error(Jg);e===Vx?(t=Qi(),t.value=t.value==="true",n=lg(t)):e===Xx?(t=Qi(),t.value=null,n=lg(t)):jt("/")||jt("/=")?(n=lg(m2e()),IG()):Qx(Qi())}return n}function T2e(){const e=[];if(vi("("),!jt(")"))for(;re<yi&&(e.push(mc()),!jt(")"));)vi(",");return vi(")"),e}function M2e(){re=Ct.start;const e=Qi();return y2e(e)||Qx(e),ek(e.value)}function k2e(){return vi("."),M2e()}function N2e(){vi("[");const e=tk();return vi("]"),e}function F2e(){var e,t,n;for(e=D2e();;)if(jt("."))n=k2e(),e=S9(".",e,n);else if(jt("("))t=T2e(),e=b2e(e,t);else if(jt("["))n=N2e(),e=S9("[",e,n);else break;return e}function _9(){const e=F2e();if(Ct.type===Vi&&(jt("++")||jt("--")))throw new Error(Jg);return e}function zy(){var e,t;if(Ct.type!==Vi&&Ct.type!==Qu)t=_9();else{if(jt("++")||jt("--"))throw new Error(Jg);if(jt("+")||jt("-")||jt("~")||jt("!"))e=Qi(),t=zy(),t=S2e(e.value,t);else{if(l_("delete")||l_("void")||l_("typeof"))throw new Error(Jg);t=_9()}}return t}function C9(e){let t=0;if(e.type!==Vi&&e.type!==Qu)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function O2e(){var e,t,n,i,r,a,s,o,l,f;if(e=Ct,l=zy(),i=Ct,r=C9(i),r===0)return l;for(i.prec=r,Qi(),t=[e,Ct],s=zy(),a=[l,i,s];(r=C9(Ct))>0;){for(;a.length>2&&r<=a[a.length-2].prec;)s=a.pop(),o=a.pop().value,l=a.pop(),t.pop(),n=E9(o,l,s),a.push(n);i=Qi(),i.prec=r,a.push(i),t.push(Ct),n=zy(),a.push(n)}for(f=a.length-1,n=a[f],t.pop();f>1;)t.pop(),n=E9(a[f-1].value,a[f-2],n),f-=2;return n}function mc(){var e,t,n;return e=O2e(),jt("?")&&(Qi(),t=mc(),vi(":"),n=mc(),e=x2e(e,t,n)),e}function tk(){const e=mc();if(jt(","))throw new Error(Jg);return e}function R2e(e){we=e,re=0,yi=we.length,Ct=null,IG();const t=tk();if(Ct.type!==Gp)throw new Error("Unexpect token after expression.");return t}var z2e="6.2.0",B2e={version:z2e};function nk(e){return de(e,"or")}function ik(e){return de(e,"and")}function rk(e){return de(e,"not")}function By(e,t){if(rk(e))By(e.not,t);else if(ik(e))for(const n of e.and)By(n,t);else if(nk(e))for(const n of e.or)By(n,t);else t(e)}function sd(e,t){return rk(e)?{not:sd(e.not,t)}:ik(e)?{and:e.and.map(n=>sd(n,t))}:nk(e)?{or:e.or.map(n=>sd(n,t))}:t(e)}const Ue=structuredClone;function qG(e){throw new Error(e)}function Nd(e,t){const n={};for(const i of t)pn(e,i)&&(n[i]=e[i]);return n}function _r(e,t){const n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>Et(e)).join(",")})`};function rt(e){if(Ht(e))return e;const t=He(e)?e:Et(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function w3(e){return e===!1||e===null}function et(e,t){return e.includes(t)}function Fd(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function ak(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function HG(e,...t){for(const n of t)L2e(e,n??{});return e}function L2e(e,t){for(const n of fe(t))Yx(e,n,t[n],!0)}function ns(e,t){const n=[],i={};let r;for(const a of e)r=t(a),!(r in i)&&(i[r]=1,n.push(a));return n}function j2e(e,t){const n=fe(e),i=fe(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function GG(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function sk(e,t){for(const n of e)if(t.has(n))return!0;return!1}function _3(e){const t=new Set;for(const n of e){const r=zc(n).map((s,o)=>o===0?s:`[${s}]`),a=r.map((s,o)=>r.slice(0,o+1).join(""));for(const s of a)t.add(s)}return t}function ok(e,t){return e===void 0||t===void 0?!0:sk(_3(e),_3(t))}function Rt(e){return fe(e).length===0}const fe=Object.keys,mn=Object.values,Uu=Object.entries;function tp(e){return e===!0||e===!1}function qt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Cg(e,t){return rk(e)?`!(${Cg(e.not,t)})`:ik(e)?`(${e.and.map(n=>Cg(n,t)).join(") && (")})`:nk(e)?`(${e.or.map(n=>Cg(n,t)).join(") || (")})`:t(e)}function ob(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&ob(e[n],t)&&delete e[n],Rt(e)}function Xp(e){return e.charAt(0).toUpperCase()+e.substr(1)}function uk(e,t="datum"){const n=zc(e),i=[];for(let r=1;r<=n.length;r++){const a=`[${n.slice(0,r).map(ct).join("][")}]`;i.push(`${t}${a}`)}return i.join(" && ")}function YG(e,t="datum"){return`${t}[${ct(zc(e).join("."))}]`}function wt(e){return`datum['${e.replaceAll("'","\\'")}']`}function U2e(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ta(e){return`${zc(e).map(U2e).join("\\.")}`}function yc(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function fh(e){return`${zc(e).join(".")}`}function Od(e){return e?zc(e).length:0}function un(...e){return e.find(t=>t!==void 0)}let VG=42;function XG(e){const t=++VG;return e?String(e)+t:t}function P2e(){VG=42}function WG(e){return QG(e)?e:`__${e}`}function QG(e){return e.startsWith("__")}function np(e){if(e!==void 0)return(e%360+360)%360}function Zx(e){return Ht(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const $9=Object.getPrototypeOf(structuredClone({}));function Sr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!Sr(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const a of e.entries())if(!t.has(a[0]))return!1;for(const a of e.entries())if(!Sr(a[1],t.get(a[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const a of e.entries())if(!t.has(a[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==$9.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==$9.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const a=r[i];if(!Sr(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function Et(e){const t=[];return function n(i){if(i!=null&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?`${i}`:"null";if(typeof i!="object")return JSON.stringify(i);let r,a;if(Array.isArray(i)){for(a="[",r=0;r<i.length;r++)r&&(a+=","),a+=n(i[r])||"null";return`${a}]`}if(i===null)return"null";if(t.includes(i))throw new TypeError("Converting circular structure to JSON");const s=t.push(i)-1,o=Object.keys(i).sort();for(a="",r=0;r<o.length;r++){const l=o[r],f=n(i[l]);f&&(a&&(a+=","),a+=`${JSON.stringify(l)}:${f}`)}return t.splice(s,1),`{${a}}`}(e)}function de(e,t){return dt(e)&&pn(e,t)&&e[t]!==void 0}const ho="row",go="column",Kx="facet",Gt="x",In="y",Ba="x2",Cs="y2",Zu="xOffset",dh="yOffset",La="radius",Co="radius2",ra="theta",$o="theta2",ja="latitude",Ua="longitude",Pa="latitude2",na="longitude2",Ku="time",nr="color",$s="fill",Ds="stroke",ir="shape",Do="size",Lc="angle",To="opacity",Ju="fillOpacity",el="strokeOpacity",tl="strokeWidth",nl="strokeDash",Wp="text",Rd="order",Qp="detail",Jx="key",vc="tooltip",e2="href",t2="url",n2="description",I2e={x:1,y:1,x2:1,y2:1},ZG={theta:1,theta2:1,radius:1,radius2:1};function KG(e){return pn(ZG,e)}const lk={longitude:1,longitude2:1,latitude:1,latitude2:1};function JG(e){switch(e){case ja:return"y";case Pa:return"y2";case Ua:return"x";case na:return"x2"}}function eY(e){return pn(lk,e)}const q2e=fe(lk),ck={...I2e,...ZG,...lk,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function od(e){return e===nr||e===$s||e===Ds}const tY={row:1,column:1,facet:1},Vr=fe(tY),fk={...ck,...tY},H2e=fe(fk),{order:XTe,detail:WTe,tooltip:QTe,...G2e}=fk,{row:ZTe,column:KTe,facet:JTe,...Y2e}=G2e;function V2e(e){return pn(Y2e,e)}function nY(e){return pn(fk,e)}const X2e=[Ba,Cs,Pa,na,$o,Co];function iY(e){return jc(e)!==e}function jc(e){switch(e){case Ba:return Gt;case Cs:return In;case Pa:return ja;case na:return Ua;case $o:return ra;case Co:return La}return e}function Pu(e){if(KG(e))switch(e){case ra:return"startAngle";case $o:return"endAngle";case La:return"outerRadius";case Co:return"innerRadius"}return e}function Ts(e){switch(e){case Gt:return Ba;case In:return Cs;case ja:return Pa;case Ua:return na;case ra:return $o;case La:return Co}}function rr(e){switch(e){case Gt:case Ba:return"width";case In:case Cs:return"height"}}function rY(e){switch(e){case Gt:return"xOffset";case In:return"yOffset";case Ba:return"x2Offset";case Cs:return"y2Offset";case ra:return"thetaOffset";case La:return"radiusOffset";case $o:return"theta2Offset";case Co:return"radius2Offset"}}function dk(e){switch(e){case Gt:return"xOffset";case In:return"yOffset"}}function W2e(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const Q2e=fe(ck),{x:eMe,y:tMe,x2:nMe,y2:iMe,xOffset:rMe,yOffset:aMe,latitude:sMe,longitude:oMe,latitude2:uMe,longitude2:lMe,theta:cMe,theta2:fMe,radius:dMe,radius2:hMe,...hk}=ck,Z2e=fe(hk),gk={x:1,y:1},Mo=fe(gk);function ln(e){return pn(gk,e)}const pk={theta:1,radius:1},K2e=fe(pk);function i2(e){return e==="width"?Gt:In}const aY={xOffset:1,yOffset:1};function Zp(e){return pn(aY,e)}const J2e={time:1};function c_(e){return e in J2e}const{text:gMe,tooltip:pMe,href:mMe,url:yMe,description:vMe,detail:bMe,key:xMe,order:EMe,...sY}=hk,eEe=fe(sY);function tEe(e){return pn(hk,e)}function nEe(e){switch(e){case nr:case $s:case Ds:case Do:case ir:case To:case tl:case nl:return!0;case Ju:case el:case Lc:case Ku:return!1}}const oY={...gk,...pk,...aY,...sY},mk=fe(oY);function Ms(e){return pn(oY,e)}function iEe(e,t){return aEe(e)[t]}const uY={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:SMe,...rEe}=uY;function aEe(e){switch(e){case nr:case $s:case Ds:case n2:case Qp:case Jx:case vc:case e2:case Rd:case To:case Ju:case el:case tl:case Kx:case ho:case go:return uY;case Gt:case In:case Zu:case dh:case ja:case Ua:case Ku:return rEe;case Ba:case Cs:case Pa:case na:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Do:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case nl:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case ir:return{point:"always",geoshape:"always"};case Wp:return{text:"always"};case Lc:return{point:"always",square:"always",text:"always"};case t2:return{image:"always"};case ra:return{text:"always",arc:"always"};case La:return{text:"always",arc:"always"};case $o:case Co:return{arc:"always"}}}function f_(e){switch(e){case Gt:case In:case ra:case La:case Zu:case dh:case Do:case Lc:case tl:case To:case Ju:case el:case Ku:case Ba:case Cs:case $o:case Co:return;case Kx:case ho:case go:case ir:case nl:case Wp:case vc:case e2:case t2:case n2:return"discrete";case nr:case $s:case Ds:return"flexible";case ja:case Ua:case Pa:case na:case Qp:case Jx:case Rd:return}}const sEe={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},oEe={count:1,min:1,max:1};function Eo(e){return de(e,"argmin")}function il(e){return de(e,"argmax")}function yk(e){return He(e)&&pn(sEe,e)}const uEe=new Set(["count","valid","missing","distinct"]);function r2(e){return He(e)&&uEe.has(e)}function lEe(e){return He(e)&&et(["min","max"],e)}const cEe=new Set(["count","sum","distinct","valid","missing"]),fEe=new Set(["mean","average","median","q1","q3","min","max"]);function lY(e){return Hp(e)&&(e=m2(e,void 0)),`bin${fe(e).map(t=>a2(e[t])?qt(`_${t}_${Uu(e[t])}`):qt(`_${t}_${e[t]}`)).join("")}`}function Bt(e){return e===!0||Uc(e)&&!e.binned}function Yn(e){return e==="binned"||Uc(e)&&e.binned===!0}function Uc(e){return dt(e)}function a2(e){return de(e,"param")}function D9(e){switch(e){case ho:case go:case Do:case nr:case $s:case Ds:case tl:case To:case Ju:case el:case ir:return 6;case nl:return 4;default:return 10}}function Kp(e){return de(e,"expr")}function Vn(e,{level:t}={level:0}){const n=fe(e||{}),i={};for(const r of n)i[r]=t===0?br(e[r]):Vn(e[r],{level:t-1});return i}function cY(e){const{anchor:t,frame:n,offset:i,orient:r,angle:a,limit:s,color:o,subtitleColor:l,subtitleFont:f,subtitleFontSize:d,subtitleFontStyle:h,subtitleFontWeight:p,subtitleLineHeight:y,subtitlePadding:v,...b}=e,E={...b,...o?{fill:o}:{}},S={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...a!==void 0?{angle:a}:{},...s!==void 0?{limit:s}:{}},w={...l?{subtitleColor:l}:{},...f?{subtitleFont:f}:{},...d?{subtitleFontSize:d}:{},...h?{subtitleFontStyle:h}:{},...p?{subtitleFontWeight:p}:{},...y?{subtitleLineHeight:y}:{},...v?{subtitlePadding:v}:{}},_=Nd(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:E,subtitleMarkConfig:_,nonMarkTitleProperties:S,subtitle:w}}function fu(e){return He(e)||Se(e)&&He(e[0])}function Ce(e){return de(e,"signal")}function Pc(e){return de(e,"step")}function dEe(e){return Se(e)?!1:de(e,"fields")&&!de(e,"data")}function hEe(e){return Se(e)?!1:de(e,"fields")&&de(e,"data")}function uo(e){return Se(e)?!1:de(e,"field")&&de(e,"data")}const gEe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},pEe=fe(gEe),mEe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},C3=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"],yEe="  ";function fY(e){const t=Se(e.condition)?e.condition.map(T9):T9(e.condition);return{...br(e),condition:t}}function br(e){if(Kp(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function T9(e){if(Kp(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Ut(e){if(Kp(e)){const{expr:t,...n}=e;return{signal:t,...n}}return Ce(e)?e:e!==void 0?{value:e}:void 0}function vEe(e){return Ce(e)?e.signal:ct(e)}function M9(e){return Ce(e)?e.signal:ct(e.value)}function xa(e){return Ce(e)?e.signal:e==null?null:ct(e)}function bEe(e,t,n){for(const i of n){const r=ms(i,t.markDef,t.config);r!==void 0&&(e[i]=Ut(r))}return e}function dY(e){return[].concat(e.type,e.style??[])}function kt(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:a}=i;return r&&de(t,r)?t[r]:t[e]!==void 0?t[e]:a&&(!r||r===e)?void 0:ms(e,t,n,i)}function ms(e,t,n,{vgChannel:i}={}){const r=$3(e,t,n.style);return un(i?r:void 0,r,i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function $3(e,t,n){return hY(e,dY(t),n)}function hY(e,t,n){t=on(t);let i;for(const r of t){const a=n[r];de(a,e)&&(i=a[e])}return i}function gY(e,t){return on(e).reduce((n,i)=>(n.field.push(ve(i,t)),n.order.push(i.sort??"ascending"),n),{field:[],order:[]})}function pY(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(Sr(r,i))return;n.push(i)}),n}function mY(e,t){return Sr(e,t)||!t?e:e?[...on(e),...on(t)].join(", "):t}function yY(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((fu(n)||Ce(n))&&(fu(i)||Ce(i)))return{explicit:e.explicit,value:mY(n,i)};if(fu(n)||Ce(n))return{explicit:e.explicit,value:n};if(fu(i)||Ce(i))return{explicit:e.explicit,value:i};if(!fu(n)&&!Ce(n)&&!fu(i)&&!Ce(i))return{explicit:e.explicit,value:pY(n,i)};throw new Error("It should never reach here")}function vk(e){return`Invalid specification ${Et(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const xEe='Autosize "fit" only works for single views and layered views.';function k9(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function N9(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function F9(e){return e?`Dropping "fit-${e}" because spec has discrete ${rr(e)}.`:'Dropping "fit" because spec has discrete size.'}function bk(e){return`Unknown field for ${e}. Cannot calculate view size.`}function O9(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function EEe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function SEe(e){return`The "nearest" transform is not supported for ${e} marks.`}function vY(e){return`Selection not supported for ${e} yet.`}function AEe(e){return`Cannot find a selection named "${e}".`}const wEe="Scale bindings are currently only supported for scales with unbinned, continuous domains.",_Ee="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",CEe="Legend bindings are only supported for selections over an individual field or encoding channel.";function $Ee(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function DEe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const TEe="The same selection must be used to override scale domains in a layered view.",MEe='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function kEe(e){return`Unknown repeated value "${e}".`}function R9(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const NEe="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",xk="Animation involving facet, layer, or concat is currently unsupported.";function FEe(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${$e(e)}.`}function OEe(e,t,n,i){return`${e.length?"Multiple ":"No "}matching ${$e(t)} encoding found for selection ${$e(n.param)}. Using "field": ${$e(i)}.`}const REe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function zEe(e){return`Unrecognized parse "${e}".`}function z9(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const BEe="Attempt to add the same child twice.";function LEe(e){return`Ignoring an invalid transform: ${Et(e)}.`}const jEe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function B9(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function UEe(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Et(t)} is overridden by a child projection ${Et(n)}.`}const PEe="Arc marks uses theta channel rather than angle, replacing angle with theta.";function IEe(e){return`${e}Offset dropped because ${e} is continuous`}function qEe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Et(n)}}.`}function bY(e){return`Invalid field type "${e}".`}function HEe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function GEe(e){return`Invalid aggregation operator "${e}".`}function xY(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function YEe(e){return`Position range does not support relative band size for ${e}.`}function D3(e,t){return`Dropping ${Et(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const VEe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function s2(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function XEe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function WEe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function QEe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function ZEe(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function d_(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function KEe(e){return`The ${e} for range marks cannot be an expression`}function JEe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function eSe(e,t){return`Specified orient "${e}" overridden with "${t}".`}function tSe(e){return`Cannot use the scale property "${e}" with non-color channel.`}function nSe(e){return`Cannot use the relative band size with ${e} scale.`}function iSe(e){return`Using unaggregated domain with raw field has no effect (${Et(e)}).`}function rSe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function aSe(e){return`Unaggregated domain is currently unsupported for log scale (${Et(e)}).`}function sSe(e){return`Cannot apply size to non-oriented mark "${e}".`}function oSe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function uSe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function EY(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function SY(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function lSe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Et(n)} and ${Et(i)}). Using ${Et(n)}.`}function cSe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Et(n)} and ${Et(i)}). Using the union of the two domains.`}function fSe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function dSe(e){return`Dropping sort property ${Et(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const L9="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",hSe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",gSe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",pSe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function mSe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function ySe(e){return`Stack is applied to a non-linear scale (${e}).`}function vSe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function ub(e,t){return`Invalid ${e}: ${Et(t)}.`}function bSe(e){return`Dropping day from datetime ${Et(e)} as day cannot be combined with other units.`}function xSe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function ESe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function SSe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function j9(e){return`1D error band does not support ${e}.`}function AY(e){return`Channel ${e} is required for "binned" bin.`}function ASe(e){return`Channel ${e} should not be used with "binned" bin.`}function wSe(e){return`Domain for ${e} is required for threshold scale.`}const wY=gxe(TG);let bc=wY;function _Se(e){return bc=e,bc}function CSe(){return bc=wY,bc}function Ek(...e){bc.error(...e)}function ge(...e){bc.warn(...e)}function $Se(...e){bc.debug(...e)}function Ic(e){if(e&&dt(e)){for(const t of Ak)if(de(e,t))return!0}return!1}const _Y=["january","february","march","april","may","june","july","august","september","october","november","december"],DSe=_Y.map(e=>e.substr(0,3)),CY=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],TSe=CY.map(e=>e.substr(0,3));function MSe(e){if(Zx(e)&&(e=+e),Ht(e))return e>4&&ge(ub("quarter",e)),e-1;throw new Error(ub("quarter",e))}function kSe(e){if(Zx(e)&&(e=+e),Ht(e))return e-1;{const t=e.toLowerCase(),n=_Y.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=DSe.indexOf(i);if(r!==-1)return r;throw new Error(ub("month",e))}}function NSe(e){if(Zx(e)&&(e=+e),Ht(e))return e%7;{const t=e.toLowerCase(),n=CY.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=TSe.indexOf(i);if(r!==-1)return r;throw new Error(ub("day",e))}}function Sk(e,t){const n=[];if(t&&e.day!==void 0&&fe(e).length>1&&(ge(bSe(e)),e=Ue(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?kSe(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?MSe(e.quarter):e.quarter;n.push(Ht(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?NSe(e.day):e.day;n.push(Ht(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function xc(e){const n=Sk(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function FSe(e){const n=Sk(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function OSe(e){const t=Sk(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const $Y={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Ak=fe($Y);function RSe(e){return ze($Y,e)}function qc(e){return dt(e)?e.binned:DY(e)}function DY(e){return e==null?void 0:e.startsWith("binned")}function wk(e){return e.startsWith("utc")}function zSe(e){return e.substring(3)}const BSe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function o2(e){return Ak.filter(t=>MY(e,t))}function TY(e){const t=o2(e);return t[t.length-1]}function MY(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function LSe(e,t,{end:n}={end:!1}){const i=uk(t),r=wk(e)?"utc":"";function a(l){return l==="quarter"?`(${r}quarter(${i})-1)`:`${r}${l}(${i})`}let s;const o={};for(const l of Ak)MY(e,l)&&(o[l]=a(l),s=l);return n&&(o[s]+="+1"),FSe(o)}function kY(e){if(!e)return;const t=o2(e);return`timeUnitSpecifier(${Et(t)}, ${Et(BSe)})`}function jSe(e,t,n){if(!e)return;const i=kY(e);return`${n||wk(e)?"utc":"time"}Format(${t}, ${i})`}function jn(e){if(!e)return;let t;return He(e)?DY(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:dt(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),wk(t.unit)&&(t.utc=!0,t.unit=zSe(t.unit)),t}function USe(e){const{utc:t,...n}=jn(e);return n.unit?(t?"utc":"")+fe(n).map(i=>qt(`${i==="unit"?"":`_${i}_`}${n[i]}`)).join(""):`${t?"utc":""}timeunit${fe(n).map(i=>qt(`_${i}_${n[i]}`)).join("")}`}function NY(e,t=n=>n){const n=jn(e),i=TY(n.unit);if(i&&i!=="day"){const r={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:a,part:s}=FY(i,n.step),o={...r,[s]:+r[s]+a};return`${t(xc(o))} - ${t(xc(r))}`}}const PSe={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function ISe(e){return ze(PSe,e)}function FY(e,t=1){if(ISe(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function qSe(e){return de(e,"param")}function _k(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function Ck(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function $k(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function Dk(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function Tk(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function Mk(e){if(e!=null&&e.field){if(Se(e.range)&&e.range.length===2)return!0;if(Ce(e.range))return!0}return!1}function kk(e){return!!(e!=null&&e.field)&&(Se(e.oneOf)||Se(e.in))}function HSe(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function OY(e){return kk(e)||_k(e)||Mk(e)||Ck(e)||Dk(e)||$k(e)||Tk(e)}function Wa(e,t){return y2(e,{timeUnit:t,wrapTime:!0})}function GSe(e,t){return e.map(n=>Wa(n,t))}function RY(e,t=!0){const{field:n}=e,i=jn(e.timeUnit),{unit:r,binned:a}=i||{},s=ve(e,{expr:"datum"}),o=r?`time(${a?s:LSe(r,n)})`:s;if(_k(e))return`${o}===${Wa(e.equal,r)}`;if(Ck(e)){const l=e.lt;return`${o}<${Wa(l,r)}`}else if(Dk(e)){const l=e.gt;return`${o}>${Wa(l,r)}`}else if($k(e)){const l=e.lte;return`${o}<=${Wa(l,r)}`}else if(Tk(e)){const l=e.gte;return`${o}>=${Wa(l,r)}`}else{if(kk(e))return`indexof([${GSe(e.oneOf,r).join(",")}], ${o}) !== -1`;if(HSe(e))return u2(o,e.valid);if(Mk(e)){const{range:l}=Vn(e),f=Ce(l)?{signal:`${l.signal}[0]`}:l[0],d=Ce(l)?{signal:`${l.signal}[1]`}:l[1];if(f!==null&&d!==null&&t)return`inrange(${o}, [${Wa(f,r)}, ${Wa(d,r)}])`;const h=[];return f!==null&&h.push(`${o} >= ${Wa(f,r)}`),d!==null&&h.push(`${o} <= ${Wa(d,r)}`),h.length>0?h.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Et(e)}`)}function u2(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function YSe(e){return OY(e)&&e.timeUnit?{...e,timeUnit:jn(e.timeUnit)}:e}const Jp={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function VSe(e){return e==="quantitative"||e==="temporal"}function zY(e){return e==="ordinal"||e==="nominal"}const Ec=Jp.quantitative,Nk=Jp.ordinal,zd=Jp.temporal,Fk=Jp.nominal,hh=Jp.geojson;function XSe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Ec:return"quantitative";case"t":case zd:return"temporal";case"o":case Nk:return"ordinal";case"n":case Fk:return"nominal";case hh:return"geojson"}}const Xn={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},T3={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function WSe(e,t){const n=T3[e],i=T3[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const QSe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function U9(e){return QSe[e]}const BY=new Set(["linear","log","pow","sqrt","symlog"]),LY=new Set([...BY,"time","utc"]);function jY(e){return BY.has(e)}const UY=new Set(["quantile","quantize","threshold"]),ZSe=new Set([...LY,...UY,"sequential","identity"]),KSe=new Set(["ordinal","bin-ordinal","point","band"]);function Un(e){return KSe.has(e)}function $a(e){return ZSe.has(e)}function is(e){return LY.has(e)}function Bd(e){return UY.has(e)}const JSe={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function eAe(e){return!He(e)&&de(e,"name")}function PY(e){return de(e,"param")}function tAe(e){return de(e,"unionWith")}function nAe(e){return dt(e)&&"field"in e}const iAe={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:AMe,domain:wMe,range:_Me,rangeMax:CMe,rangeMin:$Me,scheme:DMe,...rAe}=iAe,aAe=fe(rAe);function M3(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return is(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return is(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return is(e);case"nice":return is(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return $a(e)&&!et(["log","time","utc","threshold","quantile"],e)}}function IY(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return od(e)?void 0:tSe(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function sAe(e,t){return et([Nk,Fk],t)?e===void 0||Un(e):t===zd?et([Xn.TIME,Xn.UTC,void 0],e):t===Ec?jY(e)||Bd(e)||e===void 0:!0}function oAe(e,t,n=!1){if(!Ms(e))return!1;switch(e){case Gt:case In:case Zu:case dh:case ra:case La:return is(t)||t==="band"?!0:t==="point"?!n:!1;case Ku:return et(["linear","band"],t);case Do:case tl:case To:case Ju:case el:case Lc:return is(t)||Bd(t)||et(["band","point","ordinal"],t);case nr:case $s:case Ds:return t!=="band";case nl:case ir:return t==="ordinal"||Bd(t)}}function uAe(e){return dt(e)&&"value"in e}const ji={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},qY=ji.arc,l2=ji.area,c2=ji.bar,lAe=ji.image,f2=ji.line,d2=ji.point,cAe=ji.rect,lb=ji.rule,HY=ji.text,Ok=ji.tick,fAe=ji.trail,Rk=ji.circle,zk=ji.square,GY=ji.geoshape;function rl(e){return["line","area","trail"].includes(e)}function ip(e){return["rect","bar","image","arc","tick"].includes(e)}const dAe=new Set(fe(ji));function ys(e){return de(e,"type")}const hAe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],gAe=["fill","fillOpacity"],pAe=[...hAe,...gAe],mAe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},P9=fe(mAe),h_=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],yAe={area:["line","point"],bar:h_,rect:h_,line:["point"],tick:["bandSize","thickness",...h_]},vAe={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},bAe={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},YY=fe(bAe);function Sc(e){return de(e,"band")}const xAe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},EAe=5,Bk={binSpacing:0,continuousBandSize:EAe,minBandSize:.25,timeUnitBandPosition:.5},SAe={...Bk,binSpacing:1},AAe={...Bk,thickness:1};function wAe(e){return ys(e)?e.type:e}function VY(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function Lk({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){var o,l;if(!i||!$a(i)||r)return"always-valid";const a=VY(kt("invalid",e,t),{isPath:rl(e.type)});return((l=(o=t.scale)==null?void 0:o.invalid)==null?void 0:l[n])!==void 0?"show":a}function _Ae(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function XY({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,a=`peek(${i})`,s=t.domainHasZero();return s==="definitely"?{scale:e,value:0}:s==="maybe"?{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${n==="zeroOrMin"?r:a})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?r:a})`}}function WY({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:a}){var d;const s=n==null?void 0:n.get("type"),o=Ta(t),l=r2(o==null?void 0:o.aggregate),f=Lk({scaleChannel:e,markDef:r,config:a,scaleType:s,isCountAggregate:l});if(o&&f==="show"){const h=((d=a.scale.invalid)==null?void 0:d[e])??"zero-or-min";return{test:u2(ve(o,{expr:"datum"}),!1),...CAe(h,n,i)}}}function CAe(e,t,n){if(uAe(e)){const{value:i}=e;return Ce(i)?{signal:i.signal}:{value:i}}return XY({scale:t,scaleName:n,mode:"zeroOrMin"})}function jk(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:a,config:s}=e,o=jc(t),l=Uk(e),f=WY({scaleChannel:o,channelDef:n,scale:r,scaleName:a,markDef:i,config:s});return f!==void 0?[f,l]:l}function $Ae(e){const{datum:t}=e;return Ic(t)?xc(t):`${Et(t)}`}function Jl(e,t,n,i){const r={};if(t&&(r.scale=t),ks(e)){const{datum:a}=e;Ic(a)?r.signal=xc(a):Ce(a)?r.signal=a.signal:Kp(a)?r.signal=a.expr:r.value=a}else r.field=ve(e,n);if(i){const{offset:a,band:s}=i;a&&(r.offset=a),s&&(r.band=s)}return r}function cb({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:a="end",bandPosition:s=.5}){const o=!Ce(s)&&0<s&&s<1?"datum":void 0,l=ve(t,{expr:o,suffix:r}),f=n!==void 0?ve(n,{expr:o}):ve(t,{suffix:a,expr:o}),d={};if(s===0||s===1){d.scale=e;const h=s===0?l:f;d.field=h}else{const h=Ce(s)?`(1-${s.signal}) * ${l} + ${s.signal} * ${f}`:`${1-s} * ${l} + ${s} * ${f}`;d.signal=`scale("${e}", ${h})`}return i&&(d.offset=i),d}function DAe({scaleName:e,fieldDef:t}){const n=ve(t,{expr:"datum"}),i=ve(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${i}) - scale("${e}", ${n}))`}function Uk({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:a,scale:s,stack:o,offset:l,defaultRef:f,bandPosition:d}){if(t){if(qe(t)){const h=s==null?void 0:s.get("type");if(zi(t)){d??(d=Iu({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:p,timeUnit:y,type:v}=t;if(Bt(p)||d&&y&&v===zd)return o!=null&&o.impute?Jl(t,a,{binSuffix:"mid"},{offset:l}):d&&!Un(h)?cb({scaleName:a,fieldOrDatumDef:t,bandPosition:d,offset:l}):Jl(t,a,rm(t,e)?{binSuffix:"range"}:{},{offset:l});if(Yn(p)){if(pe(n))return cb({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:d,offset:l});ge(AY(e===Gt?Ba:Cs))}}return Jl(t,a,Un(h)?{binSuffix:"range"}:{},{offset:l,band:h==="band"?d??t.bandPosition??.5:void 0})}else if(Da(t)){const h=t.value,p=l?{offset:l}:{};return{...$g(e,h),...p}}}return mxe(f)&&(f=f()),f&&{...f,...l?{offset:l}:{}}}function $g(e,t){return et(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:et(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Ut(t)}function Ac(e){return e&&e!=="number"&&e!=="time"}function QY(e,t,n){return`${e}(${t}${n?`, ${Et(n)}`:""})`}function Pk({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:a}){var f;if(Ac(n))return Ea({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:a});const s=ZY(e,i,r),o=Ld(e);if(t===void 0&&n===void 0&&a.customFormatTypes){if(o==="quantitative"){if(r&&a.normalizedNumberFormatType)return Ea({fieldOrDatumDef:e,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:i,config:a});if(a.numberFormatType)return Ea({fieldOrDatumDef:e,format:a.numberFormat,formatType:a.numberFormatType,expr:i,config:a})}if(o==="temporal"&&a.timeFormatType&&pe(e)&&e.timeUnit===void 0)return Ea({fieldOrDatumDef:e,format:a.timeFormat,formatType:a.timeFormatType,expr:i,config:a})}function l(d){return pe(d)?jn(d.timeUnit)||{}:{unit:void 0,utc:void 0}}if(Ud(e)){const{unit:d,utc:h}=l(e),p=MAe({field:s,timeUnit:d,format:t,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:h||Hc(e)&&((f=e.scale)==null?void 0:f.type)===Xn.UTC});return p?{signal:p}:void 0}if(t=k3({type:o,specifiedFormat:t,config:a,normalizeStack:r}),pe(e)&&Bt(e.bin)){const d=ve(e,{expr:i,binSuffix:"end"});return{signal:em(s,d,t,n,a)}}else return t||Ld(e)==="quantitative"?{signal:`${eV(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function ZY(e,t,n){return pe(e)?n?`${ve(e,{expr:t,suffix:"end"})}-${ve(e,{expr:t,suffix:"start"})}`:ve(e,{expr:t}):$Ae(e)}function Ea({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:a,field:s}){if(s??(s=ZY(e,i,r)),s!=="datum.value"&&pe(e)&&Bt(e.bin)){const o=ve(e,{expr:i,binSuffix:"end"});return{signal:em(s,o,t,n,a)}}return{signal:QY(n,s,t)}}function KY(e,t,n,i,r,a){var s;if(!(He(i)&&Ac(i))&&!(n===void 0&&i===void 0&&r.customFormatTypes&&Ld(e)==="quantitative"&&(r.normalizedNumberFormatType&&jd(e)&&e.stack==="normalize"||r.numberFormatType))){if(jd(e)&&e.stack==="normalize"&&r.normalizedNumberFormat)return k3({type:"quantitative",config:r,normalizeStack:!0});if(Ud(e)){const o=pe(e)?(s=jn(e.timeUnit))==null?void 0:s.unit:void 0;return o===void 0&&r.customFormatTypes&&r.timeFormatType?void 0:TAe({specifiedFormat:n,timeUnit:o,config:r,omitTimeFormatConfig:a})}return k3({type:t,specifiedFormat:n,config:r})}}function JY(e,t,n){var i;if(e&&(Ce(e)||e==="number"||e==="time"))return e;if(Ud(t)&&n!=="time"&&n!=="utc")return pe(t)&&((i=jn(t==null?void 0:t.timeUnit))!=null&&i.utc)?"utc":"time"}function k3({type:e,specifiedFormat:t,config:n,normalizeStack:i}){if(He(t))return t;if(e===Ec)return i?n.normalizedNumberFormat:n.numberFormat}function TAe({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:kY(t)}:i?void 0:n.timeFormat)}function eV(e,t){return`format(${e}, "${t||""}")`}function I9(e,t,n,i){return Ac(n)?QY(n,e,t):eV(e,(He(t)?t:void 0)??i.numberFormat)}function em(e,t,n,i,r){if(n===void 0&&i===void 0&&r.customFormatTypes&&r.numberFormatType)return em(e,t,r.numberFormat,r.numberFormatType,r);const a=I9(e,n,i,r),s=I9(t,n,i,r);return`${u2(e,!1)} ? "null" : ${a} + "${yEe}" + ${s}`}function MAe({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:a}){return!t||n?!t&&i?`${i}(${e}, ${Et(n)})`:(n=He(n)?n:r,`${a?"utc":"time"}Format(${e}, ${Et(n)})`):jSe(t,e,a)}const h2="min",kAe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function q9(e){return pn(kAe,e)}function NAe(e){return de(e,"encoding")}function po(e){return e&&(e.op==="count"||de(e,"field"))}function tV(e){return e&&Se(e)}function tm(e){return de(e,"row")||de(e,"column")}function Ik(e){return de(e,"header")}function g2(e){return de(e,"facet")}function FAe(e){return de(e,"param")}function OAe(e){return!He(e)&&de(e,"repeat")}function H9(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function qk(e){return de(e,"sort")}function Iu({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(qe(e)&&e.bandPosition!==void 0)return e.bandPosition;if(pe(e)){const{timeUnit:r,bin:a}=e;if(r&&!t)return ms("timeUnitBandPosition",n,i);if(Bt(a))return .5}}function nV({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:a,useVlSizeChannel:s}){var f,d,h;const o=rr(e),l=kt(s?"size":o,i,r,{vgChannel:o});if(l!==void 0)return l;if(pe(t)){const{timeUnit:p,bin:y}=t;if(p&&!n)return{band:ms("timeUnitBandSize",i,r)};if(Bt(y)&&!Un(a))return{band:1}}if(ip(i.type))return a?Un(a)?((f=r[i.type])==null?void 0:f.discreteBandSize)||{band:1}:(d=r[i.type])==null?void 0:d.continuousBandSize:(h=r[i.type])==null?void 0:h.discreteBandSize}function iV(e,t,n,i){return Bt(e.bin)||e.timeUnit&&zi(e)&&e.type==="temporal"?Iu({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function rV(e){return de(e,"sort")&&!de(e,"field")}function nm(e){return de(e,"condition")}function p2(e){const t=e==null?void 0:e.condition;return!!t&&!Se(t)&&pe(t)}function im(e){const t=e==null?void 0:e.condition;return!!t&&!Se(t)&&qe(t)}function RAe(e){const t=e==null?void 0:e.condition;return!!t&&(Se(t)||Da(t))}function pe(e){return de(e,"field")||(e==null?void 0:e.aggregate)==="count"}function Ld(e){return e==null?void 0:e.type}function ks(e){return de(e,"datum")}function Su(e){return zi(e)&&!db(e)||fb(e)}function G9(e){return zi(e)&&e.type==="quantitative"&&!e.bin||fb(e)}function fb(e){return ks(e)&&Ht(e.datum)}function qe(e){return pe(e)||ks(e)}function zi(e){return e&&(de(e,"field")||e.aggregate==="count")&&de(e,"type")}function Da(e){return de(e,"value")}function Hc(e){return de(e,"scale")||de(e,"sort")}function jd(e){return de(e,"axis")||de(e,"stack")||de(e,"impute")}function aV(e){return de(e,"legend")}function sV(e){return de(e,"format")||de(e,"formatType")}function zAe(e){return _r(e,["legend","axis","header","scale"])}function BAe(e){return de(e,"op")}function ve(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,a="";if(jAe(e))n=WG("count");else{let s;if(!t.nofn)if(BAe(e))s=e.op;else{const{bin:o,aggregate:l,timeUnit:f}=e;Bt(o)?(s=lY(o),r=(t.binSuffix??"")+(t.suffix??"")):l?il(l)?(a=`["${n}"]`,n=`argmax_${l.argmax}`):Eo(l)?(a=`["${n}"]`,n=`argmin_${l.argmin}`):s=String(l):f&&!qc(f)&&(s=USe(f),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?fh(n):t.expr?YG(n,t.expr)+a:ta(n)+a}function db(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return pe(e)&&!!e.bin;case"temporal":return!1}throw new Error(bY(e.type))}function LAe(e){var t;return Hc(e)&&Bd((t=e.scale)==null?void 0:t.type)}function jAe(e){return e.aggregate==="count"}function UAe(e,t){var s;const{field:n,bin:i,timeUnit:r,aggregate:a}=e;if(a==="count")return t.countTitle;if(Bt(i))return`${n} (binned)`;if(r&&!qc(r)){const o=(s=jn(r))==null?void 0:s.unit;if(o)return`${n} (${o2(o).join("-")})`}else if(a)return il(a)?`${n} for max ${a.argmax}`:Eo(a)?`${n} for min ${a.argmin}`:`${Xp(a)} of ${n}`;return n}function PAe(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(il(t))return`${r} for argmax(${t.argmax})`;if(Eo(t))return`${r} for argmin(${t.argmin})`;const a=i&&!qc(i)?jn(i):void 0,s=t||(a==null?void 0:a.unit)||(a==null?void 0:a.maxbins)&&"timeunit"||Bt(n)&&"bin";return s?`${s.toUpperCase()}(${r})`:r}const oV=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return PAe(e);default:return UAe(e,t)}};let uV=oV;function lV(e){uV=e}function IAe(){lV(oV)}function ud(e,t,{allowDisabling:n,includeDefault:i=!0}){var o;const r=(o=Hk(e))==null?void 0:o.title;if(!pe(e))return r??e.title;const a=e,s=i?Gk(a,t):void 0;return n?un(r,a.title,s):r??a.title??s}function Hk(e){if(jd(e)&&e.axis)return e.axis;if(aV(e)&&e.legend)return e.legend;if(Ik(e)&&e.header)return e.header}function Gk(e,t){return uV(e,t)}function hb(e){if(sV(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=Hk(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i}}}function qAe(e,t){var a;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(qk(e)&&Se(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!il(n)&&!Eo(n))return"quantitative";if(Hc(e)&&((a=e.scale)!=null&&a.type))switch(T3[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Ta(e){if(pe(e))return e;if(p2(e))return e.condition}function An(e){if(qe(e))return e;if(im(e))return e.condition}function cV(e,t,n,i={}){if(He(e)||Ht(e)||Hp(e)){const r=He(e)?"string":Ht(e)?"number":"boolean";return ge(qEe(t,r,e)),{value:e}}return qe(e)?gb(e,t,n,i):im(e)?{...e,condition:gb(e.condition,t,n,i)}:e}function gb(e,t,n,i){if(sV(e)){const{format:r,formatType:a,...s}=e;if(Ac(a)&&!n.customFormatTypes)return ge(B9(t)),gb(s,t,n,i)}else{const r=jd(e)?"axis":aV(e)?"legend":Ik(e)?"header":null;if(r&&e[r]){const{format:a,formatType:s,...o}=e[r];if(Ac(s)&&!n.customFormatTypes)return ge(B9(t)),gb({...e,[r]:o},t,n,i)}}return pe(e)?Yk(e,t,i):HAe(e)}function HAe(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Ht(n)?"quantitative":He(n)?"nominal":Ic(n)?"temporal":void 0,{...e,type:t}}function Yk(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:a,field:s}=e,o={...e};if(!n&&i&&!yk(i)&&!il(i)&&!Eo(i)&&(ge(GEe(i)),delete o.aggregate),r&&(o.timeUnit=jn(r)),s&&(o.field=`${s}`),Bt(a)&&(o.bin=m2(a,t)),Yn(a)&&!ln(t)&&ge(ASe(t)),zi(o)){const{type:l}=o,f=XSe(l);l!==f&&(o.type=f),l!=="quantitative"&&r2(i)&&(ge(HEe(l,i)),o.type="quantitative")}else if(!iY(t)){const l=qAe(o,t);o.type=l}if(zi(o)){const{compatible:l,warning:f}=GAe(o,t)||{};l===!1&&ge(f)}if(qk(o)&&He(o.sort)){const{sort:l}=o;if(q9(l))return{...o,sort:{encoding:l}};const f=l.substring(1);if(l.charAt(0)==="-"&&q9(f))return{...o,sort:{encoding:f,order:"descending"}}}if(Ik(o)){const{header:l}=o;if(l){const{orient:f,...d}=l;if(f)return{...o,header:{...d,labelOrient:l.labelOrient||f,titleOrient:l.titleOrient||f}}}}return o}function m2(e,t){return Hp(e)?{maxbins:D9(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:D9(t)}:e}const If={compatible:!0};function GAe(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ho:case go:case Kx:return db(e)?If:{compatible:!1,warning:WEe(t)};case Gt:case In:case Zu:case dh:case nr:case $s:case Ds:case Wp:case Qp:case Jx:case vc:case e2:case t2:case Lc:case ra:case La:case n2:return If;case Ua:case na:case ja:case Pa:return n!==Ec?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:If;case To:case Ju:case el:case tl:case Do:case $o:case Co:case Ba:case Cs:case Ku:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:If;case ir:case nl:return!db(e)&&!LAe(e)?{compatible:!1,warning:QEe(t)}:If;case Rd:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:If}}function Ud(e){const{formatType:t}=hb(e);return t==="time"||!t&&YAe(e)}function YAe(e){return e&&(e.type==="temporal"||pe(e)&&!!e.timeUnit)}function y2(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var l;const a=t&&((l=jn(t))==null?void 0:l.unit);let s=a||n==="temporal",o;return Kp(e)?o=e.expr:Ce(e)?o=e.signal:Ic(e)?(s=!0,o=xc(e)):(He(e)||Ht(e))&&s&&(o=`datetime(${Et(e)})`,RSe(a)&&(Ht(e)&&e<1e4||He(e)&&isNaN(Date.parse(e)))&&(o=xc({[a]:e}))),o?i&&s?`time(${o})`:o:r?void 0:Et(e)}function fV(e,t){const{type:n}=e;return t.map(i=>{const r=pe(e)&&!qc(e.timeUnit)?e.timeUnit:void 0,a=y2(i,{timeUnit:r,type:n,undefinedIfExprNotRequired:!0});return a!==void 0?{signal:a}:i})}function rm(e,t){return Bt(e.bin)?Ms(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const Y9={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function am(e){return e==null?void 0:e.condition}const dV=["domain","grid","labels","ticks","title"],VAe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},hV={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},XAe={...hV,style:1,labelExpr:1,encoding:1};function V9(e){return pn(XAe,e)}const WAe={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},gV=fe(WAe);function ko(e){return de(e,"mark")}class v2{constructor(t,n){ce(this,"name");ce(this,"run");this.name=t,this.run=n}hasMatchingType(t){return ko(t)?wAe(t.mark)===this.name:!1}}function ec(e,t){const n=e==null?void 0:e[t];return n?Se(n)?Fd(n,i=>!!i.field):pe(n)||p2(n):!1}function pV(e,t){const n=e==null?void 0:e[t];return n?Se(n)?Fd(n,i=>!!i.field):pe(n)||ks(n)||im(n):!1}function mV(e,t){if(ln(t)){const n=e[t];if((pe(n)||ks(n))&&(zY(n.type)||pe(n)&&n.timeUnit)){const i=dk(t);return pV(e,i)}}return!1}function yV(e){return Fd(H2e,t=>{if(ec(e,t)){const n=e[t];if(Se(n))return Fd(n,i=>!!i.aggregate);{const i=Ta(n);return i&&!!i.aggregate}}return!1})}function vV(e,t){const n=[],i=[],r=[],a=[],s={};return Vk(e,(o,l)=>{if(pe(o)){const{field:f,aggregate:d,bin:h,timeUnit:p,...y}=o;if(d||p||h){const v=Hk(o),b=v==null?void 0:v.title;let E=ve(o,{forAs:!0});const S={...b?[]:{title:ud(o,t,{allowDisabling:!0})},...y,field:E};if(d){let w;if(il(d)?(w="argmax",E=ve({op:"argmax",field:d.argmax},{forAs:!0}),S.field=`${E}.${f}`):Eo(d)?(w="argmin",E=ve({op:"argmin",field:d.argmin},{forAs:!0}),S.field=`${E}.${f}`):d!=="boxplot"&&d!=="errorbar"&&d!=="errorband"&&(w=d),w){const _={op:w,as:E};f&&(_.field=f),a.push(_)}}else if(n.push(E),zi(o)&&Bt(h)){if(i.push({bin:h,field:f,as:E}),n.push(ve(o,{binSuffix:"end"})),rm(o,l)&&n.push(ve(o,{binSuffix:"range"})),ln(l)){const w={field:`${E}_end`};s[`${l}2`]=w}S.bin="binned",iY(l)||(S.type=Ec)}else if(p&&!qc(p)){r.push({timeUnit:p,field:f,as:E});const w=zi(o)&&o.type!==zd&&"time";w&&(l===Wp||l===vc?S.formatType=w:tEe(l)?S.legend={formatType:w,...S.legend}:ln(l)&&(S.axis={formatType:w,...S.axis}))}s[l]=S}else n.push(f),s[l]=e[l]}else s[l]=e[l]}),{bins:i,timeUnits:r,aggregate:a,groupby:n,encoding:s}}function QAe(e,t,n){const i=iEe(t,n);if(i){if(i==="binned"){const r=e[t===Ba?Gt:In];return!!(pe(r)&&pe(e[t])&&Yn(r.bin))}}else return!1;return!0}function ZAe(e,t,n,i){const r={};for(const a of fe(e))nY(a)||ge(XEe(a));for(let a of Q2e){if(!e[a])continue;const s=e[a];if(Zp(a)){const o=W2e(a),l=r[o];if(pe(l)&&VSe(l.type)&&pe(s)&&!l.timeUnit){ge(IEe(o));continue}}if(a==="angle"&&t==="arc"&&!e.theta&&(ge(PEe),a=ra),!QAe(e,a,t)){ge(s2(a,t));continue}if(a===Do&&t==="line"){const o=Ta(e[a]);if(o!=null&&o.aggregate){ge(VEe);continue}}if(a===nr&&(n?"fill"in e:"stroke"in e)){ge(xY("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(a===Qp||a===Rd&&!Se(s)&&!Da(s)||a===vc&&Se(s)){if(s){if(a===Rd){const o=e[a];if(rV(o)){r[a]=o;continue}}r[a]=on(s).reduce((o,l)=>(pe(l)?o.push(Yk(l,a)):ge(D3(l,a)),o),[])}}else{if(a===vc&&s===null)r[a]=null;else if(!pe(s)&&!ks(s)&&!Da(s)&&!nm(s)&&!Ce(s)){ge(D3(s,a));continue}r[a]=cV(s,a,i)}}return r}function b2(e,t){const n={};for(const i of fe(e)){const r=cV(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function KAe(e){const t=[];for(const n of fe(e))if(ec(e,n)){const i=e[n],r=on(i);for(const a of r)pe(a)?t.push(a):p2(a)&&t.push(a.condition)}return t}function Vk(e,t,n){if(e)for(const i of fe(e)){const r=e[i];if(Se(r))for(const a of r)t.call(n,a,i);else t.call(n,r,i)}}function JAe(e,t,n,i){return e?fe(e).reduce((r,a)=>{const s=e[a];return Se(s)?s.reduce((o,l)=>t.call(i,o,l,a),r):t.call(i,r,s,a)},n):n}function bV(e,t){return fe(t).reduce((n,i)=>{switch(i){case Gt:case In:case e2:case n2:case t2:case Ba:case Cs:case Zu:case dh:case ra:case $o:case La:case Co:case Ku:case ja:case Ua:case Pa:case na:case Wp:case ir:case Lc:case vc:return n;case Rd:if(e==="line"||e==="trail")return n;case Qp:case Jx:{const r=t[i];if(Se(r)||pe(r))for(const a of on(r))a.aggregate||n.push(ve(a,{}));return n}case Do:if(e==="trail")return n;case nr:case $s:case Ds:case To:case Ju:case el:case nl:case tl:{const r=Ta(t[i]);return r&&!r.aggregate&&n.push(ve(r,{})),n}}},[])}function ewe(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(Se(t)){for(const a of t)a.aggregate?(i||(i=[]),i.push(a)):(r||(r=[]),r.push(a));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return Se(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function N3(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:s,titlePrefix:o})=>{const l=i?` of ${Xk(t)}`:"";return{field:s+t.field,type:t.type,title:Ce(o)?{signal:`${o}"${escape(l)}"`}:o+l}}),a=KAe(n).map(zAe);return{tooltip:[...r,...ns(a,rt)]}}function Xk(e){const{title:t,field:n}=e;return un(t,n)}function Wk(e,t,n,i,r){const{scale:a,axis:s}=n;return({partName:o,mark:l,positionPrefix:f,endPositionPrefix:d=void 0,extraEncoding:h={}})=>{const p=Xk(n);return xV(e,o,r,{mark:l,encoding:{[t]:{field:`${f}_${n.field}`,type:n.type,...p!==void 0?{title:p}:{},...a!==void 0?{scale:a}:{},...s!==void 0?{axis:s}:{}},...He(d)?{[`${t}2`]:{field:`${d}_${n.field}`}}:{},...i,...h}})}}function xV(e,t,n,i){const{clip:r,color:a,opacity:s}=e,o=e.type;return e[t]||e[t]===void 0&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...a?{color:a}:{},...s?{opacity:s}:{},...ys(i.mark)?i.mark:{type:i.mark},style:`${o}-${String(t)}`,...Hp(e[t])?{}:e[t]}}]:[]}function EV(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",a=i[r],s=i[`${r}2`],o=i[`${r}Error`],l=i[`${r}Error2`];return{continuousAxisChannelDef:ey(a,n),continuousAxisChannelDef2:ey(s,n),continuousAxisChannelDefError:ey(o,n),continuousAxisChannelDefError2:ey(l,n),continuousAxis:r}}function ey(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...i}=e;return n!==t&&ge(SSe(n,t)),i}else return e}function SV(e,t){const{mark:n,encoding:i}=e,{x:r,y:a}=i;if(ys(n)&&n.orient)return n.orient;if(Su(r)){if(Su(a)){const s=pe(r)&&r.aggregate,o=pe(a)&&a.aggregate;if(!s&&o===t)return"vertical";if(!o&&s===t)return"horizontal";if(s===t&&o===t)throw new Error("Both x and y cannot have aggregate");return Ud(a)&&!Ud(r)?"horizontal":"vertical"}return"horizontal"}else{if(Su(a))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const pb="boxplot",twe=["box","median","outliers","rule","ticks"],nwe=new v2(pb,wV);function AV(e){return Ht(e)?"tukey":e}function wV(e,{config:t}){e={...e,encoding:b2(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:a,...s}=e,o=ys(n)?n:{type:n};r&&ge(vY("boxplot"));const l=o.extent??t.boxplot.extent,f=kt("size",o,t),d=o.invalid,h=AV(l),{bins:p,timeUnits:y,transform:v,continuousAxisChannelDef:b,continuousAxis:E,groupby:S,aggregate:w,encodingWithoutContinuousAxis:_,ticksOrient:C,boxOrient:$,customTooltipWithoutAggregatedField:M}=iwe(e,l,t),T=fh(b.field),{color:F,size:R,...B}=_,L=dn=>Wk(o,E,b,dn,t.boxplot),Y=L(B),H=L(_),U=(dt(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",z=L({...B,...R?{size:R}:{},color:{condition:{test:`${wt(`lower_box_${b.field}`)} >= ${wt(`upper_box_${b.field}`)}`,...F||{value:U}}}}),O=N3([{fieldPrefix:h==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:h==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],b,_),I={type:"tick",color:"black",opacity:1,orient:C,invalid:d,aria:!1},W=h==="min-max"?O:N3([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],b,_),K=[...Y({partName:"rule",mark:{type:"rule",invalid:d,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:W}),...Y({partName:"rule",mark:{type:"rule",invalid:d,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:W}),...Y({partName:"ticks",mark:I,positionPrefix:"lower_whisker",extraEncoding:W}),...Y({partName:"ticks",mark:I,positionPrefix:"upper_whisker",extraEncoding:W})],k=[...h!=="tukey"?K:[],...H({partName:"box",mark:{type:"bar",...f?{size:f}:{},orient:$,invalid:d,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:O}),...z({partName:"median",mark:{type:"tick",invalid:d,...dt(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...f?{size:f}:{},orient:C,aria:!1},positionPrefix:"mid_box",extraEncoding:O})];if(h==="min-max")return{...s,transform:(s.transform??[]).concat(v),layer:k};const V=wt(`lower_box_${b.field}`),X=wt(`upper_box_${b.field}`),ne=`(${X} - ${V})`,ye=`${V} - ${l} * ${ne}`,le=`${X} + ${l} * ${ne}`,be=wt(b.field),Ye={joinaggregate:_V(b.field),groupby:S},it={transform:[{filter:`(${ye} <= ${be}) && (${be} <= ${le})`},{aggregate:[{op:"min",field:b.field,as:`lower_whisker_${T}`},{op:"max",field:b.field,as:`upper_whisker_${T}`},{op:"min",field:`lower_box_${b.field}`,as:`lower_box_${T}`},{op:"max",field:`upper_box_${b.field}`,as:`upper_box_${T}`},...w],groupby:S}],layer:K},{tooltip:xe,...Ie}=B,{scale:Ge,axis:he}=b,nn=Xk(b),lt=xV(o,"outliers",t.boxplot,{transform:[{filter:`(${be} < ${ye}) || (${be} > ${le})`}],mark:"point",encoding:{[E]:{field:b.field,type:b.type,...nn!==void 0?{title:nn}:{},...Ge!==void 0?{scale:Ge}:{},...he!==void 0?{axis:he}:{}},...Ie,...F?{color:F}:{},...M?{tooltip:M}:{}}})[0];let fn;const $n=[...p,...y,Ye];return lt?fn={transform:$n,layer:[lt,it]}:(fn=it,fn.transform.unshift(...$n)),{...s,layer:[fn,{transform:v,layer:k}]}}function _V(e){const t=fh(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function iwe(e,t,n){const i=SV(e,pb),{continuousAxisChannelDef:r,continuousAxis:a}=EV(e,i,pb),s=r.field,o=fh(s),l=AV(t),f=[..._V(s),{op:"median",field:s,as:`mid_box_${o}`},{op:"min",field:s,as:(l==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:s,as:(l==="min-max"?"upper_whisker_":"max_")+o}],d=l==="min-max"||l==="tukey"?[]:[{calculate:`${wt(`upper_box_${o}`)} - ${wt(`lower_box_${o}`)}`,as:`iqr_${o}`},{calculate:`min(${wt(`upper_box_${o}`)} + ${wt(`iqr_${o}`)} * ${t}, ${wt(`max_${o}`)})`,as:`upper_whisker_${o}`},{calculate:`max(${wt(`lower_box_${o}`)} - ${wt(`iqr_${o}`)} * ${t}, ${wt(`min_${o}`)})`,as:`lower_whisker_${o}`}],{[a]:h,...p}=e.encoding,{customTooltipWithoutAggregatedField:y,filteredEncoding:v}=ewe(p),{bins:b,timeUnits:E,aggregate:S,groupby:w,encoding:_}=vV(v,n),C=i==="vertical"?"horizontal":"vertical",$=i,M=[...b,...E,{aggregate:[...S,...f],groupby:w},...d];return{bins:b,timeUnits:E,transform:M,groupby:w,aggregate:S,continuousAxisChannelDef:r,continuousAxis:a,encodingWithoutContinuousAxis:_,ticksOrient:C,boxOrient:$,customTooltipWithoutAggregatedField:y}}const Qk="errorbar",rwe=["ticks","rule"],awe=new v2(Qk,CV);function CV(e,{config:t}){e={...e,encoding:b2(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:o,outerSpec:l,tooltipEncoding:f}=$V(e,Qk,t);delete a.size;const d=Wk(o,r,i,a,t.errorbar),h=o.thickness,p=o.size,y={type:"tick",orient:s,aria:!1,...h!==void 0?{thickness:h}:{},...p!==void 0?{size:p}:{}},v=[...d({partName:"ticks",mark:y,positionPrefix:"lower",extraEncoding:f}),...d({partName:"ticks",mark:y,positionPrefix:"upper",extraEncoding:f}),...d({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...h!==void 0?{size:h}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f})];return{...l,transform:n,...v.length>1?{layer:v}:{...v[0]}}}function swe(e,t){const{encoding:n}=e;if(owe(n))return{orient:SV(e,t),inputType:"raw"};const i=uwe(n),r=lwe(n),a=n.x,s=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const o=n.x2,l=n.y2;if(qe(o)&&qe(l))throw new Error(`${t} cannot have both x2 and y2`);if(qe(o)){if(Su(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(qe(l)){if(Su(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const o=n.xError,l=n.xError2,f=n.yError,d=n.yError2;if(qe(l)&&!qe(o))throw new Error(`${t} cannot have xError2 without xError`);if(qe(d)&&!qe(f))throw new Error(`${t} cannot have yError2 without yError`);if(qe(o)&&qe(f))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(qe(o)){if(Su(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(qe(f)){if(Su(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function owe(e){return(qe(e.x)||qe(e.y))&&!qe(e.x2)&&!qe(e.y2)&&!qe(e.xError)&&!qe(e.xError2)&&!qe(e.yError)&&!qe(e.yError2)}function uwe(e){return qe(e.x2)||qe(e.y2)}function lwe(e){return qe(e.xError)||qe(e.xError2)||qe(e.yError)||qe(e.yError2)}function $V(e,t,n){const{mark:i,encoding:r,params:a,projection:s,...o}=e,l=ys(i)?i:{type:i};a&&ge(vY(t));const{orient:f,inputType:d}=swe(e,t),{continuousAxisChannelDef:h,continuousAxisChannelDef2:p,continuousAxisChannelDefError:y,continuousAxisChannelDefError2:v,continuousAxis:b}=EV(e,f,t),{errorBarSpecificAggregate:E,postAggregateCalculates:S,tooltipSummary:w,tooltipTitleWithFieldName:_}=cwe(l,h,p,y,v,d,t,n),{[b]:C,[b==="x"?"x2":"y2"]:$,[b==="x"?"xError":"yError"]:M,[b==="x"?"xError2":"yError2"]:T,...F}=r,{bins:R,timeUnits:B,aggregate:L,groupby:Y,encoding:H}=vV(F,n),U=[...L,...E],z=d!=="raw"?[]:Y,O=N3(w,h,H,_);return{transform:[...o.transform??[],...R,...B,...U.length===0?[]:[{aggregate:U,groupby:z}],...S],groupby:z,continuousAxisChannelDef:h,continuousAxis:b,encodingWithoutContinuousAxis:H,ticksOrient:f==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:o,tooltipEncoding:O}}function cwe(e,t,n,i,r,a,s,o){let l=[],f=[];const d=t.field;let h,p=!1;if(a==="raw"){const y=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":o.errorbar.center,v=e.extent?e.extent:y==="mean"?"stderr":"iqr";if(y==="median"!=(v==="iqr")&&ge(ESe(y,v,s)),v==="stderr"||v==="stdev")l=[{op:v,field:d,as:`extent_${d}`},{op:y,field:d,as:`center_${d}`}],f=[{calculate:`${wt(`center_${d}`)} + ${wt(`extent_${d}`)}`,as:`upper_${d}`},{calculate:`${wt(`center_${d}`)} - ${wt(`extent_${d}`)}`,as:`lower_${d}`}],h=[{fieldPrefix:"center_",titlePrefix:Xp(y)},{fieldPrefix:"upper_",titlePrefix:X9(y,v,"+")},{fieldPrefix:"lower_",titlePrefix:X9(y,v,"-")}],p=!0;else{let b,E,S;v==="ci"?(b="mean",E="ci0",S="ci1"):(b="median",E="q1",S="q3"),l=[{op:E,field:d,as:`lower_${d}`},{op:S,field:d,as:`upper_${d}`},{op:b,field:d,as:`center_${d}`}],h=[{fieldPrefix:"upper_",titlePrefix:ud({field:d,aggregate:S,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:ud({field:d,aggregate:E,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:ud({field:d,aggregate:b,type:"quantitative"},o,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&ge(xSe(e.center,e.extent)),a==="aggregated-upper-lower"?(h=[],f=[{calculate:wt(n.field),as:`upper_${d}`},{calculate:wt(d),as:`lower_${d}`}]):a==="aggregated-error"&&(h=[{fieldPrefix:"",titlePrefix:d}],f=[{calculate:`${wt(d)} + ${wt(i.field)}`,as:`upper_${d}`}],r?f.push({calculate:`${wt(d)} + ${wt(r.field)}`,as:`lower_${d}`}):f.push({calculate:`${wt(d)} - ${wt(i.field)}`,as:`lower_${d}`}));for(const y of f)h.push({fieldPrefix:y.as.substring(0,6),titlePrefix:yc(yc(y.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:f,errorBarSpecificAggregate:l,tooltipSummary:h,tooltipTitleWithFieldName:p}}function X9(e,t,n){return`${Xp(e)} ${n} ${t}`}const Zk="errorband",fwe=["band","borders"],dwe=new v2(Zk,DV);function DV(e,{config:t}){e={...e,encoding:b2(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:o,tooltipEncoding:l}=$V(e,Zk,t),f=s,d=Wk(f,r,i,a,t.errorband),h=e.encoding.x!==void 0&&e.encoding.y!==void 0;let p={type:h?"area":"rect"},y={type:h?"line":"rule"};const v={...f.interpolate?{interpolate:f.interpolate}:{},...f.tension&&f.interpolate?{tension:f.tension}:{}};return h?(p={...p,...v,ariaRoleDescription:"errorband"},y={...y,...v,aria:!1}):f.interpolate?ge(j9("interpolate")):f.tension&&ge(j9("tension")),{...o,transform:n,layer:[...d({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...d({partName:"borders",mark:y,positionPrefix:"lower",extraEncoding:l}),...d({partName:"borders",mark:y,positionPrefix:"upper",extraEncoding:l})]}}const TV={};function Kk(e,t,n){const i=new v2(e,t);TV[e]={normalizer:i,parts:n}}function hwe(){return fe(TV)}Kk(pb,wV,twe);Kk(Qk,CV,rwe);Kk(Zk,DV,fwe);const gwe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],MV={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},kV={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},pwe=fe(MV),mwe=fe(kV),ywe={header:1,headerRow:1,headerColumn:1,headerFacet:1},NV=fe(ywe),FV=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],vwe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},bwe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ma="_vgsid_",xwe={point:{on:"click",fields:[Ma],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function Jk(e){return e==="legend"||!!(e!=null&&e.legend)}function g_(e){return Jk(e)&&dt(e)}function e6(e){return!!(e!=null&&e.select)}function OV(e){const t=[];for(const n of e||[]){if(e6(n))continue;const{expr:i,bind:r,...a}=n;if(r&&i){const s={...a,bind:r,init:i};t.push(s)}else{const s={...a,...i?{update:i}:{},...r?{bind:r}:{}};t.push(s)}}return t}function Ewe(e){return x2(e)||n6(e)||t6(e)}function t6(e){return de(e,"concat")}function x2(e){return de(e,"vconcat")}function n6(e){return de(e,"hconcat")}function RV({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function vs(e){return de(e,"step")}function W9(e){return de(e,"view")||de(e,"width")||de(e,"height")}const Q9=20,Swe={align:1,bounds:1,center:1,columns:1,spacing:1},Awe=fe(Swe);function wwe(e,t,n){const i=n[t],r={},{spacing:a,columns:s}=i;a!==void 0&&(r.spacing=a),s!==void 0&&(g2(e)&&!tm(e.facet)||t6(e))&&(r.columns=s),x2(e)&&(r.columns=1);for(const o of Awe)if(e[o]!==void 0)if(o==="spacing"){const l=e[o];r[o]=Ht(l)?l:{row:l.row??a,column:l.column??a}}else r[o]=e[o];return r}function F3(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function O3(e,t){const n=mb(e,t);return vs(n)?n.step:zV}function mb(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return un(n,{step:e.step})}const zV=20,_we={continuousWidth:300,continuousHeight:300,step:zV},Cwe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:_we,mark:vAe,arc:{},area:{},bar:SAe,circle:{},geoshape:{},image:{},line:{},point:{},rect:Bk,rule:{color:"black"},square:{},text:{color:"black"},tick:AAe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:JSe,projection:{},legend:vwe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:xwe,style:{},title:{},facet:{spacing:Q9},concat:{spacing:Q9},normalizedNumberFormat:".0%"},Qs=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Z9={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},K9={blue:Qs[0],orange:Qs[1],red:Qs[2],teal:Qs[3],green:Qs[4],yellow:Qs[5],purple:Qs[6],pink:Qs[7],brown:Qs[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function $we(e={}){return{signals:[{name:"color",value:dt(e)?{...K9,...e}:K9}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Dwe(e){return{signals:[{name:"fontSize",value:dt(e)?{...Z9,...e}:Z9}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Twe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function BV(e){const t=fe(e||{}),n={};for(const i of t){const r=e[i];n[i]=am(r)?fY(r):br(r)}return n}function Mwe(e){const t=fe(e),n={};for(const i of t)n[i]=BV(e[i]);return n}const kwe=[...YY,...gV,...NV,"background","padding","legend","lineBreak","scale","style","title","view"];function LV(e={}){const{color:t,font:n,fontSize:i,selection:r,...a}=e,s=MG({},Ue(Cwe),n?Twe(n):{},t?$we(t):{},i?Dwe(i):{},a||{});r&&Yx(s,"selection",r,!0);const o=_r(s,kwe);for(const l of["background","lineBreak","padding"])s[l]&&(o[l]=br(s[l]));for(const l of YY)s[l]&&(o[l]=Vn(s[l]));for(const l of gV)s[l]&&(o[l]=BV(s[l]));for(const l of NV)s[l]&&(o[l]=Vn(s[l]));if(s.legend&&(o.legend=Vn(s.legend)),s.scale){const{invalid:l,...f}=s.scale,d=Vn(l,{level:1});o.scale={...Vn(f),...fe(d).length>0?{invalid:d}:{}}}return s.style&&(o.style=Mwe(s.style)),s.title&&(o.title=Vn(s.title)),s.view&&(o.view=Vn(s.view)),o}const Nwe=new Set(["view",...dAe]),Fwe=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Owe={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...yAe};function Rwe(e){e=Ue(e);for(const t of Fwe)delete e[t];if(e.axis)for(const t in e.axis)am(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of gwe)delete e.legend[t];if(e.mark){for(const t of P9)delete e.mark[t];e.mark.tooltip&&dt(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(OV(e.params)),delete e.params);for(const t of Nwe){for(const i of P9)delete e[t][i];const n=Owe[t];if(n)for(const i of n)delete e[t][i];Bwe(e,t)}for(const t of hwe())delete e[t];zwe(e);for(const t in e)dt(e[t])&&Rt(e[t])&&delete e[t];return Rt(e)?void 0:e}function zwe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=cY(e.title);Rt(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Rt(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Rt(i)?delete e.title:e.title=i}function Bwe(e,t,n,i){const r=e[t];t==="view"&&(n="cell");const a={...r,...e.style[n??t]};Rt(a)||(e.style[n??t]=a),delete e[t]}function E2(e){return de(e,"layer")}function Lwe(e){return de(e,"repeat")}function jwe(e){return!Se(e.repeat)&&de(e.repeat,"layer")}class i6{map(t,n){return g2(t)?this.mapFacet(t,n):Lwe(t)?this.mapRepeat(t,n):n6(t)?this.mapHConcat(t,n):x2(t)?this.mapVConcat(t,n):t6(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(E2(t))return this.mapLayer(t,n);if(ko(t))return this.mapUnit(t,n);throw new Error(vk(t))}mapLayer(t,n){return{...t,layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(i=>this.map(i,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(i=>this.map(i,n))}}mapConcat(t,n){const{concat:i,...r}=t;return{...r,concat:i.map(a=>this.map(a,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const Uwe={zero:1,center:1,normalize:1};function Pwe(e){return pn(Uwe,e)}const Iwe=new Set([qY,c2,l2,lb,d2,Rk,zk,f2,HY,Ok]),qwe=new Set([c2,l2,qY]);function qf(e){return pe(e)&&Ld(e)==="quantitative"&&!e.bin}function J9(e,t,{orient:n,type:i}){const r=t==="x"?"y":"radius",a=t==="x"&&["bar","area"].includes(i),s=e[t],o=e[r];if(pe(s)&&pe(o))if(qf(s)&&qf(o)){if(s.stack)return t;if(o.stack)return r;const l=pe(s)&&!!s.aggregate,f=pe(o)&&!!o.aggregate;if(l!==f)return l?t:r;if(a){if(n==="vertical")return r;if(n==="horizontal")return t}}else{if(qf(s))return t;if(qf(o))return r}else{if(qf(s))return a&&n==="vertical"?void 0:t;if(qf(o))return a&&n==="horizontal"?void 0:r}}function Hwe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function jV(e,t){var b,E;const n=ys(e)?e:{type:e},i=n.type;if(!Iwe.has(i))return null;const r=J9(t,"x",n)||J9(t,"theta",n);if(!r)return null;const a=t[r],s=pe(a)?ve(a,{}):void 0,o=Hwe(r),l=[],f=new Set;if(t[o]){const S=t[o],w=pe(S)?ve(S,{}):void 0;w&&w!==s&&(l.push(o),f.add(w))}const d=o==="x"?"xOffset":"yOffset",h=t[d],p=pe(h)?ve(h,{}):void 0;p&&p!==s&&(l.push(d),f.add(p));const y=Z2e.reduce((S,w)=>{if(w!=="tooltip"&&ec(t,w)){const _=t[w];for(const C of on(_)){const $=Ta(C);if($.aggregate)continue;const M=ve($,{});(!M||!f.has(M))&&S.push({channel:w,fieldDef:$})}}return S},[]);let v;return a.stack!==void 0?Hp(a.stack)?v=a.stack?"zero":null:v=a.stack:qwe.has(i)&&(v="zero"),!v||!Pwe(v)||yV(t)&&y.length===0?null:((b=a==null?void 0:a.scale)!=null&&b.type&&((E=a==null?void 0:a.scale)==null?void 0:E.type)!==Xn.LINEAR&&a!=null&&a.stack&&ge(ySe(a.scale.type)),qe(t[Ts(r)])?(a.stack!==void 0&&ge(mSe(r)),null):(pe(a)&&a.aggregate&&!cEe.has(a.aggregate)&&ge(vSe(a.aggregate)),{groupbyChannels:l,groupbyFields:f,fieldChannel:r,impute:a.impute===null?!1:rl(i),stackBy:y,offset:v}))}function UV(e,t,n){const i=Vn(e),r=kt("orient",i,n);if(i.orient=Xwe(i.type,t,r),r!==void 0&&r!==i.orient&&ge(eSe(i.orient,r)),i.type==="bar"&&i.orient){const l=kt("cornerRadiusEnd",i,n);if(l!==void 0){const f=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:xAe[i.orient];for(const d of f)i[d]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}const a=kt("opacity",i,n),s=kt("fillOpacity",i,n);return a===void 0&&s===void 0&&(i.opacity=Ywe(i.type,t)),kt("cursor",i,n)===void 0&&(i.cursor=Gwe(i,t,n)),i}function Gwe(e,t,n){return t.href||e.href||kt("href",e,n)?"pointer":e.cursor}function Ywe(e,t){if(et([d2,Ok,Rk,zk],e)&&!yV(t))return .7}function Vwe(e,t,{graticule:n}){if(n)return!1;const i=ms("filled",e,t),r=e.type;return un(i,r!==d2&&r!==f2&&r!==lb)}function Xwe(e,t,n){switch(e){case d2:case Rk:case zk:case HY:case cAe:case lAe:return}const{x:i,y:r,x2:a,y2:s}=t;switch(e){case c2:if(pe(i)&&(Yn(i.bin)||pe(r)&&r.aggregate&&!i.aggregate))return"vertical";if(pe(r)&&(Yn(r.bin)||pe(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(s||a){if(n)return n;if(!a)return(pe(i)&&i.type===Ec&&!Bt(i.bin)||fb(i))&&pe(r)&&Yn(r.bin)?"horizontal":"vertical";if(!s)return(pe(r)&&r.type===Ec&&!Bt(r.bin)||fb(r))&&pe(i)&&Yn(i.bin)?"vertical":"horizontal"}case lb:if(a&&!(pe(i)&&Yn(i.bin))&&s&&!(pe(r)&&Yn(r.bin)))return;case l2:if(s)return pe(r)&&Yn(r.bin)?"horizontal":"vertical";if(a)return pe(i)&&Yn(i.bin)?"vertical":"horizontal";if(e===lb){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case f2:case Ok:{const o=G9(i),l=G9(r);if(n)return n;if(o&&!l)return e!=="tick"?"horizontal":"vertical";if(!o&&l)return e!=="tick"?"vertical":"horizontal";if(o&&l)return"vertical";{const f=zi(i)&&i.type===zd,d=zi(r)&&r.type===zd;if(f&&!d)return"vertical";if(!f&&d)return"horizontal"}return}}return"vertical"}function Wwe(e){const{point:t,line:n,...i}=e;return fe(i).length>1?i:i.type}function Qwe(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:_r(e[t],["point","line"])});return e}function p_(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?dt(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?dt(t.point)?t.point:{}:void 0}function ez(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Zwe{constructor(){ce(this,"name","path-overlay")}hasMatchingType(t,n){if(ko(t)){const{mark:i,encoding:r}=t,a=ys(i)?i:{type:i};switch(a.type){case"line":case"rule":case"trail":return!!p_(a,n[a.type],r);case"area":return!!p_(a,n[a.type],r)||!!ez(a,n[a.type])}}return!1}run(t,n,i){const{config:r}=n,{params:a,projection:s,mark:o,name:l,encoding:f,...d}=t,h=b2(f,r),p=ys(o)?o:{type:o},y=p_(p,r[p.type],h),v=p.type==="area"&&ez(p,r[p.type]),b=[{name:l,...a?{params:a}:{},mark:Wwe({...p.type==="area"&&p.opacity===void 0&&p.fillOpacity===void 0?{opacity:.7}:{},...p}),encoding:_r(h,["shape"])}],E=jV(UV(p,h,r),h);let S=h;if(E){const{fieldChannel:w,offset:_}=E;S={...h,[w]:{...h[w],..._?{stack:_}:{}}}}return S=_r(S,["y2","x2"]),v&&b.push({...s?{projection:s}:{},mark:{type:"line",...Nd(p,["clip","interpolate","tension","tooltip"]),...v},encoding:S}),y&&b.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...Nd(p,["clip","tooltip"]),...y},encoding:S}),i({...d,layer:b},{...n,config:Qwe(r)})}}function Kwe(e,t){return t?tm(e)?IV(e,t):PV(e,t):e}function m_(e,t){return t?IV(e,t):e}function R3(e,t,n){const i=t[e];if(OAe(i)){if(i.repeat in n)return{...t,[e]:n[i.repeat]};ge(kEe(i.repeat));return}return t}function PV(e,t){if(e=R3("field",e,t),e!==void 0){if(e===null)return null;if(qk(e)&&po(e.sort)){const n=R3("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function tz(e,t){if(pe(e))return PV(e,t);{const n=R3("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function nz(e,t){if(qe(e)){const n=tz(e,t);if(n)return n;if(nm(e))return{condition:e.condition}}else{if(im(e)){const n=tz(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}}function IV(e,t){const n={};for(const i in e)if(de(e,i)){const r=e[i];if(Se(r))n[i]=r.map(a=>nz(a,t)).filter(a=>a);else{const a=nz(r,t);a!==void 0&&(n[i]=a)}}return n}class Jwe{constructor(){ce(this,"name","RuleForRangedLine")}hasMatchingType(t){if(ko(t)){const{encoding:n,mark:i}=t;if(i==="line"||ys(i)&&i.type==="line")for(const r of X2e){const a=jc(r),s=n[a];if(n[r]&&(pe(s)&&!Yn(s.bin)||ks(s)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:a}=t;return ge(JEe(!!r.x2,!!r.y2)),i({...t,mark:dt(a)?{...a,type:"rule"}:"rule"},n)}}class e_e extends i6{constructor(){super(...arguments);ce(this,"nonFacetUnitNormalizers",[nwe,awe,dwe,new Zwe,new Jwe])}map(n,i){if(ko(n)){const r=ec(n.encoding,ho),a=ec(n.encoding,go),s=ec(n.encoding,Kx);if(r||a||s)return this.mapFacetedUnit(n,i)}return super.map(n,i)}mapUnit(n,i){const{parentEncoding:r,parentProjection:a}=i,s=m_(n.encoding,i.repeater),o={...n,...n.name?{name:[i.repeaterPrefix,n.name].filter(f=>f).join("_")}:{},...s?{encoding:s}:{}};if(r||a)return this.mapUnitWithParentEncodingOrProjection(o,i);const l=this.mapLayerOrUnit.bind(this);for(const f of this.nonFacetUnitNormalizers)if(f.hasMatchingType(o,i.config))return f.run(o,i,l);return o}mapRepeat(n,i){return jwe(n)?this.mapLayerRepeat(n,i):this.mapNonLayerRepeat(n,i)}mapLayerRepeat(n,i){const{repeat:r,spec:a,...s}=n,{row:o,column:l,layer:f}=r,{repeater:d={},repeaterPrefix:h=""}=i;return o||l?this.mapRepeat({...n,repeat:{...o?{row:o}:{},...l?{column:l}:{}},spec:{repeat:{layer:f},spec:a}},i):{...s,layer:f.map(p=>{const y={...d,layer:p},v=`${(a.name?`${a.name}_`:"")+h}child__layer_${qt(p)}`,b=this.mapLayerOrUnit(a,{...i,repeater:y,repeaterPrefix:v});return b.name=v,b})}}mapNonLayerRepeat(n,i){const{repeat:r,spec:a,data:s,...o}=n;!Se(r)&&n.columns&&(n=_r(n,["columns"]),ge(R9("repeat")));const l=[],{repeater:f={},repeaterPrefix:d=""}=i,h=!Se(r)&&r.row||[f?f.row:null],p=!Se(r)&&r.column||[f?f.column:null],y=Se(r)&&r||[f?f.repeat:null];for(const b of y)for(const E of h)for(const S of p){const w={repeat:b,row:E,column:S,layer:f.layer},_=`${(a.name?`${a.name}_`:"")+d}child__${Se(r)?`${qt(b)}`:(r.row?`row_${qt(E)}`:"")+(r.column?`column_${qt(S)}`:"")}`,C=this.map(a,{...i,repeater:w,repeaterPrefix:_});C.name=_,l.push(_r(C,["data"]))}const v=Se(r)?n.columns:r.column?r.column.length:1;return{data:a.data??s,align:"all",...o,columns:v,concat:l}}mapFacet(n,i){const{facet:r}=n;return tm(r)&&n.columns&&(n=_r(n,["columns"]),ge(R9("facet"))),super.mapFacet(n,i)}mapUnitWithParentEncodingOrProjection(n,i){const{encoding:r,projection:a}=n,{parentEncoding:s,parentProjection:o,config:l}=i,f=rz({parentProjection:o,projection:a}),d=iz({parentEncoding:s,encoding:m_(r,i.repeater)});return this.mapUnit({...n,...f?{projection:f}:{},...d?{encoding:d}:{}},{config:l})}mapFacetedUnit(n,i){const{row:r,column:a,facet:s,...o}=n.encoding,{mark:l,width:f,projection:d,height:h,view:p,params:y,encoding:v,...b}=n,{facetMapping:E,layout:S}=this.getFacetMappingAndLayout({row:r,column:a,facet:s},i),w=m_(o,i.repeater);return this.mapFacet({...b,...S,facet:E,spec:{...f?{width:f}:{},...h?{height:h}:{},...p?{view:p}:{},...d?{projection:d}:{},mark:l,encoding:w,...y?{params:y}:{}}},i)}getFacetMappingAndLayout(n,i){const{row:r,column:a,facet:s}=n;if(r||a){s&&ge(ZEe([...r?[ho]:[],...a?[go]:[]]));const o={},l={};for(const f of[ho,go]){const d=n[f];if(d){const{align:h,center:p,spacing:y,columns:v,...b}=d;o[f]=b;for(const E of["align","center","spacing"])d[E]!==void 0&&(l[E]??(l[E]={}),l[E][f]=d[E])}}return{facetMapping:o,layout:l}}else{const{align:o,center:l,spacing:f,columns:d,...h}=s;return{facetMapping:Kwe(h,i.repeater),layout:{...o?{align:o}:{},...l?{center:l}:{},...f?{spacing:f}:{},...d?{columns:d}:{}}}}}mapLayer(n,{parentEncoding:i,parentProjection:r,...a}){const{encoding:s,projection:o,...l}=n,f={...a,parentEncoding:iz({parentEncoding:i,encoding:s,layer:!0}),parentProjection:rz({parentProjection:r,projection:o})};return super.mapLayer({...l,...n.name?{name:[f.repeaterPrefix,n.name].filter(d=>d).join("_")}:{}},f)}}function iz({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...fe(e),...fe(t)]);for(const a of r){const s=t[a],o=e[a];if(qe(s)){const l={...o,...s};i[a]=l}else im(s)?i[a]={...s,condition:{...o,...s.condition}}:s||s===null?i[a]=s:(n||Da(o)||Ce(o)||qe(o)||Se(o))&&(i[a]=o)}}else i=t;return!i||Rt(i)?void 0:i}function rz(e){const{parentProjection:t,projection:n}=e;return t&&n&&ge(UEe({parentProjection:t,projection:n})),n??t}function r6(e){return de(e,"filter")}function t_e(e){return de(e,"stop")}function qV(e){return de(e,"lookup")}function n_e(e){return de(e,"data")}function i_e(e){return de(e,"param")}function r_e(e){return de(e,"pivot")}function a_e(e){return de(e,"density")}function s_e(e){return de(e,"quantile")}function o_e(e){return de(e,"regression")}function u_e(e){return de(e,"loess")}function l_e(e){return de(e,"sample")}function c_e(e){return de(e,"window")}function f_e(e){return de(e,"joinaggregate")}function d_e(e){return de(e,"flatten")}function h_e(e){return de(e,"calculate")}function HV(e){return de(e,"bin")}function g_e(e){return de(e,"impute")}function p_e(e){return de(e,"timeUnit")}function m_e(e){return de(e,"aggregate")}function y_e(e){return de(e,"stack")}function v_e(e){return de(e,"fold")}function b_e(e){return de(e,"extent")&&!de(e,"density")&&!de(e,"regression")}function x_e(e){return e.map(t=>r6(t)?{filter:sd(t.filter,YSe)}:t)}class E_e extends i6{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=az(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=az(t,n),t.encoding){const i={};for(const[r,a]of Uu(t.encoding))i[r]=GV(a,n);t={...t,encoding:i}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:i,...r}=t;return i?{...r,params:Uu(i).map(([a,s])=>{const{init:o,bind:l,empty:f,...d}=s;d.type==="single"?(d.type="point",d.toggle=!1):d.type==="multi"&&(d.type="point"),n.emptySelections[a]=f!=="none";for(const h of mn(n.selectionPredicates[a]??{}))h.empty=f!=="none";return{name:a,value:o,select:d,bind:l}})}:t}}function az(e,t){const{transform:n,...i}=e;if(n){const r=n.map(a=>{if(r6(a))return{filter:z3(a,t)};if(HV(a)&&Uc(a.bin))return{...a,bin:YV(a.bin)};if(qV(a)){const{selection:s,...o}=a.from;return s?{...a,from:{param:s,...o}}:a}return a});return{...i,transform:r}}return e}function GV(e,t){var i,r;const n=Ue(e);if(pe(n)&&Uc(n.bin)&&(n.bin=YV(n.bin)),Hc(n)&&((r=(i=n.scale)==null?void 0:i.domain)!=null&&r.selection)){const{selection:a,...s}=n.scale.domain;n.scale.domain={...s,...a?{param:a}:{}}}if(nm(n))if(Se(n.condition))n.condition=n.condition.map(a=>{const{selection:s,param:o,test:l,...f}=a;return o?a:{...f,test:z3(a,t)}});else{const{selection:a,param:s,test:o,...l}=GV(n.condition,t);n.condition=s?n.condition:{...l,test:z3(n.condition,t)}}return n}function YV(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function z3(e,t){const n=i=>sd(i,r=>{var o;const a=t.emptySelections[r]??!0,s={param:r,empty:a};return(o=t.selectionPredicates)[r]??(o[r]=[]),t.selectionPredicates[r].push(s),s});return e.selection?n(e.selection):sd(e.test||e.filter,i=>i.selection?n(i.selection):i)}class B3 extends i6{map(t,n){const i=n.selections??[];if(t.params&&!ko(t)){const r=[];for(const a of t.params)e6(a)?i.push(a):r.push(a);t.params=r}return n.selections=i,super.map(t,n)}mapUnit(t,n){const i=n.selections;if(!i||!i.length)return t;const r=(n.path??[]).concat(t.name),a=[];for(const s of i)if(!s.views||!s.views.length)a.push(s);else for(const o of s.views)(He(o)&&(o===t.name||r.includes(o))||Se(o)&&o.map(l=>r.indexOf(l)).every((l,f,d)=>l!==-1&&(f===0||l>d[f-1])))&&a.push(s);return a.length&&(t.params=a),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=B3.prototype[e];B3.prototype[e]=function(n,i){return t.call(this,n,S_e(n,i))}}function S_e(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function VV(e,t){t===void 0&&(t=LV(e.config));const n=C_e(e,t),{width:i,height:r}=e,a=$_e(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...a?{autosize:a}:{}}}const A_e=new e_e,w_e=new E_e,__e=new B3;function C_e(e,t={}){const n={config:t};return __e.map(A_e.map(w_e.map(e,n),n),n)}function sz(e){return He(e)?{type:e}:e??{}}function $_e(e,t,n){let{width:i,height:r}=t;const a=ko(e)||E2(e),s={};a?i=="container"&&r=="container"?(s.type="fit",s.contains="padding"):i=="container"?(s.type="fit-x",s.contains="padding"):r=="container"&&(s.type="fit-y",s.contains="padding"):(i=="container"&&(ge(k9("width")),i=void 0),r=="container"&&(ge(k9("height")),r=void 0));const o={type:"pad",...s,...n?sz(n.autosize):{},...sz(e.autosize)};if(o.type==="fit"&&!a&&(ge(xEe),o.type="pad"),i=="container"&&!(o.type=="fit"||o.type=="fit-x")&&ge(N9("width")),r=="container"&&!(o.type=="fit"||o.type=="fit-y")&&ge(N9("height")),!Sr(o,{type:"pad"}))return o}function D_e(e){return["fit","fit-x","fit-y"].includes(e)}function T_e(e){return e?`fit-${i2(e)}`:"fit"}const M_e=["background","padding"];function oz(e,t){const n={};for(const i of M_e)e&&e[i]!==void 0&&(n[i]=br(e[i]));return t&&(n.params=e.params),n}class No{constructor(t={},n={}){ce(this,"explicit");ce(this,"implicit");this.explicit=t,this.implicit=n}clone(){return new No(Ue(this.explicit),Ue(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return un(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of fe(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function Za(e){return{explicit:!0,value:e}}function mr(e){return{explicit:!1,value:e}}function XV(e){return(t,n,i,r)=>{const a=e(t.value,n.value);return a>0?t:a<0?n:S2(t,n,i,r)}}function S2(e,t,n,i){return e.explicit&&t.explicit&&ge(lSe(n,i,e.value,t.value)),e}function qu(e,t,n,i,r=S2){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Sr(e.value,t.value)?e:r(e,t,n,i)}class k_e extends No{constructor(n={},i={},r=!1){super(n,i);ce(this,"explicit");ce(this,"implicit");ce(this,"parseNothing");this.explicit=n,this.implicit=i,this.parseNothing=r}clone(){const n=super.clone();return n.parseNothing=this.parseNothing,n}}function Pd(e){return de(e,"url")}function rp(e){return de(e,"values")}function WV(e){return de(e,"name")&&!Pd(e)&&!rp(e)&&!Du(e)}function Du(e){return e&&(QV(e)||ZV(e)||a6(e))}function QV(e){return de(e,"sequence")}function ZV(e){return de(e,"sphere")}function a6(e){return de(e,"graticule")}var Wt;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(Wt||(Wt={}));function KV({invalid:e,isPath:t}){switch(VY(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function N_e(e){const{marks:t,scales:n}=KV(e);return t===n?Wt.Main:n==="include-invalid-values"?Wt.PreFilterInvalid:Wt.PostFilterInvalid}class $t{constructor(t,n){ce(this,"debugName");ce(this,"_children",[]);ce(this,"_parent",null);ce(this,"_hash");this.debugName=n,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){ge(BEe);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const i=t.parent.removeChild(t);this._parent=n,n.addChild(this,i),t.parent=this}}class Ki extends $t{constructor(n,i,r,a){super(n,i);ce(this,"type");ce(this,"refCounts");ce(this,"_source");ce(this,"_name");this.type=r,this.refCounts=a,this._source=this._name=i,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const n=new this.constructor;return n.debugName=`clone_${this.debugName}`,n._source=this._source,n._name=`clone_${this._name}`,n.type=this.type,n.refCounts=this.refCounts,n.refCounts[n._name]=0,n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${XG()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(n){this._source=n}}function y_(e){return e.as!==void 0}function uz(e){return`${e}_end`}class os extends $t{constructor(n,i){super(n);ce(this,"timeUnits");this.timeUnits=i}clone(){return new os(null,Ue(this.timeUnits))}static makeFromEncoding(n,i){const r=i.reduceFieldDef((a,s,o)=>{const{field:l,timeUnit:f}=s;if(f){let d;if(qc(f)){if(Xt(i)){const{mark:h,markDef:p,config:y}=i,v=Iu({fieldDef:s,markDef:p,config:y});(ip(h)||v)&&(d={timeUnit:jn(f),field:l})}}else d={as:ve(s,{forAs:!0}),field:l,timeUnit:f};if(Xt(i)){const{mark:h,markDef:p,config:y}=i,v=Iu({fieldDef:s,markDef:p,config:y});ip(h)&&ln(o)&&v!==.5&&(d.rectBandPosition=v)}d&&(a[rt(d)]=d)}return a},{});return Rt(r)?null:new os(n,r)}static makeFromTransform(n,i){const{timeUnit:r,...a}={...i},s=jn(r),o={...a,timeUnit:s};return new os(n,{[rt(o)]:o})}merge(n){this.timeUnits={...this.timeUnits};for(const i in n.timeUnits)this.timeUnits[i]||(this.timeUnits[i]=n.timeUnits[i]);for(const i of n.children)n.removeChild(i),i.parent=this;n.remove()}removeFormulas(n){const i={};for(const[r,a]of Uu(this.timeUnits)){const s=y_(a)?a.as:`${a.field}_end`;n.has(s)||(i[r]=a)}this.timeUnits=i}producedFields(){return new Set(mn(this.timeUnits).map(n=>y_(n)?n.as:uz(n.field)))}dependentFields(){return new Set(mn(this.timeUnits).map(n=>n.field))}hash(){return`TimeUnit ${rt(this.timeUnits)}`}assemble(){const n=[];for(const i of mn(this.timeUnits)){const{rectBandPosition:r}=i,a=jn(i.timeUnit);if(y_(i)){const{field:s,as:o}=i,{unit:l,utc:f,...d}=a,h=[o,`${o}_end`];n.push({field:ta(s),type:"timeunit",...l?{units:o2(l)}:{},...f?{timezone:"utc"}:{},...d,as:h}),n.push(...lz(h,r,a))}else if(i){const{field:s}=i,o=s.replaceAll("\\.","."),l=JV({timeUnit:a,field:o}),f=uz(o);n.push({type:"formula",expr:l,as:f}),n.push(...lz([o,f],r,a))}}return n}}const A2="offsetted_rect_start",w2="offsetted_rect_end";function JV({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,a=TY(i),{part:s,step:o}=FY(a,e.step);return`${r?"utcOffset":"timeOffset"}('${s}', ${wt(t)}, ${n?-o:o})`}function lz([e,t],n,i){if(n!==void 0&&n!==.5){const r=wt(e),a=wt(t);return[{type:"formula",expr:cz([JV({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${A2}`},{type:"formula",expr:cz([r,a],n+.5),as:`${e}_${w2}`}]}return[]}function cz([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const sm="_tuple_fields";class F_e{constructor(...t){ce(this,"hasChannel");ce(this,"hasField");ce(this,"hasSelectionId");ce(this,"timeUnit");ce(this,"items");this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const O_e={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??(t.project=new F_e),a={},s={},o=new Set,l=(v,b)=>{const E=b==="visual"?v.channel:v.field;let S=qt(`${i}_${E}`);for(let w=1;o.has(S);w++)S=qt(`${i}_${E}_${w}`);return o.add(S),{[b]:S}},f=t.type,d=e.config.selection[f],h=n.value!==void 0?on(n.value):null;let{fields:p,encodings:y}=dt(n.select)?n.select:{};if(!p&&!y&&h){for(const v of h)if(dt(v))for(const b of fe(v))V2e(b)?(y||(y=[])).push(b):f==="interval"?(ge(MEe),y=d.encodings):(p??(p=[])).push(b)}!p&&!y&&(y=d.encodings,"fields"in d&&(p=d.fields));for(const v of y??[]){const b=e.fieldDef(v);if(b){let E=b.field;if(b.aggregate){ge(EEe(v,b.aggregate));continue}else if(!E){ge(O9(v));continue}if(b.timeUnit&&!qc(b.timeUnit)){E=e.vgField(v);const S={timeUnit:b.timeUnit,as:E,field:b.field};s[rt(S)]=S}if(!a[E]){const S=f==="interval"&&Ms(v)&&$a(e.getScaleComponent(v).get("type"))?"R":b.bin?"R-RE":"E",w={field:E,channel:v,type:S,index:r.items.length};w.signals={...l(w,"data"),...l(w,"visual")},r.items.push(a[E]=w),r.hasField[E]=a[E],r.hasSelectionId=r.hasSelectionId||E===Ma,eY(v)?(w.geoChannel=v,w.channel=JG(v),r.hasChannel[w.channel]=a[E]):r.hasChannel[v]=a[E]}}else ge(O9(v))}for(const v of p??[]){if(r.hasField[v])continue;const b={type:"E",field:v,index:r.items.length};b.signals={...l(b,"data")},r.items.push(b),r.hasField[v]=b,r.hasSelectionId=r.hasSelectionId||v===Ma}h&&(t.init=h.map(v=>r.items.map(b=>dt(v)?v[b.geoChannel||b.channel]!==void 0?v[b.geoChannel||b.channel]:v[b.field]:v))),Rt(s)||(r.timeUnit=new os(null,s))},signals:(e,t,n)=>{const i=t.name+sm;return n.filter(a=>a.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(iX)})}},eX="_curr",Ly="anim_value",Vf="anim_clock",L3="eased_anim_clock",tX="min_extent",nX="max_range_extent",v_="last_tick_at",b_="is_playing",R_e=1/60*1e3,z_e=(e,t)=>[{name:L3,update:Vf},{name:`${e}_domain`,init:`domain('${t}')`},{name:tX,init:`extent(${e}_domain)[0]`},{name:nX,init:`extent(range('${t}'))[1]`},{name:Ly,update:`invert('${t}', ${L3})`}],B_e={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(us(t)&&(n=n.concat([{name:Vf,init:"0",on:[{events:{type:"timer",throttle:R_e},update:`${b_} ? (${Vf} + (now() - ${v_}) > ${nX} ? 0 : ${Vf} + (now() - ${v_})) : ${Vf}`}]},{name:v_,init:"now()",on:[{events:[{signal:Vf},{signal:b_}],update:"now()"}]},{name:b_,init:"true"}])),n),signals:(e,t,n)=>{const i=t.name,r=i+sm,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",o=mn(e.component.selection??{}).reduce((d,h)=>h.type==="interval"?d.concat(h.name+ld):d,[]).map(d=>`indexof(item().mark.name, '${d}') < 0`).join(" && "),l=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${o?` && ${o}`:""}`;let f=`unit: ${tc(e)}, `;if(t.project.hasSelectionId)f+=`${Ma}: ${s}[${ct(Ma)}]`;else if(us(t))f+=`fields: ${r}, values: [${Ly} ? ${Ly} : ${tX}]`;else{const d=a.items.map(h=>{const p=e.fieldDef(h.channel);return p!=null&&p.bin?`[${s}[${ct(e.vgField(h.channel,{}))}], ${s}[${ct(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${ct(h.field)}]`}).join(", ");f+=`fields: ${r}, values: [${d}]`}if(us(t))return n.concat(z_e(t.name,e.scaleName(Ku)),[{name:i+Ao,on:[{events:[{signal:L3},{signal:Ly}],update:`{${f}}`,force:!0}]}]);{const d=t.events;return n.concat([{name:i+Ao,on:d?[{events:d,update:`${l} ? {${f}} : null`,force:!0}]:[]}])}}};function iX(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=ta(r.field),r}function wc(e,t=!0,n=lxe){if(Se(e)){const i=e.map(r=>wc(r,t,n));return t?`[${i.join(", ")}]`:i}else if(Ic(e))return n(t?xc(e):OSe(e));return t?n(Et(e)):e}function L_e(e,t){for(const n of mn(e.component.selection??{})){const i=n.name;let r=`${i}${Ao}, ${n.resolve==="global"?"true":`{unit: ${tc(e)}}`}`;for(const a of C2)a.defined(n)&&(a.signals&&(t=a.signals(e,n,t)),a.modifyExpr&&(r=a.modifyExpr(e,n,r)));t.push({name:i+fCe,on:[{events:{signal:n.name+Ao},update:`modify(${ct(n.name+_c)}, ${r})`}]})}return s6(t)}function j_e(e,t){if(e.component.selection&&fe(e.component.selection).length){const n=ct(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:ch("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return s6(t)}function U_e(e,t){let n=!1;for(const i of mn(e.component.selection??{})){const r=i.name,a=ct(r+_c);if(t.filter(o=>o.name===r).length===0){const o=i.resolve==="global"?"union":i.resolve,l=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${xX}(${a}, ${ct(o)}${l}`})}n=!0;for(const o of C2)o.defined(i)&&o.topLevelSignals&&(t=o.topLevelSignals(e,i,t))}return n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),s6(t)}function P_e(e,t){const n=[],i=[],r=tc(e,{escape:!1});for(const a of mn(e.component.selection??{})){const s={name:a.name+_c};if(a.project.hasSelectionId&&(s.transform=[{type:"collect",sort:{field:Ma}}]),a.init){const l=a.project.items.map(iX);s.values=a.project.hasSelectionId?a.init.map(f=>({unit:r,[Ma]:wc(f,!1)[0]})):a.init.map(f=>({unit:r,fields:l,values:wc(f,!1)}))}if([...n,...t].filter(l=>l.name===a.name+_c).length||n.push(s),us(a)&&t.length){const l=e.lookupDataSource(e.getDataName(Wt.Main)),f=t.find(h=>h.name===l),d=f.transform.find(h=>h.type==="filter"&&h.expr.includes("vlSelectionTest"));if(d){f.transform=f.transform.filter(p=>p!==d);const h={name:f.name+eX,source:f.name,transform:[d]};i.push(h)}}}return n.concat(t,i)}function rX(e,t){for(const n of mn(e.component.selection??{}))for(const i of C2)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t}function I_e(e,t){for(const n of e.children)Xt(n)&&(t=rX(n,t));return t}function q_e(e,t,n,i){const r=_X(e,t.param,t);return{signal:$a(n.get("type"))&&Se(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function s6(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const mo={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Ms(r))continue;const a=e.getScaleComponent(r),s=a?a.get("type"):void 0;if(s=="sequential"&&ge(_Ee),!a||!$a(s)){ge(wEe);continue}a.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(s=>n.filter(o=>o.name===s.signals.data).length===0);if(!e.parent||U3(e)||i.length===0)return n;const r=n.find(s=>s.name===t.name);let a=r.update;if(a.includes(xX))r.update=`{${i.map(s=>`${ct(ta(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of i){const o=`${ct(ta(s.field))}: ${s.signals.data}`;a.includes(o)||(a=`${a.substring(0,a.length-1)}, ${o}}`)}r.update=a}return n.concat(i.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!U3(e))for(const i of t.scales){const r=n.find(a=>a.name===i.signals.data);r.push="outer",delete r.value,delete r.update}return n}};function j3(e,t){return`domain(${ct(e.scaleName(t))})`}function U3(e){return e.parent&&vh(e.parent)&&(!e.parent.parent||U3(e.parent.parent))}const ld="_brush",aX="_scale_trigger",B0="geo_interval_init_tick",sX="_init",H_e="_center",G_e={defined:e=>e.type==="interval",parse:(e,t,n)=>{var i;if(e.hasProjection){const r={...Pe(n.select)?n.select:{}};r.fields=[Ma],r.encodings||(r.encodings=n.value?fe(n.value):[Ua,ja]),n.select={type:"interval",...r}}if(t.translate&&!mo.defined(t)){const r=`!event.item || event.item.mark.name !== ${ct(t.name+ld)}`;for(const a of t.events){if(!a.between){ge(`${a} is not an ordered event stream for interval selections.`);continue}const s=on((i=a.between[0]).filter??(i.filter=[]));s.includes(r)||s.push(r)}}},signals:(e,t,n)=>{const i=t.name,r=i+Ao,a=mn(t.project.hasChannel).filter(o=>o.channel===Gt||o.channel===In),s=t.init?t.init[0]:null;if(n.push(...a.reduce((o,l)=>o.concat(Y_e(e,t,l,s==null?void 0:s[l.index])),[])),e.hasProjection){const o=ct(e.projectionName()),l=e.projectionName()+H_e,{x:f,y:d}=t.project.hasChannel,h=f==null?void 0:f.signals.visual,p=d==null?void 0:d.signals.visual,y=f?s==null?void 0:s[f.index]:`${l}[0]`,v=d?s==null?void 0:s[d.index]:`${l}[1]`,b=$=>e.getSizeSignalRef($).signal,E=`[[${h?`${h}[0]`:"0"}, ${p?`${p}[0]`:"0"}],[${h?`${h}[1]`:b("width")}, ${p?`${p}[1]`:b("height")}]]`;s&&(n.unshift({name:i+sX,init:`[scale(${o}, [${f?y[0]:y}, ${d?v[0]:v}]), scale(${o}, [${f?y[1]:y}, ${d?v[1]:v}])]`}),(!f||!d)&&(n.find(M=>M.name===l)||n.unshift({name:l,update:`invert(${o}, [${b("width")}/2, ${b("height")}/2])`})));const S=`intersect(${E}, {markname: ${ct(e.getName("marks"))}}, unit.mark)`,w=`{unit: ${tc(e)}}`,_=`vlSelectionTuples(${S}, ${w})`,C=a.map($=>$.signals.visual);return n.concat({name:r,on:[{events:[...C.length?[{signal:C.join(" || ")}]:[],...s?[{signal:B0}]:[]],update:_}]})}else{if(!mo.defined(t)){const f=i+aX,d=a.map(h=>{const p=h.channel,{data:y,visual:v}=h.signals,b=ct(e.scaleName(p)),E=e.getScaleComponent(p).get("type"),S=$a(E)?"+":"";return`(!isArray(${y}) || (${S}invert(${b}, ${v})[0] === ${S}${y}[0] && ${S}invert(${b}, ${v})[1] === ${S}${y}[1]))`});d.length&&n.push({name:f,value:{},on:[{events:a.map(h=>({scale:e.scaleName(h.channel)})),update:`${d.join(" && ")} ? ${f} : {}`}]})}const o=a.map(f=>f.signals.data),l=`unit: ${tc(e)}, fields: ${i+sm}, values`;return n.concat({name:r,...s?{init:`{${l}: ${wc(s)}}`}:{},...o.length?{on:[{events:[{signal:o.join(" || ")}],update:`${o.join(" && ")} ? {${l}: [${o}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(Xt(e)&&e.hasProjection&&t.init&&(n.filter(r=>r.name===B0).length||n.unshift({name:B0,value:null,on:[{events:"timer{1}",update:`${B0} === null ? {} : ${B0}`}]})),n),marks:(e,t,n)=>{const i=t.name,{x:r,y:a}=t.project.hasChannel,s=r==null?void 0:r.signals.visual,o=a==null?void 0:a.signals.visual,l=`data(${ct(t.name+_c)})`;if(mo.defined(t)||!r&&!a)return n;const f={x:r!==void 0?{signal:`${s}[0]`}:{value:0},y:a!==void 0?{signal:`${o}[0]`}:{value:0},x2:r!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:a!==void 0?{signal:`${o}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const E of fe(f))f[E]=[{test:`${l}.length && ${l}[0].unit === ${tc(e)}`,...f[E]},{value:0}];const{fill:d,fillOpacity:h,cursor:p,...y}=t.mark,v=fe(y).reduce((E,S)=>(E[S]=[{test:[r!==void 0&&`${s}[0] !== ${s}[1]`,a!==void 0&&`${o}[0] !== ${o}[1]`].filter(w=>w).join(" && "),value:y[S]},{value:null}],E),{}),b=p??(t.translate?"move":null);return[{name:`${i+ld}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:d},fillOpacity:{value:h}},update:f}},...n,{name:i+ld,type:"rect",clip:!0,encode:{enter:{...b?{cursor:{value:b}}:{},fill:{value:"transparent"}},update:{...f,...v}}}]}};function Y_e(e,t,n,i){const r=!e.hasProjection,a=n.channel,s=n.signals.visual,o=ct(r?e.scaleName(a):e.projectionName()),l=p=>`scale(${o}, ${p})`,f=e.getSizeSignalRef(a===Gt?"width":"height").signal,d=`${a}(unit)`,h=t.events.reduce((p,y)=>[...p,{events:y.between[0],update:`[${d}, ${d}]`},{events:y,update:`[${s}[0], clamp(${d}, 0, ${f})]`}],[]);if(r){const p=n.signals.data,y=mo.defined(t),v=e.getScaleComponent(a),b=v?v.get("type"):void 0,E=i?{init:wc(i,!0,l)}:{value:[]};return h.push({events:{signal:t.name+aX},update:$a(b)?`[${l(`${p}[0]`)}, ${l(`${p}[1]`)}]`:"[0, 0]"}),y?[{name:p,on:[]}]:[{name:s,...E,on:h},{name:p,...i?{init:wc(i)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${o}, ${s})`}]}]}else{const p=a===Gt?0:1,y=t.name+sX,v=i?{init:`[${y}[0][${p}], ${y}[1][${p}]]`}:{value:[]};return[{name:s,...v,on:h}]}}function gh({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const a=nm(t)&&t.condition;let s=[];a&&(s=on(a).map(f=>{const d=r(f);if(FAe(f)){const{param:h,empty:p}=f;return{test:wX(e,{param:h,empty:p}),...d}}else return{test:bb(e,f.test),...d}})),i!==void 0&&s.push(i);const o=r(t);return o!==void 0&&s.push(o),s.length>1||s.length===1&&s[0].test?{[n]:s}:s.length===1?{[n]:s[0]}:{}}function o6(e,t="text"){const n=e.encoding[t];return gh({model:e,channelDef:n,vgChannel:t,mainRefFn:i=>_2(i,e.config),invalidValueRef:void 0})}function _2(e,t,n="datum"){if(e){if(Da(e))return Ut(e.value);if(qe(e)){const{format:i,formatType:r}=hb(e);return Pk({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function oX(e,t={}){const{encoding:n,markDef:i,config:r,stack:a}=e,s=n.tooltip;if(Se(s))return{tooltip:fz({tooltip:s},a,r,t)};{const o=t.reactiveGeom?"datum.datum":"datum";return gh({model:e,channelDef:s,vgChannel:"tooltip",mainRefFn:f=>{const d=_2(f,r,o);if(d)return d;if(f===null)return;let h=kt("tooltip",i,r);if(h===!0&&(h={content:"encoding"}),He(h))return{value:h};if(dt(h))return Ce(h)?h:h.content==="encoding"?fz(n,a,r,t):{signal:o}},invalidValueRef:void 0})}}function uX(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},a=new Set,s=i?"datum.datum":"datum",o=[];function l(d,h){const p=jc(h),y=zi(d)?d:{...d,type:e[p].type},v=y.title||Gk(y,r),b=on(v).join(", ").replaceAll(/"/g,'\\"');let E;if(ln(h)){const S=h==="x"?"x2":"y2",w=Ta(e[S]);if(Yn(y.bin)&&w){const _=ve(y,{expr:s}),C=ve(w,{expr:s}),{format:$,formatType:M}=hb(y);E=em(_,C,$,M,r),a.add(S)}}if((ln(h)||h===ra||h===La)&&t&&t.fieldChannel===h&&t.offset==="normalize"){const{format:S,formatType:w}=hb(y);E=Pk({fieldOrDatumDef:y,format:S,formatType:w,expr:s,config:r,normalizeStack:!0}).signal}E??(E=_2(y,r,s).signal),o.push({channel:h,key:b,value:E})}Vk(e,(d,h)=>{pe(d)?l(d,h):p2(d)&&l(d.condition,h)});const f={};for(const{channel:d,key:h,value:p}of o)!a.has(d)&&!f[h]&&(f[h]=p);return f}function fz(e,t,n,{reactiveGeom:i}={}){const r=uX(e,t,n,{reactiveGeom:i}),a=Uu(r).map(([s,o])=>`"${s}": ${o}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function V_e(e){const{markDef:t,config:n}=e,i=kt("aria",t,n);return i===!1?{}:{...i?{aria:i}:{},...X_e(e),...W_e(e)}}function X_e(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=kt("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:pn(mEe,t)?{}:{ariaRoleDescription:{value:t}}}function W_e(e){const{encoding:t,markDef:n,config:i,stack:r}=e,a=t.description;if(a)return gh({model:e,channelDef:a,vgChannel:"description",mainRefFn:l=>_2(l,e.config),invalidValueRef:void 0});const s=kt("description",n,i);if(s!=null)return{description:Ut(s)};if(i.aria===!1)return{};const o=uX(t,r,i);if(!Rt(o))return{description:{signal:Uu(o).map(([l,f],d)=>`"${d>0?"; ":""}${l}: " + (${f})`).join(" + ")}}}function Wn(e,t,n={}){const{markDef:i,encoding:r,config:a}=t,{vgChannel:s}=n;let{defaultRef:o,defaultValue:l}=n;const f=r[e];o===void 0&&(l??(l=kt(e,i,a,{vgChannel:s,ignoreVgConfig:!nm(f)})),l!==void 0&&(o=Ut(l)));const d={markDef:i,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},h=WY({...d,scaleChannel:e,channelDef:f});return gh({model:t,channelDef:f,vgChannel:s??e,invalidValueRef:h,mainRefFn:y=>Uk({...d,channel:e,channelDef:y,stack:null,defaultRef:o})})}function lX(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:a}=n,s=t.filled??kt("filled",n,r),o=et(["bar","point","circle","square","geoshape"],a)?"transparent":void 0,l=kt(s===!0?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[s===!0&&"color"]??o,f=kt(s===!1?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[s===!1&&"color"],d=s?"fill":"stroke",h={...l?{fill:Ut(l)}:{},...f?{stroke:Ut(f)}:{}};return n.color&&(s?n.fill:n.stroke)&&ge(xY("property",{fill:"fill"in n,stroke:"stroke"in n})),{...h,...Wn("color",e,{vgChannel:d,defaultValue:s?l:f}),...Wn("fill",e,{defaultValue:i.fill?l:void 0}),...Wn("stroke",e,{defaultValue:i.stroke?f:void 0})}}function Q_e(e){const{encoding:t,mark:n}=e,i=t.order;return!rl(n)&&Da(i)?gh({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:r=>Ut(r.value),invalidValueRef:void 0}):{}}function Id({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const a=`${e}Offset`,s=t[a],o=n[a];if((a==="xOffset"||a==="yOffset")&&o)return{offsetType:"encoding",offset:Uk({channel:a,channelDef:o,markDef:t,config:i==null?void 0:i.config,scaleName:i.scaleName(a),scale:i.getScaleComponent(a),stack:null,defaultRef:Ut(s),bandPosition:r})};const l=t[a];return l?{offsetType:"visual",offset:l}:{}}function Mi(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:a,config:s,stack:o}=t,l=r[e],f=r[Ts(e)],d=t.scaleName(e),h=t.getScaleComponent(e),{offset:p,offsetType:y}=Id({channel:e,markDef:a,encoding:r,model:t,bandPosition:.5}),v=u6({model:t,defaultPos:n,channel:e,scaleName:d,scale:h}),b=!l&&ln(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:Z_e({channel:e,channelDef:l,channel2Def:f,markDef:a,config:s,scaleName:d,scale:h,stack:o,offset:p,defaultRef:v,bandPosition:y==="encoding"?0:void 0});return b?{[i||e]:b}:void 0}function Z_e(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:a,markDef:s}=e;if(qe(n)&&r&&t===r.fieldChannel){if(pe(n)){let o=n.bandPosition;if(o===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(o=.5),o!==void 0)return cb({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:o,offset:a})}return Jl(n,i,{suffix:"end"},{offset:a})}return jk(e)}function u6({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:a,config:s}=e;return()=>{const o=jc(n),l=Pu(n),f=kt(n,a,s,{vgChannel:l});if(f!==void 0)return $g(n,f);switch(t){case"zeroOrMin":return dz({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:o,config:s});case"zeroOrMax":return dz({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:o,config:s});case"mid":return{...e[rr(n)],mult:.5}}}}function dz({mainChannel:e,config:t,...n}){const i=XY(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if(r==="zeroOrMin")return{value:0};const{widthSignal:a,heightSignal:s}=r.zeroOrMax;return{signal:`min(${a},${s})/2`}}case"theta":return r==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return r==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return r==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const K_e={left:"x",center:"xc",right:"x2"},J_e={top:"y",middle:"yc",bottom:"y2"};function cX(e,t,n,i="middle"){if(e==="radius"||e==="theta")return Pu(e);const r=e==="x"?"align":"baseline",a=kt(r,t,n);let s;return Ce(a)?(ge(KEe(r)),s=void 0):s=a,e==="x"?K_e[s||(i==="top"?"left":"center")]:J_e[s||i]}function yb(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?fX(e,t,{defaultPos:n,defaultPos2:i}):Mi(e,t,{defaultPos:n})}function fX(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:a}=t,s=Ts(e),o=rr(e),l=eCe(t,i,s),f=l[o]?cX(e,r,a):Pu(e);return{...Mi(e,t,{defaultPos:n,vgChannel:f}),...l}}function eCe(e,t,n){const{encoding:i,mark:r,markDef:a,stack:s,config:o}=e,l=jc(n),f=rr(n),d=Pu(n),h=i[l],p=e.scaleName(l),y=e.getScaleComponent(l),{offset:v}=n in i||n in a?Id({channel:n,markDef:a,encoding:i,model:e}):Id({channel:l,markDef:a,encoding:i,model:e});if(!h&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const E=rr(n),S=e.markDef[E];return S!=null?{[E]:{value:S}}:{[d]:{field:e.getName(n)}}}const b=tCe({channel:n,channelDef:h,channel2Def:i[n],markDef:a,config:o,scaleName:p,scale:y,stack:s,offset:v,defaultRef:void 0});return b!==void 0?{[d]:b}:ty(n,a)||ty(n,{[n]:$3(n,a,o.style),[f]:$3(f,a,o.style)})||ty(n,o[r])||ty(n,o.mark)||{[d]:u6({model:e,defaultPos:t,channel:n,scaleName:p,scale:y})()}}function tCe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:a,scale:s,stack:o,offset:l,defaultRef:f}){return qe(t)&&o&&e.charAt(0)===o.fieldChannel.charAt(0)?Jl(t,a,{suffix:"start"},{offset:l}):jk({channel:e,channelDef:n,scaleName:a,scale:s,stack:o,markDef:i,config:r,offset:l,defaultRef:f})}function ty(e,t){const n=rr(e),i=Pu(e);if(t[i]!==void 0)return{[i]:$g(e,t[i])};if(t[e]!==void 0)return{[i]:$g(e,t[e])};if(t[n]){const r=t[n];if(Sc(r))ge(YEe(n));else return{[n]:$g(e,r)}}}function So(e,t){const{config:n,encoding:i,markDef:r}=e,a=r.type,s=Ts(t),o=rr(t),l=i[t],f=i[s],d=e.getScaleComponent(t),h=d?d.get("type"):void 0,p=r.orient,y=i[o]??i.size??kt("size",r,n,{vgChannel:o}),v=rY(t),b=a==="bar"&&(t==="x"?p==="vertical":p==="horizontal")||a==="tick"&&(t==="y"?p==="vertical":p==="horizontal");return pe(l)&&(Bt(l.bin)||Yn(l.bin)||l.timeUnit&&!f)&&!(y&&!Sc(y))&&!i[v]&&!Un(h)?rCe({fieldDef:l,fieldDef2:f,channel:t,model:e}):(qe(l)&&Un(h)||b)&&!f?iCe(l,t,e):fX(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function nCe(e,t,n,i,r,a,s){if(Sc(r))if(n){const l=n.get("type");if(l==="band"){let f=`bandwidth('${t}')`;r.band!==1&&(f=`${r.band} * ${f}`);const d=ms("minBandSize",{type:s},i);return{signal:d?`max(${xa(d)}, ${f})`:f}}else r.band!==1&&(ge(nSe(l)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(Ce(r))return r;if(r)return{value:r}}if(n){const l=n.get("range");if(Pc(l)&&Ht(l.step))return{value:l.step-2}}if(!a){const{bandPaddingInner:l,barBandPaddingInner:f,rectBandPaddingInner:d,tickBandPaddingInner:h}=i.scale,p=un(l,s==="tick"?h:s==="bar"?f:d);if(Ce(p))return{signal:`(1 - (${p.signal})) * ${e}`};if(Ht(p))return{signal:`${1-p} * ${e}`}}return{value:O3(i.view,e)-2}}function iCe(e,t,n){var R,B;const{markDef:i,encoding:r,config:a,stack:s}=n,o=i.orient,l=n.scaleName(t),f=n.getScaleComponent(t),d=rr(t),h=Ts(t),p=rY(t),y=n.scaleName(p),v=n.getScaleComponent(dk(t)),b=i.type==="tick"||o==="horizontal"&&t==="y"||o==="vertical"&&t==="x";let E;(r.size||i.size)&&(b?E=Wn("size",n,{vgChannel:d,defaultRef:Ut(i.size)}):ge(sSe(i.type)));const S=!!E,w=nV({channel:t,fieldDef:e,markDef:i,config:a,scaleType:(R=f||v)==null?void 0:R.get("type"),useVlSizeChannel:b});E=E||{[d]:nCe(d,y||l,v||f,a,w,!!e,i.type)};const _=((B=f||v)==null?void 0:B.get("type"))==="band"&&Sc(w)&&!S?"top":"middle",C=cX(t,i,a,_),$=C==="xc"||C==="yc",{offset:M,offsetType:T}=Id({channel:t,markDef:i,encoding:r,model:n,bandPosition:$?.5:0}),F=jk({channel:t,channelDef:e,markDef:i,config:a,scaleName:l,scale:f,stack:s,offset:M,defaultRef:u6({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:f}),bandPosition:$?T==="encoding"?0:.5:Ce(w)?{signal:`(1-${w})/2`}:Sc(w)?(1-w.band)/2:0});if(d)return{[C]:F,...E};{const L=Pu(h),Y=E[d],H=M?{...Y,offset:M}:Y;return{[C]:F,[L]:Se(F)?[F[0],{...F[1],offset:H}]:{...F,offset:H}}}}function hz(e,t,n,i,r,a,s){if(KG(e))return 0;const o=e==="x"||e==="y2",l=o?-t/2:t/2;if(Ce(n)||Ce(r)||Ce(i)||a){const f=xa(n),d=xa(r),h=xa(i),p=xa(a),v=a?`(${s} < ${p} ? ${o?"":"-"}0.5 * (${p} - (${s})) : ${l})`:l,b=h?`${h} + `:"",E=f?`(${f} ? -1 : 1) * `:"",S=d?`(${d} + ${v})`:v;return{signal:b+E+S}}else return r=r||0,i+(n?-r-l:+r+l)}function rCe({fieldDef:e,fieldDef2:t,channel:n,model:i}){var B;const{config:r,markDef:a,encoding:s}=i,o=i.getScaleComponent(n),l=i.scaleName(n),f=o?o.get("type"):void 0,d=o.get("reverse"),h=nV({channel:n,fieldDef:e,markDef:a,config:r,scaleType:f}),p=(B=i.component.axes[n])==null?void 0:B[0],y=(p==null?void 0:p.get("translate"))??.5,v=ln(n)?kt("binSpacing",a,r)??0:0,b=Ts(n),E=Pu(n),S=Pu(b),w=ms("minBandSize",a,r),{offset:_}=Id({channel:n,markDef:a,encoding:s,model:i,bandPosition:0}),{offset:C}=Id({channel:b,markDef:a,encoding:s,model:i,bandPosition:0}),$=DAe({fieldDef:e,scaleName:l}),M=hz(n,v,d,y,_,w,$),T=hz(b,v,d,y,C??_,w,$),F=Ce(h)?{signal:`(1-${h.signal})/2`}:Sc(h)?(1-h.band)/2:.5,R=Iu({fieldDef:e,fieldDef2:t,markDef:a,config:r});if(Bt(e.bin)||e.timeUnit){const L=e.timeUnit&&R!==.5;return{[S]:gz({fieldDef:e,scaleName:l,bandPosition:F,offset:T,useRectOffsetField:L}),[E]:gz({fieldDef:e,scaleName:l,bandPosition:Ce(F)?{signal:`1-${F.signal}`}:1-F,offset:M,useRectOffsetField:L})}}else if(Yn(e.bin)){const L=Jl(e,l,{},{offset:T});if(pe(t))return{[S]:L,[E]:Jl(t,l,{},{offset:M})};if(Uc(e.bin)&&e.bin.step)return{[S]:L,[E]:{signal:`scale("${l}", ${ve(e,{expr:"datum"})} + ${e.bin.step})`,offset:M}}}ge(AY(b))}function gz({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return cb({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:A2,endSuffix:w2}:{}})}const aCe=new Set(["aria","width","height"]);function aa(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?lX(e):{};return{...sCe(e.markDef,t),...pz("fill",n),...pz("stroke",i),...Wn("opacity",e),...Wn("fillOpacity",e),...Wn("strokeOpacity",e),...Wn("strokeWidth",e),...Wn("strokeDash",e),...Q_e(e),...oX(e),...o6(e,"href"),...V_e(e)}}function pz(e,t){return t?{[e]:t}:{}}function sCe(e,t){return pEe.reduce((n,i)=>(!aCe.has(i)&&de(e,i)&&t[i]!=="ignore"&&(n[i]=Ut(e[i])),n),{})}function l6(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,a)=>{var f;let s;if(!Ms(a)||!(s=e.getScaleType(a)))return;const o=r2(r.aggregate),l=Lk({scaleChannel:a,markDef:n,config:t,scaleType:s,isCountAggregate:o});if(_Ae(l)){const d=e.vgField(a,{expr:"datum",binSuffix:(f=e.stack)!=null&&f.impute?"mid":void 0});d&&i.add(d)}}),i.size>0)return{defined:{signal:[...i].map(a=>u2(a,!0)).join(" && ")}}}function mz(e,t){if(t!==void 0)return{[e]:Ut(t)}}const x_="voronoi",dX={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(x_)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,a=e.mark;if(rl(a))return ge(SEe(a)),n;const s={name:e.getName(x_),type:"path",interactive:!0,aria:!1,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...oX(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let o=0,l=!1;return n.forEach((f,d)=>{const h=f.name??"";h===e.component.mark[0].name?o=d:h.includes(x_)&&(l=!0)}),l||n.splice(o+1,0,s),n}},hX={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!Jk(e.bind),parse:(e,t,n)=>EX(t,n),topLevelSignals:(e,t,n)=>{var l;const i=t.name,r=t.project,a=t.bind,s=(l=t.init)==null?void 0:l[0],o=dX.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((f,d)=>{const h=qt(`${i}_${f.field}`);n.filter(y=>y.name===h).length||n.unshift({name:h,...s?{init:wc(s[d])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${o}[${ct(f.field)}] : null`}]:[],bind:a[f.field]??a[f.channel]??a})}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,a=n.find(f=>f.name===i+Ao),s=i+sm,o=r.items.map(f=>qt(`${i}_${f.field}`)),l=o.map(f=>`${f} !== null`).join(" && ");return o.length&&(a.update=`${l} ? {fields: ${s}, values: [${o.join(", ")}]} : null`),delete a.value,delete a.on,n}},vb="_toggle",gX={defined:e=>e.type==="point"&&!us(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+vb,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ao,i=t.name+vb;return`${i} ? null : ${n}, ${t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${tc(e)}}, `}${i} ? ${n} : null`}},oCe={defined:e=>e.clear!==void 0&&e.clear!==!1&&!us(e),parse:(e,t)=>{t.clear&&(t.clear=He(t.clear)?ch(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(hX.defined(t))for(const i of t.project.items){const r=n.findIndex(a=>a.name===qt(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,a){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:a})}if(t.type==="interval")for(const r of t.project.items){const a=n.findIndex(s=>s.name===r.signals.visual);if(i(a,"[0, 0]"),a===-1){const s=n.findIndex(o=>o.name===r.signals.data);i(s,"null")}}else{let r=n.findIndex(a=>a.name===t.name+Ao);i(r,"null"),gX.defined(t)&&(r=n.findIndex(a=>a.name===t.name+vb),i(r,"false"))}return n}},pX={defined:e=>{const t=e.resolve==="global"&&e.bind&&Jk(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ma;return t&&!n&&ge(CEe),t&&n},parse:(e,t,n)=>{const i=Ue(n);if(i.select=He(i.select)?{type:i.select,toggle:t.toggle}:{...i.select,toggle:t.toggle},EX(t,i),Pe(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const o of t.events)o.filter=on(o.filter??[]),o.filter.includes(s)||o.filter.push(s)}const r=g_(t.bind)?t.bind.legend:"click",a=He(r)?ch(r,"view"):on(r);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=g_(t.bind)&&t.bind.legend,a=s=>o=>{const l=Ue(o);return l.markname=s,l};for(const s of t.project.items){if(!s.hasLegend)continue;const o=`${qt(s.field)}_legend`,l=`${i}_${o}`;if(n.filter(d=>d.name===l).length===0){const d=r.merge.map(a(`${o}_symbols`)).concat(r.merge.map(a(`${o}_labels`))).concat(r.merge.map(a(`${o}_entries`)));n.unshift({name:l,...t.init?{}:{value:null},on:[{events:d,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]})}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,a=n.find(p=>p.name===i+Ao),s=i+sm,o=r.items.filter(p=>p.hasLegend).map(p=>qt(`${i}_${qt(p.field)}_legend`)),f=`${o.map(p=>`${p} !== null`).join(" && ")} ? {fields: ${s}, values: [${o.join(", ")}]} : null`;t.events&&o.length>0?a.on.push({events:o.map(p=>({signal:p})),update:f}):o.length>0&&(a.update=f,delete a.value,delete a.on);const d=n.find(p=>p.name===i+vb),h=g_(t.bind)&&t.bind.legend;return d&&(t.events?d.on.push({...d.on[0],events:h}):d.on[0].events=h),n}};function uCe(e,t,n){var r;const i=(r=e.fieldDef(t))==null?void 0:r.field;for(const a of mn(e.component.selection??{})){const s=a.project.hasField[i]??a.project.hasChannel[t];if(s&&pX.defined(a)){const o=n.get("selections")??[];o.push(a.name),n.set("selections",o,!1),s.hasLegend=!0}}}const mX="_translate_anchor",yX="_translate_delta",lCe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=mo.defined(t),a=i+mX,{x:s,y:o}=t.project.hasChannel;let l=ch(t.translate,"scope");return r||(l=l.map(f=>(f.between[0].markname=i+ld,f))),n.push({name:a,value:{},on:[{events:l.map(f=>f.between[0]),update:`{x: x(unit), y: y(unit)${s!==void 0?`, extent_x: ${r?j3(e,Gt):`slice(${s.signals.visual})`}`:""}${o!==void 0?`, extent_y: ${r?j3(e,In):`slice(${o.signals.visual})`}`:""}}`}]},{name:i+yX,value:{},on:[{events:l,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),s!==void 0&&yz(e,t,s,"width",n),o!==void 0&&yz(e,t,o,"height",n),n}};function yz(e,t,n,i,r){const a=t.name,s=a+mX,o=a+yX,l=n.channel,f=mo.defined(t),d=r.find($=>$.name===n.signals[f?"data":"visual"]),h=e.getSizeSignalRef(i).signal,p=e.getScaleComponent(l),y=p==null?void 0:p.get("type"),v=p==null?void 0:p.get("reverse"),b=f?l===Gt?v?"":"-":v?"-":"":"",E=`${s}.extent_${l}`,S=`${b}${o}.${l} / ${f?`${h}`:`span(${E})`}`,w=!f||!p?"panLinear":y==="log"?"panLog":y==="symlog"?"panSymlog":y==="pow"?"panPow":"panLinear",_=f?y==="pow"?`, ${p.get("exponent")??1}`:y==="symlog"?`, ${p.get("constant")??1}`:"":"",C=`${w}(${E}, ${S}${_})`;d.on.push({events:{signal:o},update:f?C:`clampRange(${C}, 0, ${h})`})}const vX="_zoom_anchor",bX="_zoom_delta",cCe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=mo.defined(t),a=i+bX,{x:s,y:o}=t.project.hasChannel,l=ct(e.scaleName(Gt)),f=ct(e.scaleName(In));let d=ch(t.zoom,"scope");return r||(d=d.map(h=>(h.markname=i+ld,h))),n.push({name:i+vX,on:[{events:d,update:r?`{${[l?`x: invert(${l}, x(unit))`:"",f?`y: invert(${f}, y(unit))`:""].filter(h=>h).join(", ")}}`:"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:d,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&vz(e,t,s,"width",n),o!==void 0&&vz(e,t,o,"height",n),n}};function vz(e,t,n,i,r){const a=t.name,s=n.channel,o=mo.defined(t),l=r.find(w=>w.name===n.signals[o?"data":"visual"]),f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(s),h=d==null?void 0:d.get("type"),p=o?j3(e,s):l.name,y=a+bX,v=`${a}${vX}.${s}`,b=!o||!d?"zoomLinear":h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear",E=o?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",S=`${b}(${p}, ${v}, ${y}${E})`;l.on.push({events:{signal:y},update:o?S:`clampRange(${S}, 0, ${f})`})}const _c="_store",Ao="_tuple",fCe="_modify",xX="vlSelectionResolve",C2=[B_e,G_e,O_e,gX,hX,mo,pX,oCe,lCe,cCe,dX];function dCe(e){let t=e.parent;for(;t&&!Cr(t);)t=t.parent;return t}function tc(e,{escape:t}={escape:!0}){let n=t?ct(e.name):e.name;const i=dCe(e);if(i){const{facet:r}=i;for(const a of Vr)r[a]&&(n+=` + '__facet_${a}_' + (facet[${ct(i.vgField(a))}])`)}return n}function c6(e){return mn(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function EX(e,t){(ft(t.select)||!t.select.on)&&delete e.events,(ft(t.select)||!t.select.clear)&&delete e.clear,(ft(t.select)||!t.select.toggle)&&delete e.toggle}function us(e){var t;return(t=e.events)==null?void 0:t.find(n=>"type"in n&&n.type==="timer")}function P3(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...P3(e.object)),t.push(...P3(e.property))),t)}function SX(e){return e.object.type==="MemberExpression"?SX(e.object):e.object.name==="datum"}function AX(e){const t=R2e(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&SX(i)&&n.add(P3(i).slice(1).join("."))}),n}class ph extends $t{constructor(n,i,r){super(n);ce(this,"model");ce(this,"filter");ce(this,"expr");ce(this,"_dependentFields");this.model=i,this.filter=r,this.expr=bb(this.model,this.filter,this),this._dependentFields=AX(this.expr)}clone(){return new ph(null,this.model,Ue(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function hCe(e,t){const n={},i=e.config.selection;if(!t||!t.length)return n;let r=0;for(const a of t){const s=qt(a.name),o=a.select,l=He(o)?o:o.type,f=dt(o)?Ue(o):{type:l},d=i[l];for(const y in d)y==="fields"||y==="encodings"||(y==="mark"&&(f.mark={...d.mark,...f.mark}),(f[y]===void 0||f[y]===!0)&&(f[y]=Ue(d[y]??f[y])));const h=n[s]={...f,name:s,type:l,init:a.value,bind:a.bind,events:He(f.on)?ch(f.on,"scope"):on(Ue(f.on))};if(us(h)&&(r++,r>1)){delete n[s];continue}const p=Ue(a);for(const y of C2)y.defined(h)&&y.parse&&y.parse(e,h,p)}return r>1&&ge(NEe),n}function wX(e,t,n,i="datum"){const r=He(t)?t:t.param,a=qt(r),s=ct(a+_c);let o;try{o=e.getSelectionComponent(a,r)}catch{return`!!${a}`}if(o.project.timeUnit){const p=n??e.component.data.raw,y=o.project.timeUnit.clone();p.parent?y.insertAsParentOf(p):p.parent=y}const l=o.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",f=o.resolve==="global"?")":`, ${ct(o.resolve)})`,d=`${l}${s}, ${i}${f}`,h=`length(data(${s}))`;return t.empty===!1?`${h} && ${d}`:`!${h} || ${d}`}function _X(e,t,n){const i=qt(t),r=n.encoding;let a=n.field,s;try{s=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!a)a=s.project.items[0].field,s.project.items.length>1&&ge(FEe(a));else if(r&&!a){const o=s.project.items.filter(l=>l.channel===r);!o.length||o.length>1?(a=s.project.items[0].field,ge(OEe(o,r,n,a))):a=o[0].field}return`${s.name}[${ct(ta(a))}]`}function gCe(e,t){for(const[n,i]of Uu(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Ki(new ph(t,e,{param:n}),r,Wt.Lookup,e.component.data.outputNodeRefCounts)}}function bb(e,t,n){return Cg(t,i=>He(i)?i:qSe(i)?wX(e,i,n):RY(i))}function pCe(e,t){if(e)return Se(e)&&!fu(e)?e.map(n=>Gk(n,t)).join(", "):e}function E_(e,t,n,i){var r,a;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(a=e.encode[t]).update??(a.update={}),e.encode[t].update[n]=i}function cg(e,t,n,i={header:!1}){var h,p;const{disable:r,orient:a,scale:s,labelExpr:o,title:l,zindex:f,...d}=e.combine();if(!r){for(const y in d){const v=y,b=VAe[v],E=d[v];if(b&&b!==t&&b!=="both")delete d[v];else if(am(E)){const{condition:S,...w}=E,_=on(S),C=Y9[v];if(C){const{vgProp:$,part:M}=C,T=[..._.map(F=>{const{test:R,...B}=F;return{test:bb(null,R),...B}}),w];E_(d,M,$,T),delete d[v]}else if(C===null){const $={signal:_.map(M=>{const{test:T,...F}=M;return`${bb(null,T)} ? ${M9(F)} : `}).join("")+M9(w)};d[v]=$}}else if(Ce(E)){const S=Y9[v];if(S){const{vgProp:w,part:_}=S;E_(d,_,w,E),delete d[v]}}et(["labelAlign","labelBaseline"],v)&&d[v]===null&&delete d[v]}if(t==="grid"){if(!d.grid)return;if(d.encode){const{grid:y}=d.encode;d.encode={...y?{grid:y}:{}},Rt(d.encode)&&delete d.encode}return{scale:s,orient:a,...d,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:un(f,0)}}else{if(!i.header&&e.mainExtracted)return;if(o!==void 0){let v=o;(p=(h=d.encode)==null?void 0:h.labels)!=null&&p.update&&Ce(d.encode.labels.update.text)&&(v=yc(o,"datum.label",d.encode.labels.update.text.signal)),E_(d,"labels","text",{signal:v})}if(d.labelAlign===null&&delete d.labelAlign,d.encode){for(const v of dV)e.hasAxisPart(v)||delete d.encode[v];Rt(d.encode)&&delete d.encode}const y=pCe(l,n);return{scale:s,orient:a,grid:!1,...y?{title:y}:{},...d,...n.aria===!1?{aria:!1}:{},zindex:un(f,0)}}}}function CX(e){const{axes:t}=e.component,n=[];for(const i of Mo)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const a=i==="x"?"height":"width",s=e.getSizeSignalRef(a).signal;a!==s&&n.push({name:a,update:s})}}return n}function mCe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>cg(r,"grid",t)),...i.map(r=>cg(r,"grid",t)),...n.map(r=>cg(r,"main",t)),...i.map(r=>cg(r,"main",t))].filter(r=>r)}function bz(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const a=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},o=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...fe(s),...fe(o)]),f={};for(const d of l.values())f[d]={signal:`${i.signal} === "${a}" ? ${xa(s[d])} : ${xa(o[d])}`};return f}return t[r]})])}function yCe(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:jY(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],a=e==="x"?"axisX":"axisY",s=Ce(n)?"axisOrient":`axis${Xp(n)}`,o=[...r,...r.map(f=>a+f.substr(4))],l=["axis",s,a];return{vlOnlyAxisConfig:bz(o,i,e,n),vgAxisConfig:bz(l,i,e,n),axisConfigStyle:vCe([...l,...o],i)}}function vCe(e,t){var i;const n=[{}];for(const r of e){let a=(i=t[r])==null?void 0:i.style;if(a){a=on(a);for(const s of a)n.push(t.style[s])}}return Object.assign.apply(null,n)}function I3(e,t,n,i={}){var a;const r=hY(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((a=i[s])==null?void 0:a[e])!==void 0)return{configFrom:s,configValue:i[s][e]};return{}}const xz={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??bCe(n,e),gridScale:({model:e,channel:t})=>xCe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||DX(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||$X(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??SCe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??ACe(t.type,n,pe(t)&&!!t.timeUnit,pe(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const a=e==="x"?"width":e==="y"?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return n.tickCount??_Ce({fieldOrDatumDef:i,scaleType:r,size:s,values:n.values})},tickMinStep:({axis:e,format:t,fieldOrDatumDef:n})=>e.tickMinStep??CCe({format:t,fieldOrDatumDef:n}),title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=TX(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),a=n==="x"?"x2":"y2",s=t.fieldDef(a);return pY(r?[H9(r)]:[],pe(s)?[H9(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>$Ce(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??DCe(n,t)};function bCe(e,t){return!Un(e)&&pe(t)&&!Bt(t==null?void 0:t.bin)&&!Yn(t==null?void 0:t.bin)}function xCe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function ECe(e,t,n,i,r){const a=t==null?void 0:t.labelAngle;if(a!==void 0)return Ce(a)?a:np(a);{const{configValue:s}=I3("labelAngle",i,t==null?void 0:t.style,r);return s!==void 0?np(s):n===Gt&&et([Fk,Nk],e.type)&&!(pe(e)&&e.timeUnit)?270:void 0}}function q3(e){return`(((${e.signal} % 360) + 360) % 360)`}function $X(e,t,n,i){if(e!==void 0)if(n==="x"){if(Ce(e)){const r=q3(e),a=Ce(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${a} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Ce(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Ce(e)){const r=q3(e),a=Ce(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${a} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(Ce(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function DX(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,a=i?"bottom":"left";if(Ce(e)){const s=q3(e),o=Ce(t)?`(${t.signal} === "${a}")`:t===a;return{signal:`(${r?`(${s} + 90)`:s} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${s} && ${s} < ${180+r}) === ${o} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(Ce(t)){const s=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${s} "${a}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===a)?"left":"right"}function SCe(e,t){if(t==="x"&&et(["quantitative","temporal"],e))return!0}function ACe(e,t,n,i){if(n&&!dt(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function wCe(e){return e==="x"?"bottom":"left"}function _Ce({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!Un(t)&&t!=="log"){if(pe(e)){if(Bt(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&et(["month","hours","day","quarter"],(r=jn(e.timeUnit))==null?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function CCe({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(pe(t)){const{timeUnit:n}=t;if(n){const i=NY(n);if(i)return{signal:i}}}}function TX(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),a=i?i.title:void 0,s=r?r.title:void 0;if(a&&s)return mY(a,s);if(a)return a;if(s)return s;if(a!==void 0)return a;if(s!==void 0)return s}function $Ce(e,t){const n=e.values;if(Se(n))return fV(t,n);if(Ce(n))return n}function DCe(e,t){return e==="rect"&&db(t)?1:0}class qd extends $t{constructor(n,i){super(n);ce(this,"transform");ce(this,"_dependentFields");this.transform=i,this._dependentFields=AX(this.transform.calculate)}clone(){return new qd(null,Ue(this.transform))}static parseAllForSortIndex(n,i){return i.forEachFieldDef((r,a)=>{if(Hc(r)&&tV(r.sort)){const{field:s,timeUnit:o}=r,l=r.sort,f=l.map((d,h)=>`${RY({field:s,timeUnit:o,equal:d})} ? ${h} : `).join("")+l.length;n=new qd(n,{calculate:f,as:Hd(r,a,{forAs:!0})})}}),n}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${rt(this.transform)}`}}function Hd(e,t,n){return ve(e,{prefix:t,suffix:"sort_index",...n})}function $2(e,t){return et(["top","bottom"],t)?"column":et(["left","right"],t)||e==="row"?"row":"column"}function Gd(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return un((t||{})[e],r[e],n.header[e])}function D2(e,t,n,i){const r={};for(const a of e){const s=Gd(a,t||{},n,i);s!==void 0&&(r[a]=s)}return r}const f6=["row","column"],d6=["header","footer"];function TCe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:a,titleAngle:s,titleOrient:o}=D2(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),l=$2(t,o),f=np(s);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...kX(f,l),...MX(l,f,a),...NX(i,r,t,pwe,MV)}}}function MX(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=DX(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function kX(e,t){const n=$X(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function MCe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of d6)if(n[r])for(const a of n[r]){const s=NCe(e,t,r,n,a);s!=null&&i.push(s)}return i}function kCe(e,t){const{sort:n}=e;return po(n)?{field:ve(n,{expr:"datum"}),order:n.order??"ascending"}:Se(n)?{field:Hd(e,t,{expr:"datum"}),order:"ascending"}:{field:ve(e,{expr:"datum"}),order:n??"ascending"}}function H3(e,t,n){const{format:i,formatType:r,labelAngle:a,labelAnchor:s,labelOrient:o,labelExpr:l}=D2(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),f=Pk({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,d=$2(t,o);return{text:{signal:l?yc(yc(l,"datum.label",f),"datum.value",ve(e,{expr:"parent"})):f},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...kX(a,d),...MX(d,a,s),...NX(n,e,t,mwe,kV)}}function NCe(e,t,n,i,r){if(r){let a=null;const{facetFieldDef:s}=i,o=e.config?e.config:void 0;if(s&&r.labels){const{labelOrient:h}=D2(["labelOrient"],s.header,o,t);(t==="row"&&!et(["top","bottom"],h)||t==="column"&&!et(["left","right"],h))&&(a=H3(s,t,o))}const l=Cr(e)&&!tm(e.facet),f=r.axes,d=(f==null?void 0:f.length)>0;if(a||d){const h=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:kCe(s,t)}:{},...d&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...a?{title:a}:{},...r.sizeSignal?{encode:{update:{[h]:r.sizeSignal}}}:{},...d?{axes:f}:{}}}}return null}const FCe={column:{start:0,end:1},row:{start:1,end:0}};function OCe(e,t){return FCe[t][e]}function RCe(e,t){const n={};for(const i of Vr){const r=e[i];if(r!=null&&r.facetFieldDef){const{titleAnchor:a,titleOrient:s}=D2(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),o=$2(i,s),l=OCe(a,o);l!==void 0&&(n[o]=l)}}return Rt(n)?void 0:n}function NX(e,t,n,i,r){const a={};for(const s of i){if(!r[s])continue;const o=Gd(s,t==null?void 0:t.header,e,n);o!==void 0&&(a[r[s]]=o)}return a}function h6(e){return[...ny(e,"width"),...ny(e,"height"),...ny(e,"childWidth"),...ny(e,"childHeight")]}function ny(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const a=e.getScaleComponent(n);if(a){const s=a.get("type"),o=a.get("range");if(Un(s)&&Pc(o)){const l=e.scaleName(n);return Cr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Ez(l,o)]:[Ez(l,o),{name:r,update:FX(l,a,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const a=r.endsWith("width"),s=a?"containerSize()[0]":"containerSize()[1]",o=F3(e.config.view,a?"width":"height"),l=`isFinite(${s}) ? ${s} : ${o}`;return[{name:r,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:r,value:i}]}function Ez(e,t){const n=`${e}_step`;return Ce(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function FX(e,t,n){const i=t.get("type"),r=t.get("padding"),a=un(t.get("paddingOuter"),r);let s=t.get("paddingInner");return s=i==="band"?s!==void 0?s:r:1,`bandspace(${n}, ${xa(s)}, ${xa(a)}) * ${e}_step`}function OX(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function RX(e,t){return fe(e).reduce((n,i)=>({...n,...gh({model:t,channelDef:e[i],vgChannel:i,mainRefFn:r=>Ut(r.value),invalidValueRef:void 0})}),{})}function zX(e,t){if(Cr(t))return e==="theta"?"independent":"shared";if(vh(t))return"shared";if(x6(t))return ln(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function g6(e,t){const n=e.scale[t],i=ln(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&ge(fSe(t)),"independent"):e[i][t]||"shared"}const zCe={...bwe,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},BX=fe(zCe);class BCe extends No{}const Sz={symbols:LCe,gradient:jCe,labels:UCe,entries:PCe};function LCe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:a}){if(a!=="symbol")return;const{markDef:s,encoding:o,config:l,mark:f}=n,d=s.filled&&f!=="trail";let h={...bEe({},n,pAe),...lX(n,{filled:d})};const p=r.get("symbolOpacity")??l.legend.symbolOpacity,y=r.get("symbolFillColor")??l.legend.symbolFillColor,v=r.get("symbolStrokeColor")??l.legend.symbolStrokeColor,b=p===void 0?LX(o.opacity)??s.opacity:void 0;if(h.fill){if(i==="fill"||d&&i===nr)delete h.fill;else if(de(h.fill,"field"))y?delete h.fill:(h.fill=Ut(l.legend.symbolBaseFillColor??"black"),h.fillOpacity=Ut(b??1));else if(Se(h.fill)){const E=G3(o.fill??o.color)??s.fill??(d&&s.color);E&&(h.fill=Ut(E))}}if(h.stroke){if(i==="stroke"||!d&&i===nr)delete h.stroke;else if(de(h.stroke,"field")||v)delete h.stroke;else if(Se(h.stroke)){const E=un(G3(o.stroke||o.color),s.stroke,d?s.color:void 0);E&&(h.stroke={value:E})}}if(i!==To){const E=pe(t)&&UX(n,r,t);E?h.opacity=[{test:E,...Ut(b??1)},Ut(l.legend.unselectedOpacity)]:b&&(h.opacity=Ut(b))}return h={...h,...e},Rt(h)?void 0:h}function jCe(e,{model:t,legendType:n,legendCmpt:i}){if(n!=="gradient")return;const{config:r,markDef:a,encoding:s}=t;let o={};const f=(i.get("gradientOpacity")??r.legend.gradientOpacity)===void 0?LX(s.opacity)||a.opacity:void 0;return f&&(o.opacity=Ut(f)),o={...o,...e},Rt(o)?void 0:o}function UCe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const a=n.legend(i)||{},s=n.config,o=pe(t)?UX(n,r,t):void 0,l=o?[{test:o,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:f,formatType:d}=a;let h;Ac(d)?h=Ea({fieldOrDatumDef:t,field:"datum.value",format:f,formatType:d,config:s}):f===void 0&&d===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?h=Ea({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&pe(t)&&t.timeUnit===void 0&&(h=Ea({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const p={...l?{opacity:l}:{},...h?{text:h}:{},...e};return Rt(p)?void 0:p}function PCe(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function LX(e){return jX(e,(t,n)=>Math.max(t,n.value))}function G3(e){return jX(e,(t,n)=>un(t,n.value))}function jX(e,t){if(RAe(e))return on(e.condition).reduce(t,e.value);if(Da(e))return e.value}function UX(e,t,n){const i=t.get("selections");if(!(i!=null&&i.length))return;const r=ct(n.field);return i.map(a=>`(!length(data(${ct(qt(a)+_c)})) || (${a}[${r}] && indexof(${a}[${r}], datum.value) >= 0))`).join(" || ")}const Az={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return KY(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return JY(i,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??XCe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??WCe(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??qCe(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>ud(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(od(n)&&is(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>ICe(t,e)};function ICe(e,t){const n=e.values;if(Se(n))return fV(t,n);if(Ce(n))return n}function qCe(e,t,n,i){if(t!=="shape"){const r=G3(n)??i;if(r)return r}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function HCe(e){const{legend:t}=e;return un(t.type,GCe(e))}function GCe({channel:e,timeUnit:t,scaleType:n}){if(od(e)){if(et(["quarter","month","day"],t))return"symbol";if(is(n))return"gradient"}return"symbol"}function YCe({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??VCe(n,t)}function VCe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function XCe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:s,gradientVerticalMaxLength:o,gradientVerticalMinLength:l}=e;if(is(r))return n==="horizontal"?i==="top"||i==="bottom"?wz(t,"width",s,a):s:wz(t,"height",l,o)}function wz(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function WCe(e){if(et(["quantile","threshold","log","symlog"],e))return"greedy"}function PX(e){const t=Xt(e)?QCe(e):e3e(e);return e.component.legends=t,t}function QCe(e){const{encoding:t}=e,n={};for(const i of[nr,...FV]){const r=An(t[i]);!r||!e.getScaleComponent(i)||i===ir&&pe(r)&&r.type===hh||(n[i]=JCe(e,i))}return n}function ZCe(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function KCe(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function JCe(e,t){var C;let n=e.legend(t);const{markDef:i,encoding:r,config:a}=e,s=a.legend,o=new BCe({},ZCe(e,t));uCe(e,t,o);const l=n!==void 0?!n:s.disable;if(o.set("disable",l,n!==void 0),l)return o;n=n||{};const f=e.getScaleComponent(t).get("type"),d=An(r[t]),h=pe(d)?(C=jn(d.timeUnit))==null?void 0:C.unit:void 0,p=n.orient||a.legend.orient||"right",y=HCe({legend:n,channel:t,timeUnit:h,scaleType:f}),v=YCe({legend:n,legendType:y,orient:p,legendConfig:s}),b={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:d,legendConfig:s,config:a,scaleType:f,orient:p,legendType:y,direction:v};for(const $ of BX){if(y==="gradient"&&$.startsWith("symbol")||y==="symbol"&&$.startsWith("gradient"))continue;const M=$ in Az?Az[$](b):n[$];if(M!==void 0){const T=KCe(M,$,n,e.fieldDef(t));(T||a.legend[$]===void 0)&&o.set($,M,T)}}const E=(n==null?void 0:n.encoding)??{},S=o.get("selections"),w={},_={fieldOrDatumDef:d,model:e,channel:t,legendCmpt:o,legendType:y};for(const $ of["labels","legend","title","symbols","gradient","entries"]){const M=RX(E[$]??{},e),T=$ in Sz?Sz[$](M,_):M;T!==void 0&&!Rt(T)&&(w[$]={...S!=null&&S.length&&pe(d)?{name:`${qt(d.field)}_legend_${$}`}:{},...S!=null&&S.length?{interactive:!!S}:{},update:T})}return Rt(w)||o.set("encode",w,!!(n!=null&&n.encoding)),o}function e3e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){PX(i);for(const r of fe(i.component.legends))n.legend[r]=g6(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=IX(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of fe(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function IX(e,t){var a,s,o,l;if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const f of BX){const d=qu(e.getWithExplicit(f),t.getWithExplicit(f),f,"legend",(h,p)=>{switch(f){case"symbolType":return t3e(h,p);case"title":return yY(h,p);case"type":return r=!0,mr("symbol")}return S2(h,p,f,"legend")});e.setWithExplicit(f,d)}return r&&((s=(a=e.implicit)==null?void 0:a.encode)!=null&&s.gradient&&ob(e.implicit,["encode","gradient"]),(l=(o=e.explicit)==null?void 0:o.encode)!=null&&l.gradient&&ob(e.explicit,["encode","gradient"])),e}function t3e(e,t){return t.value==="circle"?t:e}function n3e(e,t,n,i){var r,a;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(a=e.encode[t]).update??(a.update={}),e.encode[t].update[n]=i}function qX(e){const t=e.component.legends,n={};for(const r of fe(t)){const a=e.getScaleComponent(r),s=Et(a.get("domains"));if(n[s])for(const o of n[s])IX(o,t[r])||n[s].push(t[r]);else n[s]=[t[r].clone()]}return mn(n).flat().map(r=>i3e(r,e.config)).filter(r=>r!==void 0)}function i3e(e,t){var s,o,l;const{disable:n,labelExpr:i,selections:r,...a}=e.combine();if(!n){if(t.aria===!1&&a.aria==null&&(a.aria=!1),(s=a.encode)!=null&&s.symbols){const f=a.encode.symbols.update;f.fill&&f.fill.value!=="transparent"&&!f.stroke&&!a.stroke&&(f.stroke={value:"transparent"});for(const d of FV)a[d]&&delete f[d]}if(a.title||delete a.title,i!==void 0){let f=i;(l=(o=a.encode)==null?void 0:o.labels)!=null&&l.update&&Ce(a.encode.labels.update.text)&&(f=yc(i,"datum.label",a.encode.labels.update.text.signal)),n3e(a,"labels","text",{signal:f})}return a}}function r3e(e){return vh(e)||x6(e)?a3e(e):HX(e)}function a3e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),HX(e))}function HX(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},a=t.data.reduce((s,o)=>{const l=Ce(o)?o.signal:`data('${e.lookupDataSource(o)}')`;return et(s,l)||s.push(l),s},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]},...n}]}else return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}]}const s3e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class GX extends No{constructor(n,i,r,a){super({...i},{name:n});ce(this,"specifiedProjection");ce(this,"size");ce(this,"data");ce(this,"merged",!1);this.specifiedProjection=i,this.size=r,this.data=a}get isFit(){return!!this.data}}function YX(e){e.component.projection=Xt(e)?o3e(e):c3e(e)}function o3e(e){if(e.hasProjection){const t=Vn(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?u3e(e):void 0,a=new GX(e.projectionName(!0),{...Vn(e.config.projection),...t},i,r);return a.get("type")||a.set("type","equalEarth",!1),a}}function u3e(e){const t=[],{encoding:n}=e;for(const i of[[Ua,ja],[na,Pa]])(An(n[i[0]])||An(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(ir)&&e.typedFieldDef(ir).type===hh&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Wt.Main)),t}function l3e(e,t){const n=ak(s3e,r=>!!(!pn(e.explicit,r)&&!pn(t.explicit,r)||pn(e.explicit,r)&&pn(t.explicit,r)&&Sr(e.get(r),t.get(r))));if(Sr(e.size,t.size)){if(n)return e;if(Sr(e.explicit,{}))return t;if(Sr(t.explicit,{}))return e}return null}function c3e(e){if(e.children.length===0)return;let t;for(const i of e.children)YX(i);const n=ak(e.children,i=>{const r=i.component.projection;if(r)if(t){const a=l3e(t,r);return a&&(t=a),!!a}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new GX(i,t.specifiedProjection,t.size,Ue(t.data));for(const a of e.children){const s=a.component.projection;s&&(s.isFit&&r.data.push(...a.component.projection.data),a.renameProjection(s.get("name"),i),s.merged=!0)}return r}}function f3e(e,t,n,i){if(rm(t,n)){const r=Xt(e)?e.axis(n)??e.legend(n)??{}:{},a=ve(t,{expr:"datum"}),s=ve(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ve(t,{binSuffix:"range",forAs:!0}),formula:em(a,s,r.format,r.formatType,i)}}return{}}function VX(e,t){return`${lY(e)}_${t}`}function d3e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function p6(e,t,n){const i=m2(n,void 0)??{},r=VX(i,t);return e.getName(`${r}_bins`)}function h3e(e){return"as"in e}function _z(e,t,n){let i,r;h3e(e)?i=He(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[ve(e,{forAs:!0}),ve(e,{binSuffix:"end",forAs:!0})];const a={...m2(t,void 0)},s=VX(a,e.field),{signal:o,extentSignal:l}=d3e(n,s);if(a2(a.extent)){const d=a.extent;r=_X(n,d.param,d),delete a.extent}const f={bin:a,field:e.field,as:[i],...o?{signal:o}:{},...l?{extentSignal:l}:{},...r?{span:r}:{}};return{key:s,binComponent:f}}class ls extends $t{constructor(n,i){super(n);ce(this,"bins");this.bins=i}clone(){return new ls(null,Ue(this.bins))}static makeFromEncoding(n,i){const r=i.reduceFieldDef((a,s,o)=>{if(zi(s)&&Bt(s.bin)){const{key:l,binComponent:f}=_z(s,s.bin,i);a[l]={...f,...a[l],...f3e(i,s,o,i.config)}}return a},{});return Rt(r)?null:new ls(n,r)}static makeFromTransform(n,i,r){const{key:a,binComponent:s}=_z(i,i.bin,r);return new ls(n,{[a]:s})}merge(n,i){for(const r of fe(n.bins))r in this.bins?(i(n.bins[r].signal,this.bins[r].signal),this.bins[r].as=ns([...this.bins[r].as,...n.bins[r].as],rt)):this.bins[r]=n.bins[r];for(const r of n.children)n.removeChild(r),r.parent=this;n.remove()}producedFields(){return new Set(mn(this.bins).map(n=>n.as).flat(2))}dependentFields(){return new Set(mn(this.bins).map(n=>n.field))}hash(){return`Bin ${rt(this.bins)}`}assemble(){return mn(this.bins).flatMap(n=>{const i=[],[r,...a]=n.as,{extent:s,...o}=n.bin,l={type:"bin",field:ta(n.field),as:r,signal:n.signal,...a2(s)?{extent:null}:{extent:s},...n.span?{span:{signal:`span(${n.span})`}}:{},...o};!s&&n.extentSignal&&(i.push({type:"extent",field:ta(n.field),signal:n.extentSignal}),l.extent={signal:n.extentSignal}),i.push(l);for(const f of a)for(let d=0;d<2;d++)i.push({type:"formula",expr:ve({field:r[d]},{expr:"datum"}),as:f[d]});return n.formula&&i.push({type:"formula",expr:n.formula,as:n.formulaAs}),i})}}function g3e(e,t,n,i){var a;const r=Xt(i)?i.encoding[Ts(t)]:void 0;if(zi(n)&&Xt(i)&&iV(n,r,i.markDef,i.config)){e.add(ve(n,{})),e.add(ve(n,{suffix:"end"}));const{mark:s,markDef:o,config:l}=i,f=Iu({fieldDef:n,markDef:o,config:l});ip(s)&&f!==.5&&ln(t)&&(e.add(ve(n,{suffix:A2})),e.add(ve(n,{suffix:w2}))),n.bin&&rm(n,t)&&e.add(ve(n,{binSuffix:"range"}))}else if(eY(t)){const s=JG(t);e.add(i.getName(s))}else e.add(ve(n));return Hc(n)&&nAe((a=n.scale)==null?void 0:a.range)&&e.add(n.scale.range.field),e}function p3e(e,t){for(const n of fe(t)){const i=t[n];for(const r of fe(i))n in e?e[n][r]=new Set([...e[n][r]??[],...i[r]]):e[n]={[r]:i[r]}}}class Aa extends $t{constructor(n,i,r){super(n);ce(this,"dimensions");ce(this,"measures");this.dimensions=i,this.measures=r}clone(){return new Aa(null,new Set(this.dimensions),Ue(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(n,i){let r=!1;i.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const a={},s=new Set;return!r||(i.forEachFieldDef((o,l)=>{const{aggregate:f,field:d}=o;if(f)if(f==="count")a["*"]??(a["*"]={}),a["*"].count=new Set([ve(o,{forAs:!0})]);else{if(Eo(f)||il(f)){const h=Eo(f)?"argmin":"argmax",p=f[h];a[p]??(a[p]={}),a[p][h]=new Set([ve({op:h,field:p},{forAs:!0})])}else a[d]??(a[d]={}),a[d][f]=new Set([ve(o,{forAs:!0})]);Ms(l)&&i.scaleDomain(l)==="unaggregated"&&(a[d]??(a[d]={}),a[d].min=new Set([ve({field:d,aggregate:"min"},{forAs:!0})]),a[d].max=new Set([ve({field:d,aggregate:"max"},{forAs:!0})]))}else g3e(s,l,o,i)}),s.size+fe(a).length===0)?null:new Aa(n,s,a)}static makeFromTransform(n,i){var s;const r=new Set,a={};for(const o of i.aggregate){const{op:l,field:f,as:d}=o;l&&(l==="count"?(a["*"]??(a["*"]={}),a["*"].count=new Set([d||ve(o,{forAs:!0})])):(a[f]??(a[f]={}),(s=a[f])[l]??(s[l]=new Set),a[f][l].add(d||ve(o,{forAs:!0}))))}for(const o of i.groupby??[])r.add(o);return r.size+fe(a).length===0?null:new Aa(n,r,a)}merge(n){return GG(this.dimensions,n.dimensions)?(p3e(this.measures,n.measures),!0):($Se("different dimensions, cannot merge"),!1)}addDimensions(n){n.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...fe(this.measures)])}producedFields(){const n=new Set;for(const i of fe(this.measures))for(const r of fe(this.measures[i])){const a=this.measures[i][r];a.size===0?n.add(`${r}_${i}`):a.forEach(n.add,n)}return n}hash(){return`Aggregate ${rt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const n=[],i=[],r=[];for(const s of fe(this.measures))for(const o of fe(this.measures[s]))for(const l of this.measures[s][o])r.push(l),n.push(o),i.push(s==="*"?null:ta(s));return{type:"aggregate",groupby:[...this.dimensions].map(ta),ops:n,fields:i,as:r}}}class mh extends $t{constructor(n,i,r,a){super(n);ce(this,"model");ce(this,"name");ce(this,"data");ce(this,"column");ce(this,"row");ce(this,"facet");ce(this,"childModel");this.model=i,this.name=r,this.data=a;for(const s of Vr){const o=i.facet[s];if(o){const{bin:l,sort:f}=o;this[s]={name:i.getName(`${s}_domain`),fields:[ve(o),...Bt(l)?[ve(o,{binSuffix:"end"})]:[]],...po(f)?{sortField:f}:Se(f)?{sortIndexField:Hd(o,s)}:{}}}}this.childModel=i.child}hash(){let n="Facet";for(const i of Vr)this[i]&&(n+=` ${i.charAt(0)}:${rt(this[i])}`);return n}get fields(){var i;const n=[];for(const r of Vr)(i=this[r])!=null&&i.fields&&n.push(...this[r].fields);return n}dependentFields(){const n=new Set(this.fields);for(const i of Vr)this[i]&&(this[i].sortField&&n.add(this[i].sortField.field),this[i].sortIndexField&&n.add(this[i].sortIndexField));return n}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const n={};for(const i of Mo){const r=this.childModel.component.scales[i];if(r&&!r.merged){const a=r.get("type"),s=r.get("range");if(Un(a)&&Pc(s)){const o=T2(this.childModel,i),l=b6(o);l?n[i]=l:ge(bk(i))}}}return n}assembleRowColumnHeaderData(n,i,r){const a={row:"y",column:"x",facet:void 0}[n],s=[],o=[],l=[];a&&r&&r[a]&&(i?(s.push(`distinct_${r[a]}`),o.push("max")):(s.push(r[a]),o.push("distinct")),l.push(`distinct_${r[a]}`));const{sortField:f,sortIndexField:d}=this[n];if(f){const{op:h=h2,field:p}=f;s.push(p),o.push(h),l.push(ve(f,{forAs:!0}))}else d&&(s.push(d),o.push("max"),l.push(d));return{name:this[n].name,source:i??this.data,transform:[{type:"aggregate",groupby:this[n].fields,...s.length?{fields:s,ops:o,as:l}:{}}]}}assembleFacetHeaderData(n){var f,d;const{columns:i}=this.model.layout,{layoutHeaders:r}=this.model.component,a=[],s={};for(const h of f6){for(const p of d6){const y=((f=r[h])==null?void 0:f[p])??[];for(const v of y)if(((d=v.axes)==null?void 0:d.length)>0){s[h]=!0;break}}if(s[h]){const p=`length(data("${this.facet.name}"))`,y=h==="row"?i?{signal:`ceil(${p} / ${i})`}:1:i?{signal:`min(${p}, ${i})`}:{signal:p};a.push({name:`${this.facet.name}_${h}`,transform:[{type:"sequence",start:0,stop:y}]})}}const{row:o,column:l}=s;return(o||l)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,n)),a}assemble(){const n=[];let i=null;const r=this.getChildIndependentFieldsWithStep(),{column:a,row:s,facet:o}=this;if(a&&s&&(r.x||r.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat(r.x??[],r.y??[]),f=l.map(()=>"distinct");n.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:f}]})}for(const l of[go,ho])this[l]&&n.push(this.assembleRowColumnHeaderData(l,i,r));if(o){const l=this.assembleFacetHeaderData(r);l&&n.push(...l)}return n}}function Cz(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function m3e(e,t){const n=uk(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=Cz(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=Cz(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return ge(zEe(t)),null}function y3e(e){const t={};return By(e.filter,n=>{if(OY(n)){let i=null;_k(n)?i=br(n.equal):$k(n)?i=br(n.lte):Ck(n)?i=br(n.lt):Dk(n)?i=br(n.gt):Tk(n)?i=br(n.gte):Mk(n)?i=n.range[0]:kk(n)&&(i=(n.oneOf??n.in)[0]),i&&(Ic(i)?t[n.field]="date":Ht(i)?t[n.field]="number":He(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function v3e(e){const t={};function n(i){Ud(i)?t[i.field]="date":i.type==="quantitative"&&lEe(i.aggregate)?t[i.field]="number":Od(i.field)>1?i.field in t||(t[i.field]="flatten"):Hc(i)&&po(i.sort)&&Od(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((Xt(e)||Cr(e))&&e.forEachFieldDef((i,r)=>{if(zi(i))n(i);else{const a=jc(r),s=e.fieldDef(a);n({...i,type:s.type})}}),Xt(e)){const{mark:i,markDef:r,encoding:a}=e;if(rl(i)&&!e.encoding.order){const s=r.orient==="horizontal"?"y":"x",o=a[s];pe(o)&&o.type==="quantitative"&&!(o.field in t)&&(t[o.field]="number")}}return t}function b3e(e){const t={};if(Xt(e)&&e.component.selection)for(const n of fe(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Od(r.field)>1&&(t[r.field]="flatten")}return t}class di extends $t{constructor(n,i){super(n);ce(this,"_parse");this._parse=i}clone(){return new di(null,Ue(this._parse))}hash(){return`Parse ${rt(this._parse)}`}static makeExplicit(n,i,r){var o;let a={};const s=i.data;return!Du(s)&&((o=s==null?void 0:s.format)!=null&&o.parse)&&(a=s.format.parse),this.makeWithAncestors(n,a,{},r)}static makeWithAncestors(n,i,r,a){for(const l of fe(r)){const f=a.getWithExplicit(l);f.value!==void 0&&(f.explicit||f.value===r[l]||f.value==="derived"||r[l]==="flatten"?delete r[l]:ge(z9(l,r[l],f.value)))}for(const l of fe(i)){const f=a.get(l);f!==void 0&&(f===i[l]?delete i[l]:ge(z9(l,i[l],f)))}const s=new No(i,r);a.copyAll(s);const o={};for(const l of fe(s.combine())){const f=s.get(l);f!==null&&(o[l]=f)}return fe(o).length===0||a.parseNothing?null:new di(n,o)}get parse(){return this._parse}merge(n){this._parse={...this._parse,...n.parse},n.remove()}assembleFormatParse(){const n={};for(const i of fe(this._parse)){const r=this._parse[i];Od(i)===1&&(n[i]=r)}return n}producedFields(){return new Set(fe(this._parse))}dependentFields(){return new Set(fe(this._parse))}assembleTransforms(n=!1){return fe(this._parse).filter(i=>n?Od(i)>1:!0).map(i=>{const r=m3e(i,this._parse[i]);return r?{type:"formula",expr:r,as:fh(i)}:null}).filter(i=>i!==null)}}class Hu extends $t{clone(){return new Hu(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ma])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ma}}}class om extends $t{constructor(n,i){super(n);ce(this,"params");this.params=i}clone(){return new om(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${rt(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class um extends $t{constructor(n,i){super(n);ce(this,"params");this.params=i}clone(){return new um(null,this.params)}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${rt(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Cc extends $t{constructor(n){super(null);ce(this,"_data");ce(this,"_name");ce(this,"_generator");n??(n={name:"source"});let i;if(Du(n)||(i=n.format?{..._r(n.format,["parse"])}:{}),rp(n))this._data={values:n.values};else if(Pd(n)){if(this._data={url:n.url},!i.type){let r=/(?:\.([^.]+))?$/.exec(n.url)[1];et(["json","csv","tsv","dsv","topojson"],r)||(r="json"),i.type=r}}else ZV(n)?this._data={values:[{type:"Sphere"}]}:(WV(n)||Du(n))&&(this._data={});this._generator=Du(n),n.name&&(this._name=n.name),i&&!Rt(i)&&(this._data.format=i)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(n){this._name=n}set parent(n){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}function m6(e){return e instanceof Cc||e instanceof om||e instanceof um}var fd;class y6{constructor(){wF(this,fd);KS(this,fd,!1)}setModified(){KS(this,fd,!0)}get modifiedFlag(){return AF(this,fd)}}fd=new WeakMap;class Gc extends y6{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,a)=>a[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class v6 extends y6{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class x3e extends v6{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of fe(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class E3e extends v6{constructor(n){super();ce(this,"requiresSelectionId");this.requiresSelectionId=n&&c6(n)}run(n){n instanceof Hu&&(this.requiresSelectionId&&(m6(n.parent)||n.parent instanceof Aa||n.parent instanceof di)||(this.setModified(),n.remove()))}}class S3e extends y6{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof os&&(i=t.producedFields(),sk(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class A3e extends v6{constructor(){super()}run(t){t instanceof Ki&&!t.isRequired()&&(this.setModified(),t.remove())}}class w3e extends Gc{run(t){if(!m6(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof di)if(t instanceof di)this.setModified(),t.merge(n);else{if(ok(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class _3e extends Gc{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof di);if(t.numChildren()>1&&i.length>=1){const r={},a=new Set;for(const s of i){const o=s.parse;for(const l of fe(o))l in r?r[l]!==o[l]&&a.add(l):r[l]=o[l]}for(const s of a)delete r[s];if(!Rt(r)){this.setModified();const s=new di(t,r);for(const o of n){if(o instanceof di)for(const l of fe(r))delete o.parse[l];t.removeChild(o),o.parent=s,o instanceof di&&fe(o.parse).length===0&&o.remove()}}}}}class C3e extends Gc{run(t){t instanceof Ki||t.numChildren()>0||t instanceof mh||t instanceof Cc||(this.setModified(),t.remove())}}class $3e extends Gc{run(t){const n=t.children.filter(r=>r instanceof os),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class D3e extends Gc{run(t){const n=t.children.filter(r=>r instanceof Aa),i={};for(const r of n){const a=rt(r.groupBy);a in i||(i[a]=[]),i[a].push(r)}for(const r of fe(i)){const a=i[r];if(a.length>1){const s=a.pop();for(const o of a)s.merge(o)&&(t.removeChild(o),o.parent=s,o.remove(),this.setModified())}}}}class T3e extends Gc{constructor(n){super();ce(this,"model");this.model=n}run(n){const i=!(m6(n)||n instanceof ph||n instanceof di||n instanceof Hu),r=[],a=[];for(const s of n.children)s instanceof ls&&(i&&!ok(n.producedFields(),s.dependentFields())?r.push(s):a.push(s));if(r.length>0){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),n instanceof ls?n.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(a.length>1){const s=a.pop();for(const o of a)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class M3e extends Gc{run(t){const n=[...t.children];if(!Fd(n,s=>s instanceof Ki)||t.numChildren()<=1)return;const r=[];let a;for(const s of n)if(s instanceof Ki){let o=s;for(;o.numChildren()===1;){const[l]=o.children;if(l instanceof Ki)o=l;else break}r.push(...o.children),a?(t.removeChild(s),s.parent=a.parent,a.parent.removeChild(a),a.parent=o,this.setModified()):a=o}else r.push(s);if(r.length){this.setModified();for(const s of r)s.parent.removeChild(s),s.parent=a}}}class Yc extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i}clone(){return new Yc(null,Ue(this.transform))}addDimensions(n){this.transform.groupby=ns(this.transform.groupby.concat(n),i=>i)}dependentFields(){const n=new Set;return this.transform.groupby&&this.transform.groupby.forEach(n.add,n),this.transform.joinaggregate.map(i=>i.field).filter(i=>i!==void 0).forEach(n.add,n),n}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(n){return n.as??ve(n)}hash(){return`JoinAggregateTransform ${rt(this.transform)}`}assemble(){const n=[],i=[],r=[];for(const s of this.transform.joinaggregate)i.push(s.op),r.push(this.getDefaultName(s)),n.push(s.field===void 0?null:s.field);const a=this.transform.groupby;return{type:"joinaggregate",as:r,ops:i,fields:n,...a!==void 0?{groupby:a}:{}}}}class Yd extends $t{constructor(n,i){super(n);ce(this,"filter");this.filter=i}clone(){return new Yd(null,{...this.filter})}static make(n,i,r){const{config:a,markDef:s}=i,{marks:o,scales:l}=r;if(o==="include-invalid-values"&&l==="include-invalid-values")return null;const f=i.reduceFieldDef((d,h,p)=>{const y=Ms(p)&&i.getScaleComponent(p);if(y){const v=y.get("type"),{aggregate:b}=h,E=Lk({scaleChannel:p,markDef:s,config:a,scaleType:v,isCountAggregate:r2(b)});E!=="show"&&E!=="always-valid"&&(d[h.field]=h)}return d},{});return fe(f).length?new Yd(n,f):null}dependentFields(){return new Set(fe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${rt(this.filter)}`}assemble(){const n=fe(this.filter).reduce((i,r)=>{const a=this.filter[r],s=ve(a,{expr:"datum"});return a!==null&&(a.type==="temporal"?i.push(`(isDate(${s}) || (${Y3(s)}))`):a.type==="quantitative"&&i.push(Y3(s))),i},[]);return n.length>0?{type:"filter",expr:n.join(" && ")}:null}}function Y3(e){return`isValid(${e}) && isFinite(+${e})`}function k3e(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=ve(i);return r&&t.push(r),t},[])}function N3e(e){return Se(e)&&e.every(t=>He(t))&&e.length>1}class yo extends $t{constructor(n,i){super(n);ce(this,"_stack");this._stack=i}clone(){return new yo(null,Ue(this._stack))}static makeFromTransform(n,i){const{stack:r,groupby:a,as:s,offset:o="zero"}=i,l=[],f=[];if(i.sort!==void 0)for(const p of i.sort)l.push(p.field),f.push(un(p.order,"ascending"));const d={field:l,order:f};let h;return N3e(s)?h=s:He(s)?h=[s,`${s}_end`]:h=[`${i.stack}_start`,`${i.stack}_end`],new yo(n,{dimensionFieldDefs:[],stackField:r,groupby:a,offset:o,sort:d,facetby:[],as:h})}static makeFromEncoding(n,i){const r=i.stack,{encoding:a}=i;if(!r)return null;const{groupbyChannels:s,fieldChannel:o,offset:l,impute:f}=r,d=s.map(v=>{const b=a[v];return Ta(b)}).filter(v=>!!v),h=k3e(i),p=i.encoding.order;let y;if(Se(p)||pe(p))y=gY(p);else{const v=rV(p)?p.sort:o==="y"?"descending":"ascending";y=h.reduce((b,E)=>(b.field.includes(E)||(b.field.push(E),b.order.push(v)),b),{field:[],order:[]})}return new yo(n,{dimensionFieldDefs:d,stackField:i.vgField(o),facetby:[],stackby:h,sort:y,offset:l,impute:f,as:[i.vgField(o,{suffix:"start",forAs:!0}),i.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(n){this._stack.facetby.push(...n)}dependentFields(){const n=new Set;return n.add(this._stack.stackField),this.getGroupbyFields().forEach(n.add,n),this._stack.facetby.forEach(n.add,n),this._stack.sort.field.forEach(n.add,n),n}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${rt(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:n,impute:i,groupby:r}=this._stack;return n.length>0?n.map(a=>a.bin?i?[ve(a,{binSuffix:"mid"})]:[ve(a,{}),ve(a,{binSuffix:"end"})]:[ve(a)]).flat():r??[]}assemble(){const n=[],{facetby:i,dimensionFieldDefs:r,stackField:a,stackby:s,sort:o,offset:l,impute:f,as:d}=this._stack;if(f)for(const h of r){const{bandPosition:p=.5,bin:y}=h;if(y){const v=ve(h,{expr:"datum"}),b=ve(h,{expr:"datum",binSuffix:"end"});n.push({type:"formula",expr:`${Y3(v)} ? ${p}*${v}+${1-p}*${b} : ${v}`,as:ve(h,{binSuffix:"mid",forAs:!0})})}n.push({type:"impute",field:a,groupby:[...s,...i],key:ve(h,{binSuffix:"mid"}),method:"value",value:0})}return n.push({type:"stack",groupby:[...this.getGroupbyFields(),...i],field:a,sort:o,as:d,offset:l}),n}}class yh extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i}clone(){return new yh(null,Ue(this.transform))}addDimensions(n){this.transform.groupby=ns(this.transform.groupby.concat(n),i=>i)}dependentFields(){const n=new Set;return(this.transform.groupby??[]).forEach(n.add,n),(this.transform.sort??[]).forEach(i=>n.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(n){return n.as??ve(n)}hash(){return`WindowTransform ${rt(this.transform)}`}assemble(){const n=[],i=[],r=[],a=[];for(const p of this.transform.window)i.push(p.op),r.push(this.getDefaultName(p)),a.push(p.param===void 0?null:p.param),n.push(p.field===void 0?null:p.field);const s=this.transform.frame,o=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&i.every(p=>yk(p)))return{type:"joinaggregate",as:r,ops:i,fields:n,...o!==void 0?{groupby:o}:{}};const l=[],f=[];if(this.transform.sort!==void 0)for(const p of this.transform.sort)l.push(p.field),f.push(p.order??"ascending");const d={field:l,order:f},h=this.transform.ignorePeers;return{type:"window",params:a,as:r,ops:i,fields:n,sort:d,...h!==void 0?{ignorePeers:h}:{},...o!==void 0?{groupby:o}:{},...s!==void 0?{frame:s}:{}}}}function F3e(e){function t(n){if(!(n instanceof mh)){const i=n.clone();if(i instanceof Ki){const r=X3+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Aa||i instanceof yo||i instanceof yh||i instanceof Yc)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function V3(e){if(e instanceof mh)if(e.numChildren()===1&&!(e.children[0]instanceof Ki)){const t=e.children[0];(t instanceof Aa||t instanceof yo||t instanceof yh||t instanceof Yc)&&t.addDimensions(e.fields),t.swapWithParent(),V3(e)}else{const t=e.model.component.data.main;XX(t);const n=F3e(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(V3)}function XX(e){if(e instanceof Ki&&e.type===Wt.Main&&e.numChildren()===1){const t=e.children[0];t instanceof mh||(t.swapWithParent(),XX(e))}}const X3="scale_",iy=5;function W3(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!W3(t.children))return!1}return!0}function la(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function $z(e,t,n){let i=e.sources,r=!1;return r=la(new A3e,i)||r,r=la(new E3e(t),i)||r,i=i.filter(a=>a.numChildren()>0),r=la(new C3e,i)||r,i=i.filter(a=>a.numChildren()>0),n||(r=la(new w3e,i)||r,r=la(new T3e(t),i)||r,r=la(new S3e,i)||r,r=la(new _3e,i)||r,r=la(new D3e,i)||r,r=la(new $3e,i)||r,r=la(new x3e,i)||r,r=la(new M3e,i)||r),e.sources=i,r}function O3e(e,t){W3(e.sources);let n=0,i=0;for(let r=0;r<iy&&$z(e,t,!0);r++)n++;e.sources.map(V3);for(let r=0;r<iy&&$z(e,t,!1);r++)i++;W3(e.sources),Math.max(n,i)===iy&&ge(`Maximum optimization runs(${iy}) reached.`)}class Nn{constructor(t){ce(this,"signal");Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Nn(()=>t(n))}}function WX(e){Xt(e)?R3e(e):z3e(e)}function R3e(e){const t=e.component.scales;for(const n of fe(t)){const i=L3e(e,n);if(t[n].setWithExplicit("domains",i),U3e(e,n),e.component.data.isFaceted){let a=e;for(;!Cr(a)&&a.parent;)a=a.parent;if(a.component.resolve.scale[n]==="shared")for(const o of i.value)uo(o)&&(o.data=X3+o.data.replace(X3,""))}}}function z3e(e){for(const n of e.children)WX(n);const t=e.component.scales;for(const n of fe(t)){let i,r=null;for(const a of e.children){const s=a.component.scales[n];if(s){i===void 0?i=s.getWithExplicit("domains"):i=qu(i,s.getWithExplicit("domains"),"domains","scale",Q3);const o=s.get("selectionExtent");r&&o&&r.param!==o.param&&ge(TEe),r=o}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function B3e(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:a}=Dz(t,n);if(!r){ge(a);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=Dz(t,n);if(r)return"unaggregated"}return e}function L3e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=B3e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),t==="x"&&An(i.x2)?An(i.x)?qu(su(n,r,e,"x"),su(n,r,e,"x2"),"domain","scale",Q3):su(n,r,e,"x2"):t==="y"&&An(i.y2)?An(i.y)?qu(su(n,r,e,"y"),su(n,r,e,"y2"),"domain","scale",Q3):su(n,r,e,"y2"):su(n,r,e,t)}function j3e(e,t,n){return e.map(i=>({signal:`{data: ${y2(i,{timeUnit:n,type:t})}}`}))}function S_(e,t,n){var r;const i=(r=jn(n))==null?void 0:r.unit;return t==="temporal"||i?j3e(e,t,i):[e]}function su(e,t,n,i){const{encoding:r,markDef:a,mark:s,config:o,stack:l}=n,f=An(r[i]),{type:d}=f,h=f.timeUnit,p=N_e({invalid:ms("invalid",a,o),isPath:rl(s)});if(tAe(t)){const b=su(e,void 0,n,i),E=S_(t.unionWith,d,h);return Za([...E,...b.value])}else{if(Ce(t))return Za([t]);if(t&&t!=="unaggregated"&&!PY(t))return Za(S_(t,d,h))}if(l&&i===l.fieldChannel){if(l.offset==="normalize")return mr([[0,1]]);const b=n.requestDataName(p);return mr([{data:b,field:n.vgField(i,{suffix:"start"})},{data:b,field:n.vgField(i,{suffix:"end"})}])}const y=Ms(i)&&pe(f)?P3e(n,i,e):void 0;if(ks(f)){const b=S_([f.datum],d,h);return mr(b)}const v=f;if(t==="unaggregated"){const{field:b}=f;return mr([{data:n.requestDataName(p),field:ve({field:b,aggregate:"min"})},{data:n.requestDataName(p),field:ve({field:b,aggregate:"max"})}])}else if(Bt(v.bin)){if(Un(e))return mr(e==="bin-ordinal"?[]:[{data:tp(y)?n.requestDataName(p):n.requestDataName(Wt.Raw),field:n.vgField(i,rm(v,i)?{binSuffix:"range"}:{}),sort:y===!0||!dt(y)?{field:n.vgField(i,{}),op:"min"}:y}]);{const{bin:b}=v;if(Bt(b)){const E=p6(n,v.field,b);return mr([new Nn(()=>{const S=n.getSignalName(E);return`[${S}.start, ${S}.stop]`})])}else return mr([{data:n.requestDataName(p),field:n.vgField(i,{})}])}}else if(v.timeUnit&&et(["time","utc"],e)){const b=r[Ts(i)];if(iV(v,b,a,o)){const E=n.requestDataName(p),S=Iu({fieldDef:v,fieldDef2:b,markDef:a,config:o}),w=ip(s)&&S!==.5&&ln(i);return mr([{data:E,field:n.vgField(i,w?{suffix:A2}:{})},{data:E,field:n.vgField(i,{suffix:w?w2:"end"})}])}}return mr(y?[{data:tp(y)?n.requestDataName(p):n.requestDataName(Wt.Raw),field:n.vgField(i),sort:y}]:[{data:n.requestDataName(p),field:n.vgField(i)}])}function A_(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":h2),...i?{field:ta(i)}:{},...r?{order:r}:{}}}function U3e(e,t){var o;const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=(o=e.fieldDef(t))==null?void 0:o.bin,a=PY(i)?i:void 0,s=Uc(r)&&a2(r.extent)?r.extent:void 0;(a||s)&&n.set("selectionExtent",a??s,!0)}function P3e(e,t,n){if(!Un(n))return;const i=e.fieldDef(t),r=i.sort;if(tV(r))return{op:"min",field:Hd(i,t),order:"ascending"};const{stack:a}=e,s=a?new Set([...a.groupbyFields,...a.stackBy.map(o=>o.fieldDef.field)]):void 0;if(po(r)){const o=a&&!s.has(r.field);return A_(r,o)}else if(NAe(r)){const{encoding:o,order:l}=r,f=e.fieldDef(o),{aggregate:d,field:h}=f,p=a&&!s.has(h);if(Eo(d)||il(d))return A_({field:ve(f),order:l},p);if(yk(d)||!d)return A_({op:d,field:h,order:l},p)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(et(["ascending",void 0],r))return!0}}function Dz(e,t){const{aggregate:n,type:i}=e;return n?He(n)&&!fEe.has(n)?{valid:!1,reason:rSe(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:aSe(e)}:{valid:!0}:{valid:!1,reason:iSe(e)}}function Q3(e,t,n,i){return e.explicit&&t.explicit&&ge(cSe(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function I3e(e){const t=ns(e.map(s=>{if(uo(s)){const{sort:o,...l}=s;return l}return s}),rt),n=ns(e.map(s=>{if(uo(s)){const o=s.sort;return o!==void 0&&!tp(o)&&("op"in o&&o.op==="count"&&delete o.field,o.order==="ascending"&&delete o.order),o}}).filter(s=>s!==void 0),rt);if(t.length===0)return;if(t.length===1){const s=e[0];if(uo(s)&&n.length>0){let o=n[0];if(n.length>1){ge(L9);const l=n.filter(f=>dt(f)&&"op"in f&&f.op!=="min");n.every(f=>dt(f)&&"op"in f)&&l.length===1?o=l[0]:o=!0}else if(dt(o)&&"field"in o){const l=o.field;s.field===l&&(o=o.order?{order:o.order}:!0)}return{...s,sort:o}}return s}const i=ns(n.map(s=>tp(s)||!("op"in s)||He(s.op)&&pn(oEe,s.op)?s:(ge(dSe(s)),!0)),rt);let r;i.length===1?r=i[0]:i.length>1&&(ge(L9),r=!0);const a=ns(e.map(s=>uo(s)?s.data:null),s=>s);return a.length===1&&a[0]!==null?{data:a[0],fields:t.map(o=>o.field),...r?{sort:r}:{}}:{fields:t,...r?{sort:r}:{}}}function b6(e){if(uo(e)&&He(e.field))return e.field;if(dEe(e)){let t;for(const n of e.fields)if(uo(n)&&He(n.field)){if(!t)t=n.field;else if(t!==n.field)return ge(hSe),t}return ge(gSe),t}else if(hEe(e)){ge(pSe);const t=e.fields[0];return He(t)?t:void 0}}function T2(e,t){const i=e.component.scales[t].get("domains").map(r=>(uo(r)&&(r.data=e.lookupDataSource(r.data)),r));return I3e(i)}function QX(e){return vh(e)||x6(e)?e.children.reduce((t,n)=>t.concat(QX(n)),Tz(e)):Tz(e)}function Tz(e){return fe(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:a,type:s,selectionExtent:o,domains:l,range:f,reverse:d,...h}=r,p=q3e(r.range,a,n,e),y=T2(e,n),v=o?q_e(e,o,i,y):null;return t.push({name:a,type:s,...y?{domain:y}:{},...v?{domainRaw:v}:{},range:p,...d!==void 0?{reverse:d}:{},...h}),t},[])}function q3e(e,t,n,i){if(ln(n)){if(Pc(e))return{step:{signal:`${t}_step`}}}else if(dt(e)&&uo(e))return{...e,data:i.lookupDataSource(e.data)};return e}class ZX extends No{constructor(n,i){super({},{name:n});ce(this,"merged",!1);this.setWithExplicit("type",i)}domainHasZero(){const n=this.get("type");if(et([Xn.LOG,Xn.TIME,Xn.UTC],n))return"definitely-not";const i=this.get("zero");if(i===!0||i===void 0&&et([Xn.LINEAR,Xn.SQRT,Xn.POW],n))return"definitely";const r=this.get("domains");if(r.length>0){let a=!1,s=!1,o=!1;for(const l of r){if(Se(l)){const f=l[0],d=l[l.length-1];if(Ht(f)&&Ht(d))if(f<=0&&d>=0){a=!0;continue}else{s=!0;continue}}o=!0}if(a)return"definitely";if(s&&!o)return"definitely-not"}return"maybe"}}const H3e=["range","scheme"];function G3e(e){const t=e.component.scales;for(const n of mk){const i=t[n];if(!i)continue;const r=Y3e(n,e);i.setWithExplicit("range",r)}}function Mz(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:i,field:r}=n,a=rr(t),s=e.getName(a);if(dt(i)&&i.binned&&i.step!==void 0)return new Nn(()=>{const o=e.scaleName(t),l=`(domain("${o}")[1] - domain("${o}")[0]) / ${i.step}`;return`${e.getSignalName(s)} / (${l})`});if(Bt(i)){const o=p6(e,r,i);return new Nn(()=>{const l=e.getSignalName(o),f=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(s)} / (${f})`})}}}function Y3e(e,t){const n=t.specifiedScales[e],{size:i}=t,a=t.getScaleComponent(e).get("type");for(const h of H3e)if(n[h]!==void 0){const p=M3(a,h),y=IY(e,h);if(!p)ge(EY(a,h,e));else if(y)ge(y);else switch(h){case"range":{const v=n.range;if(Se(v)){if(ln(e))return Za(v.map(b=>{if(b==="width"||b==="height"){const E=t.getName(b),S=t.getSignalName.bind(t);return Nn.fromName(S,E)}return b}))}else if(dt(v))return Za({data:t.requestDataName(Wt.Main),field:v.field,sort:{op:"min",field:t.vgField(e)}});return Za(v)}case"scheme":return Za(V3e(n[h]))}}const s=e===Gt||e==="xOffset"?"width":"height",o=i[s];if(vs(o)){if(ln(e))if(Un(a)){const h=JX(o,t,e);if(h)return Za({step:h})}else ge(SY(s));else if(Zp(e)){const h=e===Zu?"x":"y";if(t.getScaleComponent(h).get("type")==="band"){const v=eW(o,a);if(v)return Za(v)}}}const{rangeMin:l,rangeMax:f}=n,d=X3e(e,t);return(l!==void 0||f!==void 0)&&M3(a,"rangeMin")&&Se(d)&&d.length===2?Za([l??d[0],f??d[1]]):mr(d)}function V3e(e){return eAe(e)?{scheme:e.name,..._r(e,["name"])}:{scheme:e}}function KX(e,t,n,{center:i}={}){const r=rr(e),a=t.getName(r),s=t.getSignalName.bind(t);return e===In&&$a(n)?i?[Nn.fromName(o=>`${s(o)}/2`,a),Nn.fromName(o=>`-${s(o)}/2`,a)]:[Nn.fromName(s,a),0]:i?[Nn.fromName(o=>`-${s(o)}/2`,a),Nn.fromName(o=>`${s(o)}/2`,a)]:[0,Nn.fromName(s,a)]}function X3e(e,t){const{size:n,config:i,mark:r,encoding:a}=t,{type:s}=An(a[e]),l=t.getScaleComponent(e).get("type"),{domain:f,domainMid:d}=t.specifiedScales[e];switch(e){case Gt:case In:{if(et(["point","band"],l)){const h=tW(e,n,i.view);if(vs(h))return{step:JX(h,t,e)}}return KX(e,t,l)}case Zu:case dh:return W3e(e,t,l);case Do:{const h=K3e(r,i),p=J3e(r,n,t,i);return Bd(l)?Z3e(h,p,Q3e(l,i,f,e)):[h,p]}case ra:return[0,Math.PI*2];case Lc:return[0,360];case La:return[0,new Nn(()=>{const h=t.getSignalName(Cr(t.parent)?"child_width":"width"),p=t.getSignalName(Cr(t.parent)?"child_height":"height");return`min(${h},${p})/2`})];case Ku:return{step:1e3/i.scale.framesPerSecond};case tl:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case nl:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case ir:return"symbol";case nr:case $s:case Ds:return l==="ordinal"?s==="nominal"?"category":"ordinal":d!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case To:case Ju:case el:return[i.scale.minOpacity,i.scale.maxOpacity]}}function JX(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),a=dk(n),s=i[a];if(RV({step:e,offsetIsDiscrete:qe(s)&&zY(s.type)})==="offset"&&pV(i,a)){const l=t.getScaleComponent(a);let d=`domain('${t.scaleName(a)}').length`;if(l.get("type")==="band"){const p=l.get("paddingInner")??l.get("padding")??0,y=l.get("paddingOuter")??l.get("padding")??0;d=`bandspace(${d}, ${p}, ${y})`}const h=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${d} / (1-${vEe(h)})`}}else return e.step}function eW(e,t){if(RV({step:e,offsetIsDiscrete:Un(t)})==="offset")return{step:e.step}}function W3e(e,t,n){const i=e===Zu?"x":"y",r=t.getScaleComponent(i);if(!r)return KX(i,t,n,{center:!0});const a=r.get("type"),s=t.scaleName(i),{markDef:o,config:l}=t;if(a==="band"){const f=tW(i,t.size,t.config.view);if(vs(f)){const d=eW(f,n);if(d)return d}return[0,{signal:`bandwidth('${s}')`}]}else{const f=t.encoding[i];if(pe(f)&&f.timeUnit){const d=NY(f.timeUnit,v=>`scale('${s}', ${v})`),h=t.config.scale.bandWithNestedOffsetPaddingInner,p=Iu({fieldDef:f,markDef:o,config:l})-.5,y=p!==0?` + ${p}`:"";if(h){const v=Ce(h)?`${h.signal}/2${y}`:`${h/2+p}`,b=Ce(h)?`(1 - ${h.signal}/2)${y}`:`${1-h/2+p}`;return[{signal:`${v} * (${d})`},{signal:`${b} * (${d})`}]}return[0,{signal:d}]}return qG(`Cannot use ${e} scale if ${i} scale is not discrete.`)}}function tW(e,t,n){const i=e===Gt?"width":"height",r=t[i];return r||mb(n,i)}function Q3e(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Se(n)?n.length+1:(ge(wSe(i)),3)}}function Z3e(e,t,n){const i=()=>{const r=xa(t),a=xa(e),s=`(${r} - ${a}) / (${n} - 1)`;return`sequence(${a}, ${r} + ${s}, ${s})`};return Ce(t)?new Nn(i):{signal:i()}}function K3e(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(s2("size",e))}const kz=.95;function J3e(e,t,n,i){const r={x:Mz(n,"x"),y:Mz(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const a=Nz(t,r,i.view);return Ht(a)?a-1:new Nn(()=>`${a.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const a=Nz(t,r,i.view);return Ht(a)?Math.pow(kz*a,2):new Nn(()=>`pow(${kz} * ${a.signal}, 2)`)}}throw new Error(s2("size",e))}function Nz(e,t,n){const i=vs(e.width)?e.width.step:O3(n,"width"),r=vs(e.height)?e.height.step:O3(n,"height");return t.x||t.y?new Nn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function nW(e,t){Xt(e)?e$e(e,t):rW(e,t)}function e$e(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:a,specifiedScales:s}=e;for(const o of fe(n)){const l=s[o],f=n[o],d=e.getScaleComponent(o),h=An(r[o]),p=l[t],y=d.get("type"),v=d.get("padding"),b=d.get("paddingInner"),E=M3(y,t),S=IY(o,t);if(p!==void 0&&(E?S&&ge(S):ge(EY(y,t,o))),E&&S===void 0)if(p!==void 0){const w=h.timeUnit,_=h.type;switch(t){case"domainMax":case"domainMin":Ic(l[t])||_==="temporal"||w?f.set(t,{signal:y2(l[t],{type:_,timeUnit:w})},!0):f.set(t,l[t],!0);break;default:f.copyKeyFromObject(t,l)}}else{const w=de(Fz,t)?Fz[t]({model:e,channel:o,fieldOrDatumDef:h,scaleType:y,scalePadding:v,scalePaddingInner:b,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:a,config:i,hasNestedOffsetScale:mV(r,o),hasSecondaryRangeChannel:!!r[Ts(o)]}):i.scale[t];w!==void 0&&f.set(t,w,!1)}}}const Fz={bins:({model:e,fieldOrDatumDef:t})=>pe(t)?t$e(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>n$e(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:a})=>i$e(e,t,n,i,r,a),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>r$e(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:a})=>a$e(e,t,n.type,i,r.scale,a),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:a})=>s$e(e,t,n,i,r.scale,a),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=pe(e)?e.sort:void 0;return o$e(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:a,hasSecondaryRangeChannel:s})=>u$e(e,t,n,i,r,a.scale,s)};function iW(e){Xt(e)?G3e(e):rW(e,"range")}function rW(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?iW(i):nW(i,t);for(const i of fe(n)){let r;for(const a of e.children){const s=a.component.scales[i];if(s){const o=s.getWithExplicit(t);r=qu(r,o,t,"scale",XV((l,f)=>{switch(t){case"range":return l.step&&f.step?l.step-f.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function t$e(e,t){const n=t.bin;if(Bt(n)){const i=p6(e,t.field,n);return new Nn(()=>e.getSignalName(i))}else if(Yn(n)&&Uc(n)&&n.step!==void 0)return{step:n.step}}function n$e(e,t){if(et([nr,$s,Ds],e)&&t!=="nominal")return"hcl"}function i$e(e,t,n,i,r,a){var s;if(!((s=Ta(a))!=null&&s.bin||Se(n)||r!=null||i!=null||et([Xn.TIME,Xn.UTC],e)))return ln(t)?!0:void 0}function r$e(e,t,n,i,r,a){if(ln(e)){if(is(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:o}=r;if(s==="bar"&&!(pe(i)&&(i.bin||i.timeUnit))&&(o==="vertical"&&e==="x"||o==="horizontal"&&e==="y"))return a.continuousBandSize}if(t===Xn.POINT)return n.pointPadding}}function a$e(e,t,n,i,r,a=!1){if(e===void 0){if(ln(t)){const{bandPaddingInner:s,barBandPaddingInner:o,rectBandPaddingInner:l,tickBandPaddingInner:f,bandWithNestedOffsetPaddingInner:d}=r;return a?d:un(s,n==="bar"?o:n==="tick"?f:l)}else if(Zp(t)&&i===Xn.BAND)return r.offsetBandPaddingInner}}function s$e(e,t,n,i,r,a=!1){if(e===void 0){if(ln(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:o}=r;if(a)return o;if(n===Xn.BAND)return un(s,Ce(i)?{signal:`${i.signal}/2`}:i/2)}else if(Zp(t)){if(n===Xn.POINT)return .5;if(n===Xn.BAND)return r.offsetBandPaddingOuter}}}function o$e(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return $a(e)&&t==="descending"?Ce(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if($a(e)&&t==="descending")return!0}function u$e(e,t,n,i,r,a,s){if(!!n&&n!=="unaggregated"&&$a(r)){if(Se(n)){const l=n[0],f=n[n.length-1];if(Ht(l)&&l<=0&&Ht(f)&&f>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!Bd(r))return!0;if(!(pe(t)&&t.bin)&&et([...Mo,...K2e],e)){const{orient:l,type:f}=i;return et(["bar","area","line","trail"],f)&&(l==="horizontal"&&e==="y"||l==="vertical"&&e==="x")?!1:et(["bar","area"],f)&&!s?!0:a==null?void 0:a.zero}return!1}function l$e(e,t,n,i,r=!1){const a=c$e(t,n,i,r),{type:s}=e;return Ms(t)?s!==void 0?oAe(t,s)?pe(n)&&!sAe(s,n.type)?(ge(uSe(s,a)),a):s:(ge(oSe(t,s,a)),a):a:null}function c$e(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":{if(od(e)||f_(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&ge(d_(e,"ordinal")),"ordinal";if(c_(e))return"band";if(ln(e)||Zp(e)){if(et(["rect","bar","image","rule","tick"],n.type)||i)return"band"}else if(n.type==="arc"&&e in pk)return"band";const a=n[rr(e)];return Sc(a)||jd(t)&&((r=t.axis)!=null&&r.tickBand)?"band":"point"}case"temporal":return od(e)?"time":f_(e)==="discrete"?(ge(d_(e,"temporal")),"ordinal"):pe(t)&&t.timeUnit&&jn(t.timeUnit).utc?"utc":c_(e)?"band":"time";case"quantitative":return od(e)?pe(t)&&Bt(t.bin)?"bin-ordinal":"linear":f_(e)==="discrete"?(ge(d_(e,"quantitative")),"ordinal"):c_(e)?"band":"linear";case"geojson":return}throw new Error(bY(t.type))}function f$e(e,{ignoreRange:t}={}){aW(e),WX(e);for(const n of aAe)nW(e,n);t||iW(e)}function aW(e){Xt(e)?e.component.scales=d$e(e):e.component.scales=g$e(e)}function d$e(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const a of mk){const s=An(t[a]);if(s&&n===GY&&a===ir&&s.type===hh)continue;let o=s&&s.scale;if(s&&o!==null&&o!==!1){o??(o={});const l=mV(t,a),f=l$e(o,a,s,i,l);r[a]=new ZX(e.scaleName(`${a}`,!0),{value:f,explicit:o.type===f})}}return r}const h$e=XV((e,t)=>U9(e)-U9(t));function g$e(e){var r;const t=e.component.scales={},n={},i=e.component.resolve;for(const a of e.children){aW(a);for(const s of fe(a.component.scales))if((r=i.scale)[s]??(r[s]=zX(s,e)),i.scale[s]==="shared"){const o=n[s],l=a.component.scales[s].getWithExplicit("type");o?WSe(o.value,l.value)?n[s]=qu(o,l,"type","scale",h$e):(i.scale[s]="independent",delete n[s]):n[s]=l}}for(const a of fe(n)){const s=e.scaleName(a,!0),o=n[a];t[a]=new ZX(s,o);for(const l of e.children){const f=l.component.scales[a];f&&(l.renameScale(f.get("name"),s),f.merged=!0)}}return t}class w_{constructor(){ce(this,"nameMap");this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Xt(e){return(e==null?void 0:e.type)==="unit"}function Cr(e){return(e==null?void 0:e.type)==="facet"}function x6(e){return(e==null?void 0:e.type)==="concat"}function vh(e){return(e==null?void 0:e.type)==="layer"}class E6{constructor(t,n,i,r,a,s,o){ce(this,"type");ce(this,"parent");ce(this,"config");ce(this,"name");ce(this,"size");ce(this,"title");ce(this,"description");ce(this,"data");ce(this,"transforms");ce(this,"layout");ce(this,"scaleNameMap");ce(this,"projectionNameMap");ce(this,"signalNameMap");ce(this,"component");ce(this,"view");this.type=n,this.parent=i,this.config=a,this.parent=i,this.config=a,this.view=Vn(o),this.name=t.name??r,this.title=fu(t.title)?{text:t.title}:t.title?Vn(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new w_,this.projectionNameMap=i?i.projectionNameMap:new w_,this.signalNameMap=i?i.signalNameMap:new w_,this.data=t.data,this.description=t.description,this.transforms=x_e(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:wwe(t,n,a),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:g2(t)||(i==null?void 0:i.component.data.isFaceted)&&t.data===void 0},layoutSize:new No,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?Ue(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){f$e(this)}parseProjection(){YX(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){PX(this)}assembleEncodeFromView(t){const{style:n,...i}=t,r={};for(const a of fe(i)){const s=i[a];s!==void 0&&(r[a]=Ut(s))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Ut(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Rt(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:i,config:r}=this,a=RCe(i.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...n,...a?{titleBand:a}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Vr)t[i].title&&n.push(TCe(this,i));for(const i of f6)n=n.concat(MCe(this,i));return n}assembleAxes(){return mCe(this.component.axes,this.config)}assembleLegends(){return qX(this)}assembleProjections(){return r3e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},i={...cY(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(i.text)return et(["unit","layer"],this.type)?et(["middle",void 0],i.anchor)&&(i.frame??(i.frame="group")):i.anchor??(i.anchor="start"),Rt(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Cr(this.parent)?QX(this):[];r.length>0&&(n.scales=r);const a=this.assembleAxes();a.length>0&&(n.axes=a);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return qt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Wt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(Cr(this.parent)){const n=OX(t),i=i2(n),r=this.component.scales[i];if(r&&!r.merged){const a=r.get("type"),s=r.get("range");if(Un(a)&&Pc(s)){const o=r.get("name"),l=T2(this,i),f=b6(l);if(f){const d=ve({aggregate:"distinct",field:f},{expr:"datum"});return{signal:FX(o,r,d)}}else return ge(bk(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(nY(t)&&Ms(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(AEe(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(i=>i.hasOrientSignalRef()))}}class sW extends E6{vgField(t,n={}){const i=this.fieldDef(t);if(i)return ve(i,n)}reduceFieldDef(t,n){return JAe(this.getMapping(),(i,r,a)=>{const s=Ta(r);return s?t(i,s,a):i},n)}forEachFieldDef(t,n){Vk(this.getMapping(),(i,r)=>{const a=Ta(i);a&&t(a,r)},n)}}class M2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"];const a=this.transform.resolve??"shared";this.transform.resolve=a}clone(){return new M2(null,Ue(this.transform))}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${rt(this.transform)}`}assemble(){const{density:n,...i}=this.transform,r={type:"kde",field:n,...i};return r.resolve=this.transform.resolve,r}}class k2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i)}clone(){return new k2(null,Ue(this.transform))}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${rt(this.transform)}`}assemble(){const{extent:n,param:i}=this.transform;return{type:"extent",field:n,signal:i}}}class N2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i);const{flatten:r,as:a=[]}=this.transform;this.transform.as=r.map((s,o)=>a[o]??s)}clone(){return new N2(this.parent,Ue(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${rt(this.transform)}`}assemble(){const{flatten:n,as:i}=this.transform;return{type:"flatten",fields:n,as:i}}}class F2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}clone(){return new F2(null,Ue(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${rt(this.transform)}`}assemble(){const{fold:n,as:i}=this.transform;return{type:"fold",fields:n,as:i}}}class cd extends $t{constructor(n,i,r,a){super(n);ce(this,"fields");ce(this,"geojson");ce(this,"signal");this.fields=i,this.geojson=r,this.signal=a}clone(){return new cd(null,Ue(this.fields),this.geojson,this.signal)}static parseAll(n,i){if(i.component.projection&&!i.component.projection.isFit)return n;let r=0;for(const a of[[Ua,ja],[na,Pa]]){const s=a.map(o=>{const l=An(i.encoding[o]);return pe(l)?l.field:ks(l)?{expr:`${l.datum}`}:Da(l)?{expr:`${l.value}`}:void 0});(s[0]||s[1])&&(n=new cd(n,s,null,i.getName(`geojson_${r++}`)))}if(i.channelHasField(ir)){const a=i.typedFieldDef(ir);a.type===hh&&(n=new cd(n,null,a.field,i.getName(`geojson_${r++}`)))}return n}dependentFields(){const n=(this.fields??[]).filter(He);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${rt(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class ap extends $t{constructor(n,i,r,a){super(n);ce(this,"projection");ce(this,"fields");ce(this,"as");this.projection=i,this.fields=r,this.as=a}clone(){return new ap(null,this.projection,Ue(this.fields),Ue(this.as))}static parseAll(n,i){if(!i.projectionName())return n;for(const r of[[Ua,ja],[na,Pa]]){const a=r.map(o=>{const l=An(i.encoding[o]);return pe(l)?l.field:ks(l)?{expr:`${l.datum}`}:Da(l)?{expr:`${l.value}`}:void 0}),s=r[0]===na?"2":"";(a[0]||a[1])&&(n=new ap(n,i.projectionName(),a,[i.getName(`x${s}`),i.getName(`y${s}`)]))}return n}dependentFields(){return new Set(this.fields.filter(He))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${rt(this.fields)} ${rt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class nc extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i}clone(){return new nc(null,Ue(this.transform))}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(n){const{start:i=0,stop:r,step:a}=n;return{signal:`sequence(${[i,r,...a?[a]:[]].join(",")})`}}static makeFromTransform(n,i){return new nc(n,i)}static makeFromEncoding(n,i){const r=i.encoding,a=r.x,s=r.y;if(pe(a)&&pe(s)){const o=a.impute?a:s.impute?s:void 0;if(o===void 0)return;const l=a.impute?s:s.impute?a:void 0,{method:f,value:d,frame:h,keyvals:p}=o.impute,y=bV(i.mark,r);return new nc(n,{impute:o.field,key:l.field,...f?{method:f}:{},...d!==void 0?{value:d}:{},...h?{frame:h}:{},...p!==void 0?{keyvals:p}:{},...y.length?{groupby:y}:{}})}return null}hash(){return`Impute ${rt(this.transform)}`}assemble(){const{impute:n,key:i,keyvals:r,method:a,groupby:s,value:o,frame:l=[null,null]}=this.transform,f={type:"impute",field:n,key:i,...r?{keyvals:t_e(r)?this.processSequence(r):r}:{},method:"value",...s?{groupby:s}:{},value:!a||a==="value"?o:null};if(a&&a!=="value"){const d={type:"window",as:[`imputed_${n}_value`],ops:[a],fields:[n],frame:l,ignorePeers:!1,...s?{groupby:s}:{}},h={type:"formula",expr:`datum.${n} === null ? datum.imputed_${n}_value : datum.${n}`,as:n};return[f,d,h]}else return[f]}}class O2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??i.on,r[1]??i.loess]}clone(){return new O2(null,Ue(this.transform))}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${rt(this.transform)}`}assemble(){const{loess:n,on:i,...r}=this.transform;return{type:"loess",x:i,y:n,...r}}}class sp extends $t{constructor(n,i,r){super(n);ce(this,"transform");ce(this,"secondary");this.transform=i,this.secondary=r}clone(){return new sp(null,Ue(this.transform),this.secondary)}static make(n,i,r,a){const s=i.component.data.sources,{from:o}=r;let l=null;if(n_e(o)){let f=lW(o.data,s);f||(f=new Cc(o.data),s.push(f));const d=i.getName(`lookup_${a}`);l=new Ki(f,d,Wt.Lookup,i.component.data.outputNodeRefCounts),i.component.data.outputNodes[d]=l}else if(i_e(o)){const f=o.param;r={as:f,...r};let d;try{d=i.getSelectionComponent(qt(f),f)}catch{throw new Error($Ee(f))}if(l=d.materialized,!l)throw new Error(DEe(f))}return new sp(n,r,l.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?on(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${rt({transform:this.transform,secondary:this.secondary})}`}assemble(){let n;if(this.transform.from.fields)n={values:this.transform.from.fields,...this.transform.as?{as:on(this.transform.as)}:{}};else{let i=this.transform.as;He(i)||(ge(jEe),i="_lookup"),n={as:[i]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...n,...this.transform.default?{default:this.transform.default}:{}}}}class R2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}clone(){return new R2(null,Ue(this.transform))}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${rt(this.transform)}`}assemble(){const{quantile:n,...i}=this.transform;return{type:"quantile",field:n,...i}}}class z2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i,this.transform=Ue(i);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??i.on,r[1]??i.regression]}clone(){return new z2(null,Ue(this.transform))}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${rt(this.transform)}`}assemble(){const{regression:n,on:i,...r}=this.transform;return{type:"regression",x:i,y:n,...r}}}class B2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i}clone(){return new B2(null,Ue(this.transform))}addDimensions(n){this.transform.groupby=ns((this.transform.groupby??[]).concat(n),i=>i)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${rt(this.transform)}`}assemble(){const{pivot:n,value:i,groupby:r,limit:a,op:s}=this.transform;return{type:"pivot",field:n,value:i,...a!==void 0?{limit:a}:{},...s!==void 0?{op:s}:{},...r!==void 0?{groupby:r}:{}}}}class L2 extends $t{constructor(n,i){super(n);ce(this,"transform");this.transform=i}clone(){return new L2(null,Ue(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${rt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function oW(e){let t=0;function n(i,r){if(i instanceof Cc&&!i.isGenerator&&!Pd(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof di&&(i.parent instanceof Cc&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof mh){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof om||i instanceof um||i instanceof Yd||i instanceof ph||i instanceof qd||i instanceof ap||i instanceof Aa||i instanceof sp||i instanceof yh||i instanceof Yc||i instanceof F2||i instanceof N2||i instanceof M2||i instanceof O2||i instanceof R2||i instanceof z2||i instanceof Hu||i instanceof L2||i instanceof B2||i instanceof k2)&&r.transform.push(i.assemble()),(i instanceof ls||i instanceof os||i instanceof nc||i instanceof yo||i instanceof cd)&&r.transform.push(...i.assemble()),i instanceof Ki&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Ki?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Ki&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let a=r.name;!r.source||r.transform.length>0?e.push(r):a=r.source;for(const s of i.children)n(s,{name:null,source:a,transform:[]});break}}}return n}function p$e(e){const t=[],n=oW(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function m$e(e,t){const n=[],i=oW(n);let r=0;for(const s of e.sources){s.hasName()||(s.dataName=`source_${r++}`);const o=s.assemble();i(s,o)}for(const s of n)s.transform.length===0&&delete s.transform;let a=0;for(const[s,o]of n.entries())(o.transform??[]).length===0&&!o.source&&n.splice(a++,0,n.splice(s,1)[0]);for(const s of n)for(const o of s.transform??[])o.type==="lookup"&&(o.from=e.outputNodes[o.from].getSource());for(const s of n)s.name in t&&(s.values=t[s.name]);return n}function y$e(e){return e==="top"||e==="left"||Ce(e)?"header":"footer"}function v$e(e){for(const t of Vr)b$e(e,t);Oz(e,"x"),Oz(e,"y")}function b$e(e,t){var s;const{facet:n,config:i,child:r,component:a}=e;if(e.channelHasField(t)){const o=n[t],l=Gd("title",null,i,t);let f=ud(o,i,{allowDisabling:!0,includeDefault:l===void 0||!!l});r.component.layoutHeaders[t].title&&(f=Se(f)?f.join(", "):f,f+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const d=Gd("labelOrient",o.header,i,t),h=o.header!==null?un((s=o.header)==null?void 0:s.labels,i.header.labels,!0):!1,p=et(["bottom","right"],d)?"footer":"header";a.layoutHeaders[t]={title:o.header!==null?f:null,facetFieldDef:o,[p]:t==="facet"?[]:[uW(e,t,h)]}}}function uW(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function Oz(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=g6(r,t),r.axis[t]==="shared"){const a=t==="x"?"column":"row",s=i[a];for(const o of n.component.axes[t]){const l=y$e(o.get("orient"));s[l]??(s[l]=[uW(e,a,!1)]);const f=cg(o,"main",e.config,{header:!0});f&&s[l][0].axes.push(f),o.mainExtracted=!0}}}}function x$e(e){S6(e),xb(e,"width"),xb(e,"height")}function E$e(e){S6(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";xb(e,t),xb(e,n)}function S6(e){for(const t of e.children)t.parseLayoutSize()}function xb(e,t){const n=OX(t),i=i2(n),r=e.component.resolve,a=e.component.layoutSize;let s;for(const o of e.children){const l=o.component.layoutSize.getWithExplicit(n),f=r.scale[i]??zX(i,e);if(f==="independent"&&l.value==="step"){s=void 0;break}if(s){if(f==="independent"&&s.value!==l.value){s=void 0;break}s=qu(s,l,n,"")}else s=l}if(s){for(const o of e.children)e.renameSignal(o.getName(n),e.getName(t)),o.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(t,s)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function S$e(e){const{size:t,component:n}=e;for(const i of Mo){const r=rr(i);if(t[r]){const a=t[r];n.layoutSize.set(r,vs(a)?"step":a,!0)}else{const a=A$e(e,r);n.layoutSize.set(r,a,!1)}}}function A$e(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const a=r.get("type"),s=r.get("range");if(Un(a)){const o=mb(i.view,t);return Pc(s)||vs(o)?"step":o}else return F3(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return F3(i.view,t);{const a=mb(i.view,t);return vs(a)?a.step:a}}}function Z3(e,t,n){return ve(t,{suffix:`by_${ve(e)}`,...n})}class Dg extends sW{constructor(n,i,r,a){super(n,"facet",i,r,a,n.resolve);ce(this,"facet");ce(this,"child");ce(this,"children");this.child=$6(n.spec,this,this.getName("child"),void 0,a),this.children=[this.child],this.facet=this.initFacet(n.facet)}initFacet(n){if(!tm(n))return{facet:this.initFacetFieldDef(n,"facet")};const i=fe(n),r={};for(const a of i){if(![ho,go].includes(a)){ge(s2(a,"facet"));break}const s=n[a];if(s.field===void 0){ge(D3(s,a));break}r[a]=this.initFacetFieldDef(s,a)}return r}initFacetFieldDef(n,i){const r=Yk(n,i);return r.header?r.header=Vn(r.header):r.header===null&&(r.header=null),r}channelHasField(n){return de(this.facet,n)}fieldDef(n){return this.facet[n]}parseData(){this.component.data=j2(this),this.child.parseData()}parseLayoutSize(){S6(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,mn(this.component.selection).some(n=>us(n))&&Ek(xk)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),v$e(this)}assembleSelectionTopLevelSignals(n){return this.child.assembleSelectionTopLevelSignals(n)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(n){return this.child.assembleSelectionData(n)}getHeaderLayoutMixins(){const n={};for(const i of Vr)for(const r of d6){const a=this.component.layoutHeaders[i],s=a[r],{facetFieldDef:o}=a;if(o){const l=Gd("titleOrient",o.header,this.config,i);if(["right","bottom"].includes(l)){const f=$2(i,l);n.titleAnchor??(n.titleAnchor={}),n.titleAnchor[f]="end"}}if(s!=null&&s[0]){const l=i==="row"?"height":"width",f=r==="header"?"headerBand":"footerBand";i!=="facet"&&!this.child.component.layoutSize.get(l)&&(n[f]??(n[f]={}),n[f][i]=.5),a.title&&(n.offset??(n.offset={}),n.offset[i==="row"?"rowTitle":"columnTitle"]=10)}}return n}assembleDefaultLayout(){const{column:n,row:i}=this.facet,r=n?this.columnDistinctSignal():i?1:void 0;let a="all";return(!i&&this.component.resolve.scale.x==="independent"||!n&&this.component.resolve.scale.y==="independent")&&(a="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:a}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Dg))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(n){return this.parent&&this.parent instanceof Dg?{...this.channelHasField("column")?{encode:{update:{columns:{field:ve(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(n)}:super.assembleGroup(n)}getCardinalityAggregateForChild(){const n=[],i=[],r=[];if(this.child instanceof Dg){if(this.child.channelHasField("column")){const a=ve(this.child.facet.column);n.push(a),i.push("distinct"),r.push(`distinct_${a}`)}}else for(const a of Mo){const s=this.child.component.scales[a];if(s&&!s.merged){const o=s.get("type"),l=s.get("range");if(Un(o)&&Pc(l)){const f=T2(this.child,a),d=b6(f);d?(n.push(d),i.push("distinct"),r.push(`distinct_${d}`)):ge(bk(a))}}}return{fields:n,ops:i,as:r}}assembleFacet(){const{name:n,data:i}=this.component.data.facetRoot,{row:r,column:a}=this.facet,{fields:s,ops:o,as:l}=this.getCardinalityAggregateForChild(),f=[];for(const h of Vr){const p=this.facet[h];if(p){f.push(ve(p));const{bin:y,sort:v}=p;if(Bt(y)&&f.push(ve(p,{binSuffix:"end"})),po(v)){const{field:b,op:E=h2}=v,S=Z3(p,v);r&&a?(s.push(S),o.push("max"),l.push(S)):(s.push(b),o.push(E),l.push(S))}else if(Se(v)){const b=Hd(p,h);s.push(b),o.push("max"),l.push(b)}}}const d=!!r&&!!a;return{name:n,data:i,groupby:f,...d||s.length>0?{aggregate:{...d?{cross:d}:{},...s.length?{fields:s,ops:o,as:l}:{}}}:{}}}facetSortFields(n){const{facet:i}=this,r=i[n];return r?po(r.sort)?[Z3(r,r.sort,{expr:"datum"})]:Se(r.sort)?[Hd(r,n,{expr:"datum"})]:[ve(r,{expr:"datum"})]:[]}facetSortOrder(n){const{facet:i}=this,r=i[n];if(r){const{sort:a}=r;return[(po(a)?a.order:!Se(a)&&a)||"ascending"]}return[]}assembleLabelTitle(){var a;const{facet:n,config:i}=this;if(n.facet)return H3(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const s of f6)if(n[s]){const o=Gd("labelOrient",(a=n[s])==null?void 0:a.header,i,s);if(r[s].includes(o))return H3(n[s],s,i)}}assembleMarks(){const{child:n}=this,i=this.component.data.facetRoot,r=p$e(i),a=n.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||n.assembleTitle(),o=n.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...o?{style:o}:{},from:{facet:this.assembleFacet()},sort:{field:Vr.map(f=>this.facetSortFields(f)).flat(),order:Vr.map(f=>this.facetSortOrder(f)).flat()},...r.length>0?{data:r}:{},...a?{encode:{update:a}}:{},...n.assembleGroup(j_e(this,[]))}]}getMapping(){return this.facet}}function w$e(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const a of[n,i])if(po(a.sort)){const{field:s,op:o=h2}=a.sort;e=r=new Yc(e,{joinaggregate:[{op:o,field:s,as:Z3(a,a.sort,{forAs:!0})}],groupby:[ve(a)]})}return r}return null}function lW(e,t){var n,i,r,a;for(const s of t){const o=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const l=(n=e.format)==null?void 0:n.mesh,f=(i=o.format)==null?void 0:i.feature;if(l&&f)continue;const d=(r=e.format)==null?void 0:r.feature;if((d||f)&&d!==f)continue;const h=(a=o.format)==null?void 0:a.mesh;if(!((l||h)&&l!==h)){if(rp(e)&&rp(o)){if(Sr(e.values,o.values))return s}else if(Pd(e)&&Pd(o)){if(e.url===o.url)return s}else if(WV(e)&&e.name===s.dataName)return s}}return null}function _$e(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Cc({values:[]});return t.push(i),i}const n=lW(e.data,t);if(n)return Du(e.data)||(n.data.format=HG({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Cc(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function C$e(e,t,n){let i=0;for(const r of t.transforms){let a,s;if(h_e(r))s=e=new qd(e,r),a="derived";else if(r6(r)){const o=y3e(r);s=e=di.makeWithAncestors(e,{},o,n)??e,e=new ph(e,t,r.filter)}else if(HV(r))s=e=ls.makeFromTransform(e,r,t),a="number";else if(p_e(r))a="date",n.getWithExplicit(r.field).value===void 0&&(e=new di(e,{[r.field]:a}),n.set(r.field,a,!1)),s=e=os.makeFromTransform(e,r);else if(m_e(r))s=e=Aa.makeFromTransform(e,r),a="number",c6(t)&&(e=new Hu(e));else if(qV(r))s=e=sp.make(e,t,r,i++),a="derived";else if(c_e(r))s=e=new yh(e,r),a="number";else if(f_e(r))s=e=new Yc(e,r),a="number";else if(y_e(r))s=e=yo.makeFromTransform(e,r),a="derived";else if(v_e(r))s=e=new F2(e,r),a="derived";else if(b_e(r))s=e=new k2(e,r),a="derived";else if(d_e(r))s=e=new N2(e,r),a="derived";else if(r_e(r))s=e=new B2(e,r),a="derived";else if(l_e(r))e=new L2(e,r);else if(g_e(r))s=e=nc.makeFromTransform(e,r),a="derived";else if(a_e(r))s=e=new M2(e,r),a="derived";else if(s_e(r))s=e=new R2(e,r),a="derived";else if(o_e(r))s=e=new z2(e,r),a="derived";else if(u_e(r))s=e=new O2(e,r),a="derived";else{ge(LEe(r));continue}if(s&&a!==void 0)for(const o of s.producedFields()??[])n.set(o,a,!1)}return e}function j2(e){var E;let t=_$e(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,s=!(r&&(Du(r)||Pd(r)||rp(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new k_e;Du(r)?(QV(r)?t=new um(t,r.sequence):a6(r)&&(t=new om(t,r.graticule)),s.parseNothing=!0):((E=r==null?void 0:r.format)==null?void 0:E.parse)===null&&(s.parseNothing=!0),t=di.makeExplicit(t,e,s)??t,t=new Hu(t);const o=e.parent&&vh(e.parent);(Xt(e)||Cr(e))&&o&&(t=ls.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=C$e(t,e,s));const l=b3e(e),f=v3e(e);t=di.makeWithAncestors(t,{},{...l,...f},s)??t,Xt(e)&&(t=cd.parseAll(t,e),t=ap.parseAll(t,e)),(Xt(e)||Cr(e))&&(o||(t=ls.makeFromEncoding(t,e)??t),t=os.makeFromEncoding(t,e)??t,t=qd.parseAllForSortIndex(t,e));const d=t=ry(Wt.Raw,e,t);if(Xt(e)){const S=Aa.makeFromEncoding(t,e);S&&(t=S,c6(e)&&(t=new Hu(t))),t=nc.makeFromEncoding(t,e)??t,t=yo.makeFromEncoding(t,e)??t}let h,p;if(Xt(e)){const{markDef:S,mark:w,config:_}=e,C=kt("invalid",S,_),{marks:$,scales:M}=p=KV({invalid:C,isPath:rl(w)});$!==M&&M==="include-invalid-values"&&(h=t=ry(Wt.PreFilterInvalid,e,t)),$==="exclude-invalid-values"&&(t=Yd.make(t,e,p)??t)}const y=t=ry(Wt.Main,e,t);let v;if(Xt(e)&&p){const{marks:S,scales:w}=p;S==="include-invalid-values"&&w==="exclude-invalid-values"&&(t=Yd.make(t,e,p)??t,v=t=ry(Wt.PostFilterInvalid,e,t))}Xt(e)&&gCe(e,y);let b=null;if(Cr(e)){const S=e.getName("facet");t=w$e(t,e.facet)??t,b=new mh(t,e,S,y.getSource()),n[S]=b}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:d,main:y,facetRoot:b,ancestorParse:s,preFilterInvalid:h,postFilterInvalid:v}}function ry(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,a=t.getDataName(e),s=new Ki(n,a,e,r);return i[a]=s,s}class $$e extends E6{constructor(n,i,r,a){var s,o,l,f;super(n,"concat",i,r,a,n.resolve);ce(this,"children");(((o=(s=n.resolve)==null?void 0:s.axis)==null?void 0:o.x)==="shared"||((f=(l=n.resolve)==null?void 0:l.axis)==null?void 0:f.y)==="shared")&&ge(REe),this.children=this.getChildren(n).map((d,h)=>$6(d,this,this.getName(`concat_${h}`),void 0,a))}parseData(){this.component.data=j2(this);for(const n of this.children)n.parseData()}parseSelections(){this.component.selection={};for(const n of this.children){n.parseSelections();for(const i of fe(n.component.selection))this.component.selection[i]=n.component.selection[i]}mn(this.component.selection).some(n=>us(n))&&Ek(xk)}parseMarkGroup(){for(const n of this.children)n.parseMarkGroup()}parseAxesAndHeaders(){for(const n of this.children)n.parseAxesAndHeaders()}getChildren(n){return x2(n)?n.vconcat:n6(n)?n.hconcat:n.concat}parseLayoutSize(){E$e(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(n){return this.children.reduce((i,r)=>r.assembleSelectionTopLevelSignals(i),n)}assembleSignals(){return this.children.forEach(n=>n.assembleSignals()),[]}assembleLayoutSignals(){const n=h6(this);for(const i of this.children)n.push(...i.assembleLayoutSignals());return n}assembleSelectionData(n){return this.children.reduce((i,r)=>r.assembleSelectionData(i),n)}assembleMarks(){return this.children.map(n=>{const i=n.assembleTitle(),r=n.assembleGroupStyle(),a=n.assembleGroupEncodeEntry(!1);return{type:"group",name:n.getName("group"),...i?{title:i}:{},...r?{style:r}:{},...a?{encode:{update:a}}:{},...n.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const n=this.layout.columns;return{...n!=null?{columns:n}:{},bounds:"full",align:"each"}}}function D$e(e){return e===!1||e===null}const T$e={disable:1,gridScale:1,scale:1,...hV,labelExpr:1,encode:1},cW=fe(T$e);class A6 extends No{constructor(n={},i={},r=!1){super();ce(this,"explicit");ce(this,"implicit");ce(this,"mainExtracted");this.explicit=n,this.implicit=i,this.mainExtracted=r}clone(){return new A6(Ue(this.explicit),Ue(this.implicit),this.mainExtracted)}hasAxisPart(n){return n==="axis"?!0:n==="grid"||n==="title"?!!this.get(n):!D$e(this.get(n))}hasOrientSignalRef(){return Ce(this.explicit.orient)}}function M$e(e,t,n){const{encoding:i,config:r}=e,a=An(i[t])??An(i[Ts(t)]),s=e.axis(t)||{},{format:o,formatType:l}=s;if(Ac(l))return{text:Ea({fieldOrDatumDef:a,field:"datum.value",format:o,formatType:l,config:r}),...n};if(o===void 0&&l===void 0&&r.customFormatTypes){if(Ld(a)==="quantitative"){if(jd(a)&&a.stack==="normalize"&&r.normalizedNumberFormatType)return{text:Ea({fieldOrDatumDef:a,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:Ea({fieldOrDatumDef:a,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(Ld(a)==="temporal"&&r.timeFormatType&&pe(a)&&!a.timeUnit)return{text:Ea({fieldOrDatumDef:a,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function k$e(e){return Mo.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[L$e(n,e)]),t),{})}const N$e={bottom:"top",top:"bottom",left:"right",right:"left"};function F$e(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const a of fe(r.component.axes))n.axis[a]=g6(e.component.resolve,a),n.axis[a]==="shared"&&(t[a]=O$e(t[a],r.component.axes[a]),t[a]||(n.axis[a]="independent",delete t[a]))}for(const r of Mo){for(const a of e.children)if(a.component.axes[r]){if(n.axis[r]==="independent"){t[r]=(t[r]??[]).concat(a.component.axes[r]);for(const s of a.component.axes[r]){const{value:o,explicit:l}=s.getWithExplicit("orient");if(!Ce(o)){if(i[o]>0&&!l){const f=N$e[o];i[o]>i[f]&&s.set("orient",f,!1)}i[o]++}}}delete a.component.axes[r]}if(n.axis[r]==="independent"&&t[r]&&t[r].length>1)for(const[a,s]of(t[r]||[]).entries())a>0&&s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function O$e(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],a=t[i];if(!!r!=!!a)return;if(r&&a){const s=r.getWithExplicit("orient"),o=a.getWithExplicit("orient");if(s.explicit&&o.explicit&&s.value!==o.value)return;e[i]=R$e(r,a)}}}else return t.map(n=>n.clone());return e}function R$e(e,t){for(const n of cW){const i=qu(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,a)=>{switch(n){case"title":return yY(r,a);case"gridScale":return{explicit:r.explicit,value:un(r.value,a.value)}}return S2(r,a,n,"axis")});e.setWithExplicit(n,i)}return e}function z$e(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Ce(n.labelAngle)?n.labelAngle:np(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===TX(i,r))return!0}return e===n[t]}const B$e=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function L$e(e,t){var S,w;let n=t.axis(e);const i=new A6,r=An(t.encoding[e]),{mark:a,config:s}=t,o=(n==null?void 0:n.orient)||((S=s[e==="x"?"axisX":"axisY"])==null?void 0:S.orient)||((w=s.axis)==null?void 0:w.orient)||wCe(e),l=t.getScaleComponent(e).get("type"),f=yCe(e,l,o,t.config),d=n!==void 0?!n:I3("disable",s.style,n==null?void 0:n.style,f).configValue;if(i.set("disable",d,n!==void 0),d)return i;n=n||{};const h=ECe(r,n,e,s.style,f),p=JY(n.formatType,r,l),y=KY(r,r.type,n.format,n.formatType,s,!0),v={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:l,orient:o,labelAngle:h,format:y,formatType:p,mark:a,config:s};for(const _ of cW){const C=_ in xz?xz[_](v):V9(_)?n[_]:void 0,$=C!==void 0,M=z$e(C,_,n,t,e);if($&&M)i.set(_,C,M);else{const{configValue:T=void 0,configFrom:F=void 0}=V9(_)&&_!=="values"?I3(_,s.style,n.style,f):{},R=T!==void 0;$&&!R?i.set(_,C,M):(F!=="vgAxisConfig"||B$e.has(_)&&R||am(T)||Ce(T))&&i.set(_,T,!1)}}const b=n.encoding??{},E=dV.reduce((_,C)=>{if(!i.hasAxisPart(C))return _;const $=RX(b[C]??{},t),M=C==="labels"?M$e(t,e,$):$;return M!==void 0&&!Rt(M)&&(_[C]={update:M}),_},{});return Rt(E)||i.set("encode",E,!!n.encoding||n.labelAngle!==void 0),i}function j$e({encoding:e,size:t}){for(const n of Mo){const i=rr(n);vs(t[i])&&Su(e[n])&&(delete t[i],ge(SY(i)))}return t}const U$e={vgMark:"arc",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Mi("x",e,{defaultPos:"mid"}),...Mi("y",e,{defaultPos:"mid"}),...So(e,"radius"),...So(e,"theta")})},P$e={vgMark:"area",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...yb("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...yb("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...l6(e)})},I$e={vgMark:"rect",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...So(e,"x"),...So(e,"y")})},q$e={vgMark:"shape",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&pe(n)&&n.type===hh?{field:ve(n,{expr:"datum"})}:{}}]}},H$e={vgMark:"image",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...So(e,"x"),...So(e,"y"),...o6(e,"url")})},G$e={vgMark:"line",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Mi("x",e,{defaultPos:"mid"}),...Mi("y",e,{defaultPos:"mid"}),...Wn("size",e,{vgChannel:"strokeWidth"}),...l6(e)})},Y$e={vgMark:"trail",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Mi("x",e,{defaultPos:"mid"}),...Mi("y",e,{defaultPos:"mid"}),...Wn("size",e),...l6(e)})};function w6(e,t){const{config:n}=e;return{...aa(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Mi("x",e,{defaultPos:"mid"}),...Mi("y",e,{defaultPos:"mid"}),...Wn("size",e),...Wn("angle",e),...V$e(e,n,t)}}function V$e(e,t,n){return n?{shape:{value:n}}:Wn("shape",e)}const X$e={vgMark:"symbol",encodeEntry:e=>w6(e)},W$e={vgMark:"symbol",encodeEntry:e=>w6(e,"circle")},Q$e={vgMark:"symbol",encodeEntry:e=>w6(e,"square")},Z$e={vgMark:"rect",encodeEntry:e=>({...aa(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...So(e,"x"),...So(e,"y")})},K$e={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...aa(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...yb("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...yb("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Wn("size",e,{vgChannel:"strokeWidth"})}}},J$e={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...aa(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Mi("x",e,{defaultPos:"mid"}),...Mi("y",e,{defaultPos:"mid"}),...o6(e),...Wn("size",e,{vgChannel:"fontSize"}),...Wn("angle",e),...mz("align",eDe(e.markDef,n,t)),...mz("baseline",tDe(e.markDef,n,t)),...Mi("radius",e,{defaultPos:null}),...Mi("theta",e,{defaultPos:null})}}};function eDe(e,t,n){if(kt("align",e,n)===void 0)return"center"}function tDe(e,t,n){if(kt("baseline",e,n)===void 0)return"middle"}const nDe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"x":"y",a=i==="horizontal"?"y":"x",s=i==="horizontal"?"height":"width";return{...aa(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...So(e,r),...Mi(a,e,{defaultPos:"mid",vgChannel:a==="y"?"yc":"xc"}),[s]:Ut(kt("thickness",n,t))}}},ay={arc:U$e,area:P$e,bar:I$e,circle:W$e,geoshape:q$e,image:H$e,line:G$e,point:X$e,rect:Z$e,rule:K$e,square:Q$e,text:J$e,tick:nDe,trail:Y$e};function iDe(e){if(et([f2,l2,fAe],e.mark)){const t=bV(e.mark,e.encoding);if(t.length>0)return rDe(e,t)}else if(e.mark===c2){const t=C3.some(n=>kt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return aDe(e)}return _6(e)}const Rz="faceted_path_";function rDe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Rz+e.requestDataName(Wt.Main),data:e.requestDataName(Wt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:_6(e,{fromPrefix:Rz})}]}const zz="stack_group_";function aDe(e){var f;const[t]=_6(e,{fromPrefix:zz}),n=e.scaleName(e.stack.fieldChannel),i=(d={})=>e.vgField(e.stack.fieldChannel,d),r=(d,h)=>{const p=[i({prefix:"min",suffix:"start",expr:h}),i({prefix:"max",suffix:"start",expr:h}),i({prefix:"min",suffix:"end",expr:h}),i({prefix:"max",suffix:"end",expr:h})];return`${d}(${p.map(y=>`scale('${n}',${y})`).join(",")})`};let a,s;e.stack.fieldChannel==="x"?(a={...Nd(t.encode.update,["y","yc","y2","height",...C3]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={..._r(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(a={...Nd(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={..._r(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const d of C3){const h=ms(d,e.markDef,e.config);t.encode.update[d]?(a[d]=t.encode.update[d],delete t.encode.update[d]):h&&(a[d]=Ut(h)),h&&(t.encode.update[d]={value:0})}const o=[];if(((f=e.stack.groupbyChannels)==null?void 0:f.length)>0)for(const d of e.stack.groupbyChannels){const h=e.fieldDef(d),p=ve(h);p&&o.push(p),(h!=null&&h.bin||h!=null&&h.timeUnit)&&o.push(ve(h,{binSuffix:"end"}))}return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((d,h)=>{if(t.encode.update[h])return{...d,[h]:t.encode.update[h]};{const p=ms(h,e.markDef,e.config);return p!==void 0?{...d,[h]:Ut(p)}:d}},a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Wt.Main),name:zz+e.requestDataName(Wt.Main),groupby:o,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function sDe(e){const{encoding:t,stack:n,mark:i,markDef:r,config:a}=e,s=t.order;if(!(!Se(s)&&Da(s)&&w3(s.value)||!s&&w3(kt("order",r,a)))){if((Se(s)||pe(s))&&!n)return gY(s,{expr:"datum"});if(rl(i)){const o=r.orient==="horizontal"?"y":"x",l=t[o];if(pe(l))return{field:o}}}}function _6(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:a}=e,s=un(i.clip,oDe(e),uDe(e)),o=dY(i),l=r.key,f=sDe(e),d=lDe(e),h=kt("aria",i,a),p=ay[n].postEncodingTransform?ay[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:ay[n].vgMark,...s?{clip:s}:{},...o?{style:o}:{},...l?{key:l.field}:{},...f?{sort:f}:{},...d||{},...h===!1?{aria:h}:{},from:{data:t.fromPrefix+e.requestDataName(Wt.Main)},encode:{update:ay[n].encodeEntry(e)},...p?{transform:p}:{}}]}function oDe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function uDe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function lDe(e){if(!e.component.selection)return null;const t=fe(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=fe(i.component.selection).length,i=i.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class fW extends sW{constructor(n,i,r,a={},s){super(n,"unit",i,r,s,void 0,W9(n)?n.view:void 0);ce(this,"markDef");ce(this,"encoding");ce(this,"specifiedScales",{});ce(this,"stack");ce(this,"specifiedAxes",{});ce(this,"specifiedLegends",{});ce(this,"specifiedProjection",{});ce(this,"selection",[]);ce(this,"children",[]);ce(this,"correctDataNames",n=>{var i,r,a;return(i=n.from)!=null&&i.data&&(n.from.data=this.lookupDataSource(n.from.data),"time"in this.encoding&&(n.from.data=n.from.data+eX)),(a=(r=n.from)==null?void 0:r.facet)!=null&&a.data&&(n.from.facet.data=this.lookupDataSource(n.from.facet.data)),n});const o=ys(n.mark)?{...n.mark}:{type:n.mark},l=o.type;o.filled===void 0&&(o.filled=Vwe(o,s,{graticule:n.data&&a6(n.data)}));const f=this.encoding=ZAe(n.encoding||{},l,o.filled,s);this.markDef=UV(o,f,s),this.size=j$e({encoding:f,size:W9(n)?{...a,...n.width?{width:n.width}:{},...n.height?{height:n.height}:{}}:a}),this.stack=jV(this.markDef,f),this.specifiedScales=this.initScales(l,f),this.specifiedAxes=this.initAxes(f),this.specifiedLegends=this.initLegends(f),this.specifiedProjection=n.projection,this.selection=(n.params??[]).filter(d=>e6(d))}get hasProjection(){const{encoding:n}=this,i=this.mark===GY,r=n&&q2e.some(a=>qe(n[a]));return i||r}scaleDomain(n){const i=this.specifiedScales[n];return i?i.domain:void 0}axis(n){return this.specifiedAxes[n]}legend(n){return this.specifiedLegends[n]}initScales(n,i){return mk.reduce((r,a)=>{const s=An(i[a]);return s&&(r[a]=this.initScale(s.scale??{})),r},{})}initScale(n){const{domain:i,range:r}=n,a=Vn(n);return Se(i)&&(a.domain=i.map(br)),Se(r)&&(a.range=r.map(br)),a}initAxes(n){return Mo.reduce((i,r)=>{const a=n[r];if(qe(a)||r===Gt&&qe(n.x2)||r===In&&qe(n.y2)){const s=qe(a)?a.axis:void 0;i[r]=s&&this.initAxis({...s})}return i},{})}initAxis(n){const i=fe(n),r={};for(const a of i){const s=n[a];r[a]=am(s)?fY(s):br(s)}return r}initLegends(n){return eEe.reduce((i,r)=>{const a=An(n[r]);if(a&&nEe(r)){const s=a.legend;i[r]=s&&Vn(s)}return i},{})}parseData(){this.component.data=j2(this)}parseLayoutSize(){S$e(this)}parseSelections(){this.component.selection=hCe(this,this.selection)}parseMarkGroup(){this.component.mark=iDe(this)}parseAxesAndHeaders(){this.component.axes=k$e(this)}assembleSelectionTopLevelSignals(n){return U_e(this,n)}assembleSignals(){return[...CX(this),...L_e(this,[])]}assembleSelectionData(n){return P_e(this,n)}assembleLayout(){return null}assembleLayoutSignals(){return h6(this)}assembleMarks(){let n=this.component.mark??[];return(!this.parent||!vh(this.parent))&&(n=rX(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:n}=this.view||{};return n!==void 0?n:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(n){return ec(this.encoding,n)}fieldDef(n){const i=this.encoding[n];return Ta(i)}typedFieldDef(n){const i=this.fieldDef(n);return zi(i)?i:null}}class C6 extends E6{constructor(n,i,r,a,s){super(n,"layer",i,r,s,n.resolve,n.view);ce(this,"children");const o={...a,...n.width?{width:n.width}:{},...n.height?{height:n.height}:{}};this.children=n.layer.map((l,f)=>{if(E2(l))return new C6(l,this,this.getName(`layer_${f}`),o,s);if(ko(l))return new fW(l,this,this.getName(`layer_${f}`),o,s);throw new Error(vk(l))})}parseData(){this.component.data=j2(this);for(const n of this.children)n.parseData()}parseLayoutSize(){x$e(this)}parseSelections(){this.component.selection={};for(const n of this.children){n.parseSelections();for(const i of fe(n.component.selection))this.component.selection[i]=n.component.selection[i]}mn(this.component.selection).some(n=>us(n))&&Ek(xk)}parseMarkGroup(){for(const n of this.children)n.parseMarkGroup()}parseAxesAndHeaders(){F$e(this)}assembleSelectionTopLevelSignals(n){return this.children.reduce((i,r)=>r.assembleSelectionTopLevelSignals(i),n)}assembleSignals(){return this.children.reduce((n,i)=>n.concat(i.assembleSignals()),CX(this))}assembleLayoutSignals(){return this.children.reduce((n,i)=>n.concat(i.assembleLayoutSignals()),h6(this))}assembleSelectionData(n){return this.children.reduce((i,r)=>r.assembleSelectionData(i),n)}assembleGroupStyle(){const n=new Set;for(const r of this.children)for(const a of on(r.assembleGroupStyle()))n.add(a);const i=Array.from(n);return i.length>1?i:i.length===1?i[0]:void 0}assembleTitle(){let n=super.assembleTitle();if(n)return n;for(const i of this.children)if(n=i.assembleTitle(),n)return n}assembleLayout(){return null}assembleMarks(){return I_e(this,this.children.flatMap(n=>n.assembleMarks()))}assembleLegends(){return this.children.reduce((n,i)=>n.concat(i.assembleLegends()),qX(this))}}function $6(e,t,n,i,r){if(g2(e))return new Dg(e,t,n,r);if(E2(e))return new C6(e,t,n,i,r);if(ko(e))return new fW(e,t,n,i,r);if(Ewe(e))return new $$e(e,t,n,r);throw new Error(vk(e))}function cDe(e,t={}){t.logger&&_Se(t.logger),t.fieldTitle&&lV(t.fieldTitle);try{const n=LV(MG(t.config,e.config)),i=VV(e,n),r=$6(i,null,"",void 0,n);return r.parse(),O3e(r.component.data,r),{spec:dDe(r,fDe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&CSe(),t.fieldTitle&&IAe()}}function fDe(e,t,n,i){const r=i.component.layoutSize.get("width"),a=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):He(t)&&(t={type:t}),r&&a&&D_e(t.type)){if(r==="step"&&a==="step")ge(F9()),t.type="pad";else if(r==="step"||a==="step"){const s=r==="step"?"width":"height";ge(F9(i2(s)));const o=s==="width"?"height":"width";t.type=T_e(o)}}return{...fe(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...oz(n,!1),...oz(e,!0)}}function dDe(e,t,n={},i){const r=e.config?Rwe(e.config):void 0,a=m$e(e.component.data,n),s=e.assembleSelectionData(a),o=e.assembleProjections(),l=e.assembleTitle(),f=e.assembleGroupStyle(),d=e.assembleGroupEncodeEntry(!0);let h=e.assembleLayoutSignals();h=h.filter(v=>(v.name==="width"||v.name==="height")&&v.value!==void 0?(t[v.name]=+v.value,!1):!0);const{params:p,...y}=t;return{$schema:"https://vega.github.io/schema/vega/v6.json",...e.description?{description:e.description}:{},...y,...l?{title:l}:{},...f?{style:f}:{},...d?{encode:{update:d}}:{},data:s,...o.length>0?{projections:o}:{},...e.assembleGroup([...h,...e.assembleSelectionTopLevelSignals([]),...OV(p)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}const hDe=B2e.version,gDe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:Od,accessPathWithDatum:uk,accessWithDatumToUnescapedPath:wt,compile:cDe,contains:et,deepEqual:Sr,deleteNestedProperty:ob,duplicate:Ue,entries:Uu,every:ak,fieldIntersection:ok,flatAccessWithDatum:YG,getFirstDefined:un,hasIntersection:sk,hasProperty:de,hash:rt,internalField:WG,isBoolean:tp,isEmpty:Rt,isEqual:j2e,isInternalField:QG,isNullOrFalse:w3,isNumeric:Zx,keys:fe,logicalExpr:Cg,mergeDeep:HG,never:qG,normalize:VV,normalizeAngle:np,omit:_r,pick:Nd,prefixGenerator:_3,removePathFromField:fh,replaceAll:yc,replacePathInField:ta,resetIdCounter:P2e,setEqual:GG,some:Fd,stringify:Et,titleCase:Xp,unique:ns,uniqueId:XG,vals:mn,varName:qt,version:hDe},Symbol.toStringTag,{value:"Module"}));var sy={},Bz;function pDe(){if(Bz)return sy;Bz=1,Object.defineProperty(sy,"__esModule",{value:!0});function e(t){var n=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g,i=n.exec(t).slice(1,3),r=i[0],a=i[1];return{library:r,version:a}}return sy.default=e,sy}var mDe=pDe();const dW=up(mDe);var yDe="2.15.0",vDe={version:yDe};const Hf="#fff",Lz="#888",bDe={background:"#333",view:{stroke:Lz},title:{color:Hf,subtitleColor:Hf},style:{"guide-label":{fill:Hf},"guide-title":{fill:Hf}},axis:{domainColor:Hf,gridColor:Lz,tickColor:Hf}},Cl="#4572a7",xDe={background:"#fff",arc:{fill:Cl},area:{fill:Cl},line:{stroke:Cl,strokeWidth:2},path:{stroke:Cl},rect:{fill:Cl},shape:{stroke:Cl},symbol:{fill:Cl,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},$l="#30a2da",__="#cbcbcb",EDe="#999",SDe="#333",jz="#f0f0f0",Uz="#333",ADe={arc:{fill:$l},area:{fill:$l},axis:{domainColor:__,grid:!0,gridColor:__,gridWidth:1,labelColor:EDe,labelFontSize:10,titleColor:SDe,tickColor:__,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:jz,group:{fill:jz},legend:{labelColor:Uz,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Uz,titleFontSize:14,titlePadding:10},line:{stroke:$l,strokeWidth:2},path:{stroke:$l,strokeWidth:.5},rect:{fill:$l},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:$l},bar:{binSpacing:2,fill:$l,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Dl="#000",wDe={group:{fill:"#e5e5e5"},arc:{fill:Dl},area:{fill:Dl},line:{stroke:Dl},path:{stroke:Dl},rect:{fill:Dl},shape:{stroke:Dl},symbol:{fill:Dl,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},_De=22,CDe="normal",Pz="Benton Gothic, sans-serif",Iz=11.5,$De="normal",Tl="#82c6df",C_="Benton Gothic Bold, sans-serif",qz="normal",Hz=13,L0={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},DDe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:C_,fontSize:_De,fontWeight:CDe},arc:{fill:Tl},area:{fill:Tl},line:{stroke:Tl,strokeWidth:2},path:{stroke:Tl},rect:{fill:Tl},shape:{stroke:Tl},symbol:{fill:Tl,size:30},axis:{labelFont:Pz,labelFontSize:Iz,labelFontWeight:$De,titleFont:C_,titleFontSize:Hz,titleFontWeight:qz},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Pz,labelFontSize:Iz,symbolType:"square",titleFont:C_,titleFontSize:Hz,titleFontWeight:qz},range:{category:L0["category-6"],diverging:L0["fireandice-6"],heatmap:L0["fire-7"],ordinal:L0["fire-7"],ramp:L0["fire-7"]}},Ml="#ab5787",oy="#979797",TDe={background:"#f9f9f9",arc:{fill:Ml},area:{fill:Ml},line:{stroke:Ml},path:{stroke:Ml},rect:{fill:Ml},shape:{stroke:Ml},symbol:{fill:Ml,size:30},axis:{domainColor:oy,domainWidth:.5,gridWidth:.2,labelColor:oy,tickColor:oy,tickWidth:.2,titleColor:oy},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},kl="#3e5c69",MDe={background:"#fff",arc:{fill:kl},area:{fill:kl},line:{stroke:kl},path:{stroke:kl},rect:{fill:kl},shape:{stroke:kl},symbol:{fill:kl},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Pr="#1696d2",Gz="#000000",kDe="#FFFFFF",uy="Lato",$_="Lato",NDe="Lato",FDe="#DEDDDD",ODe=18,j0={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},RDe={background:kDe,title:{anchor:"start",fontSize:ODe,font:uy},axisX:{domain:!0,domainColor:Gz,domainWidth:1,grid:!1,labelFontSize:12,labelFont:$_,labelAngle:0,tickColor:Gz,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:uy},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:FDe,gridWidth:1,labelFontSize:12,labelFont:$_,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:uy,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:$_,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:uy,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:j0["six-groups-cat-1"],diverging:j0["diverging-colors"],heatmap:j0["diverging-colors"],ordinal:j0["six-groups-seq"],ramp:j0["shades-blue"]},area:{fill:Pr},rect:{fill:Pr},line:{color:Pr,stroke:Pr,strokeWidth:5},trail:{color:Pr,stroke:Pr,strokeWidth:0,size:1},path:{stroke:Pr,strokeWidth:.5},point:{filled:!0},text:{font:NDe,color:Pr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Pr,stroke:null}},arc:{fill:Pr},shape:{stroke:Pr},symbol:{fill:Pr,size:30}},Nl="#3366CC",Yz="#ccc",ly="Arial, sans-serif",zDe={arc:{fill:Nl},area:{fill:Nl},path:{stroke:Nl},rect:{fill:Nl},shape:{stroke:Nl},symbol:{stroke:Nl},circle:{fill:Nl},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:ly,fontSize:12},"guide-title":{font:ly,fontSize:12},"group-title":{font:ly,fontSize:12}},title:{font:ly,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Yz,tickColor:Yz,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},D6=e=>e*(1/3+1),Vz=D6(9),Xz=D6(10),Wz=D6(12),U0="Segoe UI",Qz="wf_standard-font, helvetica, arial, sans-serif",Zz="#252423",P0="#605E5C",Kz="transparent",BDe="#C8C6C4",fa="#118DFF",LDe="#12239E",jDe="#E66C37",UDe="#6B007B",PDe="#E044A7",IDe="#744EC2",qDe="#D9B300",HDe="#D64550",hW=fa,gW="#DEEFFF",Jz=[gW,hW],GDe=[gW,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",hW],YDe={view:{stroke:Kz},background:Kz,font:U0,header:{titleFont:Qz,titleFontSize:Wz,titleColor:Zz,labelFont:U0,labelFontSize:Xz,labelColor:P0},axis:{ticks:!1,grid:!1,domain:!1,labelColor:P0,labelFontSize:Vz,titleFont:Qz,titleColor:Zz,titleFontSize:Wz,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:BDe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:fa},line:{stroke:fa,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:U0,fontSize:Vz,fill:P0},arc:{fill:fa},area:{fill:fa,line:!0,opacity:.6},path:{stroke:fa},rect:{fill:fa},point:{fill:fa,filled:!0,size:75},shape:{stroke:fa},symbol:{fill:fa,strokeWidth:1.5,size:50},legend:{titleFont:U0,titleFontWeight:"bold",titleColor:P0,labelFont:U0,labelFontSize:Xz,labelColor:P0,symbolType:"circle",symbolSize:75},range:{category:[fa,LDe,jDe,UDe,PDe,IDe,qDe,HDe],diverging:Jz,heatmap:Jz,ordinal:GDe}},D_='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',VDe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',T_=400,cy={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},XDe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],WDe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function U2({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",i=cy.gridBg[e],r=cy.textPrimary[e],a=cy.textSecondary[e],s=n==="dark"?XDe:WDe,o=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:o},area:{fill:o},path:{stroke:o},rect:{fill:o},shape:{stroke:o},symbol:{stroke:o},circle:{fill:o},view:{fill:i,stroke:i},group:{fill:i},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:D_,fontWeight:600},axis:{labelColor:a,labelFontSize:12,labelFont:VDe,labelFontWeight:T_,titleColor:r,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:cy.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:D_,fill:a,fontWeight:T_},"guide-title":{font:D_,fill:a,fontWeight:T_}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const QDe=U2({theme:"white",background:"#ffffff"}),ZDe=U2({theme:"g10",background:"#f4f4f4"}),KDe=U2({theme:"g90",background:"#262626"}),JDe=U2({theme:"g100",background:"#161616"}),eTe=vDe.version,tTe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:ZDe,carbong100:JDe,carbong90:KDe,carbonwhite:QDe,dark:bDe,excel:xDe,fivethirtyeight:ADe,ggplot2:wDe,googlecharts:zDe,latimes:DDe,powerbi:YDe,quartz:TDe,urbaninstitute:RDe,version:eTe,vox:MDe},Symbol.toStringTag,{value:"Module"})),nTe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`,pW="vg-tooltip-element",iTe={offsetX:10,offsetY:10,id:pW,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:rTe,maxDepth:2};function rTe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function aTe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return nTe.toString().replace(pW,e)}var sTe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function oTe(e,t,n){if(De(e))return`[${e.map(i=>t(ft(i)?i:eB(i,n))).join(", ")}]`;if(Pe(e)){let i="";const r=e,{title:a}=r,s=sTe(r,["title"]);a&&(i+=`<h2>${t(a)}</h2>`);const o=Object.keys(s);if(o.length>0){i+="<table>";for(const l of o){let f=s[l];f!==void 0&&(Pe(f)&&(f=eB(f,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(f)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function uTe(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function eB(e,t){return JSON.stringify(e,uTe(t))}function lTe(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let a=e.clientY+i;return a+t.height>window.innerHeight&&(a=+e.clientY-i-t.height),{x:r,y:a}}class cTe{constructor(t){this.options=Object.assign(Object.assign({},iTe),t);const n=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=aTe(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}this.el=document.getElementById(n),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",n),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltipHandler(t,n,i,r){if(r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=oTe(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:a,y:s}=lTe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${a}px`)}}function fTe(e,t,n){const i=e.open(t),r=250;let a=40;function s(l){l.source===i&&(a=0,e.removeEventListener("message",s,!1))}e.addEventListener("message",s,!1);function o(){a<=0||(i.postMessage(n,"*"),setTimeout(o,r),a-=1)}setTimeout(o,r)}const dTe=`.vega-embed {
  position: relative;
  display: inline-block; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: scroll;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function mW(e,...t){for(const n of t)hTe(e,n);return e}function hTe(e,t){for(const n of Object.keys(t))kb(e,n,t[n],!0)}var M_;const hu=rxe;let op=gDe;const fy=typeof window<"u"?window:void 0;op===void 0&&(!((M_=fy==null?void 0:fy.vl)===null||M_===void 0)&&M_.compile)&&(op=fy.vl);const gTe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},pTe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},fg={vega:"Vega","vega-lite":"Vega-Lite"},Eb={vega:hu.version,"vega-lite":op?op.version:"not available"},mTe={vega:e=>e,"vega-lite":(e,t)=>op.compile(e,{config:t}).spec},yTe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`;function vTe(e){return typeof e=="function"}function tB(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(r+e+a),s.document.title=`${fg[i]} JSON Source`}function bTe(e,t){var n;if(e.$schema){const i=dW(e.$schema);t&&t!==i.library&&console.warn(`The given visualization spec is written in ${fg[i.library]}, but mode argument sets ${(n=fg[t])!==null&&n!==void 0?n:t}.`);const r=i.library;return pB.satisfies(Eb[r],`^${i.version.slice(1)}`)||console.warn(`The input spec uses ${fg[r]} ${i.version}, but the current version of ${fg[r]} is v${Eb[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function xTe(e){return!!(e&&"load"in e)}function ETe(e,t,n={}){var i,r,a;return jy(this,void 0,void 0,function*(){const s=xTe(n.loader)?n.loader:hu.loader(n.loader),o=ft(t)?JSON.parse(yield s.load(t)):t,l=yield nB((i=o.usermeta&&o.usermeta.embedOptions)!==null&&i!==void 0?i:{},s),f=yield nB(n,s),d=Object.assign(Object.assign({},mW(f,l)),{config:Mb((r=f.config)!==null&&r!==void 0?r:{},(a=l.config)!==null&&a!==void 0?a:{})});return yield STe(e,o,d,s)})}function nB(e,t){var n;return jy(this,void 0,void 0,function*(){const i=ft(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},r=ft(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),r?{patch:r}:{}),i?{config:i}:{})})}function STe(e,t,n={},i){var r,a,s,o,l,f;return jy(this,void 0,void 0,function*(){const d=n.theme?Mb(tTe[n.theme],(r=n.config)!==null&&r!==void 0?r:{}):n.config,h=y$(n.actions)?n.actions:mW({},gTe,(a=n.actions)!==null&&a!==void 0?a:{}),p=Object.assign(Object.assign({},pTe),n.i18n),y=(s=n.renderer)!==null&&s!==void 0?s:"canvas",v=(o=n.logLevel)!==null&&o!==void 0?o:hu.Warn,b=(l=n.downloadFileName)!==null&&l!==void 0?l:"visualization";if(n.defaultStyle!==!1){const R="vega-embed-style";if(!document.getElementById(R)){const B=document.createElement("style");B.id=R,B.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?dTe.toString():n.defaultStyle,document.head.appendChild(B)}}const E=bTe(t,n.mode);let S=mTe[E](t,d);if(E==="vega-lite"&&S.$schema){const R=dW(S.$schema);pB.satisfies(Eb.vega,`^${R.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${R.version}, but current version is v${Eb.vega}.`)}const w=typeof e=="string"?document.querySelector(e):e;if(!w)throw Error(`${e} does not exist`);w.classList.add("vega-embed"),h&&w.classList.add("has-actions"),w.innerHTML="";const _=n.patch;_&&(_ instanceof Function?S=_(S):S=Ab(S,_,!0,!1).newDocument),n.formatLocale&&hu.formatLocale(n.formatLocale),n.timeFormatLocale&&hu.timeFormatLocale(n.timeFormatLocale);const C=hu.parse(S,E==="vega-lite"?{}:d),$=new hu.View(C,{loader:i,logLevel:v,renderer:y});if(n.tooltip!==!1){let R;vTe(n.tooltip)?R=n.tooltip:R=new cTe(n.tooltip===!0?{}:n.tooltip).call,$.tooltip(R)}let{hover:M}=n;if(M===void 0&&(M=E==="vega"),M){const{hoverSet:R,updateSet:B}=typeof M=="boolean"?{}:M;$.hover(R,B)}n&&(n.width!=null&&$.width(n.width),n.height!=null&&$.height(n.height),n.padding!=null&&$.padding(n.padding)),yield $.initialize(e).runAsync();let T;if(h!==!1){let R=w;if(n.defaultStyle!==!1){const L=document.createElement("details");L.title=p.CLICK_TO_VIEW_ACTIONS,w.append(L),R=L;const Y=document.createElement("summary");Y.innerHTML=yTe,L.append(Y),T=H=>{L.contains(H.target)||L.removeAttribute("open")},document.addEventListener("click",T)}const B=document.createElement("div");if(R.append(B),B.classList.add("vega-actions"),h===!0||h.export!==!1){for(const L of["svg","png"])if(h===!0||h.export===!0||h.export[L]){const Y=p[`${L.toUpperCase()}_ACTION`],H=document.createElement("a");H.text=Y,H.href="#",H.target="_blank",H.download=`${b}.${L}`,H.addEventListener("mousedown",function(U){return jy(this,void 0,void 0,function*(){U.preventDefault();const z=yield $.toImageURL(L,n.scaleFactor);this.href=z})}),B.append(H)}}if(h===!0||h.source!==!1){const L=document.createElement("a");L.text=p.SOURCE_ACTION,L.href="#",L.addEventListener("mousedown",function(Y){var H,U;tB(cA(t),(H=n.sourceHeader)!==null&&H!==void 0?H:"",(U=n.sourceFooter)!==null&&U!==void 0?U:"",E),Y.preventDefault()}),B.append(L)}if(E==="vega-lite"&&(h===!0||h.compiled!==!1)){const L=document.createElement("a");L.text=p.COMPILED_ACTION,L.href="#",L.addEventListener("mousedown",function(Y){var H,U;tB(cA(S),(H=n.sourceHeader)!==null&&H!==void 0?H:"",(U=n.sourceFooter)!==null&&U!==void 0?U:"","vega"),Y.preventDefault()}),B.append(L)}if(h===!0||h.editor!==!1){const L=(f=n.editorUrl)!==null&&f!==void 0?f:"https://vega.github.io/editor/",Y=document.createElement("a");Y.text=p.EDITOR_ACTION,Y.href="#",Y.addEventListener("mousedown",function(H){fTe(window,L,{config:d,mode:E,renderer:y,spec:cA(t)}),H.preventDefault()}),B.append(Y)}}function F(){T&&document.removeEventListener("click",T),$.finalize()}return{view:$,spec:t,vgSpec:S,finalize:F}})}function ATe(e){return!!e&&{}.toString.call(e)==="[object Function]"}function wTe(e,t,n){n&&(ATe(n)?n(e.data(t)):e.change(t,hu.changeset().remove(()=>!0).insert(n)))}function _Te(e,t){Object.keys(t).forEach(n=>{wTe(e,n,t[n])})}function yW(e){const t=new Set;return e.forEach(n=>{Object.keys(n).forEach(i=>{t.add(i)})}),t}const vW=()=>{};function k_(e,t){const n=Object.keys(t);return n.forEach(i=>{try{e.addSignalListener(i,t[i])}catch(r){console.warn("Cannot add invalid signal listener.",r)}}),n.length>0}var N_,iB;function CTe(){return iB||(iB=1,N_=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,a;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!==0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),i=a.length,i!==Object.keys(n).length)return!1;for(r=i;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[r]))return!1;for(r=i;r--!==0;){var s=a[r];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n}),N_}var $Te=CTe();const DTe=up($Te);function TTe(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},i=yW([e,t]);return i.has("width")&&(!("width"in e)||!("width"in t)||e.width!==t.width)&&("width"in e&&typeof e.width=="number"?n.width=e.width:n.isExpensive=!0),i.has("height")&&(!("height"in e)||!("height"in t)||e.height!==t.height)&&("height"in e&&typeof e.height=="number"?n.height=e.height:n.isExpensive=!0),i.delete("width"),i.delete("height"),[...i].some(r=>!(r in e)||!(r in t)||!DTe(e[r],t[r]))&&(n.isExpensive=!0),n.width!==!1||n.height!==!1||n.isExpensive?n:!1}function rB(e,t){const n=Object.keys(t);return n.forEach(i=>{try{e.removeSignalListener(i,t[i])}catch(r){console.warn("Cannot remove invalid signal listener.",r)}}),n.length>0}function F_(e){const{spec:t,width:n,height:i}=e;return typeof n<"u"&&typeof i<"u"?{...t,width:n,height:i}:typeof n<"u"?{...t,width:n}:typeof i<"u"?{...t,height:i}:t}function dg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bW extends Yl.PureComponent{constructor(){super(...arguments),dg(this,"containerRef",Yl.createRef()),dg(this,"resultPromise",void 0),dg(this,"handleError",t=>{const{onError:n=vW}=this.props;n(t,this.containerRef.current),console.warn(t)}),dg(this,"modifyView",t=>{this.resultPromise&&this.resultPromise.then(n=>(n&&t(n.view),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate(t){const n=yW([this.props,t]);if(n.delete("className"),n.delete("signalListeners"),n.delete("spec"),n.delete("style"),n.delete("width"),n.delete("height"),Array.from(n).some(i=>this.props[i]!==t[i]))this.clearView(),this.createView();else{const i=TTe(F_(this.props),F_(t)),{signalListeners:r}=this.props,{signalListeners:a}=t;if(i)if(i.isExpensive)this.clearView(),this.createView();else{const s=!O_(r,a);this.modifyView(o=>{i.width!==!1&&o.width(i.width),i.height!==!1&&o.height(i.height),s&&(a&&rB(o,a),r&&k_(o,r)),o.run()})}else O_(r,a)||this.modifyView(s=>{a&&rB(s,a),r&&k_(s,r),s.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:n,signalListeners:i={},width:r,height:a,...s}=this.props;if(this.containerRef.current){const o=F_(this.props);this.resultPromise=ETe(this.containerRef.current,o,s).then(l=>{if(l){const{view:f}=l;k_(f,i)&&f.run()}return l}).catch(this.handleError),n&&this.modifyView(n)}}clearView(){return this.resultPromise&&this.resultPromise.then(t=>{t&&t.finalize()}).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:n}=this.props;return Yl.createElement("div",{ref:this.containerRef,className:t,style:n})}}dg(bW,"propTypes",{className:jF.string,onError:jF.func});function K3(){return K3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},K3.apply(this,arguments)}function J3(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const MTe={};class xW extends Yl.PureComponent{constructor(){super(...arguments),J3(this,"vegaEmbed",Yl.createRef()),J3(this,"handleNewView",t=>{this.update();const{onNewView:n=vW}=this.props;n(t)})}componentDidMount(){this.update()}componentDidUpdate(t){O_(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView(n=>{_Te(n,t),n.resize().run()})}render(){const{data:t,...n}=this.props;return Yl.createElement(bW,K3({ref:this.vegaEmbed},n,{onNewView:this.handleNewView}))}}J3(xW,"defaultProps",{data:MTe});function e$(){return e$=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e$.apply(this,arguments)}function kTe(e){return Yl.createElement(xW,e$({},e,{mode:"vega-lite"}))}const Gl={LINE:"line",BAR:"bar",AREA:"area"},aB={baci:{availableMetrics:[{value:"value",label:"Trade Value (USD)",format:"currency"},{value:"quantity",label:"Trade Quantity",format:"number"},{value:"unit_value",label:"Unit Value (USD/unit)",format:"currency"}],defaultMetric:"value",dateField:"year",groupByFields:[{value:"product",label:"Product",field:"product_code"},{value:"exporter",label:"Exporter Country",field:"exporter_name"},{value:"importer",label:"Importer Country",field:"importer_name"}],defaultGroupBy:"importer",timeRange:{min:2017,max:2022},colors:["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316"]},prodcom:{availableMetrics:[{value:"value",label:"Manufacturing Value",format:"currency"},{value:"volume",label:"Volume",format:"number"},{value:"average_price",label:"Average Price",format:"currency"}],defaultMetric:"value",dateField:"year",groupByFields:[{value:"product",label:"Product",field:"description"},{value:"type",label:"Product Type",field:"type"}],defaultGroupBy:"product",timeRange:{min:2014,max:2024},colors:["#8b5cf6","#ec4899","#10b981","#f59e0b","#3b82f6","#ef4444","#14b8a6","#f97316"]}},NTe={[Gl.LINE]:{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"line",point:!0,strokeWidth:2},encoding:{x:{field:"year",type:"temporal",axis:{title:"Year",titleColor:"#9ca3af",labelColor:"#9ca3af",grid:!1,tickColor:"#374151",domainColor:"#374151"}},y:{field:"value",type:"quantitative",axis:{titleColor:"#9ca3af",labelColor:"#9ca3af",grid:!0,gridColor:"#374151",tickColor:"#374151",domainColor:"#374151"}},color:{field:"group",type:"nominal",legend:{titleColor:"#9ca3af",labelColor:"#9ca3af",orient:"bottom"}},tooltip:[{field:"year",type:"temporal",title:"Year"},{field:"group",type:"nominal",title:"Series"},{field:"value",type:"quantitative",title:"Value"}]},background:"#1f2937",config:{view:{stroke:"transparent",continuousWidth:600,continuousHeight:300},axis:{domainColor:"#374151",gridColor:"#374151",tickColor:"#374151"}}},[Gl.BAR]:{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"bar",strokeWidth:1,stroke:"#374151"},encoding:{x:{field:"year",type:"temporal",axis:{title:"Year",titleColor:"#9ca3af",labelColor:"#9ca3af",grid:!1,tickColor:"#374151",domainColor:"#374151"}},y:{field:"value",type:"quantitative",axis:{titleColor:"#9ca3af",labelColor:"#9ca3af",grid:!0,gridColor:"#374151",tickColor:"#374151",domainColor:"#374151"}},color:{field:"group",type:"nominal",legend:{titleColor:"#9ca3af",labelColor:"#9ca3af",orient:"bottom"}},tooltip:[{field:"year",type:"temporal",title:"Year"},{field:"group",type:"nominal",title:"Series"},{field:"value",type:"quantitative",title:"Value"}]},background:"#1f2937",config:{view:{stroke:"transparent",continuousWidth:600,continuousHeight:300},axis:{domainColor:"#374151",gridColor:"#374151",tickColor:"#374151"}}},[Gl.AREA]:{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"area",opacity:.7,strokeWidth:2},encoding:{x:{field:"year",type:"temporal",axis:{title:"Year",titleColor:"#9ca3af",labelColor:"#9ca3af",grid:!1,tickColor:"#374151",domainColor:"#374151"}},y:{field:"value",type:"quantitative",axis:{titleColor:"#9ca3af",labelColor:"#9ca3af",grid:!0,gridColor:"#374151",tickColor:"#374151",domainColor:"#374151"}},color:{field:"group",type:"nominal",legend:{titleColor:"#9ca3af",labelColor:"#9ca3af",orient:"bottom"}},tooltip:[{field:"year",type:"temporal",title:"Year"},{field:"group",type:"nominal",title:"Series"},{field:"value",type:"quantitative",title:"Value"}]},background:"#1f2937",config:{view:{stroke:"transparent",continuousWidth:600,continuousHeight:300},axis:{domainColor:"#374151",gridColor:"#374151",tickColor:"#374151"}}}},FTe=e=>aB[e]||aB.baci,OTe=(e,t,n,i,r,a)=>{const s=NTe[e];if(!s)return null;const o=n.availableMetrics.find(d=>d.value===i)||n.availableMetrics[0],l=a.find(d=>d.value===r)||a[0],f=JSON.parse(JSON.stringify(s));return f.data={url:t,format:{type:"json",property:"data"}},f.transform=[{filter:`datum.${i} > 0`},{aggregate:[{op:"sum",field:i,as:"value"}],groupby:["year",l.field]}],f.encoding.x.field="year",f.encoding.x.type="ordinal",f.encoding.y.field="value",f.encoding.color.field=l.field,f.width=600,f.height=300,f.encoding.y.axis.title=o.label,f.encoding.color.legend.title=l.label,f.encoding.tooltip=[{field:"year",type:"ordinal",title:"Year"},{field:l.field,type:"nominal",title:l.label},{field:"value",type:"quantitative",title:o.label,format:o.format==="currency"?"$,.0f":",.0f"}],n.colors&&(f.encoding.color.scale={range:n.colors}),f},RTe=({data:e=[],dataset:t="baci",query:n=null,apiUrl:i=null})=>{const r=FTe(t),{config:a}=lp(t);cp(a);const o=t==="baci"&&(n!=null&&n.tradeType)?[...r.groupByFields]:r.groupByFields,[l,f]=_e.useState(Gl.LINE),[d,h]=_e.useState(r.defaultMetric),[p,y]=_e.useState(r.defaultGroupBy),v=_e.useMemo(()=>{if(console.log("DataVisualization: Received apiUrl:",i),!i)return null;const w=new URL(i);w.searchParams.set("page","1"),w.searchParams.set("page_size","1000");const _=w.toString();return console.log("DataVisualization: Using stored API URL:",_),_},[i]),b=_e.useMemo(()=>{if(!v)return console.log("DataVisualization: No API URL available"),null;console.log("DataVisualization: Using API URL:",v),console.log("DataVisualization: Selected metric:",d),console.log("DataVisualization: Selected groupBy:",p);const w=OTe(l,v,r,d,p,o);return console.log("DataVisualization: Generated Vega spec:",w),w},[v,l,r,d,p,o]),E=r.availableMetrics.find(w=>w.value===d),S=o.find(w=>w.value===p);return n?b?j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",style:{width:"100%"},children:[j.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 gap-4",children:[j.jsxs("div",{children:[j.jsx("h4",{className:"text-lg font-semibold mb-1",children:"Data Visualization"}),j.jsxs("p",{className:"text-sm text-gray-400",children:[E==null?void 0:E.label," by ",S==null?void 0:S.label," over time"]})]}),j.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[j.jsxs("div",{className:"flex flex-col",children:[j.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Chart Type"}),j.jsxs("select",{value:l,onChange:w=>f(w.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[j.jsx("option",{value:Gl.LINE,children:"Line Chart"}),j.jsx("option",{value:Gl.BAR,children:"Bar Chart"}),j.jsx("option",{value:Gl.AREA,children:"Area Chart"})]})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Y-Axis Metric"}),j.jsx("select",{value:d,onChange:w=>h(w.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:r.availableMetrics.map(w=>j.jsx("option",{value:w.value,children:w.label},w.value))})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsx("label",{className:"text-xs text-gray-400 mb-1",children:"Group By"}),j.jsx("select",{value:p,onChange:w=>y(w.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:o.map(w=>j.jsx("option",{value:w.value,children:w.label},w.value))})]})]})]}),b&&j.jsx("div",{className:"w-full",children:j.jsx(kTe,{spec:b,actions:!0,theme:"dark",renderer:"canvas"})})]}):j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[j.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Data Visualization"}),j.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading chart data..."})]}):j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[j.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Data Visualization"}),j.jsx("div",{className:"text-center py-8 text-gray-400",children:"No query available for visualization"})]})},zTe=()=>j.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[j.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Geographic Distribution"}),j.jsx("div",{className:"h-80 bg-gray-700 rounded-lg flex items-center justify-center",children:j.jsxs("div",{className:"text-center",children:[j.jsx(aK,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),j.jsx("p",{className:"text-gray-400 text-lg",children:"Interactive Map"}),j.jsx("p",{className:"text-gray-500 text-sm",children:"Coming soon - geographic visualization of trade flows"})]})})]}),BTe=()=>j.jsxs("div",{className:"text-center py-16",children:[j.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:j.jsx(n$,{className:"w-8 h-8 text-gray-500"})}),j.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"Create your first query"}),j.jsx("p",{className:"text-gray-500",children:"Search for products and create queries to analyse trade data."})]}),LTe=(e,t=1,n=10)=>{const{config:i}=lp(e==null?void 0:e.dataset),r=cp(i),[a,s]=_e.useState([]),[o,l]=_e.useState(0),[f,d]=_e.useState(1),[h,p]=_e.useState(!1),[y,v]=_e.useState("");return _e.useEffect(()=>{if(!e||!i){s([]),l(0),d(1);return}(async()=>{p(!0);try{let E,S;if(e.dataset==="baci"){const w=e.tradeType.toLowerCase().replace("trade: ",""),_=e.products.map(M=>M[i.product.codeField]).join(","),C=e.fromCountries.map(M=>typeof M=="string"?M.toLowerCase()==="everywhere"?"everywhere":M.toLowerCase()==="world"?"world":r.getCountryCodeByName(M):M.code||M.country_code||"everywhere").join(","),$=e.toCountries.map(M=>typeof M=="string"?M.toLowerCase()==="everywhere"?"everywhere":M.toLowerCase()==="world"?"world":r.getCountryCodeByName(M):M.code||M.country_code||"everywhere").join(",");E={tradeType:w,productCodes:_,fromCountry:C,toCountry:$,yearFrom:e.startYear,yearTo:e.endYear},S=await r.executeTradeQuery(E,t,n)}else if(e.dataset==="prodcom")E={productCodes:e.products.map(_=>_[i.product.codeField]).join(","),yearFrom:e.startYear,yearTo:e.endYear,measure:e.measureType},S=await r.executeProdcomQuery(E,t,n);else throw new Error(`Unsupported dataset: ${e.dataset}`);if(s(S.data||[]),l(S.total_records||0),d(S.total_pages||1),S.apiUrl){const w=new URL(S.apiUrl);w.searchParams.delete("page"),w.searchParams.delete("page_size");const _=w.toString();console.log("useTradeQuery: Storing API URL:",_),v(_)}else console.log("useTradeQuery: No apiUrl in result:",S)}catch(E){console.error("Failed to execute trade query:",E),s([]),l(0),d(1)}finally{p(!1)}})()},[e,t,n,i,r.executeTradeQuery,r.getCountryCodeByName]),{tradeData:a,tradeDataTotal:o,tradeDataTotalPages:f,tradeDataLoading:h,apiUrl:y}},jTe=(e,t)=>{const n=e[t];return n==null?"":typeof n=="string"&&(n.includes(",")||n.includes('"')||n.includes(`
`))?`"${n.replace(/"/g,'""')}"`:String(n)},UTe=(e,t="baci")=>{if(!e||e.length===0)return"";const n=e[0],i=Object.keys(n);return[i.map(s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")).join(","),...e.map(s=>i.map(o=>jTe(s,o)).join(","))].join(`
`)},PTe=(e,t="baci",n=null)=>{if(!e||e.length===0){console.warn("No data available for CSV export");return}const i=UTe(e,t),r=n||`${t}-data`,a=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=window.URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=`${r}-${Date.now()}.csv`,o.click(),window.URL.revokeObjectURL(s)},ITe=()=>{const[e,t]=_e.useState([]),[n,i]=_e.useState(null),[r,a]=_e.useState(!1),[s,o]=_e.useState(1),[l,f]=_e.useState(10),[d,h]=_e.useState("baci"),p=["baci","prodcom"],y=e.find(U=>U.id===n),{tradeData:v,tradeDataTotal:b,tradeDataTotalPages:E,tradeDataLoading:S,apiUrl:w}=LTe(y,s,l);console.log("TradeDataPlatform: apiUrl from useTradeQuery:",w);const{config:_}=lp(y==null?void 0:y.dataset),C=cp(_);_e.useEffect(()=>{const U=()=>{};return window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[]);const $=U=>{t([...e,U]),i(U.id),o(1)},M=U=>{i(U.id),o(1)},T=U=>{t(e.filter(z=>z.id!==U)),n===U&&i(null)},F=U=>{const z=U.products.map(O=>O.code||O.product_code).join(", ");if(U.dataset==="baci"){const O=U.tradeType.replace("Trade: ",""),I=U.fromCountries.map(k=>typeof k=="string"?k:k.country_name).join(", ")||"Any",W=U.toCountries.map(k=>typeof k=="string"?k:k.country_name).join(", ")||"Any",K=O.toLowerCase()==="exports"?"to":"from";return`${O} of ${z||"products"} from ${I} ${K} ${W}`}else if(U.dataset==="prodcom"){const O=U.measureType||"Value",I=U.productTypeFilter||"Product";return`${O} for ${z||"products"} (${I} level)`}else return`Query for ${z||"products"}`},R=E,B=(s-1)*l,L=Math.min(B+l,b),Y=async()=>{if(!y||!_||!C){console.warn("No active query available for CSV export");return}const U=y.dataset||"baci";try{let z,O;if(U==="baci"){const W=y.tradeType.toLowerCase().replace("trade: ",""),K=y.products.map(X=>X[_.product.codeField]).join(","),k=y.fromCountries.map(X=>typeof X=="string"?X.toLowerCase()==="everywhere"?"everywhere":X.toLowerCase()==="world"?"world":C.getCountryCodeByName(X):X.code||X.country_code||"everywhere").join(","),V=y.toCountries.map(X=>typeof X=="string"?X.toLowerCase()==="everywhere"?"everywhere":X.toLowerCase()==="world"?"world":C.getCountryCodeByName(X):X.code||X.country_code||"everywhere").join(",");z={tradeType:W,productCodes:K,fromCountry:k,toCountry:V,yearFrom:y.startYear,yearTo:y.endYear},O=await C.executeTradeQuery(z,1,5e3)}else if(U==="prodcom")z={productCodes:y.products.map(K=>K[_.product.codeField]).join(","),yearFrom:y.startYear,yearTo:y.endYear,measure:y.measureType},O=await C.executeProdcomQuery(z,1,5e3);else throw new Error(`Unsupported dataset: ${U}`);O.data&&O.data.length>0?PTe(O.data,U):console.warn("No data available for CSV export")}catch(z){console.error("Failed to fetch data for CSV export:",z)}},H=U=>{U<1||U>R||o(U)};return j.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:j.jsxs("div",{className:"flex h-screen",children:[j.jsx(uK,{sidebarCollapsed:r,setSidebarCollapsed:a,queries:e,activeQueryId:n,handleNewQuery:()=>{},handleLoadQuery:M,handleDeleteQuery:T,getQueryDisplayName:F,selectedProducts:[]}),j.jsx("div",{className:"flex-1 p-4 md:p-8 overflow-auto min-w-0",style:{width:"100%"},children:j.jsxs("div",{className:"max-w-7xl mx-auto",style:{width:"100%"},children:[j.jsxs("div",{className:"mb-8",children:[j.jsx("h2",{className:"text-2xl font-bold mb-6",children:"TradeLens"}),j.jsx(lK,{availableDatasets:p,selectedDataset:d,onDatasetChange:h}),j.jsx(FK,{selectedDataset:d,onQueryCreated:$,disabled:!1,initialState:{}})]}),n&&j.jsxs("div",{className:"space-y-6",style:{width:"100%"},children:[j.jsx(OK,{query:e.find(U=>U.id===n),getQueryDisplayName:F,downloadCSV:Y,tradeData:v}),j.jsx(RK,{tradeData:v,tradeDataLoading:S,tradeDataTotal:b,startIndex:B,endIndex:L,totalPages:R,currentPage:s,goToPage:H,rowsPerPage:l,dataset:(y==null?void 0:y.dataset)||"baci"}),j.jsx(RTe,{data:v,dataset:(y==null?void 0:y.dataset)||"baci",query:y,apiUrl:w}),j.jsx(zTe,{})]}),!n&&j.jsx(BTe,{})]})})]})})};function qTe(){return j.jsx(ITe,{})}ZZ.createRoot(document.getElementById("root")).render(j.jsx(_e.StrictMode,{children:j.jsx(qTe,{})}));
